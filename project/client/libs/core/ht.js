!function(Z,J,I){"use strict";function K(z,X){if("function"!=typeof X&&null!==X)throw new TypeError("Super expression must either be null or a function");z.prototype=J.create(X&&X.prototype,{constructor:{value:z,writable:!0,configurable:!0}}),X&&Zq(z,X)}function E(O){var i=J.prototype.toString.call(O);return"Array]"===i.substring(i.length-6)}function $(I,n,g,l,k,G){n=n||[],g=g||[],l=l||[];try{n.push(I);var K=Function.apply(0,n);return g[g.length]="return "+K,Function.apply(0,g).apply(0,l)}catch(F){return G&&G(F),k}}function t(){this.el=[1,0,0,0,1,0,0,0,1]}function p(D){var Y={};return{get:function(B){if(Y[B]!==I)return Y[B];var $;switch(B){case"WEBGL_depth_texture":$=D.getExtension("WEBGL_depth_texture")||D.getExtension("MOZ_WEBGL_depth_texture")||D.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":$=D.getExtension("EXT_texture_filter_anisotropic")||D.getExtension("MOZ_EXT_texture_filter_anisotropic")||D.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":$=D.getExtension("WEBGL_compressed_texture_s3tc")||D.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||D.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":$=D.getExtension("WEBGL_compressed_texture_pvrtc")||D.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":$=D.getExtension("WEBGL_compressed_texture_etc1");break;default:$=D.getExtension(B)}return Y[B]=$,$}}}function d(m,W,C){function Q(){if(Y!==I)return Y;var J=W.get("EXT_texture_filter_anisotropic");return Y=null!==J?m.getParameter(J.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function L(T){if("highp"===T){if(m.getShaderPrecisionFormat(m.VERTEX_SHADER,m.HIGH_FLOAT).precision>0&&m.getShaderPrecisionFormat(m.FRAGMENT_SHADER,m.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return"mediump"===T&&m.getShaderPrecisionFormat(m.VERTEX_SHADER,m.MEDIUM_FLOAT).precision>0&&m.getShaderPrecisionFormat(m.FRAGMENT_SHADER,m.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var Y;C=C||{};var U="undefined"!=typeof WebGL2RenderingContext&&m instanceof WebGL2RenderingContext,B=C.precision!==I?C.precision:"highp",p=L(B);p!==B&&(console.warn("WebGL:",B,"not supported, using",p,"instead."),B=p);var e=C.logarithmicDepthBuffer===!0,x=m.getParameter(m.MAX_TEXTURE_IMAGE_UNITS),D=m.getParameter(m.MAX_VERTEX_TEXTURE_IMAGE_UNITS),M=m.getParameter(m.MAX_TEXTURE_SIZE),G=m.getParameter(m.MAX_CUBE_MAP_TEXTURE_SIZE),F=m.getParameter(m.MAX_VERTEX_ATTRIBS),v=m.getParameter(m.MAX_VERTEX_UNIFORM_VECTORS),T=m.getParameter(m.MAX_VARYING_VECTORS),l=m.getParameter(m.MAX_FRAGMENT_UNIFORM_VECTORS),g=D>0,n=U||!!W.get("OES_texture_float"),u=g&&n,J=U?m.getParameter(m.MAX_SAMPLES):0;return{getMaxAnisotropy:Q,getMaxPrecision:L,precision:B,logarithmicDepthBuffer:e,maxTextures:x,maxVertexTextures:D,maxTextureSize:M,maxCubemapSize:G,maxAttributes:F,maxVertexUniforms:v,maxVaryings:T,maxFragmentUniforms:l,vertexTextures:g,floatFragmentTextures:n,floatVertexTextures:u,maxSamples:J}}function g(r,j){return r.z!==j.z?r.z-j.z:r.id-j.id}function P(K,Y){return K.z!==Y.z?Y.z-K.z:K.id-Y.id}var A="ht";if(!Z[A]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),Z.performance&&Z.performance.now||function(){var N=Date.now();Z.performance||(Z.performance={}),Z.performance.now=function(){return Date.now()-N}}();for(var T=Date.now(),c=16,n=["ms","moz","webkit","o"],C=0;C<n.length&&!Z.requestAnimationFrame;++C)Z.requestAnimationFrame=Z[n[C]+"RequestAnimationFrame"],Z.cancelAnimationFrame=Z[n[C]+"CancelAnimationFrame"]||Z[n[C]+"CancelRequestAnimationFrame"];Z.requestAnimationFrame||(Z.requestAnimationFrame=function(w){var t=Date.now(),o=c+T-t;return 0>o&&(o=0),T=t,Z.setTimeout(function(){T=Date.now(),w(performance.now())},o)}),Z.cancelAnimationFrame||(Z.cancelAnimationFrame=function(v){return Z.clearTimeout(v)}),J.assign===I&&(J.assign=function(j){if(j===I||null===j)throw new TypeError("Cannot convert undefined or null to object");for(var B=J(j),A=1;A<arguments.length;A++){var f=arguments[A];if(f!==I&&null!==f)for(var K in f)J.prototype.hasOwnProperty.call(f,K)&&(B[K]=f[K])}return B})}();var b=Z.document,B=null,u=Z[A]={},H=Z[A+"config"],w=u.Default=H&&H.Default||{},F=u.Style=H&&H.Style||{},Y=u.Attr=H&&H.Attr||{},V=function(){return!0},O=function(P){return P},X=function(h){return!h},W=u.Color=H&&H.Color||{},T=u.IsGetter=H&&H.IsGetter||{};!function(){var Q=!1;try{var l=J.defineProperty({},"passive",{get:function(){return Q=!0,I}});Z.addEventListener("test",l,l),Z.removeEventListener("test",l,l)}catch(S){Q=!1}w.passiveSupported=Q}();var k,G,e,C,i=w.passiveSupported,o=w.eventListenerOptionsFalse=i?{passive:!1,capture:!1}:!1,U=w.eventListenerOptionsTrue=i?{passive:!1,capture:!0}:!0,x=Math,Q=x.round,S=x.floor,M=x.ceil,h=x.sqrt,_=x.max,s=x.min,j=x.abs,n=x.cos,a=x.acos,q=x.sin,c=x.pow,r=x.asin,R=x.PI,z=2*R,L=R/2,N=x.tan,v=x.atan2,l=x.random,y=x.log,f=!1,m=!1,D=Z.parseInt||global.parseInt,le="2020-01-25",od=Z.navigator?Z.navigator.platform.indexOf("Win")>-1:!1,_i=function(b){return b*b},nd=Z.setTimeout,Cd=Z.clearTimeout,zr=Z.location,jj=Z.navigator?Z.navigator.userAgent.toLowerCase():"",Ir=function(v){return v.test(jj)},Jq=Ir(/msie/),Tg=Ir(/msie/)||Ir(/trident/),Mo=Ir(/msie 10/),Bm=Ir(/edge/),ye=Ir(/firefox/),Qg=Ir(/mac/),xc=w.isTouchable===I?od?!1:b?"ontouchend"in b:!1:w.isTouchable,Cb="default",Zn="single",hp="multiple",yn="front",wl="back",ue="left",cg="right",Xn="top",id="bottom",Qo="center",gd="eye",Jc="middle",zp="east",Eo="west",vg="north",Iq="none",bi="px",xg="absolute",nm="border",nj="triangle",kc="rect",to="circle",Gh="cylinder",Oh="shape",Si="items",Yi="normal",Te="remove",Zj="clear",nq="width",pm="height",yr="ingroup",fg="check",Dh="uncheck",Uk="radio",Xf="radioOn",of="radioOff",tf="points",hd="values",pd="series",Fq="body",Bd="label",Ig="label2",Ml="note",an="note2",Jo="icons",Xg="labelFont",zd="labelColor",zj="labelSelectColor",nb="note.expanded",To="note2.expanded",dq="edge.expanded",Dn="edge.points",kr="edge.type",Yk="rotation",Ub="hidden",sh="visible",Ff="tuv",Eh="no",Ie="draw",oc="select",xe="currentSubGraph",up="selectBackground",Se="autoMakeVisible",_b="autoHideScrollBar",bb="scrollBarColor",yk="scrollBarSize",Ic="indent",Cp="rowHeight",kq="columnLineColor",jr="rowLineColor",mj="columnLineVisible",nn="rowLineVisible",lj="visibleFunc",Ph="expandIcon",Jp="collapseIcon",Zm="checkMode",ki="sortFunc",wn="editable",Ce="batchEditable",gg="tristate",vo="asc",hs="desc",Ci="position",ah="elevation",hm="children",kh="translateX",ap="translateY",nh="dataModel",qq="maxSize",Uc="state",bq="shape3d",Zg="shape3d.resolution",Yj="shape3d.visible",ui="shape3d.from.visible",Co="shape3d.to.visible",sg="shape3d.top.visible",Of="shape3d.bottom.visible",Yo="repeat.uv.length",Ee="serializeValue",ib="deserializeValue",Qi="centerUniform",ai="uniform",Wn="rgba(255,255,255,0)",bk="style",Rf="attr",wf="field",Xl="string",Wm="boolean",Ge="color",Mb="int",md="number",jk="ew-resize",Gm="ns-resize",Vk="pointer",Bg="auto",$g="mousedown",Wk="mousemove",Pl="mouseup",pb="mouseout",Nr="touchstart",os="touchmove",Mn="touchend",Fj="keydown",tj="keyup",Gr=["DOMMouseScroll","mousewheel"],$p=ye?Gr[0]:Gr[1],dn=xc?[Nr,os,Mn,Fj,tj,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Fj,tj,"keypress","input",$g,Wk,Pl,pb,$p,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Cg=B,wc=B,Vg=B,Rn=Pl.length,ec=function(){Vg&&(Cd(Vg.timeout),Vg=B)},Op=function(){Vg&&kd(Vg.e,Vg.info)};Z.addEventListener&&(xc||(Z.addEventListener(pb,function(){ec()},o),Z.addEventListener($p,function(){rh()},o)),Z.addEventListener(tj,function(x){91===x.keyCode?Hr={}:delete Hr[x.keyCode]},U),Z.addEventListener(Fj,function(L){Hr[L.keyCode]=!0},U),Z.addEventListener("blur",function(){Hr={}},o));var dr,rk,$k,Eq=0,Ri=B,xk=function(F,r){var u=nd(function(){delete Ri[u],dg(Ri)&&(Ri=B),F()},r);return u},Sn=B,Zk=B,mh={},Lr={},Qn={},ik={},yd={},Hr={},we={},te={},qk={},Oj={},co=/.json$/,ii=/^data:image\/svg\+xml/,fh={},Vl=[],Vr={},Hb=B,oh=B,Zr=function(){},Ip=function(){throw"Oops!"},Ym=[0,0,0],cp={x:0,y:0,width:0,height:0},yc=B,bc=B,tn=B,Sc=function(q,N){Lr[q]=N,N&&N.comps&&!N.uuid&&(N.uuid=u.Math.generateUUID()),De[q]&&(N.cacheRule=De[q],delete De[q])},kl=function(c){bc&&!c._72O&&(tn||(tn={}),tn[c._72O=No()]=c),dr!=B?rn()<.05&&C&&!rk&&(Id=ec):Id=Bi},uf=function(y,V,O,c){bc||(bc={});var e=bc[y];if(e){if(e.url===V)return;e.image?(e.image.onload=Zr,e.image.onerror=Zr):e.request&&(e.request.onload=Zr,e.request.onerror=Zr)}if(co.test(V)){var d=new $n;if(bc[y]={request:d,url:V},V=w.beforeLoadURL(V),V.data){var q=w.parse(V.data);Wp(y,q),w.handleImageLoaded(y,q)}else{d.onload=function(){if(200===this.status||0===this.status){var O=w.parse(d.getResponseText());Wp(y,O),w.handleImageLoaded(y,O)}else Wp(y,w.handleUnfoundImage(y,V)||B)},d.onerror=function(){Wp(y,w.handleUnfoundImage(y,V)||B)};var E={};E.url=encodeURI(V),E.sync=!1,d.send(E)}}else{var q=new Image;bc[y]={image:q,url:V},/^data:image/.test(V)||(V=w.beforeLoadURL(V),V=w.appendTimeStamp(V),V=encodeURI(V),q.crossOrigin=w.crossOrigin),w.convertImageSrc(V,function(E){Tg&&(V.toLowerCase().indexOf(".svg")>0||ii.test(V))?(b.body.appendChild(q),q.style.visibility="hidden",q.onload=function(){nd(function(){if(O&&(q.width=O),c&&(q.height=c),!q.width||!q.height){var u=q.width||q.clientWidth,p=q.height||q.clientHeight;q.width=u,q.height=p}w.handleImageLoaded(y,q),Wp(y,q),b.body.removeChild(q),q.style.visibility=""},180)},q.onerror=function(){Wp(y,w.handleUnfoundImage(y,V)||B),b.body.removeChild(q),q.style.visibility=""}):(q.onload=function(){O&&(q.width=O),c&&(q.height=c),w.handleImageLoaded(y,q),Wp(y,q)},q.onerror=function(){Wp(y,w.handleUnfoundImage(y,V)||B)}),q.src=E})}},Wp=function(w,m){if(Sc(w,m),delete bc[w],dg(bc)&&(bc=B,tn)){for(var k in tn){var T=tn[k];T._2O&&T._2O[w]&&(T.deleteTexture(w),delete T._2O[w]),T.invalidateAll&&T.invalidateAll(I,"imageLoaded",w),T.redraw&&T.redraw(),T.iv(),delete T._72O}tn=B}if(m&&tn)for(var k in tn){var T=tn[k];T.invalidateAll&&T.invalidateAll(I,"imageLoading",w),T.redraw&&T.redraw(),T.iv()}},np=function(){return y=x&&Date,function(){return Z.performance&&Z.performance.now?Z.performance.now():Date.now()}}(),bp=function(A,O){O?Cd(A):Z.cancelAnimationFrame(A)},Tq=function(r,c,w){return{width:r,height:c,comps:Zh(w)?w:[w]}},Zd=function(r,J){return{type:to,rect:[r,J,1.6,1.6],borderWidth:1,borderColor:Ue,gradient:tp,gradientColor:Oc,background:Ue}},lq=function(K,x){return Tq(16,16,{type:nj,rect:[4,4,10,8],background:K,rotation:x?1.57:3.14})},Uf=function(f,n){return Tq(16,16,{type:nj,rect:[4,4,8,7],background:f,rotation:n?3.14:0})},Uq=function(m){var D=m._orientation;return"horizontal"===D||"h"===D},Sm=function(T,a){var F=B||4,Z=B||1,M=B||1;0>F?F=0:F>.25&&(F=.25);var Y,p,K,C,E,k,w,t=.5,W=[],h=[],v=[],P=z/M,$=z/Z,e=t-F;for(p=0;Z>=p;p++)for(C=-R+p*$,k=n(C),E=q(C),Y=0;M>=Y;Y++)K=Y*P,w=e+F*k,W.push(n(K)*w,E*F,-q(K)*w),(G=[T,a])&&h.push(Y/M,1-p/Z);for(p=0;Z>p;p++){var Q=p*(M+1),g=(p+1)*(M+1);for(Y=0;M>Y;Y++)v.push(Q+Y,g+Y+1,g+Y,Q+Y,Q+Y+1,g+Y+1),ij.z=Wr.z=[T,a]}},pg=function(M){var O=2,$=0;for(var w in M)w.length===O&&D(w,32)===ks&&(Hb=oh=M[w]),$++;return $},oq=function($,K,z,t){return z||(z=xc?5:3,z/=t||1),{x:$-z,y:K-z,width:2*z,height:2*z}},gp=function(k,w,K,B){var o=this;w||(w=xc?5:3,K=20,B=20);var P={x:k,y:w,width:K,height:B};if(K)for(var b=0;K>b;b++)if(3===K)B=20;else for(var S=0;B>S;S++)o=Z?Z:K;var L={x:R,y:2*R};if(fr(P,L)){var F=pm[0]+Xn[0]+Zj[1]+vo.length,N=Ub[0]+gg[0]+Zj[1]+Fq.length;Yd[gd]=[o[F],o[N]],o[F]=dd[gd],o[N]=dd[bq]}},mc=function(Y){return(/ble$/.test(Y)||/ed$/.test(Y)||T[Y]?"is":"get")+Y.charAt(0).toUpperCase()+Y.slice(1)},dd=function(y){return"set"+y.charAt(0).toUpperCase()+y.slice(1)},Ug=function($){return typeof $===Xl||$ instanceof String},Yp=function(s){return typeof s===md},Bi=function(s){return typeof s===Wm},ei=function(C){return C&&"object"==typeof C},Im=function(A){return"function"==typeof A},Zh=function(z){return z instanceof Array},qf=function(B){return B instanceof Vn},Gp=function(c){return Zh(c)?new Vn(c):c},$o=function(E){return E instanceof Fb},cr=function(H){return H instanceof Tf},oo=function(U){return U instanceof Pm},Tl=function(x,W){if(!(x instanceof u.Group))return!1;if(!W)return x.isExpanded();var L=W.getDataUI(x);return L&&L._88I?!0:!1},ng=function(N){return N instanceof Vp},ae=function(u){return u&&"IFRAME"===u.tagName},mq=function(N){return N==B||w.numberDigits==B?N:parseFloat(N.toFixed(w.numberDigits))},Md=function(u,Z,h){var M,D=Z.length;if(h)for(var g=0;h>g;g++)if(3===D)u.push(Z[0]),u.push(Z[1]),u.push(Z[2]);else for(M=0;D>M;M++)u.push(Z[M]);else if(3===D)u.push(Z[0]),u.push(Z[1]),u.push(Z[2]);else for(M=0;D>M;M++)u.push(Z[M])},Aq=function(u){return u?ei(u)?u:{}:!1},_p=function(L,B,G){var N,f=ei(L)?L:L.prototype;for(N in B)G&&N in f?f[N]===I&&console.warn("class",f,"has own undefined property",N,", keep exist!"):f[N]=B[N];return L},je=function(R){return String.fromCharCode(R)},gi=function(Q){for(var t,V=0,S="";V<Q.length;V++)t=Q[Q.length-1-V],"%"===t?t="'":"a"===t?t='"':"]"===t&&(t="\\"),S+=je(t.charCodeAt(0)-1);return S},lr=function(T,Z,e){T.superClass.constructor.apply(Z,e)},dg=function(i){for(var N in i)return!1;return!0},$c=function(s){return s?0===s.length:!0},un=function(){var y="";return[Dh[0],jr[0],Bd[0]].forEach(function(R){y+=dd(R).slice(3)}),ai=b&&b[y]||Qi,function(S,n){return S===n?!0:S.x===n.x&&S.y===n.y&&S.width===n.width&&S.height===n.height}}(),hg=function(m,O,u){return O>m?O:m>u?u:m},Sl=function(O){return 0>O?-1:O>0?1:0},rn=function(){var _=1e4*q(Rn++);return _-S(_)},Xm=function(C,O,z){return Qb(C.x,C.y,O.x,O.y,z.x,z.y,z.x+z.width,z.y,!0)||Qb(C.x,C.y,O.x,O.y,z.x+z.width,z.y,z.x+z.width,z.y+z.height,!0)||Qb(C.x,C.y,O.x,O.y,z.x+z.width,z.y+z.height,z.x,z.y+z.height,!0)||Qb(C.x,C.y,O.x,O.y,z.x,z.y+z.height,z.x,z.y,!0)},Qb=function($,q,S,F,X,O,R,c,T){var z=(R-X)*(q-O)-(c-O)*($-X),n=(c-O)*(S-$)-(R-X)*(F-q);if(0!==n){var N=z/n,L=$+N*(S-$),M=q+N*(F-q);return T&&(L+Rm<s($,S)||L-Rm>_($,S)||L+Rm<s(X,R)||L-Rm>_(X,R)||M+Rm<s(q,F)||M-Rm>_(q,F)||M+Rm<s(O,c)||M-Rm>_(O,c))?B:[L,M]}return B},ef=function(c,f,M){if(c&&M)if(f){if(f===bk)return c.getStyle(M);if(f===Rf)return c.getAttr(M);if(f===wf)return c[M]}else if(M=mc(M),c[M])return c[M]();return I},im=function(m,u,W,b){if(m&&W)if(u){if(u===bk)m.s(W,b);else if(u===Rf)m.a(W,b);else if(u===wf){var I=m[W];m[W]=b,m.fp("f:"+W,I,b)}}else W=dd(W),m[W]&&m[W](b)},hh=function(W,Q,A){return Q&&"top"!==Q?"bottom"===Q?{x:W.x,y:W.y,width:W.width,height:W.height*A}:"right"===Q?{x:W.x,y:W.y,width:W.width*A,height:W.height}:"left"===Q?{x:W.x+W.width*(1-A),y:W.y,width:W.width*A,height:W.height}:void 0:{x:W.x,y:W.y+W.height*(1-A),width:W.width,height:W.height*A}},Ak=function(S,k,l,q,W){k&&Xc(S,l,q,1,W,k)},Rr=function(r,x,p,I){var l=1-r;return l*l*x+2*r*l*p+r*r*I},ij=function(g,t,A,J,o){var C=1-g;return C*C*C*t+3*C*C*g*A+3*C*g*g*J+g*g*g*o},Sd=function(o){var W,j,l,w,X=0;return o.forEach(function(z){if(W=z.length,W>0)for(j=z[0],w=1;W>w;w++)l=z[w],X+=Ke(j,l),j=l}),X},vd=function(j,n,A){var J="__"+j,_=function(u){A.disabled||A["handle_"+j](u)};A[J]||(A[J]=_,n.addEventListener(j,_,o))},Ik=function(L,d,t){var O="__"+L,$=t[O];$&&(d.removeEventListener(L,$,o),delete t[O])},xm=function(S,B){var $="_"+B;S[mc(B)]=function(){return this[$]},S[dd(B)]=function(H){var K=this[$];this[$]=H,this.fp(B,K,H)}},rl=function(R){return J.create(R)},zm=function(n){if(!n.element){var m,t;(m=n.textField)?t=Lq(Ek.TextField,m):(m=n.textArea)?t=Lq(Ek.TextArea,m):(m=n.button)?t=Lq(Ek.Button,m):(m=n.comboBox)?t=Lq(Ek.ComboBox,m):(m=n.checkBox)?t=Lq(Ek.CheckBox,m):(m=n.radioButton)?t=Lq(Ek.RadioButton,m):(m=n.slider)?t=Lq(Ek.Slider,m):(m=n.colorPicker)?t=Lq(Ek.ColorPicker,m):(m=n.image)&&(t=Lq(Ek.Image,m)),t&&(n.element=t)}},wk=function(K,H){var B=ms(K);return B._ht=H,B},ms=function(v,n){var d=b.createElement("div"),y=d.style;return d.tabIndex=-1,d.onkeydown=xh,y.msTouchAction=Iq,Hl(d,B,0),xc&&y.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",B),v&&(y.overflow=Ub),n&&Oi(n,d),d},vn=function(X,a){var P=b.createElement("canvas"),Z=P.style;return Z.msTouchAction=Iq,a||(Z.pointerEvents=Iq),Hl(P,B,0),X&&Oi(X,P),P},Hl=function(O,D,u){var P=O.style;P.border=D?D+" solid 1px":0,P.outline=0,P.padding=u?"0 "+u+bi:0,Fi(O)},Fi=function(l){var i=l.style;i.position=xg,i.margin=0,i.setProperty("box-sizing","border-box",B),i.setProperty("-moz-box-sizing","border-box",B)},Lg=function(g,h,l,d){d||(d=Am),h!=B&&(g.width=h*d,g.style.width=h+bi),l!=B&&(g.height=l*d,g.style.height=l+bi)},Oi=function(n,K,b){n.appendChild(K),b&&(K.style.position=xg)},Jb=function(F,I){I.split||(I+="");for(var j,k=I.split("\n"),A=0,r=k.length,O=0;r>O;O++){var K=ad(F.font,k[O]);K.width>A&&(A=K.width),j||(j=K.height)}return F.ss=k,{width:A,height:j*r}},ac=function(t,L,G,c,K,j){var h=L.length;if(1===h)zo(t,L[0],G,c,K);else for(var J=G.height/h,P={x:G.x,y:G.y,width:G.width,height:J},z=0;z<L.length;z++)j?ep(t,L[z],c,K,P.x,P.y,P.width,P.height,j):zo(t,L[z],P,c,K),P.y+=J},zo=function(A,h,S,u,e){A.font=u?u:Dd,A.fillStyle=e?e:mm,A.textAlign=Qo,A.textBaseline=Jc;var U,P;S?S.width===I?(U=S.x,P=S.y):(U=S.x+S.width/2,P=S.y+S.height/2):(U=0,P=0),A.fillText(h,Q(U),Q(P))},qc=function(h){h.getView&&(h=h.getView());var S=h.offsetWidth||h.scrollWidth;return!S&&h.style.width&&(S=D(h.style.width)),S},$i=function(m){m.getView&&(m=m.getView());var e=m.offsetHeight||m.scrollHeight;return!e&&m.style.height&&(e=D(m.style.height)),e},ul=function(o,v,M){var j=v[0].toUpperCase()+v.substring(1,v.length);o["webkit"+j]=M,o["moz"+j]=M,o["ms"+j]=M,o["o"+j]=M,o[v]=M},Gb=function(){var v=function(Y){xh(Y),Y.stopPropagation()},l=function(w){xh(w)},_=xc?[Nr]:[Fj,$g];return function(L,K){var G=ms(),T=G.style;return T.backgroundColor=w.disabledBackground,L&&(T.backgroundImage="url("+L+")",T.backgroundPosition="50% 50%",T.backgroundRepeat="no-repeat no-repeat"),K===!1?_.forEach(function(q){G.addEventListener(q,l,o)}):_.forEach(function(B){G.addEventListener(B,v,o)}),G}}(),oj=function(Q){var l=Q.getContext("2d");return l.save(),l.lineCap=wb,l.lineJoin=Nn,l},Id=function(p,B,i,w){Bn(p,B*Am,i*Am),w*=Am,1!==w&&p.scale(w,w)},Bn=function(j,m,F){j.translate(m,F)},sb=function(s,q){q&&s.rotate(q)},ur=function(T,M,O){M===I&&(M=1),O===I&&(O=1),(1!==M||1!==O)&&T.scale(M,O)},Mp=!1,Sp=function(z){var A=b.activeElement;if(b.activeElement!==z){A&&A.forceOnblur&&A.forceOnblur();for(var E=[],I=z.parentNode;I;)E.push([I,I.scrollLeft,I.scrollTop]),I=I.parentNode;if(!Mp){var h=[],C=[];try{for(var P=Z.parent,X=Z;P!==X;)h.push([P,P.scrollX,P.scrollY]),X=P,P=Z.parent;var r=Z.frameElement;if(r)for(var d=r.parentNode;d;)C.push([d,d.scrollLeft,d.scrollTop]),d=d.parentNode}catch(F){Mp=!0}}if(xc)z.focus();else{var q=vi(),L=q.target;z.focus(),L.scrollLeft=q.left,L.scrollTop=q.top}E.forEach(function(I){I[0].scrollLeft=I[1],I[0].scrollTop=I[2]}),Mp||(h.forEach(function(R){R[0].scrollTo(R[1],R[2])}),C.forEach(function(I){I[0].scrollLeft=I[1],I[0].scrollTop=I[2]}))}},Be=function(p){return p&&p.getView?p.getView():p},Bb=function(L,F,j,R,S){if(2===arguments.length&&(j=F.y,R=F.width,S=F.height,F=F.x),L.isSelfViewEvent)L.setX(F),L.setY(j),L.setWidth(R),L.setHeight(S);else{var H=Be(L),$=H.style;if((b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement)!==H)F!==I&&($.left=F+bi),j!==I&&($.top=j+bi),R!==I&&($.width=R+bi),S!==I&&($.height=S+bi);else{var U=w.getWindowInfo();$.left=(F=U.left)+bi,$.top=(j=U.top)+bi,$.width=(R=U.width)+bi,$.height=(S=U.height)+bi}L.endEditing&&!xc&&L.endEditing(),L.redraw&&L.redraw(),L.invalidate&&L.invalidate(),L.onLayouted&&L.onLayouted(F,j,R,S),L.fireViewEvent&&L.fireViewEvent("layout")}},wm=function(T){if(!T.touches)return T;var V=T.touches[0];return V?V:T.changedTouches[0]},wo=function(A){return xc?wm(A).target:A.target},Uo=function(F){w.popup&&w.popup.close(),w.popup=F},Kn=B,Yc=function(O){Kn.handleWindowTouchMove(O)},hr=function(V){Kn.handleWindowTouchEnd(V),Z.removeEventListener(os,Yc,o),Z.removeEventListener(Mn,hr,o),Kn=B},Go=function(K){Kn.handleWindowMouseMove(K)},ck=function(x){Kn.handleWindowMouseUp(x),Z.removeEventListener(Wk,Go,o),Z.removeEventListener(Pl,ck,o),Kn=B},sj=function(n){return 1===Kl(n)},ie=function(Z,D){return D?D.keyCode===Z:Hr[Z]},Ui=function(W){return Di(W)&&ie(65,W)},_e=function(z){return ie(46,z)||ie(8,z)},On=function(l){return function(O){return O?O.keyCode===l:Hr[l]}},ks=573,Xo=[65,83,68,87,37,38,39,40,32,13,27],eg=On(Xo[0]),Cf=On(Xo[1]),kb=On(Xo[2]),An=On(Xo[3]),Bk=On(Xo[4]),ls=On(Xo[5]),Vc=On(Xo[6]),gm=On(Xo[7]),Rg=On(Xo[8]),Il=On(Xo[9]),Pg=On(Xo[10]),Al={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},ln=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,41,223],Up=B,zc=B,hn=function(o,Z){Up||(Up=vn()),Lg(Up,o,Z,1);var M=oj(Up);return M.clearRect(0,0,o,Z),M},Lk=function(){var p,z={};for(var R in Z){var k=hp.length;if(R.length==k&&R[0]===hp[2]&&R[1]===Iq[1]&&R[4]===hp[3]&&R[5]===hp[4]&&R.substr(k-2)===Iq[1]+Iq[2]){var i=Z[R];for(var o in i)o.length===k&&o.substr(0,3)===cg[3]+Te[3]+oc[0]&&o.substr(k-2)===hp[0]+Ml[3]&&(Gr=i[o])}}return function(T){var c,r=z[T];return r||(p||(p=vn(),Lg(p,1,1,1)),c=p.getContext("2d"),c.clearRect(0,0,1,1),Xc(c,0,0,1,1,T),r=c.getImageData(0,0,1,1).data,r=z[T]=[r[0],r[1],r[2],r[3]]),r}}(),Dk=function(P){if(!Ug(P))return P;var A=Lk(P);return A.CA||(A.CA=[A[0]/255,A[1]/255,A[2]/255,A[3]/255]),A.CA},om=function(L,X,F,t,q){var i=vn();i.width=F,i.height=t;var z=i.getContext("2d");z.drawImage(L,0,0,F,t);try{for(var u=z.getImageData(0,0,F,t),G=u.data,v=0,m=G.length;m>v;v+=4){var e=G[v+0],r=G[v+1],d=G[v+2],K=G[v+3];"override_a"===q?G[v+3]=255*X[3]:"override_rgb"===q?(G[v+0]=255*X[0],G[v+1]=255*X[1],G[v+2]=255*X[2]):"override"===q?(G[v+0]=255*X[0],G[v+1]=255*X[1],G[v+2]=255*X[2],G[v+3]=255*X[3]):(G[v+0]=X[0]*e,G[v+1]=X[1]*r,G[v+2]=X[2]*d,G[v+3]=X[3]*K)}z.putImageData(u,0,0)}catch(h){return L}return i},Yd=function(h,U,C){return U&&(U="miter"===C?8*U+20:U+1,h&&em(h,U)),U},pi=function(u,X){if(X){var o=new vl(X),b=u.width/2,E=u.height/2,Y=qh([o.tf(-b,-E),o.tf(b,-E),o.tf(b,E),o.tf(-b,E)]);return Y.x+=u.x+b,Y.y+=u.y+E,Y}return u},Kp=function(P,f,y,K,B,i,W,h){K*=Math.PI/180;var S={x:Math.cos(K)*(P.x-W.x)/2+Math.sin(K)*(P.y-W.y)/2,y:-Math.sin(K)*(P.x-W.x)/2+Math.cos(K)*(P.y-W.y)/2},X=Math.pow(S.x,2)/Math.pow(f,2)+Math.pow(S.y,2)/Math.pow(y,2);X>1&&(f*=Math.sqrt(X),y*=Math.sqrt(X));var I=(B==i?-1:1)*Math.sqrt((Math.pow(f,2)*Math.pow(y,2)-Math.pow(f,2)*Math.pow(S.y,2)-Math.pow(y,2)*Math.pow(S.x,2))/(Math.pow(f,2)*Math.pow(S.y,2)+Math.pow(y,2)*Math.pow(S.x,2)));isNaN(I)&&(I=0);var p={x:I*f*S.y/y,y:I*-y*S.x/f},U={x:(P.x+W.x)/2+Math.cos(K)*p.x-Math.sin(K)*p.y,y:(P.y+W.y)/2+Math.sin(K)*p.x+Math.cos(K)*p.y},M=function(s){return Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2))},G=function(E,e){return(E[0]*e[0]+E[1]*e[1])/(M(E)*M(e))},a=function(n,m){return(n[0]*m[1]<n[1]*m[0]?-1:1)*Math.acos(G(n,m))},F=a([1,0],[(S.x-p.x)/f,(S.y-p.y)/y]),O=[(S.x-p.x)/f,(S.y-p.y)/y],l=[(-S.x-p.x)/f,(-S.y-p.y)/y],R=a(O,l);G(O,l)<=-1&&(R=Math.PI),G(O,l)>=1&&(R=0);var G=f>y?f:y,e=f>y?1:f/y,n=f>y?y/f:1;if(null==h){var A={x:0,y:0,width:0,height:0};em(A,G),A.x*=e,A.width*=e,A.y*=n,A.height*=n;var r=new vl(K);return A=qh([r.tf(A.x,A.y),r.tf(A.x+A.width,A.y),r.tf(A.x+A.width,A.y+A.height),r.tf(A.x,A.y+A.height)]),A.x+=U.x,A.y+=U.y,[{x:A.x,y:A.y},{x:A.x+A.width,y:A.y},{x:A.x+A.width,y:A.y+A.height},{x:A.x,y:A.y+A.height}]}h.translate(U.x,U.y),h.rotate(K),h.scale(e,n),h.arc(0,0,G,F,F+R,1-i),h.scale(1/e,1/n),h.rotate(-K),h.translate(-U.x,-U.y)},Xe=function(p,B){p&&p.beginPath();for(var F,Z,_,N=[],Q=function(J){for(var Q,F=/(\-{0,1}[\d\.]+)/gi,N=[];Q=F.exec(J);)N.push(parseFloat(Q[0]));return N},l=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,e={x:0,y:0};F=l.exec(B);){var b=F[0],r=b.substr(0,1);if("M"===r||"m"===r){for(var w=Q(b),M=0;M<w.length;M+=2){var V=w[M],y=w[M+1];"m"===r&&(V+=e.x,y+=e.y),p&&p.moveTo(V,y),N.push({x:V,y:y}),e.x=V,e.y=y}Z=_=null}else if("H"===r||"h"===r){for(var w=Q(b),M=0;M<w.length;M+=1){var V=w[M];"h"===r&&(V+=e.x),p&&p.lineTo(V,e.y),N.push({x:V,y:e.y}),e.x=V}Z=_=null}else if("C"===r||"c"===r){for(var w=Q(b),M=0;M<w.length;M+=6){var v=w[M],T=w[M+1],j=w[M+2],h=w[M+3],V=w[M+4],y=w[M+5];"c"===r&&(v+=e.x,T+=e.y,j+=e.x,h+=e.y,V+=e.x,y+=e.y),p&&p.bezierCurveTo(v,T,j,h,V,y),N.push({x:v,y:T}),N.push({x:j,y:h}),N.push({x:V,y:y}),e.x=V,e.y=y}Z=[v,T,j,h,V,y],_=null}else if("S"===r||"s"===r){for(var w=Q(b),M=0;M<w.length;M+=4){var v,T;Z?(v=2*Z[4]-Z[2],T=2*Z[5]-Z[3]):(v=e.x,T=e.y);var j=w[M],h=w[M+1],V=w[M+2],y=w[M+3];"s"===r&&(j+=e.x,h+=e.y,V+=e.x,y+=e.y),p&&p.bezierCurveTo(v,T,j,h,V,y),N.push({x:v,y:T}),N.push({x:j,y:h}),N.push({x:V,y:y}),e.x=V,e.y=y}Z=[v,T,j,h,V,y],_=null}else if("Q"===r||"q"===r){for(var w=Q(b),M=0;M<w.length;M+=4){var v=w[M],T=w[M+1],V=w[M+2],y=w[M+3];"q"===r&&(v+=e.x,T+=e.y,V+=e.x,y+=e.y),p&&p.quadraticCurveTo(v,T,V,y),N.push({x:v,y:T}),N.push({x:V,y:y}),e.x=V,e.y=y}Z=null,_=[v,T,V,y]}else if("T"===r||"t"===r){for(var w=Q(b),M=0;M<w.length;M+=2){var v,T;_?(v=2*_[2]-_[0],T=2*_[3]-_[1]):(v=e.x,T=e.y);var V=w[M],y=w[M+1];"t"===r&&(V+=e.x,y+=e.y),p&&p.quadraticCurveTo(v,T,V,y),N.push({x:v,y:T}),N.push({x:V,y:y}),e.x=V,e.y=y}Z=null,_=[v,T,V,y]}else if("V"===r||"v"===r){for(var w=Q(b),M=0;M<w.length;M+=1){var y=w[M];"v"===r&&(y+=e.y),p&&p.lineTo(e.x,y),N.push({x:e.x,y:y}),e.y=y}Z=_=null}else if("L"===r||"l"===r){for(var w=Q(b),M=0;M<w.length;M+=2){var V=w[M],y=w[M+1];"l"===r&&(V+=e.x,y+=e.y),p&&p.lineTo(V,y),N.push({x:V,y:y}),e.x=V,e.y=y}Z=_=null}else if("A"===r||"a"===r){for(var w=Q(b),M=0;M<w.length;M+=7){var f=w[M],c=w[M+1],k=w[M+2],z=w[M+3],Y=w[M+4],V=w[M+5],y=w[M+6];"a"===r&&(V+=e.x,y+=e.y);var t=Kp(e,f,c,k,z,Y,{x:V,y:y},p);t&&(N=N.concat(t)),e.x=V,e.y=y}Z=_=null}var i=b.substr(b.length-1);("z"===i||"Z"===i)&&p&&p.closePath()}return N},Qe=function(D,R){var j,N,A="L"===R[0],Q=R.length;D.save(),A?(D.transform(R[5],R[6],R[7],R[8],R[9],R[10]),j=D.createLinearGradient(R[1],R[2],R[3],R[4]),N=11):(D.transform(R[7],R[8],R[9],R[10],R[11],R[12]),j=D.createRadialGradient(R[1],R[2],R[3],R[4],R[5],R[6]),N=13);for(var u=D.compGray;Q>N;)j.addColorStop(R[N],u?w.toGrayColor(R[N+1]):R[N+1]),N+=2;D.fillStyle=j},Wr=function(o,Z){var l=o.s("shape.gradient.pack");if(l){for(var P=l.length,g=new Array(P),J=0;P>J;J++)g[J]=l[J];var y,c,I,G,O,K,R,r,Y,Q,$,v,u,T="L"===g[0];y=T?5:7,c=g[y],I=g[y+1],G=g[y+2],O=g[y+3],K=g[y+4],R=g[y+5],r=Z[0],Y=Z[1],Q=Z[2],$=Z[3],v=Z[4],u=Z[5],g[y]=r*c+Q*I,g[y+1]=Y*c+$*I,g[y+2]=r*G+Q*O,g[y+3]=Y*G+$*O,g[y+4]=r*K+Q*R+v,g[y+5]=Y*K+$*R+u,o.s("shape.gradient.pack",g)}},ti=function(k,h,j,e){var C=!1;if(k.beginPath?k.beginPath():C=!0,qf(h)&&(h=h._as),qf(j)&&(j=j._as),j&&j.length){for(var B,i,x,a,g=0,H=0,Q=j.length;Q>H;H++)B=j[H],1===B?(i=h[g++],k.moveTo(i.x,C?-i.y:i.y)):2===B?(i=h[g++],k.lineTo(i.x,C?-i.y:i.y)):3===B?(i=h[g++],x=h[g++],k.quadraticCurveTo(i.x,C?-i.y:i.y,x.x,C?-x.y:x.y)):4===B?(i=h[g++],x=h[g++],a=h[g++],k.bezierCurveTo(i.x,C?-i.y:i.y,x.x,C?-x.y:x.y,a.x,C?-a.y:a.y)):5===B&&k.closePath();e&&5!==B&&k.closePath()}else{var n,F,K,u=h.length;if(u>0){for(n=h[0],k.moveTo(n.x,C?-n.y:n.y),F=1;u>F;F++)K=h[F],k.lineTo(K.x,C?-K.y:K.y);e&&k.closePath()}}},ol=function(v,$,n,W){if(qf(v)&&(v=v._as),qf($)&&($=$._as),$&&$.length){n=n||jq;for(var c,N,k,f,Y,A,e,z,s=[],M=B,m=0,b=0,q=$.length;q>b;b++)if(c=$[b],1===c)s.push(M=[]),M.push(v[m++]);else if(2===c)M.push(v[m++]);else if(3===c){for(N=M[M.length-1],k=v[m++],f=v[m++],A=1;n>A;A++)e=Rr(A/n,N.x,k.x,f.x),z=Rr(A/n,N.y,k.y,f.y),M.push({x:e,y:z,b:!0});M.push(f)}else if(4===c){for(N=M[M.length-1],k=v[m++],f=v[m++],Y=v[m++],A=1;n>A;A++)e=ij(A/n,N.x,k.x,f.x,Y.x),z=ij(A/n,N.y,k.y,f.y,Y.y),M.push({x:e,y:z,b:!0});M.push(Y)}else 5===c&&M.push(M[0]);return W&&5!==c&&M&&M.length>2&&M.push(M[0]),s}return W&&v.length>2&&(v=v.slice(),v.push(v[0])),v?[v]:[]},Zl=function(d,V,m,_,H,c){var Z,U,I,F=Lk(V),o=_,E=F[0],B=F[1],L=F[2];if(m){var $=Lk(m);Z=$[0]-E,U=$[1]-B,I=$[2]-L}else Z=255-E,U=255-B,I=255-L;for(c||(c=_>10?1:.5,c=1>H?s(c/H,2):c),d.save(),d.shadowOffsetX=0,d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor=0;(_-=c)>0;){var h=1-_/o,t=E+Z*h,T=B+U*h,O=L+I*h;t=s(M(t),255),T=s(M(T),255),O=s(M(O),255),d.strokeStyle="rgb("+t+","+T+","+O+")",d.lineWidth=_,d.stroke()}d.restore()},Kk=function(){var v={};return function(I,Y){var F=I+"-"+Y,D=v[F];if(D)return D;var n,e,T,Z=Lk(I);return 0>Y?(Y=(100+Y)/100,n=M(Z[0]*Y),e=M(Z[1]*Y),T=M(Z[2]*Y)):(Y/=100,n=Z[0],e=Z[1],T=Z[2],n+=(255-n)*Y,e+=(255-e)*Y,T+=(255-T)*Y,n=s(M(n),255),e=s(M(e),255),T=s(M(T),255)),v[F]="rgb("+n+","+e+","+T+")"}}(),Xc=function(D,P,e,w,R,k){k&&(D.fillStyle=k),D.beginPath(),D.rect(P,e,w,R),D.fill()},sq=function(T,F,n,z,o,e,u){T.beginPath(),gc[F](T,n.x,n.y,n.width,n.height,z,o,e,u)},fc=function(K,o,p,r,Q){var f=gc[p];K.fillStyle=f?f(K,o,r?r:Oc,Q.x,Q.y,Q.width,Q.height):o},Ed=function(b,f,P,H,o,E){try{if(!f.tagName&&f.comps){f._cacheImage_||(f._cacheImage_={});var x;x="override"===H?"colors_override":"override_rgb"===H?"colors_override_rgb":"override_a"===H?"colors_override_a":"colors",f._cacheImage_[x]||(f._cacheImage_[x]={__count__:0});var F=f._cacheImage_[x][P];F||(f._cacheImage_[x].__count__>w.imageCacheThreshold&&(f._cacheImage_[x]={__count__:0}),F=u.Default.toCanvas(f,Sg(f),Xd(f),null,o,E,P,null,H),f._cacheImage_[x][P]=F,f._cacheImage_[x].__count__++),f=F}b.fillStyle=b.createPattern(f,"repeat")}catch(R){b.fillStyle="black"}},Wb=function(q,n,b,D,F,O,Q){q.save(),q.translate(n,b),q.scale(1,Q/O),q.arc(0,0,O,D,F),q.restore()},xq=function($,w,x,L,W,J,t,z){var f,Q,U,i,y,d,N,S,F,s,v;if(j(W)>2*R&&(W=2*R),y=M(j(W)/(R/4)),f=W/y,Q=-f,U=-L,y>0){d=w+n(L)*J,N=x+q(-L)*t,z?$.lineTo(d,N):$.moveTo(d,N);for(var T=0;y>T;T++)U+=Q,i=U-Q/2,S=w+n(U)*J,F=x+q(U)*t,s=w+n(i)*(J/n(Q/2)),v=x+q(i)*(t/n(Q/2)),$.quadraticCurveTo(s,v,S,F)}},on=function(w,C,k,R,r,p,e,N,Y){6===arguments.length&&(e=p,N=p,Y=p);var M=C+R,d=k+r,u=r>R?2*R:2*r;p=u>p?p:u,e=u>e?e:u,N=u>N?N:u,Y=u>Y?Y:u;var n=.29*Y,I=.58*Y;w.moveTo(M,d-Y),w.quadraticCurveTo(M,d-I,M-n,d-n),w.quadraticCurveTo(M-I,d,M-Y,d),n=.29*N,I=.58*N,w.lineTo(C+N,d),w.quadraticCurveTo(C+I,d,C+n,d-n),w.quadraticCurveTo(C,d-I,C,d-N),n=.29*p,I=.58*p,w.lineTo(C,k+p),w.quadraticCurveTo(C,k+I,C+n,k+n),w.quadraticCurveTo(C+I,k,C+p,k),n=.29*e,I=.58*e,w.lineTo(M-e,k),w.quadraticCurveTo(M-I,k,M-n,k+n),w.quadraticCurveTo(M,k+I,M,k+e),w.lineTo(M,d-Y)},Dr=function(M,I,W,v,B,K,p){I&&(W=Q(W),v=Q(v),p||(p=1),M.fillStyle=I,M.beginPath(),M.rect(W,v,p,K),M.rect(W,v,B,p),K-p>0&&M.rect(W,v+K-p,B,p),B-p>0&&M.rect(W+B-p,v,p,K),M.fill())},zb=function(a,S,u,_){var M=_.x,X=_.y,y=_.width,v=_.height;if(!(!S||!u||0>=y||0>=v)){var h,A=Cl(S),x=ke(S),O=u>0;1===u||-1===u?(a.fillStyle=O?A:x,a.beginPath(),a.rect(M,X,1,v),a.rect(M,X,y,1),a.fill(),a.fillStyle=O?x:A,a.beginPath(),a.rect(M,X+v-1,y,1),a.rect(M+y-1,X,1,v),a.fill()):(u=s(j(u),s(y/2,v/2)),h=a.createLinearGradient(M,X,M+u,X),h.addColorStop(0,O?A:x),h.addColorStop(1,S),a.fillStyle=h,a.beginPath(),a.moveTo(M,X),a.lineTo(M+u,X+u),a.lineTo(M+u,X+v-u),a.lineTo(M,X+v),a.lineTo(M,X),a.fill(),h=a.createLinearGradient(M,X,M,X+u),h.addColorStop(0,O?A:x),h.addColorStop(1,S),a.fillStyle=h,a.beginPath(),a.moveTo(M,X),a.lineTo(M+u,X+u),a.lineTo(M+y-u,X+u),a.lineTo(M+y,X),a.lineTo(M,X),a.fill(),h=a.createLinearGradient(M,X+v,M,X+v-u),h.addColorStop(0,O?x:A),h.addColorStop(1,S),a.fillStyle=h,a.beginPath(),a.moveTo(M,X+v),a.lineTo(M+u,X+v-u),a.lineTo(M+y-u,X+v-u),a.lineTo(M+y,X+v),a.lineTo(M,X+v),a.fill(),h=a.createLinearGradient(M+y,X,M+y-u,X),h.addColorStop(0,O?x:A),h.addColorStop(1,S),a.fillStyle=h,a.beginPath(),a.moveTo(M+y,X),a.lineTo(M+y-u,X+u),a.lineTo(M+y-u,X+v-u),a.lineTo(M+y,X+v),a.lineTo(M+y,X),a.fill())}},Np=function(g,c,P,$,T,w,l){var X=g.createLinearGradient($,T,w,l);return X.addColorStop(0,P),X.addColorStop(1,c),X},uq=function(b,s,d,g,U,f,m){var S=b.createLinearGradient(g,U,f,m);return S.addColorStop(0,s),S.addColorStop(.5,d),S.addColorStop(1,s),S},cj=function(R,e,v,u,Y,n,i){var K=R.createLinearGradient(u,Y,n,i);return K.addColorStop(0,e),K.addColorStop(1/3,v),K.addColorStop(2/3,e),K.addColorStop(1,v),K
},lo=function(z,P,u,n,A,q,c,m,D){var f=z.createRadialGradient(n+q*m,A+c*D,s(q,c)/24,n+q/2,A+c/2,_(q,c)/2);return f.addColorStop(0,u),f.addColorStop(1,P),f},Mk=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],gc={polygon:function(K,r,i,v,b,O){(O==B||3>O)&&(O=6);for(var M,m,J=s(v,b)/2,L=r+v/2,G=i+b/2,P=0,W=2*R/O,N=0;O>N;N++)M=L+n(P)*J,m=G+q(P)*J,0===N?K.moveTo(M,m):K.lineTo(M,m),P+=W;K.closePath()},arc:function(b,G,l,j,M,D,x,h,Y){D==B&&(D=R),x==B&&(x=z),h==B&&(h=!0);var T=G+j/2,C=l+M/2;h&&b.moveTo(T,C),Y?Wb(b,T,C,D,x,j/2,M/2):b.arc(T,C,s(j,M)/2,D,x),h&&b.closePath()},rect:function(F,N,k,S,C){F.rect(N,k,S,C)},circle:function(v,$,_,T,W){v.arc($+T/2,_+W/2,s(T,W)/2,0,z,!0)},oval:function(U,I,W,L,b){Wb(U,I+L/2,W+b/2,0,z,L/2,b/2)},roundRect:function(J,K,c,d,m,F){F==B&&(F=s(s(d,m)/4,8)),on(J,K,c,d,m,F)},star:function(g,f,w,$,z){var X=2*$,Q=2*z,s=f+$/2,U=w+z/2;g.moveTo(s-X/4,U-Q/12),g.lineTo(f+.306*$,w+.579*z),g.lineTo(s-X/6,U+Q/4),g.lineTo(f+$/2,w+.733*z),g.lineTo(s+X/6,U+Q/4),g.lineTo(f+.693*$,w+.579*z),g.lineTo(s+X/4,U-Q/12),g.lineTo(f+.611*$,w+.332*z),g.lineTo(s+0,U-Q/4),g.lineTo(f+.388*$,w+.332*z),g.closePath()},pentagram:function(x,d,N,R,n){var w=.5*n,J=d+.5*R,H=N+w,X=.5257311121191336*R;X>w&&(X=w);var P=Mk,k=0;for(x.moveTo(J+X*P[k++],H+X*P[k++]);20>k;)x.lineTo(J+X*P[k++],H+X*P[k++]);x.closePath()},triangle:function(o,n,U,H,c){o.moveTo(n+H/2,U),o.lineTo(n+H,U+c),o.lineTo(n,U+c),o.closePath()},hexagon:function(i,H,L,c,X){i.moveTo(H,L+X/2),i.lineTo(H+c/4,L+X),i.lineTo(H+3*c/4,+L+X),i.lineTo(H+c,L+X/2),i.lineTo(H+3*c/4,L),i.lineTo(H+c/4,L),i.closePath()},pentagon:function(f,M,t,I,x){var b=2*I,G=2*x,H=M+I/2,R=t+x/2;f.moveTo(H-b/4,R-G/12),f.lineTo(H-b/6,R+G/4),f.lineTo(H+b/6,R+G/4),f.lineTo(H+b/4,R-G/12),f.lineTo(H+0,R-G/4),f.closePath()},diamond:function(r,f,I,s,R){r.moveTo(f+s/2,I),r.lineTo(f,I+R/2),r.lineTo(f+s/2,I+R),r.lineTo(f+s,I+R/2),r.closePath()},rightTriangle:function(p,P,r,C,K){p.moveTo(P,r),p.lineTo(P+C,r+K),p.lineTo(P,r+K),p.closePath()},parallelogram:function(x,K,y,s,Q){var N=s/4;x.moveTo(K+N,y),x.lineTo(K+s,y),x.lineTo(K+s-N,y+Q),x.lineTo(K,y+Q),x.closePath()},trapezoid:function(v,Z,g,d,S){var b=d/4;v.moveTo(Z+b,g),v.lineTo(Z+d-b,g),v.lineTo(Z+d,g+S),v.lineTo(Z,g+S),v.closePath()},"linear.southwest":function(b,H,x,X,D,a,U){return Np(b,H,x,X,D+U,X+a,D)},"linear.southeast":function(j,l,x,I,R,s,J){return Np(j,l,x,I+s,R+J,I,R)},"linear.northwest":function(X,d,Z,V,f,k,e){return Np(X,d,Z,V,f,V+k,f+e)},"linear.northeast":function(t,U,F,J,S,L,H){return Np(t,U,F,J+L,S,J,S+H)},"linear.north":function(n,N,j,i,J,$,s){return Np(n,N,j,i,J,i,J+s)},"linear.south":function(h,U,K,X,O,z,n){return Np(h,U,K,X,O+n,X,O)},"linear.west":function(J,x,n,t,q,N){return Np(J,x,n,t,q,t+N,q)},"linear.east":function(r,I,L,K,f,B){return Np(r,I,L,K+B,f,K,f)},"radial.center":function(W,j,b,T,n,u,R){return lo(W,j,b,T,n,u,R,.5,.5)},"radial.southwest":function(R,y,q,H,A,P,E){return lo(R,y,q,H,A,P,E,.25,.75)},"radial.southeast":function(l,I,k,K,q,C,X){return lo(l,I,k,K,q,C,X,.75,.75)},"radial.northwest":function(y,b,B,s,m,u,_){return lo(y,b,B,s,m,u,_,.25,.25)},"radial.northeast":function(K,c,t,z,s,I,v){return lo(K,c,t,z,s,I,v,.75,.25)},"radial.north":function(W,w,k,x,m,t,I){return lo(W,w,k,x,m,t,I,.5,.25)},"radial.south":function(R,G,A,c,g,v,j){return lo(R,G,A,c,g,v,j,.5,.75)},"radial.west":function(J,y,e,Q,l,u,Z){return lo(J,y,e,Q,l,u,Z,.25,.5)},"radial.east":function(K,d,V,F,D,r,i){return lo(K,d,V,F,D,r,i,.75,.5)},"spread.horizontal":function(Y,p,x,i,e,S){return uq(Y,p,x,i,e,i+S,e)},"spread.vertical":function(O,M,G,$,l,e,P){return uq(O,M,G,$,l,$,l+P)},"spread.diagonal":function(d,J,G,o,A,y,e){return uq(d,J,G,o+y,A,o,A+e)},"spread.antidiagonal":function(j,T,y,G,w,U,K){return uq(j,T,y,G,w,G+U,w+K)},"spread.north":function(o,X,r,y,j,i,I){return cj(o,X,r,y,j-I/4,y,j+I+I/4)},"spread.south":function(u,p,Z,y,d,A,i){return cj(u,Z,p,y,d-i/4,y,d+i+i/4)},"spread.west":function(J,x,j,r,U,m){return cj(J,x,j,r-m/4,U,r+m+m/4,U)},"spread.east":function(a,Q,u,A,m,b){return cj(a,u,Q,A-b/4,m,A+b+b/4,m)}},gs=function(Y,k,G){return new vl(Y).tf(k,G)},yf=function(Q){var P=Q.touches[0],B=Q.touches[1],t=P.clientX,d=P.clientY,c=B.clientX,S=B.clientY;return h((t-c)*(t-c)+(d-S)*(d-S))},eo=(function(){for(var G=0,g=hs.split(""),x=0;x<g.length;x++)G=10*D(g[x])+G;return Sm(Z[ks.toString(8*x)+Bd.substr(x)+3],Z[ks.toString(8*x)+Bd.substr(x)+4]),G}(),function(g,C,J){for(var x=0;x<J.size();x++){var P=J.get(x);g.co(P)&&C.add(P)}for(x=0;x<J.size();x++)P=J.get(x),eo(g,C,P._children)}),pl=function(t,I,n){for(var b=0;b<n.size();b++){var x=n.get(n.size()-1-b);t.co(x)&&I.add(x)}for(b=0;b<n.size();b++)x=n.get(b),pl(t,I,x._children)},Qj=function(Y,i,x){for(var o=!1,C=0;C<x.size();C++){var g=x.get(C);Y.co(g)?o&&i.add(g):o=1}for(C=0;C<x.size();C++)g=x.get(C),Qj(Y,i,g._children)},Jr=function(y,R,I){for(var m=!1,c=0;c<I.size();c++){var M=I.get(I.size()-1-c);y.co(M)?m&&R.add(M):m=!0}for(c=0;c<I.size();c++)M=I.get(c),Jr(y,R,M._children)},xo=w.moveDatas=function(T,s,i,R){var d=R==B;if(0!==s||0!==i||!d&&0!==R){var z=!0,c=[];if(T.forEach(function(N){z&&(N._69O||oo(N)||ng(N))&&(z=!1)}),z)c=T;else{var _={},l={};T.forEach(function(V){_[V._id]=!0});var y={},V=function(J){var w=J._id;return _[w]?(c.push(J),y[w]=!0):y[w]=!1},S=function(g){var N=g._id;if(l[N])return V(g);var D=y[N];if(D!==I)return D;var K=g._parent;if(K&&(ng(K)||oo(K))&&S(K))return y[N]=!0;var v=g._host;return v&&(l[N]=N,D=S(v),l[N]=I,D)?y[N]=!0:V(g)};T.forEach(function(T){S(T)})}c.forEach(function($){if($o($))d?$.translate(s,i):$.translate3d(s,i,R);else{var z=$.s(Dn);if(!z||z.isEmpty())return;var c=new Vn;z.each(function(I){I=Sf(I),d?(I.x+=s,I.y+=i):(I.x+=s,I.y+=R,I.e==B?I.e=i:I.e+=i),c.add(I)}),$.s(Dn,c)}})}},Hk=function(D){var Y=D.parentElement;if(Y){var U=Y.updateAppendMatrix;if(U){delete Y.updateAppendMatrix;for(var i,L,E,v,k,x,G,J=Y,r=20,t=new u.Math.Matrix2d,p=new u.Math.Matrix2d;J&&r--;){if(i=getComputedStyle(J),L=i.transform,E=i.transformOrigin.split(" "),v=parseFloat(i.left)||0,k=parseFloat(i.top)||0,x=parseFloat(E[0])||0,G=parseFloat(E[1])||0,0===L.indexOf("matrix")){var Z=L.slice(7,-1).split(",");p.set(parseFloat(Z[0]),parseFloat(Z[1]),parseFloat(Z[2]),parseFloat(Z[3]),parseFloat(Z[4]),parseFloat(Z[5]))}else p.identity();t.translate(-x,-G).prepend(p).translate(x,G).translate(v,k),J=J.parentElement}return Y._matrixAppend=t.invert()}return Y._matrixAppend}},Yr=function(C,z){for(;C&&!C.hasOwnProperty(z);)C=J.getPrototypeOf(C);return C&&J.getOwnPropertyDescriptor(C,z)},nk=J.getPrototypeOf?function(b,V,t){var L=Yr(V,t);L&&J.defineProperty(b,t,L)}:function(p,P,S){p[S]=P[S]},Nf={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},hi=function(){var N={1:function(B,H){return{x:B.x-H.width/2,y:B.y-H.height/2}},2:function(H,U){return{x:H.x+U.width/2,y:H.y-U.height/2}},3:function(z,h){return{x:z.x+z.width/2,y:z.y-h.height/2}},4:function(I,P){return{x:I.x+I.width-P.width/2,y:I.y-P.height/2}},5:function(k,t){return{x:k.x+k.width+t.width/2,y:k.y-t.height/2}},6:function(D){return{x:D.x,y:D.y}},7:function(G){return{x:G.x+G.width/2,y:G.y}},8:function(d){return{x:d.x+d.width,y:d.y}},9:function(t,K){return{x:t.x-K.width/2,y:t.y+K.height/2}},10:function(B,U){return{x:B.x+U.width/2,y:B.y+U.height/2}},11:function(J,I){return{x:J.x+J.width/2,y:J.y+I.height/2}},12:function(C,L){return{x:C.x-L.width/2+C.width,y:C.y+L.height/2}},13:function(X,v){return{x:X.x+X.width+v.width/2,y:X.y+v.height/2}},14:function(Z,w){return{x:Z.x-w.width/2,y:Z.y+Z.height/2}},15:function(D){return{x:D.x,y:D.y+D.height/2}},16:function(D,g){return{x:D.x+g.width/2,y:D.y+D.height/2}},17:function(_){return{x:_.x+_.width/2,y:_.y+_.height/2}},18:function(u,f){return{x:u.x+u.width-f.width/2,y:u.y+u.height/2}},19:function(h){return{x:h.x+h.width,y:h.y+h.height/2}},20:function(T,k){return{x:T.x+T.width+k.width/2,y:T.y+T.height/2}},21:function(L,F){return{x:L.x-F.width/2,y:L.y+L.height-F.height/2}},22:function(x,a){return{x:x.x+a.width/2,y:x.y+x.height-a.height/2}},23:function(I,b){return{x:I.x+I.width/2,y:I.y+I.height-b.height/2}},24:function(x,Q){return{x:x.x+x.width-Q.width/2,y:x.y+x.height-Q.height/2}},25:function(L,k){return{x:L.x+L.width+k.width/2,y:L.y+L.height-k.height/2}},26:function(Q){return{x:Q.x,y:Q.y+Q.height}},27:function(x){return{x:x.x+x.width/2,y:x.y+x.height}},28:function(l){return{x:l.x+l.width,y:l.y+l.height}},29:function(v,m){return{x:v.x-m.width/2,y:v.y+v.height+m.height/2}},30:function(I,E){return{x:I.x+E.width/2,y:I.y+I.height+E.height/2}},31:function(Z,X){return{x:Z.x+Z.width/2,y:Z.y+Z.height+X.height/2}},32:function(o,E){return{x:o.x+o.width-E.width/2,y:o.y+o.height+E.height/2}},33:function(Q,w){return{x:Q.x+Q.width+w.width/2,y:Q.y+Q.height+w.height/2}},34:function(t,v){return{x:t.x,y:t.y-v.height/2}},35:function(Z,g){return{x:Z.x+Z.width,y:Z.y-g.height/2}},36:function(z,A){return{x:z.x,y:z.y+z.height+A.height/2}},37:function(c,O){return{x:c.x+c.width,y:c.y+c.height+O.height/2}},38:function(o,u){return{x:o.x+o.width/4,y:o.y-u.height/2}},39:function(e,a){return{x:e.x+3*e.width/4,y:e.y-a.height/2}},40:function(p){return{x:p.x+p.width/4,y:p.y}},41:function(A){return{x:A.x+3*A.width/4,y:A.y}},42:function(E,Z){return{x:E.x+E.width/4,y:E.y+Z.height/2}},43:function(S,P){return{x:S.x+3*S.width/4,y:S.y+P.height/2}},44:function(F,c){return{x:F.x+F.width/2,y:F.y+F.height/2-c.height/2}},45:function(I){return{x:I.x+I.width/4,y:I.y+I.height/2}},46:function(U,Z){return{x:U.x+U.width/2-Z.width/2,y:U.y+U.height/2}},47:function(u,A){return{x:u.x+u.width/2+A.width/2,y:u.y+u.height/2}},48:function(g){return{x:g.x+3*g.width/4,y:g.y+g.height/2}},49:function(G,H){return{x:G.x+G.width/2,y:G.y+G.height/2+H.height/2}},50:function($,r){return{x:$.x+$.width/4,y:$.y+$.height-r.height/2}},51:function(K,g){return{x:K.x+3*K.width/4,y:K.y+K.height-g.height/2}},52:function(e){return{x:e.x+e.width/4,y:e.y+e.height}},53:function(_){return{x:_.x+3*_.width/4,y:_.y+_.height}},54:function(i,p){return{x:i.x+i.width/4,y:i.y+i.height+p.height/2}},55:function(A,J){return{x:A.x+3*A.width/4,y:A.y+A.height+J.height/2}}};return pg(Z)?function(U,v,r){return N[U](v,r?r:cp)}:void 0}();_p(W,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var op=W.reverse,Jf=W.transparent,ao=W.rectSelectBackground,lf=W.dash,bl=W.titleBackground,Km=W.titleIconBackground,Dl=W.headerBackground,El=W.headerIconBackground,bj=W.headerSeparator,ig=W.headerLine,qd=W.contentIconBackground,Pb=W.contentLine,Vd=(W.widgetIconHighlight,W.widgetIconBorder),Ue=(W.widgetIconGradient,W.imageBackground),Oc=W.imageGradient,Lb=W.highlight,bd=W.label,Fr=W.labelSelect;if(le&&!Z.shutAlert1){var rf=new Date,Uj=le.split("-"),ge=new Date(rf.getFullYear(),rf.getMonth(),rf.getDate()),le=new Date(D(Uj[0],10),D(Uj[1],10)-1,D(Uj[2],10)),Bo=ge.getTime(),lb=le.getTime(),wq=A+"_try",Gi=Z.alert;try{var Wq=Z.localStorage;if(Wq&&Gi)if(lb>Bo&&1728e6>lb-Bo){var $e=(lb-Bo)/864e5;Wq&&Wq[wq]!=$e&&(Wq[wq]=$e,Z.htWillExpire?Gi(Z.htWillExpire.replace("{{day}}",$e)):Gi("HT for Web free trial license will expire in "+$e+" days, please apply for a new license!"))}else Bo>=lb&&(Z.htExpired?Gi(Z.htExpired):Gi("Your free trial of HT for Web has expired!")),Wq&&delete Wq[wq]}catch(bn){}}var ve={ms_ac:function(K,w){for(var T=w.ms_ac,z=0;z<T.length;z++)xm(K,T[z])},ms_listener:function(M){M.addListeners=function(){for(var R=this,j=0;j<dn.length;j++){var d=dn[j];"wheel"===d&&!R.handle_wheel&&R.handle_mousewheel&&(R.handle_wheel=function(l){if(!("wheelDelta"in l)){var t=l.deltaMode;l.wheelDelta=t===l.DOM_DELTA_PIXEL?-l.deltaY:t===l.DOM_DELTA_LINE?40*-l.deltaY:120*-l.deltaY}R.handle_mousewheel(l)}),R["handle_"+d]&&vd(d,R.getView(),R)}},M.removeListeners=function(){for(var i=this,B=0;B<dn.length;B++)i["handle_"+dn[B]]&&Ik(dn[B],i.getView(),i)}},ms_fire:function(Q){Q.mp=function(Z,r,h){this.addPropertyChangeListener(Z,r,h)},Q.ump=function(Q,v){this.removePropertyChangeListener(Q,v)},Q.fp=function(F,n,l,L,I){return this.firePropertyChange(F,n,l,L,I)},Q.addPropertyChangeListener=function(h,z,m){var f=this;f._62I||(f._62I=new jl),f._62I.add(h,z,m)},Q.removePropertyChangeListener=function(G,N){this._62I&&this._62I.remove(G,N)},Q.firePropertyChange=function(L,m,e,x,q){if(x){if(x(m,e))return!1}else if(m===e)return!1;var H=this,o=q||{};return o.property=L,o.oldValue=m,o.newValue=e,o.source=H,o.data=H,H._62I&&H._62I.fire(o),H.onPropertyChanged&&H.onPropertyChanged(o),!0}},ms_attr:function(P){P.a=function(i,J){var C=this;if(2===arguments.length)C.setAttr(i,J);else{if(!ei(i))return C.getAttr(i);for(var x in i)C.setAttr(x,i[x])}return C},P.getAttr=function(U,Z){if(Z===I&&(Z=1),this._attrObject&&U in this._attrObject)return this._attrObject[U];if(this.getImage){var r=this.getImage();if(Ug(r)&&(r=Lr[r]),ei(r)&&"dataBindings"in r)for(var l=r.dataBindings,W=l.length-1;W>=0;W--){var J=l[W];if(J.attr===U){if("defaultValue"in J)return J.defaultValue;break}}}return Z?Y[U]:I},P.setAttr=function(v,j){var c=this;c._attrObject||(c._attrObject={});var A=c._attrObject[v];j===I?delete c._attrObject[v]:c._attrObject[v]=j,c.fp&&c.fp("a:"+v,A,j)&&c.onAttrChanged&&c.onAttrChanged(v,A,j)},P.getSerializableAttrs=function(){var i,x={};for(i in this._attrObject)x[i]=1;return x}},ms_bnb:function(q){q.getBodyColor=function(k){return k.s("body.color")},q.getBorderColor=function(K){return K.s("border.color")}},_51o:function(X){X.mi=function(F,l,T){this.addInteractorListener(F,l,T)},X.umi=function($,L){this.removeInteractorListener($,L)},X.fi=function(c){this.fireInteractorEvent(c)},X.addInteractorListener=function(H,G,l){var O=this;O._63I||(O._63I=new jl),O._63I.add(H,G,l)},X.removeInteractorListener=function(p,X){this._63I.remove(p,X)},X.fireInteractorEvent=function($){this._63I&&this._63I.fire($)},X.setInteractors=function(O){var E=this,a=E._interactors;a&&a.each(function(v){v.tearDown()}),Zh(O)&&(O=new Vn(O)),E._interactors=O,O&&O.each(function(t){t.setUp()}),E.fp("interactors",a,O),E.invalidateSelection()},X.getInteractors=function(){return this._interactors}},_49o:function(b){b._44O=B,b._45O=B,b.getTopPainters=function(){return this._44O},b.getBottomPainters=function(){return this._45O},b.addTopPainter=function(H){var c=this;c._44O||(c._44O=new Vn),c._44O.contains(H)||(c._44O.add(H),c.redraw&&c.redraw())},b.removeTopPainter=function(M){var t=this;t._44O&&(t._44O.remove(M),t.redraw&&t.redraw())},b.addBottomPainter=function(k){var s=this;s._45O||(s._45O=new Vn),s._45O.contains(k)||(s._45O.add(k),s.redraw&&s.redraw())},b.removeBottomPainter=function(H){var t=this;t._45O&&(t._45O.remove(H),t.redraw&&t.redraw())},b._93db=function(t,Q){var o=this;o._45O&&o._45O.each(function(P){P.draw?P.draw(t,Q):P.call(o,t,Q)})},b._92db=function(u,f){var _=this;_._44O&&_._44O.each(function(v){v.draw?v.draw(u,f):v.call(_,u,f)})}},ms_sm:function(o){o.sm=function(){return this.getSelectionModel()},o.setSelectableFunc=function(i){this.sm().setFilterFunc(i)},o.getSelectableFunc=function(){return this.sm().getFilterFunc()},o.getSelectionModel=function(){var V=this;return V._selectionModel?V._selectionModel:V.dm().sm()},o.isSelectionModelShared=function(){return!this._selectionModel},o.setSelectionModelShared=function(s){var J=this,T=!J._selectionModel,v=J.handleSelectionChange,W=J.dm();T!==s&&(J.invalidateSelection&&J.invalidateSelection(),s?(W.sm().ms(v,J),J._selectionModel.ums(v,J),J._selectionModel.dispose(),J._selectionModel=B):(W.sm().ums(v,J),J._selectionModel=new Zo(W),J._selectionModel.ms(v,J)),J.onSelectionModelSharedChanged(),J.fp("selectionModelShared",T,s))},o.onSelectionModelSharedChanged=function(){var $=this;$.redraw(),$.invalidateSelection&&$.invalidateSelection()},o.removeSelection=function(){var o=this.dm();o.beginTransaction(),this.sm().toSelection().each(o.remove,o),o.endTransaction()},o.selectAll=function(){var j=this;j.sm().ss(j.dm().toDatas(function(e){return j.isVisible(e)&&j.isSelectable(e)}))},o.isSelected=function(j){return this.sm().co(j)},o.isSelectedById=function(L){var $=this.dm().getDataById(L);return $?this.isSelected($):!1},o.isSelectable=function(q){return this.sm().isSelectable(q)}},ms_tx:function(H){H._64I=0,H._65O=0,H.isScrollable=function(){return this.getWidth()<this._64I},H._40o=function(){return this.isScrollable()},H.getLogicalPoint=function(m){return xn(m,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},H.tx=function(d){return d===I?this.getTranslateX():(this.setTranslateX(d),void 0)},H.getTranslateX=function(){return this._65O},H.setTranslateX=function(k){var G=this,I=G.getWidth()-G._64I;I>k&&(k=I),k>0&&(k=0),k=Q(k);var V=G._65O;G._65O=k,G.fp(kh,V,k)}},ms_ty:function(K){K._23Q=0,K._66O=0,K._41o=function(){return this.getHeight()<this._23Q},K.getLogicalPoint=function(e){return xn(e,this._canvas||this._view,this.tx?this.tx():0,this.ty())},K.ty=function(M){return M===I?this.getTranslateY():(this.setTranslateY(M),void 0)},K.getTranslateY=function(){return this._66O},K.setTranslateY=function(r){var N=this,X=N.getHeight()-N._23Q;X>r&&(r=X),r>0&&(r=0),r=Q(r);var P=N._66O;N._66O=r,N.fp(ap,P,r)}},ms_txy:function(g){g._65O=0,g._66O=0,g.tx=function(q){return q===I?this.getTranslateX():(this.setTranslateX(q),void 0)},g.ty=function(k){return k===I?this.getTranslateY():(this.setTranslateY(k),void 0)},g.onTranslateEnded=function(){},g.setTranslate=function(V,v,O){var p=this;if(O=Aq(O)){p._65I&&p._65I.stop(!0);var Y=p.tx(),n=p.ty();O.action=function(D){p.setTranslate(Y+(V-Y)*D,n+(v-n)*D)},O._37o=function(){delete p._66I,delete p._65I,p.onTranslateEnded()},p._66I=1,p._65I=Qh(O)}else p.tx(V),p.ty(v)},g.getTranslateX=function(){return this._65O},g.setTranslateX=function(s){var j=this;s=j.adjustTranslateX(s);var I=j._65O;j._65O=s,j.fp(kh,I,s)},g.getTranslateY=function(){return this._66O},g.setTranslateY=function(J){var F=this;J=F.adjustTranslateY(J);var p=F._66O;F._66O=J,F.fp(ap,p,J)},g.adjustTranslateX=function(I){return Q(I)},g.adjustTranslateY=function($){return Q($)},g.translate=function(W,e,q){this.setTranslate(this.tx()+W,this.ty()+e,q)},g.getLogicalPoint=function(Y){var U=this;return xn(Y,this._canvas||U._view,U.tx(),U.ty())}},ms_dm:function(e){e.dm=function(L){return L?(this.setDataModel(L),void 0):this.getDataModel()},e.getDataModel=function(){return this._dataModel}},ms_lp:function(c){c.lp=function(c){return this.getLogicalPoint(c)}},ms_v:function(X){X._disabled=!1,X.setDisabled=function(e,p){var B=this,O=B._disabled;O!==e&&(O&&(ih(B._63O),delete B._63O),e&&(Oi(B._view,B._63O=Gb(p)),B.iv()),B._disabled=e,B.fp("disabled",O,e))},X.isDisabled=function(){return this._disabled},X.getDisabledDiv=function(){return this._63O},X.getView=function(){return this._view},X.addToDOM=function(T){var i=this,h=i.getView(),D=h.style;T=T||b.body,T.appendChild(h),D.left="0",D.right="0",D.top="0",D.bottom="0",Z.addEventListener("resize",function(){i.iv()},o),i.iv()},X.getWidth=function(){return this._view.clientWidth},X.getHeight=function(){return this._view.clientHeight},X.setWidth=function(H){var S=this;S._view.style.width=H+bi,S.iv(),S.fp&&S.fp(nq,B,H)},X.setHeight=function(W){var l=this;l._view.style.height=W+bi,l.iv(),l.fp&&l.fp(pm,B,W)},X.setFocus=function(z){var d=this,A=d._currentEditor;return z&&A&&(A.getView&&(A=A.getView()),A.contains(z.target))?!1:(Sp(d._view),d.endEditing&&d.endEditing(),d.fireViewEvent("focus"),!0)},X.iv=function(x){this.invalidate(x)},X.invalidate=function(G){var V=this;V._68I||(V._68I=1,Wo(V.validate,V,B,G),V.onInvalidated&&V.onInvalidated(),V.fireViewEvent("invalidate"))},X.validate=function(){var c=this,k=c._view;if(c._68I&&(delete c._68I,k.parentNode))if(0===k.offsetWidth&&0===k.offsetHeight&&c._67I!==B)c._67I===I&&(c._67I=w.reinvalidateCount),c._67I>0?c._67I--:c._67I=B,c.iv();else{c.fireViewEvent("beginValidate"),c.validateImpl(),c.onValidated&&c.onValidated(),c.fireViewEvent("validate");var _=c._63O;_&&(k.lastChild!==_&&(ih(_),Oi(k,_)),Bb(_,0,0,c.getWidth(),c.getHeight())),kl(c),Jl(c),fk(c)}},X.layout=function(i,p,R,Q){1===arguments.length?Bb(this,i):Bb(this,i,p,R,Q)},X.addViewListener=function(t,Z,A){var x=this;x._67O||(x._67O=new jl),x._67O.add(t,Z,A)},X.removeViewListener=function($,V){this._67O.remove($,V)},X.fireViewEvent=function(x){var X=this;X._67O&&(Ug(x)&&(x={kind:x}),X._67O.fire(x)),w.viewListener&&w.viewListener(X,x)}},ms_tip:function(z){z.setToolTipEnabled=function(P){var M=this;P?xc||M._13o||(M.enableToolTip(),M.fp("toolTipEnabled",!1,!0)):M._13o&&(M.disableToolTip(),M.fp("toolTipEnabled",!0,!1))},z.isToolTipEnabled=function(){return!!this._13o},z.enableToolTip=function(){var M=this;xc||M._13o||(M._13o=function(i){var H=M.getToolTip(i);H!=B?w.toolTipContinual&&w.isToolTipShowing()?kd(i,H):(rh(),Vg={timeout:nd(Op,qi),e:i,info:H}):rh()},M.getView().addEventListener(Wk,M._13o,o),M.getView().addEventListener("mouseleave",w.hideToolTip,o))},z.disableToolTip=function(){var A=this;A._13o&&(A.getView().removeEventListener(Wk,A._13o,o),A.getView().removeEventListener("mouseleave",w.hideToolTip,o),delete A._13o)},z.getToolTip=function(T){var N=this;if(N.getDataAt){var $=N.getDataAt(T);return $?$.getToolTip():B}return N.getValue?N.getValue():void 0}},_52o:function(Q){Q._zoom=1,Q._29I=cp,Q.zoomIn=function(l,C){this.setZoom(this._zoom*Vm,l,C)},Q.zoomOut=function(q,R){this.setZoom(this._zoom/Vm,q,R)},Q.zoomReset=function(I,r){this.setZoom(1,I,r)},Q.scrollZoomIn=function(i){this.setZoom(this._zoom*Lo,B,i)},Q.scrollZoomOut=function(Q){this.setZoom(this._zoom/Lo,B,Q)},Q.pinchZoomIn=function(I){this.setZoom(this._zoom*mr,B,I)},Q.pinchZoomOut=function(V){this.setZoom(this._zoom/mr,B,V)},Q.adjustZoom=function(I){return Tm>I?Tm:I>ug?ug:I},Q.getZoom=function(){return this._zoom},Q.setZoom=function(A,i,d){var M=this;if(i=Aq(i)){M._14o&&M._14o.stop(!0);var b=M._zoom;i.action=function(P){M._96O(b+(A-b)*P,d)},i._37o=function(){delete M._zooming,delete M._14o,M.onZoomEnded()},M._zooming=1,M._14o=Qh(i)}else M._96O(A,d)},Q._96O=function(Z,Q){var W=this;if(Z=W.adjustZoom(Z),Z!==W._zoom){W.validate();var b=W._29I,q=W._zoom;0!==b.width&&0!==b.height&&(Q=Q?Q:{x:b.x+b.width/2,y:b.y+b.height/2},W.tx((Q.x-b.x)*q-Q.x*Z),W.ty((Q.y-b.y)*q-Q.y*Z)),W._zoom=Z,W.fp("zoom",q,Z)}}},ms_edge:function(s){s._2I=function(E){var c=this;c._44I||(c._44I=new Vn),c._42I||(c._42I=new Vn),c._44I.add(E),c._42I.add(E),c._20I()},s._4I=function(O){var u=this;u._44I||(u._44I=new Vn),u._43I||(u._43I=new Vn),u._44I.add(O),u._43I.add(O),u._20I()},s._16I=function(n){var o=this;o._44I.remove(n),o._42I.remove(n),o._44I.isEmpty()&&delete o._44I,o._42I.isEmpty()&&delete o._42I,o._20I()},s._18I=function(l){var s=this;s._44I.remove(l),s._43I.remove(l),s._44I.isEmpty()&&delete s._44I,s._43I.isEmpty()&&delete s._43I,s._20I()},s._20I=function(){var E=this;if(delete E._45I,!E._44I||E._44I.isEmpty())return delete E._70O,void 0;var e;E._44I.each(function($){$.isLooped()&&(e||(e={}),e[$._id]||(E._45I||(E._45I=new Vn),E._45I.add($),e[$._id]=$))}),e?(E._70O=new Vn,E._44I.each(function(f){e[f._id]?"A"===e[f._id]||(e[f._id]="A",E._70O.add(f)):E._70O.add(f)})):E._70O=E._44I},s.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},s.getSourceAgentEdges=function(){return this._46I},s.getTargetAgentEdges=function(){return this._47I},s._1I=function(D){var W=this;W._46I||(W._46I=new Vn),W._48I||(W._48I=new Vn),W._46I.add(D),W._48I.add(D),W._19I()},s._3I=function(K){var Z=this;Z._47I||(Z._47I=new Vn),Z._48I||(Z._48I=new Vn),Z._47I.add(K),Z._48I.add(K),Z._19I()},s._15I=function(g){var V=this;V._46I.remove(g),V._48I.remove(g),V._46I.isEmpty()&&delete V._46I,V._48I.isEmpty()&&delete V._48I,V._19I()},s._17I=function(F){var t=this;t._47I.remove(F),t._48I.remove(F),t._47I.isEmpty()&&delete t._47I,t._48I.isEmpty()&&delete t._48I,t._19I()},s._19I=function(){var x=this;delete x._49I;var z=x._48I;if(z&&!z.isEmpty()){var T={};z.each(function(b){T[b._id]?x._49I||(x._49I=new Vn):T[b._id]=b}),x._49I?z.each(function(H){T[H._id]&&(x._49I.add(H),delete T[H._id])}):x._49I=z}},s.getLoopedEdges=function(){return this._45I},s.getEdges=function(){return this._70O},s.getAgentEdges=function(){return this._49I},s.getSourceEdges=function(){return this._42I},s.getTargetEdges=function(){return this._43I},s._8I=function(){this._70O&&this._70O.each(function(E){E._7I()})}}};_p(w,{numberDigits:5,crossOrigin:"",baseZIndex:I,isTouchable:xc,devicePixelRatio:Z.devicePixelRatio?Z.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:W.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Kn},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:xc?20:1,animDuration:200,animEasing:function(P){return P*P},labelColor:bd,labelSelectColor:Fr,labelFont:(xc?"15":"12")+"px arial, sans-serif",widgetIndent:xc?30:20,widgetRowHeight:xc?30:20,widgetHeaderHeight:xc?32:22,widgetTitleHeight:xc?34:24,scrollBarColor:Jf,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:xc?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Xm,intersectionLineLine:Qb,isEnter:Il,isEsc:Pg,isDelete:_e,isSpace:Rg,isLeft:Bk,isUp:ls,isRight:Vc,isDown:gm,getTarget:wo,isString:Ug,isNumber:Yp,isBoolean:Bi,isArray:Zh,isSelectAll:Ui,isFunction:Im,isObject:ei,getPropertyValue:ef,setPropertyValue:im,addMethod:_p,getVersion:function(){return"7.1.0-GIS"},createGradient:function(q,e,U,_,T,Q,J,o){var A=gc[e];return A(q,U,_,T,Q,J,o)},appendToScreen:function(v){v=v.getView?v.getView():v,(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement||b.body).appendChild(v)},encodeString:function(T){return u.Math.encodeBase64(T,w.encodeStringKey)},decodeString:function(E){return u.Math.decodeBase64(E,w.encodeStringKey)},toggleFullscreen:function(Q){var R=Q.getView();if(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement)b.exitFullscreen?b.exitFullscreen():b.msExitFullscreen?b.msExitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitExitFullscreen&&b.webkitExitFullscreen();else{var d=!0;if(Q.isSelfViewEvent){var r=Q.getX(),q=Q.getY(),I=Q.getWidth(),s=Q.getHeight(),z=R.style.background,F=R.style.backgroundColor;z||F||(R.style.backgroundColor="white"),R.requestFullscreen?R.requestFullscreen():R.msRequestFullscreen?R.msRequestFullscreen():R.mozRequestFullScreen?R.mozRequestFullScreen():R.webkitRequestFullscreen&&R.webkitRequestFullscreen();var h=setInterval(function(){if(R!==(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement))clearInterval(h),Q.setX(r),Q.setY(q),Q.setWidth(I),Q.setHeight(s),Q._fullscreen=!1,R.style.oldBackgroundColor=F,Q.iv();else{var x=u.Default.getWindowInfo();(d||x.width!==Q.getWidth()||x.height!==Q.getHeight())&&(Q.setX(x.left),Q.setY(x.top),Q.setWidth(x.width),Q.setHeight(x.height),Q._fullscreen=!0,Q.iv(),d=!1)}},500)}else{var g=R.style.left,o=R.style.top,I=R.style.width,s=R.style.height,z=R.style.background,F=R.style.backgroundColor;z||F||(R.style.backgroundColor="white"),R.requestFullscreen?R.requestFullscreen():R.msRequestFullscreen?R.msRequestFullscreen():R.mozRequestFullScreen?R.mozRequestFullScreen():R.webkitRequestFullscreen&&R.webkitRequestFullscreen();var h=setInterval(function(){if(R!==(b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement))clearInterval(h),R.style.left=g,R.style.top=o,R.style.width=I,R.style.height=s,R.style.oldBackgroundColor=F,Q.iv();else{var z=u.Default.getWindowInfo();(d||z.width!==Q.getWidth()||z.height!==Q.getHeight())&&(Bb(Q),d=!1)}},500)}}},appendTimeStamp:function(h){return h},setCompType:function(q,C){Im(C)||ei(C)?we[q]=C:$h(q)},getCompType:function(y){var _=we[y];return _===I&&co.test(y)&&$h(y),_},getCompTypeMap:function(){return we},drawCompType:function(y,M,b,w,s,t){y(M,b,w,s,t)},numberListener:function(){var e={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(M){var $=M.keyCode;e[$]||65===$&&w.isCtrlDown(M)||86===$&&w.isCtrlDown(M)||67===$&&w.isCtrlDown(M)||88===$&&w.isCtrlDown(M)||$>=35&&40>=$||(M.shiftKey||48>$||$>57)&&(96>$||$>105)&&M.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(M){var A=M.target.tagName;("DIV"===A||"CANVAS"===A)&&!(w.ignoreKeyCodes.indexOf(M.keyCode)>=0)&&("keydown"!==M.type||Bk(M)||Vc(M)||ls(M)||gm(M)||_e(M)||65===M.keyCode&&(M.metaKey||M.ctrlKey))&&(M.preventDefault(),M.preventManipulation&&M.preventManipulation())},getWindowInfo:function(){var l=b.documentElement,D=l&&(l.scrollLeft||l.scrollTop)?l:b.body;return{target:D,left:D.scrollLeft,top:D.scrollTop,width:Z.innerWidth||D.clientWidth,height:Z.innerHeight||D.clientHeight}},isDragging:function(){return!!Kn},isLeftButton:function(I){return xc?!0:0===I.button},isMiddleButton:function(W){return xc?!1:W&&(1===W.button||4&(W.buttons||0))},isRightButton:function(j){return xc?!1:j&&(2===j.button||2&(j.buttons||0))},isInput:function(L){if(!L)return!1;var v=L.tagName;return"INPUT"===v||"TEXTAREA"===v||"SELECT"===v},getTouchCount:function(h){return xc?h.touches.length:1},isDoubleClick:function(){function C(x){x.details=0,x.timeout=null,x.lastPoint=null}var h={};return Sn=new y,Zk=Sn.getTime(),function(R){if(R.touches&&R.touches.length>1)return!1;var c=R.button==B?"":R.button,X=R.type+c,k=X+"_isDoubleClick",O=h[X];if(O||(O=h[X]={details:0,timeout:null,lastPoint:null}),R[k]===I){R[k]=!0;var A=pr(R);O.timeout&&(Cd(O.timeout),O.timeout=null),O.lastPoint&&Ke(O.lastPoint,A)>w.doubleClickRange&&C(O),O.lastPoint=A,O.details++,O.timeout=nd(function(){C(this)}.bind(O),500)}return 2===O.details}}(),isShiftDown:function(u){return u?u.shiftKey:Hr["16"]},isCtrlDown:function(J){return J?Qg?J.metaKey:J.ctrlKey:Qg?Hr["91"]:Hr["17"]},getClientPoint:function(Z){return xc&&(Z=wm(Z)),{x:Z.clientX,y:Z.clientY}},isMouseEvent:function(S){return S instanceof MouseEvent||0===S.type.indexOf("mouse")},getTargetElement:function(M){if(w.isMouseEvent(M)||!b.elementFromPoint)return M.target;var j=_m(M);return b.elementFromPoint(j.x,j.y)},getPagePoint:function(g){return xc&&(g=wm(g)),{x:g.pageX,y:g.pageY}},createObject:function(m,a){var w=new m;for(var s in a){var v=a[s];if(Im(v))w[s]=v;else if(0===s.indexOf("s:"))w.s(s.substr(2),a[s]);else if(0===s.indexOf("a:"))w.a(s.substr(2),a[s]);else{var U=dd(s),v=a[s];w[U]?(w[U](v),"setToolTip"===U&&w.enableToolTip&&w.enableToolTip()):w[s]=v}}return w},setImage:function(H,y,L,Q){var q=arguments.length;
4===q?uf(H,Q,y,L):2===q?Ug(y)?uf(H,y):Sc(H,y):1===q&&uf(H,H)},getImage:function(M,j,p){var D;if(M==B)return B;if(ei(M)?D=M:(D=Lr[M],M&&D===I&&(bc&&bc[M]||uf(M,M))),j&&D&&D.tagName){var s;s="override"===p?"colors_override":"override_rgb"===p?"colors_override_rgb":"override_a"===p?"colors_override_a":"colors",D[s]||(D[s]={__count__:0});var m=D[s][j];return m||(D[s].__count__>w.imageCacheThreshold&&(D[s]={__count__:0}),m=om(D,Dk(j),D.width,D.height,p),D[s][j]=m,D[s].__count__++),m}return D},isImageComplete:function(q,W,R){var T=Ve(q);if(!T)return!1;if(T.tagName)return T.complete;for(var s,q,N,c=T.comps,Q=!0,z=0,l=c.length;l>z;z++)if(s=c[z],N=s.type,"image"===s.type){q=s.name,q&&q.func&&(q=lg(q,W));var v=zi(q,W,R);if(!v){Q=!1;break}}else if(co.test(N)&&w.getCompType(N)===I){Q=!1,$h(N);break}return Q},getId:function(){var x=1;return function(){return++x}}(),callLater:function(H,W,t,S){var r=function(){H.apply(W,t)};return S?nd(r,S):Z.requestAnimationFrame(r)},clone:function(j){if(null==j||"object"!=typeof j)return j;if(j instanceof Date){var S=new Date;return S.setTime(j.getTime()),S}if(j instanceof Array){for(var S=[],x=0,s=j.length;s>x;x++)S[x]=Sf(j[x]);return S}if(j instanceof Vn){for(var S=new Vn,x=0,s=j.length;s>x;x++)S.set(x,Sf(j.get(x)));return S}if(j instanceof db)return j;if(j instanceof J){var S={};for(var I in j)j.hasOwnProperty(I)&&(S[I]=Sf(j[I]));return S}return j},callWhenLoaded:function(Q,D){D=D||100;var p=xk(Q,D);Ri||(Ri={}),Ri[p]={tick:p,cb:Q,delay:D}},beforeLoadURL:function(t){if(Ri){var Y={};for(var k in Ri){var i=Ri[k];Cd(i.tick);var q=xk(i.cb,i.delay);Y[q]={tick:q,delay:i.delay,cb:i.cb}}Ri=Y}return w.convertURL?w.convertURL(t):t},convertURL:function(k){return k},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return w.getImage("default_blank")},sortFunc:function(j,C){if(j===C)return 0;if(j==B&&C!=B)return 1;if(j!=B&&C==B)return-1;if(j==B&&C==B)return 0;var n,s=typeof j,U=typeof C;return s===Xl&&U===Xl?n=j.localeCompare(C):s===md&&U===md&&(n=j-C),n===I&&(n=(""+j).localeCompare(""+C)),n>0?1:0>n?-1:0},getClassMap:function(){return mh},getClass:function(z){if(Ug(z)){var b,o=mh[z];if(!o){b=z.split("."),o=Z;for(var I=0;I<b.length;I++)o=o[b[I]];mh[z]=o}return o}return z},def:function(b,H,h){var m,Y,L,X=function(){};if(X.prototype=H.prototype,m=new X,Ug(b)){if(mh[b])throw"'"+b+"' already defined";L=_q(b),m.getClassName=function(){return b}}else L=b;if(m.constructor=L,m.getClass=function(){return L},m.getSuperClass=function(){return H},h)for(Y in h)ve[Y]&&ve.hasOwnProperty(Y)?ve[Y](m,h):nk(m,h,Y);L.prototype=m,L.superClass=H.prototype},startAnim:function(){var V=function(M){M.duration&&(M.startTime=np()),M.timeId=Wo(M.tick,B,B,M.interval)};return function(n){return n=Sf(n),n.easing=n.easing||w.animEasing,n.duration||n.frames||(n.duration=w.animDuration),n.t=0,n.duration?n.interval=0:(n.frame=0,n.interval=n.interval||10),n.tick=function(){if(n.duration){var F=(np()-n.startTime)/n.duration;if(F>1&&(F=1),n.t=F,n.action(n.easing(F),F),!n.isRunning())return;1===F?n.stop():n._isPaused||(n.timeId=Wo(n.tick))}else{if(n.frame++,F=n.t=n.frame/n.frames,n.action(n.easing(F),F),!n.isRunning())return;n.frame<n.frames?n._isPaused||(n.timeId=Wo(n.tick,B,B,n.interval)):n.stop()}},n.resume=function(){n._isPaused&&(delete n._isPaused,n.duration?n.t<1&&(n.startTime=np()-n.duration*n.t,n.timeId=Wo(n.tick)):n.frame<n.frames&&(n.timeId=Wo(n.tick,B,B,n.interval)))},n.pause=function(){n._isPaused=!0},n.isPaused=function(){return this._isPaused},n.stop=function(o){n.isRunning()&&(bp(n.timeId,!n.duration),delete n.timeId,n.duration?n.t<1&&o&&(n.t=1,n.action(n.easing(1),1)):n.frame<n.frames&&o&&(n.frame=n.frames,n.action(n.easing(1),1)),n._37o&&n._37o(),n.finishFunc&&n.finishFunc())},n.isRunning=function(){return n.timeId!=B},n.delay?Wo(V,B,[n],n.delay):V(n),n}}(),getTextSize:function(){var z={},s=b?vn().getContext("2d"):B;return function(X,W){s.font=X?X:Dd;var N=z[s.font];return N||(N=2*s.measureText("e").width+4,z[s.font]=N),{width:s.measureText(W).width+4,height:N}}}(),drawText:function(N,Z,V,f,Q,S,U,K,W,C){if(Z!=B){var R=ad(V,Z),i={};i.y=C&&C!==Jc?C===Xn?S+R.height/2:S+K-R.height/2:S+K/2,i.x=W&&W!==ue?W===cg?Q+U-R.width/2:Q+U/2:Q+R.width/2,zo(N,Z,i,V,f)}},getDistance:function(u,M){var Y=u.length;return M?3===Y?h(_i(u[0]-M[0])+_i(u[1]-M[1])+_i(u[2]-M[2])):2===Y?h(_i(u[0]-M[0])+_i(u[1]-M[1])):u.z===I?h(_i(M.x-u.x)+_i(M.y-u.y)):h(_i(M.x-u.x)+_i(M.y-u.y)+_i(M.z-u.z)):3===Y?h(_i(u[0])+_i(u[1])+_i(u[2])):2===Y?h(_i(u[0])+_i(u[1])):void 0},brighter:function(X,z){return 0>z&&(z=-z),Kk(X,z?z:40)},darker:function(c,a){return a>0&&(a=-a),Kk(c,a?a:-40)},unionPoint:function(e,o){if(!e)return B;if(2===arguments.length)return e&&o?{x:s(e.x,o.x),y:s(e.y,o.y),width:j(e.x-o.x),height:j(e.y-o.y)}:B;var V=e;if(V._as&&(V=V._as),V.length===I)return B;var S=V.length;if(0>=S)return B;for(var i=1,R=V[0],f={x:R.x,y:R.y,width:0,height:0};S>i;i++){R=V[i];var K=s(f.x,R.x),b=_(f.x+f.width,R.x),p=s(f.y,R.y),P=_(f.y+f.height,R.y);f.x=K,f.y=p,f.width=b-K,f.height=P-p}return f},unionRect:function(j,p){if(j&&!p)return Sf(j);if(!j&&p)return Sf(p);if(j&&p){var r={x:s(j.x,p.x),y:s(j.y,p.y)};return r.width=_(j.x+j.width,p.x+p.width)-r.x,r.height=_(j.y+j.height,p.y+p.height)-r.y,r}return B},containsPoint:function(k,P,t,s){if(s!=B&&1!==s){var J=k.x+k.width/2,f=k.y+k.height/2;k={x:J-k.width/2*s,y:f-k.height/2*s,width:k.width*s,height:k.height*s}}if(t){var m=k.width/2,A=k.height/2,Z=q(-t),l=n(-t),j=P.x-k.x-m,M=P.y-k.y-A;return P={x:l*j-Z*M,y:Z*j+l*M},fr({x:-m,y:-A,width:k.width,height:k.height},P)}return!(!k||P.x<k.x||P.y<k.y||P.x>k.x+k.width||P.y>k.y+k.height)},containsRect:function(_,c){if(!_||!c)return!1;var U=c.x,L=c.y,B=c.width,P=c.height,w=_.width,X=_.height;if(0>(w|X|B|P))return!1;var I=_.x,t=_.y;if(I>U||t>L)return!1;if(w+=I,B+=U,U>=B){if(w>=I||B>w)return!1}else if(w>=I&&B>w)return!1;if(X+=t,P+=L,L>=P){if(X>=t||P>X)return!1}else if(X>=t&&P>X)return!1;return!0},intersectsRect:function(M,y){if(!M||!y)return!1;var N=y.width,r=y.height,A=M.width,U=M.height;if(0>=A||0>=U||0>=N||0>=r)return!1;var Q=y.x,i=y.y,V=M.x,T=M.y;return A+=V,U+=T,N+=Q,r+=i,A>Q&&U>i&&N>V&&r>T},intersection:function(q,J){if(!q||!J)return B;var s=J.x,N=J.y,l=q.x,C=q.y,W=s,m=N,u=l,Y=C;return W+=J.width,m+=J.height,u+=q.width,Y+=q.height,l>s&&(s=l),C>N&&(N=C),W>u&&(W=u),m>Y&&(m=Y),W-=s,m-=N,0>=W||0>=m?B:{x:s,y:N,width:W,height:m}},grow:function(l,A,s){s===I&&(s=A),l.x-=A,l.y-=s,l.width=l.width+2*A,l.height=l.height+2*s},getScreenPoint:function(R,M,N,h,q,w,y){var d=N.getBoundingClientRect(),s=R*(w||1)+d.left-N.scrollLeft+(h||0),J=M*(y||1)+d.top-N.scrollTop+(q||0),V={x:s,y:J},c=Hk(N.parentElement);return c?c.applyInverse(V,{}):V},getLogicalPoint:function(o,D,N,k,F,H){var O,f,u=D.getBoundingClientRect();o.target?(Di(o)?Qg?Hr["91"]=!0:Hr["17"]=!0:Qg?Hr["91"]=!1:Hr["17"]=!1,Hr["16"]=us(o)?!0:!1,o=xc?wm(o):o,O=o.clientX,f=o.clientY):(O=o.x,f=o.y);var d=Hk(D);if(d){var z=d.apply({x:O,y:f},{});return z.x=(z.x+D.scrollLeft-(N||0))/(F||1),z.y=(z.y+D.scrollTop-(k||0))/(H||1),z}return{x:(O-u.left+D.scrollLeft-(N||0))/(F||1),y:(f-u.top+D.scrollTop-(k||0))/(H||1)}},removeHTML:function(){var r;return function(c){return c&&c.getView&&(c=c.getView()),c&&c.parentNode?r===c?!0:(r=c,c.parentNode.removeChild(c),r=B,!0):!1}}(),getToolTipDiv:function(){if(!Cg){Cg=ms(),wc=ms();var u=Cg.style;w.baseZIndex!=B&&(u.zIndex=D(w.baseZIndex)+3+""),u.whiteSpace="nowrap",u.color=w.toolTipLabelColor,u.background=w.toolTipBackground,u.font=w.toolTipLabelFont,u.padding="5px",u.boxShadow="0px 0px 3px "+w.toolTipShadowColor}return Cg},isToolTipShowing:function(){return Cg&&Cg.parentNode?!0:wc&&wc.parentNode?!0:!1},hideToolTip:function(){ih(Cg),ih(wc),ec()},showToolTip:function(R,b){if(!R||b==B)return rh(),void 0;w.getToolTipDiv();var e,J;if(b.html?(b=b.html,e=wc,ih(Cg)):(e=Cg,ih(wc)),J=e.style,e.innerHTML=b,e.parentNode||u.Default.appendToScreen(e),R.target){R=_m(R);var a=vi(),X=R.x,z=R.y,A=xc?60:12;if(xc){var s=e.getBoundingClientRect();J.left=X-s.width/2+bi,J.top=z-s.height-A<a.top?z+A+bi:z-s.height-A+bi}else{J.left=X+A+bi,J.top=z+A+bi;var s=e.getBoundingClientRect();s.left+s.width>a.width&&(J.left=X-A-s.width+bi),s.top+s.height>a.height&&(J.top=z-A-s.height+bi),s.left<0&&(J.left=X+A+bi),s.top<0&&(J.top=z+A+bi)}}else J.left=R.x+bi,J.top=R.y+bi;ec()},startDragging:function(e,Y,T){T==I&&(T=!0),e!==Kn&&(Kn?T&&(xc?Kn.handleWindowTouchEnd(Y):Kn.handleWindowMouseUp(Y)):xc?(Z.addEventListener(os,Yc,o),Z.addEventListener(Mn,hr,o)):(Z.addEventListener(Wk,Go,o),Z.addEventListener(Pl,ck,o)),Kn=e)},getImageMap:function(){return Lr},toBoundaries:function(s,v,n,f){var L=[];return ol(s,v,n,f).forEach(function(s){var b=[];s.forEach(function(d){b.push(d.x,d.y)}),L.push(b)}),L},getCurrentKeyCodeMap:function(){return Hr},drawCenterImage:function(i,N,A,D,m,Y,x,t){var r=Sg(N,m,Y),l=Xd(N,m,Y);rj(i,N,Q(A-r/2),Q(D-l/2),r,l,m,Y,x,t)},drawStretchImage:function(u,W,c,r,z,C,q,A,B,d,l,H){var j,e=Sg(W,A,B,C),I=Xd(W,A,B,q);"uniform"===c?(j=s(C/e,q/I),e*=j,I*=j,r+=Q((C-e)/2),z+=Q((q-I)/2),C=e,q=I):"centerUniform"===c&&((e>C||I>q)&&(j=s(C/e,q/I),e*=j,I*=j),r+=Q((C-e)/2),z+=Q((q-I)/2),C=e,q=I);var t=u.interactiveInfo;if(t){var R;if(R="center"===c?{x:r+C/2-e/2,y:z+q/2-I/2,width:e,height:I}:{x:r,y:z,width:C,height:q},t.rect){var n=t.compInfos,f=n.length;f&&(n[f-1].rect.image=W)}else t.rect=R}if("center"===c){var F=l!==!1&&(e>C||I>q);F&&(u.save(),u.beginPath(),u.rect(r,z,C,q),u.clip()),rj(u,W,r+C/2-e/2,z+q/2-I/2,e,I,A,B,d,H),F&&u.restore()}else rj(u,W,r,z,C,q,A,B,d,H)},toCanvas:function(L,B,v,G,b,o,c,X,T){L=Ve(L,c),B=B||Sg(L,b),v=v||Xd(L,b);var J=vn(),M=oj(J);return X?(Lg(J,B,v,X),M.scale(X,X)):Lg(J,B,v,1),fl(M,L,G,0,0,B,v,b,o,c,T),L&&L.clampToEdge&&(J.clampToEdge=L.clampToEdge),M.restore(),J},toGrayColor:function(d){if(!d)return d;var G=Lk(d),R=.299*G[0]+.587*G[1]+.114*G[2];return"rgba("+R+","+R+","+R+","+G[3]/255+")"},createGradientImage:function(S,C,g,q){for(var e=["L",0,0,S,0,1,0,0,1,0,0],X=0,Z=Math.min(C.length,g.length);Z>X;X++)e.push(g[X],C[X]);var H=u.Default.toCanvas({width:S,height:S,clampToEdge:!0,comps:[{type:"shape",rotation:q||0,points:[0,0,S,0,S,S,0,S],background:"#ffffff",gradientPack:e}]});return H},createElement:function(H,V,G,U){var g=b.createElement(H);return Hl(g,V||W.widgetBorder,2),g.style.font=G?G:Dd,U!=B&&(g.value=U),w.onElementCreated&&w.onElementCreated(g),g},containedInView:function(q,D){var l=Be(D).getBoundingClientRect();return fr({x:l.left,y:l.top,width:l.width,height:l.height},pr(q))},isIsolating:function(){return Eq>0},setIsolating:function(C){C?Eq++:Eq--},getMSMap:function(){return ve},stringify:function(z,R,I){var t=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var O=JSON.stringify(z,function(M,J){return"function"==typeof J?"__ht__"+(J.__ht__||J.toString()):Yp(J)?mq(J):J instanceof u.List?"__ht__list"+(J.__ht__list||w.stringify(J._as)):J},R==B?2:R);return Date.prototype.toJSON=t,I&&(O="__ht__encode"+w.encodeString(O)),O},parse:function(y){return Ug(y)?"__ht__encode"!=y.substr(0,12)||(y=w.decodeString(y.substr(12)),Ug(y))?JSON.parse(y,function(u,q){if(Ug(q))if("__ht__function"==q.substr(0,14)){var n=q.indexOf("{")+1,L=q.lastIndexOf("}"),b=q.indexOf("(")+1,B=q.indexOf(")");if(n&&L&&b&&B){var d=new Function(q.substring(b,B),q.substring(n,L));return d.__ht__=q.substr(6),d}}else{if("__ht__date"==q.substr(0,10))return new Date(D(q.substr(10)));if("__ht__list"===q.substr(0,10))return new Vn(w.parse(q.substr(10)))}return q}):y:y},loadJS:function(h,U){U&&h.push(U);var S=h.shift();if(Zh(S))h=S.contact(h),w.loadJS(h);else if(Im(S))S(),w.loadJS(h);else if(Ug(S)){var O=b.createElement("script");O.onload=function(){w.loadJS(h)},O.setAttribute("src",S),b.getElementsByTagName("head")[0].appendChild(O)}else h.length&&w.loadJS(h)},toRoundedCorner:function(a,C){var Y=a.size();if(0>=C)return{points:a};var N,G=new Vn,P=new Vn,c=a.get(0);G.add(c),P.add(1);for(var A=1;Y>A;A++)if(Y>A+1){var $=a.get(A),k=a.get(A+1),h=c.x,Q=c.y,x=$.x,i=$.y,r=i-Q,D=x-h,d=v(r,D);N=s(.99*Ke(c,$),C),G.add({x:x-N*n(d),y:i-N*q(d)}),G.add($),h=$.x,Q=$.y,x=k.x,i=k.y,r=i-Q,D=x-h,d=v(r,D),N=s(.99*Ke($,k),C),c={x:h+N*n(d),y:Q+N*q(d)},G.add(c),P.addAll([2,3])}else G.add(a.get(A)),P.add(2);return{points:G,segments:P}},toColorData:Lk,setCanvas:Lg,createDiv:ms,createDisabledDiv:Gb,createView:wk,createCanvas:vn,appendChild:Oi,initContext:oj,checkLoadingImage:kl,translateAndScale:Id,layout:Bb,getPosition:hi,drawPoints:ti,drawRoundRect:on,drawBorder:Dr,setFocus:Sp,getter:mc,setter:dd,isEmptyObject:dg,cameraPriority:function(){var s={skybox:0,main:1e4,top:1e7,infinity:1/0};return J.seal(J.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return s.skybox},set:function(M){if(M>=s.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");s.skybox=Number(M)}},main:{configurable:!1,enumerable:!1,get:function(){return s.main},set:function(q){if(q<=s.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(q>=s.top)throw new RangeError("Main camera must have lower priority than the top camera.");s.main=Number(q)}},top:{configurable:!1,enumerable:!1,get:function(){return s.top},set:function(F){if(F<=s.main)throw new RangeError("Top camera must have higher priority than the main camera.");s.top=Number(F)}}}))}()},!0),_p(T,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Pi=w.disabledOpacity,qi=w.toolTipDelay,Am=w.devicePixelRatio,dp=w.autoMakeVisible,km=w.autoHideScrollBar,tp=w.imageGradient,kd=w.showToolTip,rh=w.hideToolTip,Oe=w.dashPattern,wb=w.lineCap,Nn=w.lineJoin,mm=w.labelColor,Jh=w.labelSelectColor,Dd=w.labelFont,sp=w.widgetIndent,kg=w.widgetRowHeight,hc=w.widgetHeaderHeight,Bj=w.widgetTitleHeight,jg=w.scrollBarColor,el=w.scrollBarSize,Fl=w.scrollBarTimeout,bg=w.scrollBarMinLength,td=w.scrollBarInteractiveSize,Vm=w.zoomIncrement,Lo=w.scrollZoomIncrement,mr=w.pinchZoomIncrement,ug=w.zoomMax,Tm=w.zoomMin,Lq=w.createObject,xh=w.preventDefault,mk=w.setImage,Ve=w.getImage,zi=w.isImageComplete,Cn=w.drawCenterImage,fl=w.drawStretchImage,No=w.getId,Wo=w.callLater,Tn=w.sortFunc,Sf=w.clone,_q=w.getClass,Qh=w.startAnim,Cl=w.brighter,ke=w.darker,ep=w.drawText,ad=w.getTextSize,yi=w.isLeftButton,kf=w.isMiddleButton,Ho=w.isRightButton,Kl=w.getTouchCount,Sb=w.isDoubleClick,us=w.isShiftDown,Di=w.isCtrlDown,pr=w.getClientPoint,_m=w.getPagePoint,Ke=w.getDistance,qh=w.unionPoint,Lh=w.unionRect,fr=w.containsPoint,Ih=w.containsRect,Pn=w.intersectsRect,Kr=w.intersection,vi=w.getWindowInfo,em=w.grow,xn=w.getLogicalPoint,yj=w.getScreenPoint,bh=w.startDragging,ih=w.removeHTML,Zc=w.createElement,jq=w.segmentResolution,Jg=w.shapeResolution,pj=w.shapeSide,eh=w.def,dk=function(i,c,E){eh(A+"."+i,c,E)},si=function(S,H){S.childNodes.forEach(function(b){H(b),si(b,H)})};_p(w,{toolTipLabelColor:mm,toolTipLabelFont:Dd,toolTipBackground:W.toolTipBackground,toolTipShadowColor:Jf,drawBreakableText:ac,setDevicePixelRatio:function(I){Am=w.devicePixelRatio="number"==typeof I?I:Z.devicePixelRatio,si(b.body,function($){var Q=$._ht;Q&&Q._canvas&&(Lg(Q._canvas,Q.getWidth(),Q.getHeight()),Q.redraw?Q.redraw():Q.iv())})}},!0);var Rm=1e-6,rg="undefined"!=typeof Uint16Array?Uint16Array:Array,Hf="undefined"!=typeof Float32Array?Float32Array:Array,Gc=function(X,Y,i){var v=[X[0]-Y[0],X[1]-Y[1],X[2]-Y[2]];if(i){var z=Ke(v);z>0&&(v[0]/=z,v[1]/=z,v[2]/=z)}return v},gf=function(){var o="charCodeAt",X=2*(2*xg.length+1);for(var _ in Z)if(_===A+ue[0]+(bi.length+2)){var y=Z[_];if(!y)break;for(var R=y.length,K=0;R>K;K++)if(y[K][o](0)===X&&y[K+1]!=B&&y[K+1]===bi[0]&&y[K+2]!=B&&y[K+2][o](0)===X){for(var T=K+3;R>T;T++)if(y[T][o](0)===X){if(0==y[T+1])for(var G,O=T+2;R>O;O++){if(y[O][o](0)===X){0==y[O-1]&&G&&(Jq=G.substr(0,G.length-1));break}G==B?G=y[O]:G+=y[O]}break}break}break}return function(U){return[-U[0],-U[1],-U[2]]}}(),qg=function(Y,R){return 3===Y.length?Y[0]*R[0]+Y[1]*R[1]+Y[2]*R[2]:Y[0]*R[0]+Y[1]*R[1]},Gf=function(){var L=new Array(16);return L[0]=1,L[1]=0,L[2]=0,L[3]=0,L[4]=0,L[5]=1,L[6]=0,L[7]=0,L[8]=0,L[9]=0,L[10]=1,L[11]=0,L[12]=0,L[13]=0,L[14]=0,L[15]=1,L},ne=Gf(),rs=function(s){var z=new Array(16);return z[0]=s[0],z[1]=s[1],z[2]=s[2],z[3]=s[3],z[4]=s[4],z[5]=s[5],z[6]=s[6],z[7]=s[7],z[8]=s[8],z[9]=s[9],z[10]=s[10],z[11]=s[11],z[12]=s[12],z[13]=s[13],z[14]=s[14],z[15]=s[15],z},qb=function(Z,j){return Z[0]=j[0],Z[1]=j[1],Z[2]=j[2],Z[3]=j[3],Z[4]=j[4],Z[5]=j[5],Z[6]=j[6],Z[7]=j[7],Z[8]=j[8],Z[9]=j[9],Z[10]=j[10],Z[11]=j[11],Z[12]=j[12],Z[13]=j[13],Z[14]=j[14],Z[15]=j[15],Z},Dc=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g},wd=function(t,s){var v=t[0],o=t[1],z=t[2];return t[0]=s[0]*v+s[4]*o+s[8]*z+s[12],t[1]=s[1]*v+s[5]*o+s[9]*z+s[13],t[2]=s[2]*v+s[6]*o+s[10]*z+s[14],t},He=function(x,g){var e=x[0],V=x[1],u=x[2],M=x[3];return x[0]=g[0]*e+g[4]*V+g[8]*u+g[12]*M,x[1]=g[1]*e+g[5]*V+g[9]*u+g[13]*M,x[2]=g[2]*e+g[6]*V+g[10]*u+g[14]*M,x[3]=g[3]*e+g[7]*V+g[11]*u+g[15]*M,x},tb=function(){var K,q,e,A,v=je(Xo[1]+Xo[7]),w=je(Xo[0]+Xo[3]-Xo[10]),T=je(Xo[8]+2),B=function(){return q=e.charAt(K),K+=1,q},m=function(){var l="";if(q===T)for(;B();){if(q===T)return B(),l;l+=q}else B()},Y=function(){for(;q&&" ">=q;)B()},R=function(){var e,b={};if(q===v){if(B(),Y(),q===w)return B(),b;for(;q;){if(e=m(),Y(),B(),b[e]=A(),Y(),q===w)return B(),b;B(),Y()}}};return A=function(){switch(Y(),q){case v:return R();default:return m()}},function(J){if(C={},J){var o;if(e=J,K=0,q=" ",o=A(),Y(),!q)return o}}}(),lp=function(l,v){if(v){var V=q(v),f=n(v),X=l[4],M=l[5],I=l[6],_=l[7],i=l[8],h=l[9],a=l[10],r=l[11];l[4]=X*f+i*V,l[5]=M*f+h*V,l[6]=I*f+a*V,l[7]=_*f+r*V,l[8]=i*f-X*V,l[9]=h*f-M*V,l[10]=a*f-I*V,l[11]=r*f-_*V}},Ze=function(D,G){if(G){var b=q(G),E=n(G),a=D[0],p=D[1],o=D[2],f=D[3],R=D[8],B=D[9],H=D[10],s=D[11];D[0]=a*E-R*b,D[1]=p*E-B*b,D[2]=o*E-H*b,D[3]=f*E-s*b,D[8]=a*b+R*E,D[9]=p*b+B*E,D[10]=o*b+H*E,D[11]=f*b+s*E}},Nm=function(E,O){if(O){var r=q(O),v=n(O),y=E[0],L=E[1],Z=E[2],h=E[3],H=E[4],D=E[5],N=E[6],C=E[7];E[0]=y*v+H*r,E[1]=L*v+D*r,E[2]=Z*v+N*r,E[3]=h*v+C*r,E[4]=H*v-y*r,E[5]=D*v-L*r,E[6]=N*v-Z*r,E[7]=C*v-h*r}},Lm=function(X,Z,R){return se(B,R===!1?B:X.getFinalScale3d(),X.getFinalRotation3d(),X.getRotationMode(),X.p3(),B,Z)},se=function(o,A,x,E,J,Q,S){return Q||(Q=Gf()),J&&tg(Q,J),Xh(Q,x,E),S&&Yb(Q,Q,S),A&&Kg(Q,A),o&&Yb(Q,Q,o),Q},pp=function(M,W,P){W=D(W),P=D(P);var I=this;I.g=M,I._84O=W,I._85O=P,I._70I=!0,I.F=0,I._83O=W+P,I.pen={x:0,y:0}},Ej="lineDashOffset",th="setLineDash",Po=function(W){for(var U in W)1===U.length&&(Ej=W[U]);return U?1:0},es=function(h,q,o){return $c(q)?h:h[th]?(h[th](q),o&&(h.lineDashOffset=o),h):new pp(h,q[0],q.length>1?q[1]:q[0])},Ne=function(M,O){!$c(O)&&M[th]&&(M[th](Vl),M.lineDashOffset=0)};if(eh(pp,J,{_69I:6,moveTo:function(J,M){var L=this,b=L.pen;b.x=J,b.y=M,L.g.moveTo(J,M),L.start||(L.start={x:J,y:M})},lineTo:function(g,X){var i=this,e=i.pen,$=g-e.x,k=X-e.y,Q=v(k,$),w=n(Q),p=q(Q),K=i._23O(e.x,e.y,g,X),B=i._85O,E=i._84O,I=i._83O;if(i.F){if(i.F>K)return i._70I?i._72I(g,X):i.moveTo(g,X),i.F-=K,void 0;if(i._70I?i._72I(e.x+w*i.F,e.y+p*i.F):i.moveTo(e.x+w*i.F,e.y+p*i.F),K-=i.F,i.F=0,i._70I=!i._70I,!K)return}var s=S(K/I);if(s){for(var D=w*E,V=p*E,f=w*B,r=p*B,Y=0;s>Y;Y++)i._70I?(i._72I(e.x+D,e.y+V),i.moveTo(e.x+f,e.y+r)):(i.moveTo(e.x+f,e.y+r),i._72I(e.x+D,e.y+V));K-=I*s}i._70I?K>E?(i._72I(e.x+w*E,e.y+p*E),i.moveTo(g,X),i.F=B-(K-E),i._70I=!1):(i._72I(g,X),K===E?(i.F=0,i._70I=!i._70I):(i.F=E-K,i.moveTo(g,X))):K>B?(i.moveTo(e.x+w*B,e.y+p*B),i._72I(g,X),i.F=E-(K-B),i._70I=!0):(i.moveTo(g,X),K===B?(i.F=0,i._70I=!i._70I):i.F=B-K)},quadraticCurveTo:function(W,E,F,h){var C,M=this,d=M.pen,$=d.x,I=d.y,N=M._22O($,I,W,E,F,h),v=0,x=0,G=M._85O,b=M._84O;if(M.F){if(M.F>N)return M._70I?M._71I(W,E,F,h):M.moveTo(F,h),M.F-=N,void 0;if(v=M.F/N,C=M._20O($,I,W,E,F,h,v),M._70I?M._71I(C[2],C[3],C[4],C[5]):M.moveTo(C[4],C[5]),M.F=0,M._70I=!M._70I,!N)return}var H=N-N*v,L=S(H/M._83O),Z=b/N,e=G/N;if(L)for(var t=0;L>t;t++)M._70I?(x=v+Z,C=M._21O($,I,W,E,F,h,v,x),M._71I(C[2],C[3],C[4],C[5]),v=x,x=v+e,C=M._21O($,I,W,E,F,h,v,x),M.moveTo(C[4],C[5])):(x=v+e,C=M._21O($,I,W,E,F,h,v,x),M.moveTo(C[4],C[5]),v=x,x=v+Z,C=M._21O($,I,W,E,F,h,v,x),M._71I(C[2],C[3],C[4],C[5])),v=x;H=N-N*v,M._70I?H>b?(x=v+Z,C=M._21O($,I,W,E,F,h,v,x),M._71I(C[2],C[3],C[4],C[5]),M.moveTo(F,h),M.F=G-(H-b),M._70I=!1):(C=M._19O($,I,W,E,F,h,v),M._71I(C[2],C[3],C[4],C[5]),N===b?(M.F=0,M._70I=!M._70I):(M.F=b-H,M.moveTo(F,h))):H>G?(x=v+e,C=M._21O($,I,W,E,F,h,v,x),M.moveTo(C[4],C[5]),C=M._19O($,I,W,E,F,h,x),M._71I(C[2],C[3],C[4],C[5]),M.F=b-(H-G),M._70I=!0):(M.moveTo(F,h),H===G?(M.F=0,M._70I=!M._70I):M.F=G-H)},bezierCurveTo:function(){var j=arguments;this.pen={x:j[4],y:j[5]},this.g.bezierCurveTo(j[0],j[1],j[2],j[3],j[4],j[5])},arc:function(x,K,O,u,d,X){X||(u=-u,d=-d),xq(this,x,K,u,d-u,O,O,!1)},rect:function(w,e,c,p){var P=this;P.pen={x:w,y:e},P.moveTo(w,e),P.lineTo(w,e+p),P.lineTo(w+c,e+p),P.lineTo(w+c,e),P.lineTo(w,e)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(u,z,V,C){var f=V-u,i=C-z;return h(f*f+i*i)},_22O:function(x,i,T,L,W,J,V){for(var q,h,n,$,b,N,S,U=0,B=x,s=i,R=V>0?V:this._69I,p=1;R>=p;p++)n=p/R,$=1-n,b=$*$,N=2*n*$,S=n*n,q=b*x+N*T+S*W,h=b*i+N*L+S*J,U+=this._23O(B,s,q,h),B=q,s=h;return U},_21O:function(h,K,F,R,$,B,w,o){var Q=this;if(0===w)return Q._20O(h,K,F,R,$,B,o);if(1===o)return Q._19O(h,K,F,R,$,B,w);var Z=Q._20O(h,K,F,R,$,B,o);return Z.push(w/o),Q._19O.apply(Q,Z)},_20O:function(t,M,O,C,I,F,g){if(1!==g){var A=O+(I-O)*g,$=C+(F-C)*g;O=t+(O-t)*g,C=M+(C-M)*g,I=O+(A-O)*g,F=C+($-C)*g}return[t,M,O,C,I,F]},_19O:function(H,r,d,Q,R,M,K){if(1!==K){var t=H+(d-H)*K,h=r+(Q-r)*K;d+=(R-d)*K,Q+=(M-Q)*K,H=t+(d-t)*K,r=h+(Q-h)*K}return[H,r,d,Q,R,M]},_72I:function(M,W){var E=this.pen;(M!==E.x||W!==E.y)&&(E.x=M,E.y=W,this.g.lineTo(M,W))},_71I:function(S,w,I,T){var m=this.pen;(S!==I||w!==T||I!==m.x||T!==m.y)&&(m.x=I,m.y=T,this.g.quadraticCurveTo(S,w,I,T))}}),f&&zr){var Nc=zr.toString();m=Nc.indexOf(Ub.substr(0,2))>0&&Nc.indexOf(Xn+Xn.substr(1,1))>1||Nc.indexOf(wf.substr(0,2)+Ub.substr(2,2)+ue[0]+Ub[4])>1?!0:!1}var zs=B,gr=B,Jl=function(O){zs&&!O._72O&&(gr||(gr={}),gr[O._72O=No()]=O)},$h=function(X,D){if(D||(D=X),D&&(zs||(zs={}),!zs[X])){var $=new $n;if(zs[D]={request:$,url:D},D=w.beforeLoadURL(D),D.data){var W=w.parse(D.data);Pq(X,W),w.handleCompTypeLoaded(X,W)}else{$.onload=function(){if(200===this.status||0===this.status){var r=w.parse($.getResponseText());Pq(X,r),w.handleCompTypeLoaded(X,r)}else Pq(X,B)},$.onerror=function(){Pq(X,B)};var k={};k.url=encodeURI(D),k.sync=!1,$.send(k)}}},Pq=function(E,w){if(we[E]=w,delete zs[E],dg(zs)&&(zs=B,gr)){for(var H in gr){var A=gr[H];A.invalidateAll&&A.invalidateAll(I,"compTypeLoaded",E),A.redraw&&A.redraw(),A.iv(),delete A._72O}gr=B}if(w&&gr)for(var H in gr){var A=gr[H];A.invalidateAll&&A.invalidateAll(I,"compTypeLoading",E),A.redraw&&A.redraw(),A.iv()}},gh=W.chart,cf="",or=w.compStack=[],ag=/^style@/,Aj=/^attr@/,mn=/^field@/,Vb={x:.5,y:.5},Sg=function(c,n,k,u){if(!c)return 0;if(lg(c.fitSize,n,k)&&u)return u;var H=lg(c.width,n,k);return null==H?20:H},Xd=function(r,f,o,C){if(!r)return 0;if(lg(r.fitSize,f,o)&&C)return C;var V=lg(r.height,f,o);return null==V?20:V},lg=function(Q,P,k){if(!Q||!Q.func)return Q;var A,j=Q.func,R=Q.value;return A=Im(j)?k&&k.vectorDataBindingDisabled&&!Q.isSafeFunc?R:j(P,k):P instanceof db?Aj.test(j)?P.a(cf+j.slice(5)):ag.test(j)?P.s(cf+j.slice(6)):mn.test(j)?P[j.slice(6)]:P[j]?P[j](k):R:R,R!==I&&A==B?R:A},rj=w.drawImage=function(){var X,j,m,l,o,H,T=function(d,y){d.getValue&&d.getValue.compType===y||(d.getValue=function(i){var l=b(d,i);if(l===I&&y.properties){var F=y.properties[i];F&&(l=F.defaultValue)}return l},d.getColor=function(P){return x(d.getValue(P))},d.getValue.compType=y)},b=function(C,i,H){var e,s=!1;if(C.prefix&&j instanceof db){var A=j.a(cf+i);A!==I&&(s=!0,e=A)}return e===I&&(e=C[i]),e&&e.func&&(s=!0,e=lg(e,j,m)),H&&(e=H(e),s||(C[i]=e)),e},x=function(N,K){var q;if(q=K?b(N,K):N,X&&X.compGray&&q)return w.toGrayColor(q);if(o&&q){if("override"===H)return o;if("override_rgb"===H){var I=Dk(o);return q=Lk(q),"rgba("+S(255*I[0])+","+S(255*I[1])+","+S(255*I[2])+","+q[3]/255+")"}if("override_a"===H){var I=Dk(o);return q=Lk(q),"rgba("+q[0]+","+q[1]+","+q[2]+","+I[3]+")"}var I=Dk(o);return q=Lk(q),"rgba("+S(q[0]*I[0])+","+S(q[1]*I[1])+","+S(q[2]*I[2])+","+q[3]/255*I[3]+")"}return q},c=function(G){if(Zh(G)){for(var b=new Vn,N=G.length,M=0;N>M;M+=2)b.add({x:G[M],y:G[M+1]});G=b}return G},k=function(D){var B=b(D,"anchorX"),r=b(D,"anchorY");if(B!==I||r!==I)return{x:B===I?Vb.x:B,y:r===I?Vb.y:r};var u=b(D,"type"),l=b(D,"name");if("image"!==u||!l)return Vb;var F=Ve(l);return F&&F.anchorX!==I&&F.anchorY!==I?{x:F.anchorX,y:F.anchorY}:Vb},N=function(W,w){var A=b(W,kc),V=k(W);if(Zh(A)){var l=A.length,K=b(W,"relative"),E=w.width,x=w.height;if(4===l)A={x:A[0],y:A[1],width:A[2],height:A[3]},K&&(A.x*=E,A.y*=x,A.width*=E,A.height*=x);else if(3===l){var S=A[0];A={width:A[1],height:A[2]},K&&(A.width*=E,A.height*=x),"object"==typeof S?S.length&&(S={x:S[0],y:S[1]}):S=hi(S,w,A),A.x=S.x-A.width*V.x,A.y=S.y-A.height*V.y}A.x+=b(W,"offsetX")||0,A.y+=b(W,"offsetY")||0,!K&&w.fitSize&&(A=D(W,A,w))}return A},D=function(u,l,L){if(l){var v,Q,D,Z={x:l.x,y:l.y,width:l.width,height:l.height},R=k(u),F=b(u,"layoutH"),E=b(u,"layoutV"),i=1,N=1,c=0,X=0,y=1,O=1;switch(F){case"left":break;case"right":Z.x+=L.width-L.rw;break;case"center":Z.x+=.5*(L.width-L.rw);break;case"scale":case"leftright":default:v=b(u,Yk)||0,v&&(c=Math.abs(X=Math.sin(v)),y=Math.abs(O=Math.cos(v))),"leftright"!==F?(i+=y*(L.widthScale-1),N+=c*(L.widthScale-1)):(i+=Z.width?y*(L.width-L.rw)/Z.width:0,N+=Z.height?c*(L.width-L.rw)/Z.height:0,Q=-Math.min(-R.x*O+R.y*X,-R.x*O-(1-R.y)*X,(1-R.x)*O+R.y*X,(1-R.x)*O-(1-R.y)*X))}switch(E){case"top":break;case"bottom":Z.y+=L.height-L.rh;break;case"center":Z.y+=.5*(L.height-L.rh);break;case"scale":case"topbottom":default:v==B&&(v=b(u,Yk),v&&(c=Math.abs(X=Math.sin(v)),y=Math.abs(O=Math.cos(v)))),"topbottom"!==E?(i+=c*(L.heightScale-1),N+=y*(L.heightScale-1)):(i+=Z.width?c*(L.height-L.rh)/Z.width:0,N+=Z.height?y*(L.height-L.rh)/Z.height:0,D=-Math.min(-R.x*X-R.y*O,-R.x*X+(1-R.y)*O,(1-R.x)*X-R.y*O,(1-R.x)*X+(1-R.y)*O))}return(1!==i||1!==N)&&("scale"!==F&&F?"leftright"===F&&(Z.x+=Z.width*(1-i)*R.x+Q*(L.width-L.rw)):Z.x+=Z.x*(L.widthScale-1)+R.x*Z.width*(L.widthScale-i),"scale"!==E&&E?"topbottom"===E&&(Z.y+=Z.height*(1-N)*R.y+D*(L.height-L.rh)):Z.y+=Z.y*(L.heightScale-1)+R.y*Z.height*(L.heightScale-N),Z.width*=i,Z.height*=N),Z.width<0&&(Z.width=0),Z.height<0&&(Z.height=0),Z}},C=function(b){return Zh(b)?new Vn(b):b},a=function(q,x,c,z,s,S,B){var v=X.interactiveInfo,H=q.transform;if(H)return X.save(),X.setTransform(H.a,H.b,H.c,H.d,H.tx,H.ty),v&&v.compInfos.push({comp:q,rect:x,matrix:H.clone(),prefix:cf}),!0;s===I&&(s=1),S===I&&(S=1);var j=b(q,"clipPercentage"),P=un(c,x);if(P&&!z&&1===s&&1===S&&!(1>j))return v&&v.compInfos.push({comp:q,rect:x,matrix:v.matrix.clone(),prefix:cf}),!1;B=B||Vb;var m=x.x+x.width*B.x,C=x.y+x.height*B.y,N=c.x+c.width*B.x,y=c.y+c.height*B.y,d=c.width?s*(x.width/c.width):1,g=c.height?S*(x.height/c.height):1;if(X.save(),v&&(v.matrix.appendTranslate(m,C).appendRotate(z).appendScale(d,g).appendTranslate(-N,-y),v.compInfos.push({comp:q,rect:x,matrix:v.matrix.clone()})),Bn(X,m,C),sb(X,z||0),ur(X,d,g),Bn(X,-N,-y),1>j){0>j&&(j=0);var Z=hh(c,b(q,"clipDirection"),j);X.beginPath(),X.rect(Z.x,Z.y,Z.width,Z.height),X.clip()}return!0},F=function(){X.restore()},Y=function(W,U,I){var q=b(W,"path"),o=b(W,Yk),T=b(W,"scaleX"),h=b(W,"scaleY"),R=k(W),s=B,e=Xe(null,q);if(I||(I=W.unionRect,I||(I=qh(e),W.path.func||(W.unionRect=I)),s=I),I){s||(s=W.unionRect,s||(s=qh(e),W.path.func||(W.unionRect=s)));var p=a(W,I,s,o,T,h,R),n=b(W,"borderPattern"),A=es(X,n),z=x(W,"background"),N=x(W,"borderColor"),t=b(W,"borderWidth"),L=b(W,"gradient"),E=x(W,"gradientColor"),$=b(W,"border3d"),c=x(W,"border3dColor"),y=b(W,"border3dAccuracy"),C=X.lineJoin,f=X.lineCap;if(X.lineJoin=b(W,"borderJoin")||Nn,X.lineCap=b(W,"borderCap")||wb,z?(fc(X,z,L,E,s),Xe(X,q),X.fill(),A!==X&&Xe(X,q)):Xe(X,q),t&&N){var S=b(W,"borderWidthAbsolute");S&&(X.save(),X.setTransform(1,0,0,1,0,0)),X.lineWidth=t,X.strokeStyle=N,X.stroke(),S&&X.restore(),$&&Zl(X,N,c,t,l,y)}if(Ne(X,n),b(W,"dash")){var r=b(W,"dashWidth")||t;if(r>0){n=b(W,"dashPattern")||Oe;var A=es(X,n,b(W,"dashOffset")),D=x(W,"dashColor")||x(lf);A!==X&&Xe(X,q),X.strokeStyle=D,X.lineWidth=r,X.stroke(),b(W,"dash3d")&&Zl(X,D,x(W,"dash3dColor"),r,l,b(W,"dash3dAccuracy")),Ne(X,n)}}U===kc&&zb(X,z,b(W,"depth"),s),X.lineJoin=C,X.lineCap=f,p&&F()}},Q=function(t,s,T,r){var I=b(t,tf,c),G=b(t,Yk),K=k(t);if(I&&r.fitSize){var W=new Vn,V=qh(I),P=D(t,V,r),O=V.x+K.x*V.width,N=V.y+K.y*V.height,h=P.x+K.x*P.width,g=P.y+K.y*P.height,Y=V.width?P.width/V.width:1,Z=V.height?P.height/V.height:1;I.each(function(t){W.add({x:h+(t.x-O)*Y,y:g+(t.y-N)*Z})}),I=W,t.unionRect=null}var y=b(t,"scaleX"),w=b(t,"scaleY"),p=s===Oh,A=B;if(!T&&p&&(T=t.unionRect,T||(T=qh(I),t.points.func||(t.unionRect=T)),A=T),T){p?A||(A=t.unionRect,A||(A=qh(I),t.points.func||(t.unionRect=A))):A=T;var n,L,U,J,i=a(t,T,A,G,y,w,K),$=b(t,"borderPattern"),E=es(X,$),u=x(t,"background"),d=Ve(b(t,"repeatImage"),o,H),v=b(t,"gradientPack"),q=x(t,"borderColor"),z=b(t,"borderWidth"),M=b(t,"segments",C),R=b(t,"gradient"),f=x(t,"gradientColor"),Q=b(t,"border3d"),S=x(t,"border3dColor"),e=b(t,"border3dAccuracy"),_=b(t,"closePath"),fi=b(t,"fillRule")||"nonzero",Nj=X.lineJoin,mg=X.lineCap;if(X.lineJoin=b(t,"borderJoin")||Nn,X.lineCap=b(t,"borderCap")||wb,p)if(u||d||v){var Tf=b(t,"fillClipPercentage");if(1>Tf){0>Tf&&(Tf=0);var yd=hh(A,b(t,"fillClipDirection"),Tf);X.save(),X.beginPath(),X.rect(yd.x,yd.y,yd.width,yd.height),X.clip()}if(ti(X,I,M,_),v)Qe(X,v);else if(d){var hj=X,ee=o,Zc=H;Ed(X,d,o,H,j,m),X=hj,o=ee,H=Zc}else{var hj=X;fc(X,u,R,f,A),X=hj}X.fill(fi),1>Tf&&X.restore(),v&&X.restore(),E!==X&&ti(E,I,M,_)}else ti(E,I,M,_);else if("roundRect"===s?n=b(t,"cornerRadius"):"polygon"===s?n=b(t,"polygonSide"):"arc"===s&&(n=b(t,"arcFrom"),L=b(t,"arcTo"),U=b(t,"arcClose"),J=b(t,"arcOval")),u||d||v){var Tf=b(t,"fillClipPercentage");if(1>Tf){0>Tf&&(Tf=0);var yd=hh(A,b(t,"fillClipDirection"),Tf);X.save(),X.beginPath(),X.rect(yd.x,yd.y,yd.width,yd.height),X.clip()}if(sq(X,s,A,n,L,U,J),v)Qe(X,v);else if(d){var hj=X,ee=o,Zc=H;Ed(X,d,o,H,j,m),X=hj,o=ee,H=Zc}else fc(X,u,R,f,A);X.fill(fi),1>Tf&&X.restore(),v&&X.restore(),X!==E&&sq(E,s,A,n,L,U,J)}else sq(E,s,A,n,L,U,J);if(z&&q){var mi=b(t,"borderWidthAbsolute");mi&&(X.save(),X.setTransform(1,0,0,1,0,0)),X.lineWidth=z,X.strokeStyle=q,X.stroke(),mi&&X.restore(),Q&&Zl(X,q,S,z,l,e)}if(Ne(X,$),b(t,"dash")){var Ur=b(t,"dashWidth")||z;if(Ur>0){$=b(t,"dashPattern")||Oe;var E=es(X,$,b(t,"dashOffset")),De=x(t,"dashColor")||x(lf);E!==X&&(p?ti(E,I,M,_):sq(E,s,A,n,L,U,J)),X.strokeStyle=De,X.lineWidth=Ur,X.stroke(),b(t,"dash3d")&&Zl(X,De,x(t,"dash3dColor"),Ur,l,b(t,"dash3dAccuracy")),Ne(X,$)}}s===kc&&zb(X,u,b(t,"depth"),A),X.lineJoin=Nj,X.lineCap=mg,i&&F()}},f=function(A,B){var N=o,x=H,d=o||b(A,Ge),p=H||b(A,"blendMode"),G=Ve(b(A,"name"),d,p);G&&(fl(X,G,b(A,"stretch"),B.x,B.y,B.width,B.height,j,m,d,null,p),o=N,H=x)},P=function(N,L){var U=b(N,"text");U!=B&&ep(X,U,b(N,"font"),x(N,Ge),L.x,L.y,L.width,L.height,b(N,"align"),b(N,"vAlign"))},V=function(Y,u){Dr(X,x(Y,Ge),u.x,u.y,u.width,u.height,b(Y,"width"))},U=function(c,E){var S=b(c,hd),M=0;if(S&&(S.forEach(function(H){M+=H}),M>0)){for(var G=b(c,"colors")||gh,U=b(c,"startAngle")||0,u=b(c,"hollow"),p=b(c,Bd),g=b(c,Xg),I=b(c,zd),K=p?new Vn:B,Y=E.x,A=E.y,T=E.width,w=E.height,d=Y+T/2,a=A+w/2,x=s(T,w)/2,o=0,P=0;P<S.length;P++){var m=S[P],y=z*m/M,J=U+y;if(X.fillStyle=G[o++],o===G.length&&(o=0),X.beginPath(),u){var i=d+n(U)*x/2,D=a+q(U)*x/2,$=d+n(J)*x,Z=a+q(J)*x;
X.moveTo(i,D),X.arc(d,a,x/2,U,J,!1),X.lineTo($,Z),X.arc(d,a,x,J,U,!0)}else X.moveTo(d,a),X.arc(d,a,x,J,U,!0);K&&(y=(U+J)/2,K.add({text:Im(p)?p(m,P,M,j):m,x:d+.75*n(y)*x,y:a+.75*q(y)*x})),X.closePath(),X.fill(),U=J}K&&K.each(function(n){ep(X,n.text,g,I,n.x,n.y,0,0,Qo)})}},M=function(a,Y){var x=b(a,pd);if(x&&x.length>0){var i=x.length,d=b(a,Bd),M=b(a,Xg),Z=b(a,zd),t=d?new Vn:B,u=b(a,"minValue")||0,e=b(a,"maxValue");if(e==B&&(e=0,x.forEach(function(X){b(X,hd).forEach(function(U){e=_(e,U)})})),u===e)return;for(var m=Y.height/(e-u),w=Y.y+e*m,$=b(x[0],hd).length,y=Y.width/(3*$+1),q=2*y/i,s=0,A=0;i>A;A++)for(var h=x[A],S=b(h,Ge),R=b(h,"colors"),N=b(h,hd),U=0;$>U;U++){R?X.fillStyle=R[U]:S?X.fillStyle=S:(X.fillStyle=gh[s++],s===gh.length&&(s=0));var g=N[U],Q=g*m,J=Y.x+(1+3*U)*y+A*q;if(Xc(X,J,w-Q,q,Q),t){var o=Im(d)?d(g,U,h,j):g,F=ad(M,o).height;t.add({x:J,y:w-Q-F,width:q,height:F,text:o})}}t&&t.each(function(Y){ep(X,Y.text,M,Z,Y.x,Y.y,Y.width,Y.height,Qo)})}},g=function(i,T){var x=b(i,pd);if(x&&x.length>0){var Y=x.length,H=b(x[0],hd).length,K=T.width/(3*H+1),y=0,C=b(i,"maxValue"),R=b(i,Bd),f=b(i,Xg),z=b(i,zd),S=R?new Vn:B;if(C==B){C=0;for(var N=0;H>N;N++){for(var Q=0,o=0;Y>o;o++)Q+=b(x[o],hd)[N];C=_(C,Q)}}if(C>0){for(var N=0;H>N;N++)for(var m=T.y+T.height,o=0;Y>o;o++){var D=x[o],U=b(D,Ge),u=b(D,hd)[N],$=u/C*T.height;U?X.fillStyle=U:(X.fillStyle=gh[y++],y===gh.length&&(y=0)),m-=$;var Z={x:T.x+(1+3*N)*K,y:m,width:2*K,height:$};Xc(X,Z.x,Z.y,Z.width,Z.height),S&&(Z.text=Im(R)?R(u,N,D,j):u,S.add(Z))}S&&S.each(function(v){ep(X,v.text,f,z,v.x,v.y,v.width,v.height,Qo)})}}},$=function(p,M){var J=b(p,pd);if(J&&J.length>0){for(var y=J.length,x=b(J[0],hd).length,d=M.width/(3*x+1),P=0,R=b(p,Bd),W=b(p,Xg),$=b(p,zd),U=R?new Vn:B,o=0;x>o;o++){for(var e=0,c=0;y>c;c++)e+=b(J[c],hd)[o];if(e>0){var s=M.y+M.height;for(c=0;y>c;c++){var u=J[c],F=b(u,Ge),h=b(u,hd)[o],Z=h/e*M.height;F?X.fillStyle=F:(X.fillStyle=gh[P++],P===gh.length&&(P=0)),s-=Z;var n={x:M.x+(1+3*o)*d,y:s,width:2*d,height:Z};Xc(X,n.x,n.y,n.width,n.height),U&&(n.text=Im(R)?R(h,o,u,j):h,U.add(n))}}}U&&U.each(function(T){ep(X,T.text,W,$,T.x,T.y,T.width,T.height,Qo)})}},h=function(K,y){var N=b(K,pd);if(N&&N.length>0){var L=N.length,o=b(K,"minValue")||0,C=b(K,"maxValue");if(C==B&&(C=0,N.forEach(function(c){b(c,hd).forEach(function(F){C=_(C,F)})})),o===C)return;for(var d=y.height/(C-o),m=y.y+C*d,s=b(N[0],hd).length,v=y.width/(3*s+1),G=0,J=b(K,"lineWidth")||2,T=b(K,"line3d"),M=b(K,"linePoint"),u=b(K,Bd),A=b(K,Xg),h=b(K,zd),R=0;L>R;R++){var S=N[R],p=b(S,Ge),Q=b(S,hd);p?X.strokeStyle=p:(p=X.strokeStyle=gh[G++],G===gh.length&&(G=0)),X.beginPath();for(var Y=0;s>Y;Y++){var x=y.x+(2+3*Y)*v,f=m-Q[Y]*d;0===Y?X.moveTo(x,f):X.lineTo(x,f)}if(X.lineWidth=J,X.stroke(),T&&Zl(X,p,B,J,l),M||u){var k,w=J/2+2;for(Y=0;s>Y;Y++){var i=Q[Y];if(x=y.x+(2+3*Y)*v,f=m-i*d,Im(M)?M(X,x,f,p,Y,S,j):M&&(X.fillStyle=p,X.beginPath(),X.arc(x,f,w,0,z,!0),X.fill()),Im(u)?k=u(i,Y,S,j):u&&(k=i),k){var U=ad(A,k).height,P=X.shadowBlur;if(P){var $=X.shadowOffsetX,c=X.shadowOffsetY,t=X.shadowColor;X.shadowOffsetX=0,X.shadowOffsetY=0,X.shadowBlur=0,X.shadowColor=B}ep(X,k,A,h,x,f-U-w+2,0,U,Qo),P&&(X.shadowOffsetX=$,X.shadowOffsetY=c,X.shadowBlur=P,X.shadowColor=t)}}}}}},y=function(){X=null,j=null,m=null},t=function(x,K){var J;m&&m.getState?J=m.getState(j):(J=j instanceof db?j.s(Uc):null,(J===I||null===J)&&(J=b(x,Uc)));var y=b(K,Uc);return y!==I&&null!==y&&y!==J?!1:b(K,sh)},u={border:V,image:f,text:P,pieChart:U,columnChart:M,stackedColumnChart:g,percentageColumnChart:$,lineChart:h};return function($,S,U,W,e,r,J,z,P,M){if(S&&e&&r){var G=X?!1:!0;X=$,j=J,m=z,l=m?m._zoom?m._zoom:1:1,o=P,H=M;var L=e,h=r;if(li()){var O,E,d;0===X[qq]?li[0]&&(O=!0):O=!0,X.texureImage2D?li[1]&&(E=!0):E=!0,X.texureImage3D?li[2]&&(d=!0):d=!0,O&&E&&d&&(L=U,h=W)}if(S.tagName)return Ug(Jq)&&!Z[Jq]||X.drawImage(S,L,h,e,r),G&&y(),void 0;if(b(S,"visible")===!1)return G&&y(),void 0;o||(o=lg(S.color,j,m)),M||(H=lg(S.blendMode,j,m)),Ug(Jq)&&!Z[Jq]&&(e=L,r=h);var p=Sg(S,j,m,e),R=Xd(S,j,m,r),f={x:0,y:0,width:p,height:R,fitSize:b(S,"fitSize")},i=b(S,"clip"),_=b(S,"opacity");if(f.fitSize){var K=f.rw=lg(S.width,j,m)||20;f.widthScale=p/K;var A=f.rh=lg(S.height,j,m)||20;f.heightScale=R/A}if(X.save(),X.interactiveInfo){var D=X.interactiveInfo.matrix,g=D.clone();D.appendTranslate(L,h).appendScale(e/p,r/R)}Bn(X,L,h),(p!==e||R!==r)&&X.scale(e/p,r/R),i&&(Im(i)?i(X,p,R,j,m,S):(X.beginPath(),X.rect(0,0,p,R),X.clip())),_!=B&&(X.globalAlpha*=_),b(S,"comps").forEach(function(o){if(o.prefix){var h=cf,V=lg(o.prefix,j,m);V&&(cf=cf+V+".")}if(t(S,o)===!1)return o.prefix&&(cf=h),void 0;if(or.splice(0,0,o),X.interactiveInfo)var z=X.interactiveInfo.matrix.clone();var K=b(o,"opacity"),P=b(o,"shadow"),s=b(o,"type"),e=N(o,f);if(K!=B){var g=X.globalAlpha;X.globalAlpha*=K}if(P){var p=X.shadowOffsetX,W=X.shadowOffsetY,G=X.shadowBlur,U=X.shadowColor,L=b(o,"shadowOffsetX"),R=b(o,"shadowOffsetY"),r=b(o,"shadowBlur"),v=x(o,"shadowColor");X.shadowOffsetX=(L==B?3:L)*l,X.shadowOffsetY=(R==B?3:R)*l,X.shadowBlur=(r==B?6:r)*l,X.shadowColor=v||x(Lb)}if("save"===s)X.save();else if("endClip"===s||"restore"===s)X.restore();else if("clip"===s)X.save(),ti(X,b(o,"points",c),b(o,"segments",C),!0),X.clip();else if(gc[s])e=e||{x:0,y:0,width:f.width,height:f.height},Q(o,s,e,f);else if(s===Oh)Q(o,s,e,f);else if("SVGPath"===s)Y(o,s,e);else{e=e||{x:0,y:0,width:f.width,height:f.height};var E=b(o,Yk),n=b(o,"scaleX"),d=b(o,"scaleY"),q=k(o),J=a(o,e,e,E,n,d,q);if(Im(s))T(o,s),w.drawCompType(s,X,e,o,j,m);else if(w.getCompType(s)){var i=w.getCompType(s),H=i.func||i;T(o,i),w.drawCompType(H,X,e,o,j,m)}else u[s]?u[s](o,e):w.getCompType(s)===I&&co.test(s)&&$h(s);J&&F()}P&&(X.shadowOffsetX=p,X.shadowOffsetY=W,X.shadowBlur=G,X.shadowColor=U),K!=B&&(X.globalAlpha=g),X.interactiveInfo&&(X.interactiveInfo.matrix=z),o.prefix&&(cf=h),or.splice(0,1)}),X.interactiveInfo&&(X.interactiveInfo.matrix=g),X.restore(),G&&y()}}}();w.getCurrentComp=function(){return or[0]},w.getParentComp=function(){return or[1]},w.getInternal=function(){return{isEnter:Il,isEsc:Pg,isSpace:Rg,isLeft:Bk,isUp:ls,isRight:Vc,isDown:gm,addMethod:_p,superCall:lr,toPointsArray:ol,translateAndScale:Id,appendArray:Md,createWorldMatrix:se,vec3TransformMat4:wd,setCanvas:Lg,createDiv:ms,createView:wk,createCanvas:vn,createImage:Tq,initContext:oj,layout:Bb,fillRect:Xc,Mat:vl,drawBorder:Dr,isString:Ug,setBorder:Hl,getPropertyValue:ef,setPropertyValue:im,drawVerticalLine:Ak,draw3DRect:zb,getPinchDist:yf,isSameRect:un,getPosition:hi,intersectionLineRect:Xm,getNodeRect:dm,getEdgeAgentPosition:In,getEdgeHostPosition:Gq,getImageWidth:Sg,getImageHeight:Xd,initItemElement:zm,drawPoints:ti,createG2:es,closePopup:Uo,isH:Uq,createAnim:Aq,createNormalMatrix:Hp,createNormals:gj,toFloatArray:Jn,glMV:rm,batchShape:ob,createNodeMatrix:Lm,getFaceInfo:vj,transformAppend:vr,drawFaceInfo:Rl,to3dPointsArray:Wi,setGLDebugMode:function(m){bs=m},cube:function(){return{vs:ic,is:Ar,uv:xp}},ui:function(){return{DataUI:wh,NodeUI:Kq,EdgeUI:so,GroupUI:Ao,ShapeUI:Eg,GridUI:ch,Data3dUI:Jm,Node3dUI:Pr,Shape3dUI:Kc}},getInternalVersion:function(){return"U2FsdGVkX18ADOPyugzSTpPOfh4nZNZav3URf+5u+7A="},getDragger:function(){return Kn},addMSMap:function(A){_p(ve,A)},k:k}},function(x){function j(F,x){F!=B&&(x==B&&Xl!=typeof F?this._54O(F,256):this._54O(F,x))}function Y(){return new j(B)}function $(G,d,Y,b,K,C){for(;--C>=0;){var m=d*this[G++]+Y[b]+K;K=S(m/67108864),Y[b++]=67108863&m}return K}function W(e,W,N,t,b,$){for(var C=32767&W,I=W>>15;--$>=0;){var _=32767&this[e],c=this[e++]>>15,x=I*_+c*C;_=C*_+((32767&x)<<15)+N[t]+(1073741823&b),b=(_>>>30)+(x>>>15)+I*c+(b>>>30),N[t++]=1073741823&_}return b}function N(H,e,m,I,S,d){for(var b=16383&e,Q=e>>14;--d>=0;){var q=16383&this[H],U=this[H++]>>14,$=Q*q+U*b;q=b*q+((16383&$)<<14)+m[I]+S,S=(q>>28)+($>>14)+Q*U,m[I++]=268435455&q}return S}function u(y){return td.charAt(y)}function I(R,q){var Q=zd[R.charCodeAt(q)];return Q==B?-1:Q}function K(I){for(var j=this.t-1;j>=0;--j)I[j]=this[j];I.t=this.t,I.s=this.s}function f(u){this.t=1,this.s=0>u?-1:0,u>0?this[0]=u:-1>u?this[0]=u+this.DV:this.t=0}function T(m){var f=Y();return f._58O(m),f}function X(P,d){var n,v=this;if(16==d)n=4;else if(8==d)n=3;else if(256==d)n=8;else if(2==d)n=1;else if(32==d)n=5;else{if(4!=d)return v.fromRadix(P,d),void 0;n=2}v.t=0,v.s=0;for(var _=P.length,x=!1,s=0;--_>=0;){var Q=8==n?255&P[_]:I(P,_);0>Q?"-"==P.charAt(_)&&(x=!0):(x=!1,0==s?v[v.t++]=Q:s+n>v.DB?(v[v.t-1]|=(Q&(1<<v.DB-s)-1)<<s,v[v.t++]=Q>>v.DB-s):v[v.t-1]|=Q<<s,s+=n,s>=v.DB&&(s-=v.DB))}8==n&&0!=(128&P[0])&&(v.s=-1,s>0&&(v[v.t-1]|=(1<<v.DB-s)-1<<s)),v._57O(),x&&j.ZERO._78O(v,v)}function d(){for(var a=this,n=a.s&a.DM;a.t>0&&a[a.t-1]==n;)--a.t}function b(m){var p=this;if(p.s<0)return"-"+p._85O()[Il](m);var Q;if(16==m)Q=4;else if(8==m)Q=3;else if(2==m)Q=1;else if(32==m)Q=5;else{if(4!=m)return p.toRadix(m);Q=2}var Z,f=(1<<Q)-1,$=!1,Y="",y=p.t,P=p.DB-y*p.DB%Q;if(y-->0)for(P<p.DB&&(Z=p[y]>>P)>0&&($=!0,Y=u(Z));y>=0;)Q>P?(Z=(p[y]&(1<<P)-1)<<Q-P,Z|=p[--y]>>(P+=p.DB-Q)):(Z=p[y]>>(P-=Q)&f,0>=P&&(P+=p.DB,--y)),Z>0&&($=!0),$&&(Y+=u(Z));return $?Y:"0"}function Z(){var N=Y();return j.ZERO._78O(this,N),N}function y(){return this.s<0?this._85O():this}function P(E){var e=this,z=e.s-E.s;if(0!=z)return z;var B=e.t;if(z=B-E.t,0!=z)return e.s<0?-z:z;for(;--B>=0;)if(0!=(z=e[B]-E[B]))return z;return 0}function o(F){var Q,J=1;return 0!=(Q=F>>>16)&&(F=Q,J+=16),0!=(Q=F>>8)&&(F=Q,J+=8),0!=(Q=F>>4)&&(F=Q,J+=4),0!=(Q=F>>2)&&(F=Q,J+=2),0!=(Q=F>>1)&&(F=Q,J+=1),J}function v(){var q=this;return q.t<=0?0:q.DB*(q.t-1)+o(q[q.t-1]^q.s&q.DM)}function H(B,M){var E;for(E=this.t-1;E>=0;--E)M[E+B]=this[E];for(E=B-1;E>=0;--E)M[E]=0;M.t=this.t+B,M.s=this.s}function w(D,R){for(var b=D;b<this.t;++b)R[b-D]=this[b];R.t=_(this.t-D,0),R.s=this.s}function Q(Y,p){var g,y=this,$=Y%y.DB,j=y.DB-$,q=(1<<j)-1,F=S(Y/y.DB),K=y.s<<$&y.DM;for(g=y.t-1;g>=0;--g)p[g+F+1]=y[g]>>j|K,K=(y[g]&q)<<$;for(g=F-1;g>=0;--g)p[g]=0;p[F]=K,p.t=y.t+F+1,p.s=y.s,p._57O()}function i(H,E){var Z=this;E.s=Z.s;var k=S(H/Z.DB);if(k>=Z.t)return E.t=0,void 0;var f=H%Z.DB,J=Z.DB-f,s=(1<<f)-1;E[0]=Z[k]>>f;for(var i=k+1;i<Z.t;++i)E[i-k-1]|=(Z[i]&s)<<J,E[i-k]=Z[i]>>f;f>0&&(E[Z.t-k-1]|=(Z.s&s)<<J),E.t=Z.t-k,E._57O()}function a(U,W){for(var v=this,u=0,b=0,K=s(U.t,v.t);K>u;)b+=v[u]-U[u],W[u++]=b&v.DM,b>>=v.DB;if(U.t<v.t){for(b-=U.s;u<v.t;)b+=v[u],W[u++]=b&v.DM,b>>=v.DB;b+=v.s}else{for(b+=v.s;u<U.t;)b-=U[u],W[u++]=b&v.DM,b>>=v.DB;b-=U.s}W.s=0>b?-1:0,-1>b?W[u++]=v.DV+b:b>0&&(W[u++]=b),W.t=u,W._57O()}function U(o,Y){var V=this.abs(),r=o.abs(),W=V.t;for(Y.t=W+r.t;--W>=0;)Y[W]=0;for(W=0;W<r.t;++W)Y[W+V.t]=V.am(0,r[W],Y,W,0,V.t);Y.s=0,Y._57O(),this.s!=o.s&&j.ZERO._78O(Y,Y)}function J(p){for(var T=this.abs(),h=p.t=2*T.t;--h>=0;)p[h]=0;for(h=0;h<T.t-1;++h){var o=T.am(h,T[h],p,2*h,0,1);(p[h+T.t]+=T.am(h+1,2*T[h],p,2*h+1,o,T.t-h-1))>=T.DV&&(p[h+T.t]-=T.DV,p[h+T.t+1]=1)}p.t>0&&(p[p.t-1]+=T.am(h,T[h],p,2*h,0,1)),p.s=0,p._57O()}function G(q,U,r){var F=q.abs(),G=this;if(!(F.t<=0)){var T=G.abs();if(T.t<F.t)return U!=B&&U._58O(0),r!=B&&G._77O(r),void 0;r==B&&(r=Y());var p=Y(),C=G.s,_=q.s,I=G.DB-o(F[F.t-1]);I>0?(F._44O(I,p),T._44O(I,r)):(F._77O(p),T._77O(r));var O=p.t,v=p[O-1];if(0!=v){var h=v*(1<<G.F1)+(O>1?p[O-2]>>G.F2:0),n=G.FV/h,k=(1<<G.F1)/h,R=1<<G.F2,b=r.t,c=b-O,f=U==B?Y():U;for(p._59O(c,f),r._52O(f)>=0&&(r[r.t++]=1,r._78O(f,r)),j.ONE._59O(O,f),f._78O(p,p);p.t<O;)p[p.t++]=0;for(;--c>=0;){var E=r[--b]==v?G.DM:S(r[b]*n+(r[b-1]+R)*k);if((r[b]+=p.am(0,E,r,c,0,O))<E)for(p._59O(c,f),r._78O(f,r);r[b]<--E;)r._78O(f,r)}U!=B&&(r._45O(O,U),C!=_&&j.ZERO._78O(U,U)),r.t=O,r._57O(),I>0&&r._46O(I,r),0>C&&j.ZERO._78O(r,r)}}}function r(C){var K=Y();return this.abs()._49O(C,B,K),this.s<0&&K._52O(j.ZERO)>0&&C._78O(K,K),K}function R(S){this.m=S}function O(M){return M.s<0||M._52O(this.m)>=0?M.mod(this.m):M}function m(n){return n}function p(h){h._49O(this.m,B,h)}function g(Z,w,b){Z._47O(w,b),this._74O(b)}function E(A,H){A._48O(H),this._74O(H)}function C(){if(this.t<1)return 0;var F=this[0];if(0==(1&F))return 0;var D=3&F;return D=15&D*(2-(15&F)*D),D=255&D*(2-(255&F)*D),D=65535&D*(2-(65535&(65535&F)*D)),D=D*(2-F*D%this.DV)%this.DV,D>0?this.DV-D:-D}function F(F){var x=this;x.m=F,x.mp=F._50O(),x.mpl=32767&x.mp,x.mph=x.mp>>15,x.um=(1<<F.DB-15)-1,x.mt2=2*F.t}function L(E){var v=Y();return E.abs()._59O(this.m.t,v),v._49O(this.m,B,v),E.s<0&&v._52O(j.ZERO)>0&&this.m._78O(v,v),v}function t(G){var W=Y();return G._77O(W),this._74O(W),W}function V(j){for(var n=this;j.t<=n.mt2;)j[j.t++]=0;for(var T=0;T<n.m.t;++T){var y=32767&j[T],c=y*n.mpl+((y*n.mph+(j[T]>>15)*n.mpl&n.um)<<15)&j.DM;for(y=T+n.m.t,j[y]+=n.m.am(0,c,j,T,0,n.m.t);j[y]>=j.DV;)j[y]-=j.DV,j[++y]++}j._57O(),j._45O(n.m.t,j),j._52O(n.m)>=0&&j._78O(n.m,j)}function ts($,g){$._48O(g),this._74O(g)}function rf(u,d,w){u._47O(d,w),this._74O(w)}function pc(){return 0==(this.t>0?1&this[0]:this.s)}function zp(b,x){if(b>4294967295||1>b)return j.ONE;var m=Y(),B=Y(),h=x._73O(this),y=o(b)-1;for(h._77O(m);--y>=0;)if(x._76O(m,B),(b&1<<y)>0)x._75O(B,h,m);else{var l=m;m=B,B=l}return x.revert(m)}function As(s,$){var L;return L=256>s||$._51O()?new R($):new F($),this.exp(s,L)}function kn(){var y=this;if(y.s<0){if(1==y.t)return y[0]-y.DV;if(0==y.t)return-1}else{if(1==y.t)return y[0];if(0==y.t)return 0}return(y[1]&(1<<32-y.DB)-1)<<y.DB|y[0]}function Ym(U,f){return new j(U,f)}function Dd(){var k=this;k.n=B,k.e=0,k.d=B,k.p=B,k.q=B,k.dmp1=B,k.dmq1=B,k._10A=B}function Eg(b){return b._53O(this.e,this.n)}function lo(B){var A,k,C,a="",d=0;for(A=0;A<B.length&&B.charAt(A)!=ug;++A)C=Jm.indexOf(B.charAt(A)),0>C||(0==d?(a+=u(C>>2),k=3&C,d=1):1==d?(a+=u(k<<2|C>>4),k=15&C,d=2):2==d?(a+=u(k),a+=u(C>>2),k=3&C,d=3):(a+=u(k<<2|C>>4),a+=u(15&C),d=0));return 1==d&&(a+=u(k<<2)),a}function lh(X){var f=X.split(""),s=lo(X);return f.forEach(function(G){var b=G.length;b>0&&s&&(dr+=D(G))}),s}function Ln(e,Y){var h=mh._4O.Util._56O(e,"ss"),H={},u=0;return H.v=h==Y,H.t=1,H.s=0>u?-1:0,rk=H.v,u>0?H[0]=u:-1>u?H[0]=u+H.DV:H.t=0,[h,H]}function er(R){var x=38,M=R.substring(0,x);if(M&&30==M.indexOf("05000420")){var h=["ss",R.substring(x)];return h}return[]}function Fq(s,T){T=T.replace(nr,""),T=T.replace(/[ \n]+/g,"");var m=Ym(T,16);if(m._55O()>this.n._55O())return 0;var B=this._37O(m),X=B[Il](16).replace(/^1f+00/,""),K=er(X);if(0==K.length)return!1;for(var l,M,f,V=.5,W=pj,O=[0,.5,.75,.875,.9375],D=[],_=[],g=[],k=z/W,u=K[1],o=Ln(s,u)[0],A=0,C=0;A<O.length;A++){var e=0===A%2?0:.5;for(l=0;W>=l;l++)M=(l+e)*k,f=1-O[A],D.push(n(M)*V*f,-V+2*O[A]*V,-q(M)*V*f),_.push((l+e)/W,f)}for(A=0;A<O.length-1;A++){var r=A*(W+1),H=(A+1)*(W+1);for(l=0;W>l;l++)g.push(r+l,H+l+1,H+l,r+l,r+l+1,H+l+1)}return g.forEach(function(v){C+=v}),u==o&&C>10}var Tc,nl=0xdeadbeefcafe,Lh=15715070==(16777215&nl),Il="toString",qr="",_f="nat",Fj=function(){};e=x["D"+11182[Il](c(2,5))];var tl=j.prototype;Eh+=Eo.substr(0,1);var yp=x.navigator?x.navigator.appName:"";Lh&&"Microsoft Internet Explorer"==yp?(tl.am=W,Tc=30):Lh&&"Netscape"!=yp?(tl.am=$,Tc=26):(tl.am=N,Tc=28),tl.DB=Tc,tl.DM=(1<<Tc)-1,tl.DV=1<<Tc;var js=52;tl.FV=c(2,js),tl.F1=js-Tc,tl.F2=2*Tc-js;var dp,Fi,td="0123456789abcdefghijklmnopqrstuvwxyz",zd=[],Ar=function(V){return String.fromCharCode(V)};for(dp="0".charCodeAt(0),Fi=0;9>=Fi;++Fi)zd[dp++]=Fi;for(dp="a".charCodeAt(0),Fi=10;36>Fi;++Fi)zd[dp++]=Fi;for(dp="A".charCodeAt(0),Fi=10;36>Fi;++Fi)zd[dp++]=Fi;var uh=R.prototype;uh._73O=O,uh.revert=m,uh._74O=p,uh._75O=g,uh._76O=E;var Bh=F.prototype;Bh._73O=L,Bh.revert=t,Bh._74O=V,Bh._75O=rf,Bh._76O=ts,tl._77O=K,tl._58O=f,tl._54O=X,tl._57O=d,tl._59O=H,tl._45O=w,tl._44O=Q,tl._46O=i,tl._78O=a,tl._47O=U,tl._48O=J,tl._49O=G,tl._50O=C,tl._51O=pc,tl.exp=zp,tl.toString=b,tl._85O=Z,tl.abs=y,tl._52O=P,tl._55O=v,tl.mod=r,tl._53O=As,j.ZERO=T(0),j.ONE=T(1),tl._86O=kn;var Dr=function(T,O){var A=this;A.isPublic=!0,typeof T!==Xl?(A.n=T,A.e=O):T!=B&&O!=B&&T.length>0&&O.length>0&&(A.n=Ym(T,16),A.e=D(O,16))};zc=function(){var Y,V,q=lh(ec),A=q.substr(0,4),$=q.substr(4,2),N=q.substr(6,2),y=1,n=!y,H=k,i=[],Z=Gm.charAt(7);if(e&&(e[Il]().indexOf(_f)<0||e[Eh][Il]().indexOf(_f)<0||!q?Y=B:(q=new e(A-0,$-y,N-0),V=q.setHours(9),e[Eh]()>V?Y=Wr[Z]:n=!0)),q&&Y&&Y[0]&&Y[M(.5)]&&H){var X=tb(Y[0]),C=tb(Y[1]);for(var f in C)i.push(f);var R,x=0,w=X[i[x]],S=C[i[x++]],T=C[i[x++]],o=C[i[x++]],a=C[i[x++]],l=C[i[x++]],v=C[i[x++]],P=X[i[x]],d=C[i[x++]],_=zf._27O(H);if(w===S&&_&&d){R=S+T+o+a+l+v;var I=!v||v===Gr;if(!I&&v)for(var D,g=0,O=v.length;O>g;g++)v[g]===lj[x]?D===Gr?I=!0:D=B:(D==B?D=v[g]:D+=v[g],g===O-1&&D===Gr&&(I=!0));R&&_._31O(R,d)&&_._31O(w,P)&&I&&(!l||e[Eh]()<l)&&(n=!0)}}return n||(sq=$c),Z};var no=Dd.prototype;no._37O=Eg,no._38O=Dr;var Jm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ug="=",Rn=25,hj=10,ec="ICABJQ==",Kb=Kb||function(J,W){var n={},h=n._7A={},T=h._6A=function(){function i(){}return{_80O:function(u){i.prototype=this;var j=new i;return u&&j._5A(u),j.hasOwnProperty("_82O")||(j._82O=function(){j.$super._82O.apply(this,arguments)}),j._82O.prototype=j,j.$super=this,j},_3A:function(){var i=this._80O();return i._82O.apply(i,arguments),i},_82O:function(){},_5A:function($){for(var p in $)$.hasOwnProperty(p)&&(this[p]=$[p]);$.hasOwnProperty(Il)&&(this.toString=$.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),d=h._39O=T._80O({_82O:function(r,z){r=this._84O=r||[],this._65O=z!=W?z:4*r.length},toString:function(l){return(l||G).stringify(this)},_89O:function(f){var U=this._84O,v=f._84O,n=this._65O,Z=f._65O;if(this._57O(),n%4)for(var A=0;Z>A;A++){var $=255&v[A>>>2]>>>24-8*(A%4);U[n+A>>>2]|=$<<24-8*((n+A)%4)}else if(v.length>65535)for(var A=0;Z>A;A+=4)U[n+A>>>2]=v[A>>>2];else U.push.apply(U,v);return this._65O+=Z,this},_57O:function(){var a=this._84O,q=this._65O;a[q>>>2]&=4294967295<<32-8*(q%4),a.length=M(q/4)},_88O:function(){var P=T._88O.call(this);return P._84O=this._84O.slice(0),P},_87O:function($){for(var v=[],w=0;$>w;w+=4)v.push(0|4294967296*l);return new d._82O(v,$)}}),U=n._2A={},G=U._69O={stringify:function(V){var W,p=V._84O,F=V._65O,u=[];for(W=0;F>W;W++){var d=255&p[W>>>2]>>>24-8*(W%4);u.push((d>>>4).toString(16)),u.push((15&d).toString(16))}return u.join("")},_68O:function(k){for(var T=k.length,o=[],n=0;T>n;n+=2)o[n>>>3]|=D(k.substr(n,2),16)<<24-4*(n%8);return new d._82O(o,T/2)}},e=U._8A={stringify:function(K){var o,J=K._84O,u=K._65O,W=[];for(o=0;u>o;o++){var z=255&J[o>>>2]>>>24-8*(o%4);W.push(Ar(z))}return W.join("")},_68O:function(S){var g,P=S.length,$=[];for(g=0;P>g;g++)$[g>>>2]|=(255&S.charCodeAt(g))<<24-8*(g%4);return new d._82O($,P)}},N=U._9A={stringify:function(P){try{return decodeURIComponent(escape(e.stringify(P)))}catch(O){throw new Error("")}},_68O:function(T){return e._68O(unescape(encodeURIComponent(T)))}},K=h._32O=T._80O({_1A:function(){this._83O=new d._82O,this._23O=0},_33O:function(s){typeof s==Xl&&(s=N._68O(s)),this._83O._89O(s),this._23O+=s._65O},_25O:function(J){var O=this._83O,L=O._84O,P=O._65O,a=this._79O,Q=4*a,E=P/Q;E=J?M(E):_((0|E)-this._22O,0);var j=E*a,v=s(4*j,P);if(j){for(var e=0;j>e;e+=a)this._20O(L,e);var H=L.splice(0,j);O._65O-=v}return new d._82O(H,v)},_88O:function(){var F=T._88O.call(this);return F._83O=this._83O._88O(),F},_22O:0});h._66O=K._80O({cfg:T._80O(),_82O:function(c){this.cfg=this.cfg._80O(c),this._1A()},_1A:function(){K._1A.call(this),this._34O()},_81O:function(Q){return this._33O(Q),this._25O(),this},_72O:function(Y){Y&&this._33O(Y);var V=this._21O();return V},_79O:16,_26O:function(m){return function(M,P){return new m._82O(P)._72O(M)}},_19O:function(b){return function(j,a){return new u._71O._82O(b,a)._72O(j)}}});var u=n._67O={};return n}();!function(){var L=Kb,Y=L._7A,k=Y._39O,D=Y._66O,j=L._67O,n=[],P=[];!function(){function G(t){for(var k=h(t),Z=2;k>=Z;Z++)if(!(t%Z))return!1;return!0}function R(H){return 0|4294967296*(H-(0|H))}for(var v=2,W=0;64>W;)G(v)&&(8>W&&(n[W]=R(c(v,.5))),P[W]=R(c(v,1/3)),W++),v++}();var f=[],R=j._41O=D._80O({_34O:function(){this._64O=new k._82O(n.slice(0))},_20O:function($,G){for(var T=this._64O._84O,Z=T[0],r=T[1],N=T[2],Q=T[3],n=T[4],h=T[5],m=T[6],c=T[7],v=0;64>v;v++){if(16>v)f[v]=0|$[G+v];else{var S=f[v-15],e=(S<<25|S>>>7)^(S<<14|S>>>18)^S>>>3,B=f[v-2],E=(B<<15|B>>>17)^(B<<13|B>>>19)^B>>>10;f[v]=e+f[v-7]+E+f[v-16]}var Y=n&h^~n&m,l=Z&r^Z&N^r&N,D=(Z<<30|Z>>>2)^(Z<<19|Z>>>13)^(Z<<10|Z>>>22),J=(n<<26|n>>>6)^(n<<21|n>>>11)^(n<<7|n>>>25),X=c+J+Y+P[v]+f[v],g=D+l;c=m,m=h,h=n,n=0|Q+X,Q=N,N=r,r=Z,Z=0|X+g}T[0]=0|T[0]+Z,T[1]=0|T[1]+r,T[2]=0|T[2]+N,T[3]=0|T[3]+Q,T[4]=0|T[4]+n,T[5]=0|T[5]+h,T[6]=0|T[6]+m,T[7]=0|T[7]+c},_21O:function(){var G=this._83O,n=G._84O,P=8*this._23O,r=8*G._65O;return n[r>>>5]|=128<<24-r%32,n[(r+64>>>9<<4)+14]=S(P/4294967296),n[(r+64>>>9<<4)+15]=P,G._65O=4*n.length,this._25O(),this._64O},_88O:function(){var S=D._88O.call(this);return S._64O=this._64O._88O(),S}});L._41O=D._26O(R),L._42O=D._19O(R)}();var nr=new RegExp("");nr.compile("[^0-9a-f]","gi"),Dd._28O=-1,Dd._29O=-2,no._31O=Fq,no._63O=Fq,Dd._43O=-2;var vm=new function(){var X=this;X._5O=function(A,F){if("8"!=A.substring(F+2,F+3))return 1;var b=D(A.substring(F+3,F+4));return 0==b?-1:b>0&&10>b?b+1:-2},X._13O=function(m,a){var U=X._5O(m,a);return 1>U?"":m.substring(a+2,a+2+2*U)},X._12O=function(v,z){var K=X._13O(v,z);if(""==K)return-1;var I;return I=D(K.substring(0,1))<8?new j(K,16):new j(K.substring(2),16),I._86O()},X._6O=function(R,i){var U=X._5O(R,i);return 0>U?U:i+2*(U+1)},X._11O=function(o,s){var h=X._6O(o,s),u=X._12O(o,s);return o.substring(h,h+2*u)},X._10O=function($,_){var I=X._6O($,_),G=X._12O($,_);return I+2*G},X._7O=function(Z,F){var w=[],m=X._6O(Z,F);w.push(m);for(var u=X._12O(Z,F),D=m,v=0;;){var C=X._10O(Z,D);if(C==B||C-m>=2*u)break;if(v>=200)break;w.push(C),D=C,v++}return w}};if(vm._90O=Ar(hj+24),vm._91O=A+Ar(hj*hj+8),mh==B||!mh)var mh={};mh._4O!=B&&mh._4O||(mh._4O={});var pr=mh._4O;mh._4O.Util=new function(){var a=this;a._56O=function(W){var g=new mh._4O._3O;return g._30O(W)},a._4A=function(q){var P=new mh._4O._3O;return P._36O(q)},a._11A=function(P){var g=new pr._3O;return g._30O(P)}},mh._4O._3O=function(){var e=this;e._8O=function(E,G){if("ss"==E&&"cj"==G){try{e.md=Kb._67O._41O._3A()}catch(v){Fj(qr)}e._24O=function(R){e.md._81O(R)},e._35O=function(G){var R=Kb._2A._69O._68O(G);e.md._81O(R)},e._60O=function(){var E=e.md._72O();return E[Il](Kb._2A._69O)},e._30O=function(n){return e._24O(n),e._60O()},e._36O=function(D){return e._35O(D),e._60O()}}},e._24O=function(){Fj(qr)},e._35O=function(){Fj(qr)},e._60O=function(){Fj(qr)},e._30O=function(){Fj(qr)},e._36O=function(){Fj(qr)},e._8O("ss","cj")},$k=function(L){var i=ij[Ee[7]],e=1,H=!1;if(ln.a!=ij[md])return ln.a;if(ln.forEach(function(q){e*=q}),L>e){if(i&&i[1]&&i[0]){var F=i[0],Z=i[1];Z=Z.split(vm._90O),F=F.split(vm._90O);var a=Z[3],f=F[3],X=Z[7],r=Z[11],u=Z[15],W=Z[19],D=Z[23],N=Z[27],I=F[7],l=a+X+r+u+W+D,n=D?!1:!0,_=f===a;if(D){var M=D&&D.split(dd("firefox")[3]);if(M)for(var T=0;T<M.length;T++)if(ai.indexOf(M[T])>=0){n=!0;break}}H=_&&yc()(f,I)&&yc()(l,N)&&n&&(!W||W>L)}H||(wh.prototype._42=Op)}else H=!0;return ln.a=H,H},Rn=String.fromCharCode(Rn+20);var Aq=function(w){return w=w.replace(nr,qr),w=w.replace(/[ \n]+/g,qr)},Sd="30",sf="06",sk="02",Lk="03",Ao=Ym,An=/^1f+00/,zf=function(){var x;return x={_18O:function(V){var x=V,f=x.replace(/\s+/g,""),B=lo(f);return B},_14O:function(L){var J=this._18O(L),z=this._15O(J);return z},_15O:function(v){var Y=this._17O(v);if("2a864886f70d010101"==Y._61O){var B=this._16O(Y.key),F=new Dd;return F._38O(B.n,B.e),F}Fj(qr)},_16O:function(E){var r={};E.substr(0,2)!=Sd&&Fj(qr);var g=vm._7O(E,0);return 2!=g.length&&Fj(qr),E.substr(g[0],2)!=sk&&Fj(qr),r.n=vm._11O(E,g[0]),E.substr(g[1],2)!=sk&&Fj(qr),r.e=vm._11O(E,g[1]),r},_17O:function(S){var Z={};Z._40O=B;var h=vm._7O(S,0);2!=h.length&&Fj(qr);var i=h[0];S.substr(i,2)!=Sd&&Fj(qr);var L=vm._7O(S,i);return 2!=L.length&&Fj(qr),S.substr(L[0],2)!=sf&&Fj(qr),Z._61O=vm._11O(S,L[0]),S.substr(L[1],2)==sf?Z._40O=vm._11O(S,L[1]):S.substr(L[1],2)==Sd&&(Z._40O={},Z._40O.p=vm._70O(S,L[1],[0],sk),Z._40O.q=vm._70O(S,L[1],[1],sk),Z._40O.g=vm._70O(S,L[1],[2],sk)),S.substr(h[1],2)!=Lk&&Fj(qr),Z.key=vm._11O(S,h[1]).substr(2),Z}},x._17O?x:B}(),gm=zf._27O=function(Z){return zf._14O(Z)};yc=function(){return function(C,L){if(C&&L){L=Aq(L);var X=Ao(L,c(2,4)),j=this;if(!j||!j.n||X._55O()>j.n._55O())return 0;var N=j._37O(X),E=N[Il](c(2,4)).replace(An,""),k=er(E);if(0==k.length)return!1;var I=k[0],y=k[1],V=function(C){return mh._4O.Util._56O(C,I)},$=V(C);return y==$}}.bind(gm(k))};var Lg,El;return function(){var j=Jp.length-Ph.length;if(j>0)for(var O=0;j>O;O++)Lg=pr.Util,El=Aq}(),fh=function(g,a){a=El(a);var S=gm(Ej),y=bi.length,M=2*y,C=Ao(a,c(y,M)),F=S,j=!0;if(F){var Q=F[Iq[0]];Q&&C._55O()<=Q._55O()&&(j=!1)}if(j)return 0;var P=F._37O(C),v=P[Il](c(y,M)).replace(An,""),G=er(v);if(0==G.length)return!1;var W=G[0],l=G[1],t=Lg._11A(g,W);return l==t},zf}(Z,J),_p(w,{load:function(){var K={},P=function(i){return i?"c_"+(i.sync?"1":"0")+"_"+(i.post?"1":"0")+"_"+(i.responseType||"H")+"_"+(i.mimeType||"H")+"_"+(i.data?JSON.stringify(i.data):"H"):""};return function(T,J,I){var k,a=K[T],x=P(I);return a&&(k=a[x])?(k.push(J),void 0):(K[T]||(a=K[T]={count:0}),k=a[x]=[J],a.count++,w.xhrLoad(T,function(n){delete a[x],a.count--,a.count||delete K[T],k.forEach(function(M){M(n)})},I),void 0)}}(),asyncEach:function(T,E,O){"function"!=typeof O&&(O=Function.prototype);var H=new Array(T.length),L=0,X=!1;T.forEach(function(r,C){E(r,function(r,i){return X?void 0:r?(X=!0,O(null)):(H[C]=i,L++,L===T.length?O(H):void 0)})})},xhrLoad:function(X,p,t){var c=!1;Zh(X)||(c=!0,X=[X]),t=t||{},X.length;var D=t.sync,E=!!t.post,T=null;return w.asyncEach(X,function(j,U){var B=new $n;j=w.beforeLoadURL(j),j.data?U(null,j.data):(t.url=encodeURI(j),t.method=E?"POST":"GET",t.responseType?B.setResponseType(t.responseType):B.setOverrideMimeType(t.mimeType||"text/plain"),B.onload=function(){200===this.status||0===this.status?U(null,B.getResponseText()):U(!0)},B.onerror=function(){U(!0)},B.send(t))},function(Z){var P="function"==typeof p;(P||D)&&(T=c&&Z?Z[0]:Z,P&&p(T))}),D?T:void 0}});var Zq=J.setPrototypeOf||function(_,r){return _.__proto__=r,_},Ur=J.getPrototypeOf||function(E){return E.__proto__},Fg=J.freeze;J.isFrozen;var pk=function(){var u=function(Z){return Z};return function(o){return o&&o.length?new Function("o",["return o['",o.join("']['"),"'];"].join("")):u}}(),bo=function(){var l=function(v,H){return v=H};return function(Y){return Y&&Y.length?new Function("o","v",["return o['",Y.join("']['"),"'] = v;"].join("")):l}}();!function(){function P(N){var x=[];if(N)for(var l;(l=C.exec(N))!=I;)x.push(l[1]);return x}function G(K,x){var _=b.exec(x);this._cell=K,this._key=_[1],this._format=_[2],this._style=P(_[3])}function N(q){for(var e=this._cellList=[],k=this._paramList=[],m=q.split(w),v=0,f=m.length;f>v;++v){var j=m[v];if("{{"!==j)for(var H=j.split(p),K=0,i=H.length;i>K;++K){var W=H[K];p.test(W)?(k.push(new G(e.length,W)),e.push(I)):W.length>0&&e.push(W)}else e.push("{")}this._formatList=this._cellList.slice(0)}var n={},S={},w=/(\{\{)/,p=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,b=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,C=/\&([\w\.]*)/g;N.prototype._73O=function(j){for(var v=this._paramList.length;v--;){var T=this._paramList[v],m=j[D(T._key)+1],F=S[T._format];F&&(m=F(m,T._style)),this._formatList[T._cell]=m}return this._formatList.join("")},N.prototype._map=function(m){for(var f=this._paramList.length;f--;){var O=this._paramList[f],i=m[O._key],y=S[O._format];y&&(i=y(i,O._style)),this._formatList[O._cell]=i}return this._formatList.join("")};var r=function(x){var k=n[x];return k||(n[x]=k=new N(x)),k._73O(arguments)};return r.map=function(e,t){var X=n[e];return X||(n[e]=X=new N(e)),X._map(t)},r.setValueFormat=function(w,j){S[w]=j},r.gc=function(){n.length=0},r.__parsed=n,r}();var Bc=function(){function x(C,Y,b,D){var a=C?C.path.slice(0):[];Y&&a.push(Y),this.desc=b,this.name=Y,this.path=Fg(a),this.getter=pk(a),this.setter=bo(a),this.isLeaf=D,this.parent=C,this.children=[],this.childMap={}}return x.create=function(){function V(A,s,k,q){var G=q(k),Z=new x(A,s,k,G);if(!G){for(var H=Z.children,K=Z.childMap,P=J.keys(k),I=0,m=P.length;m>I;++I){var T=P[I],i=V(Z,T,k[T],q);H.push(i),K[i.name]=i}Z.children=Fg(H),Z.childMap=Fg(K)}return Fg(Z),Z}return function(m,A){return V(I,I,m,A)}}(),x.prototype.forEach=function(I,o){for(var w=this.children,b=0,$=w.length;$>b;++b){var s=w[b];I(s,o)}},x}();Math.sign===I&&(Math.sign=function(n){return 0>n?-1:n>0?1:+n});var qo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Nk={encode:function(A,t){var i,P,z,S,C,O,L,v="",Y=0;for(A=Nk._utf8_encode(A);Y<A.length;)i=A.charCodeAt(Y++),P=A.charCodeAt(Y++),z=A.charCodeAt(Y++),S=i>>2,C=(3&i)<<4|P>>4,O=(15&P)<<2|z>>6,L=63&z,isNaN(P)?O=L=64:isNaN(z)&&(L=64),v=v+t.charAt(S)+t.charAt(C)+t.charAt(O)+t.charAt(L);return v},decode:function(w,t){var W,f,y,d,R,I,U,r="",q=0;for(w=w.replace(/[^A-Za-z0-9\+\/\=]/g,"");q<w.length;)d=t.indexOf(w.charAt(q++)),R=t.indexOf(w.charAt(q++)),I=t.indexOf(w.charAt(q++)),U=t.indexOf(w.charAt(q++)),W=d<<2|R>>4,f=(15&R)<<4|I>>2,y=(3&I)<<6|U,r+=String.fromCharCode(W),64!=I&&(r+=String.fromCharCode(f)),64!=U&&(r+=String.fromCharCode(y));return r=Nk._utf8_decode(r)},_utf8_encode:function($){$=$.replace(/\r\n/g,"\n");for(var Y="",C=0;C<$.length;C++){var M=$.charCodeAt(C);128>M?Y+=String.fromCharCode(M):M>127&&2048>M?(Y+=String.fromCharCode(192|M>>6),Y+=String.fromCharCode(128|63&M)):(Y+=String.fromCharCode(224|M>>12),Y+=String.fromCharCode(128|63&M>>6),Y+=String.fromCharCode(128|63&M))}return Y},_utf8_decode:function(t){for(var F="",g=0,I=0,y=0,W=0;g<t.length;)I=t.charCodeAt(g),128>I?(F+=String.fromCharCode(I),g++):I>191&&224>I?(y=t.charCodeAt(g+1),F+=String.fromCharCode((31&I)<<6|63&y),g+=2):(y=t.charCodeAt(g+1),W=t.charCodeAt(g+2),F+=String.fromCharCode((15&I)<<12|(63&y)<<6|63&W),g+=3);return F}};u.Math={generateUUID:function(){for(var a=[],B=0;256>B;B++)a[B]=(16>B?"0":"")+B.toString(16).toUpperCase();return function(){var X=0|4294967295*Math.random(),q=0|4294967295*Math.random(),I=0|4294967295*Math.random(),L=0|4294967295*Math.random();return a[255&X]+a[255&X>>8]+a[255&X>>16]+a[255&X>>24]+"-"+a[255&q]+a[255&q>>8]+"-"+a[64|15&q>>16]+a[255&q>>24]+"-"+a[128|63&I]+a[255&I>>8]+"-"+a[255&I>>16]+a[255&I>>24]+a[255&L]+a[255&L>>8]+a[255&L>>16]+a[255&L>>24]}}(),clamp:function(B,f,d){return Math.max(f,Math.min(d,B))},generateIncreasingID:function(){var e=0;return function(){return++e}}(),encodeBase64:function(k,e){return Nk.encode(k,e||qo)},decodeBase64:function(R,C){return Nk.decode(R,C||qo)},randomArray:function(H,B){B=B||H.length;for(var N=B-1;N>0;N--){var d=Math.floor(Math.random()*(N+1)),b=H[N];H[N]=H[d],H[d]=b}return H}};var aq=u.Matrix=u.Math.Matrix2d=function(R,d,L,C,m){this.setFromTransform(R,d,L,C,m)},vl=aq;aq.prototype={},aq.prototype.constructor=aq,aq.prototype.set=function(z,o,m,F,L,h){return this.a=z,this.b=o,this.c=m,this.d=F,this.tx=L,this.ty=h,this},aq.prototype.setFromTransform=function(C,f,r,k,P){var s=this;if(C===I)return s.a=1,s.b=0,s.c=0,s.d=1,s.tx=0,s.ty=0,void 0;C=C||0;var l=q(C),i=n(C);return k=k||1,P=P||1,s.a=i*k,s.b=l*k,s.c=-l*P,s.d=i*P,s.tx=f||0,s.ty=r||0,s},aq.prototype.apply=function(B,d){d=d||new ps;var H=B.x,f=B.y;return d.x=this.a*H+this.c*f+this.tx,d.y=this.b*H+this.d*f+this.ty,d},aq.prototype.applyInverse=function(t,G){G=G||new ps;var p=1/(this.a*this.d+this.c*-this.b),v=t.x,j=t.y;return G.x=this.d*p*v+-this.c*p*j+(this.ty*this.c-this.tx*this.d)*p,G.y=this.a*p*j+-this.b*p*v+(-this.ty*this.a+this.tx*this.b)*p,G},aq.prototype.translate=function(J,$){return this.tx+=J,this.ty+=$,this},aq.prototype.scale=function(C,N){return this.a*=C,this.d*=N,this.c*=C,this.b*=N,this.tx*=C,this.ty*=N,this},aq.prototype.rotate=function(R){var F=Math.cos(R),Y=Math.sin(R),g=this.a,W=this.c,B=this.tx;return this.a=g*F-this.b*Y,this.b=g*Y+this.b*F,this.c=W*F-this.d*Y,this.d=W*Y+this.d*F,this.tx=B*F-this.ty*Y,this.ty=B*Y+this.ty*F,this},aq.prototype.appendTranslate=function(g,f){return this.tx+=this.a*g+this.c*f,this.ty+=this.b*g+this.d*f,this},aq.prototype.appendScale=function(x,s){return this.a*=x,this.d*=s,this.c*=s,this.b*=x,this},aq.prototype.appendRotate=function(i){if(!i)return this;
var z=Math.cos(i),k=Math.sin(i),e=this.a,f=this.b;return this.a=e*z+this.c*k,this.b=f*z+this.d*k,this.c=-e*k+this.c*z,this.d=-f*k+this.d*z,this},aq.prototype.append=function(e){var h=this.a,f=this.b,c=this.c,H=this.d;return this.a=e.a*h+e.b*c,this.b=e.a*f+e.b*H,this.c=e.c*h+e.d*c,this.d=e.c*f+e.d*H,this.tx=e.tx*h+e.ty*c+this.tx,this.ty=e.tx*f+e.ty*H+this.ty,this},aq.prototype.setTransform=function(Y,m,P,A,H,i,d,t,w){var F,f,g,I,u,s,K,T,j,q;return u=Math.sin(d),s=Math.cos(d),K=Math.cos(w),T=Math.sin(w),j=-Math.sin(t),q=Math.cos(t),F=s*H,f=u*H,g=-u*i,I=s*i,this.a=K*F+T*g,this.b=K*f+T*I,this.c=j*F+q*g,this.d=j*f+q*I,this.tx=Y+(P*F+A*g),this.ty=m+(P*f+A*I),this},aq.prototype.prepend=function(o){var u=this.tx;if(1!==o.a||0!==o.b||0!==o.c||1!==o.d){var M=this.a,F=this.c;this.a=M*o.a+this.b*o.c,this.b=M*o.b+this.b*o.d,this.c=F*o.a+this.d*o.c,this.d=F*o.b+this.d*o.d}return this.tx=u*o.a+this.ty*o.c+o.tx,this.ty=u*o.b+this.ty*o.d+o.ty,this},aq.prototype.transform=aq.prototype.prepend,aq.prototype.invert=function(){var s=this.a,p=this.b,i=this.c,b=this.d,q=this.tx,C=s*b-p*i;return this.a=b/C,this.b=-p/C,this.c=-i/C,this.d=s/C,this.tx=(i*this.ty-b*q)/C,this.ty=-(s*this.ty-p*q)/C,this},aq.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},aq.prototype.clone=function(){var f=new aq;return f.a=this.a,f.b=this.b,f.c=this.c,f.d=this.d,f.tx=this.tx,f.ty=this.ty,f},aq.prototype.copy=function(T){return T.a=this.a,T.b=this.b,T.c=this.c,T.d=this.d,T.tx=this.tx,T.ty=this.ty,T},aq.prototype.tf=function(q,M){1===arguments.length&&(M=q.y,q=q.x);var Y=this;return{x:Y.a*q+Y.c*M+Y.tx,y:Y.b*q+Y.d*M+Y.ty}},aq.prototype.tfi=function(h,J){1===arguments.length&&(J=h.y,h=h.x);var F=this,z=1/(F.a*F.d+F.c*-F.b);return{x:F.d*z*h+-F.c*z*J+(F.ty*F.c-F.tx*F.d)*z,y:F.a*z*J+-F.b*z*h+(-F.ty*F.a+F.tx*F.b)*z}},aq.IDENTITY=new aq,aq.TEMP_MATRIX=new aq;var So=u.Math.Quaternion=function(z,_,r,X){this.set(z,_,r,X)};J.assign(So.prototype,{set:function(r,i,t,L){var Y=this;return Y._x=r||0,Y._y=i||0,Y._z=t||0,Y._w=L!==I?L:1,Y},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(X){var B=this;return B._x=X._x,B._y=X._y,B._z=X._z,B._w=X._w,B},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var G=this.length();return 0===G?(this._x=0,this._y=0,this._z=0,this._w=1):(G=1/G,this._x=this._x*G,this._y=this._y*G,this._z=this._z*G,this._w=this._w*G),this},fromArray:function(s,E){E===I&&(E=0);var V=this;return V._x=s[E],V._y=s[E+1],V._z=s[E+2],V._w=s[E+3],this},slerp:function(S,O){if(0===O)return this;if(1===O)return this.copy(S);var W=this._x,I=this._y,K=this._z,R=this._w,o=R*S._w+W*S._x+I*S._y+K*S._z;if(0>o?(this._w=-S._w,this._x=-S._x,this._y=-S._y,this._z=-S._z,o=-o):this.copy(S),o>=1)return this._w=R,this._x=W,this._y=I,this._z=K,this;var $=Math.sqrt(1-o*o);if(Math.abs($)<.001)return this._w=.5*(R+this._w),this._x=.5*(W+this._x),this._y=.5*(I+this._y),this._z=.5*(K+this._z),this;var D=Math.atan2($,o),f=Math.sin((1-O)*D)/$,i=Math.sin(O*D)/$;return this._w=R*f+this._w*i,this._x=W*f+this._x*i,this._y=I*f+this._y*i,this._z=K*f+this._z*i,this},setFromAxisAngle:function(j,N){var Q=N/2,c=Math.sin(Q);return this._x=j.x*c,this._y=j.y*c,this._z=j.z*c,this._w=Math.cos(Q),this},setFromEuler:function(w){var T=w._x,I=w._y,b=w._z,Y=w._order,Q=Math.cos,y=Math.sin,$=Q(T/2),A=Q(I/2),j=Q(b/2),n=y(T/2),D=y(I/2),F=y(b/2);return"XYZ"===Y?(this._x=n*A*j+$*D*F,this._y=$*D*j-n*A*F,this._z=$*A*F+n*D*j,this._w=$*A*j-n*D*F):"YXZ"===Y?(this._x=n*A*j+$*D*F,this._y=$*D*j-n*A*F,this._z=$*A*F-n*D*j,this._w=$*A*j+n*D*F):"ZXY"===Y?(this._x=n*A*j-$*D*F,this._y=$*D*j+n*A*F,this._z=$*A*F+n*D*j,this._w=$*A*j-n*D*F):"ZYX"===Y?(this._x=n*A*j-$*D*F,this._y=$*D*j+n*A*F,this._z=$*A*F-n*D*j,this._w=$*A*j+n*D*F):"YZX"===Y?(this._x=n*A*j+$*D*F,this._y=$*D*j+n*A*F,this._z=$*A*F-n*D*j,this._w=$*A*j-n*D*F):"XZY"===Y&&(this._x=n*A*j-$*D*F,this._y=$*D*j-n*A*F,this._z=$*A*F+n*D*j,this._w=$*A*j+n*D*F),this},setFromRotationMatrix:function(s){var E,z=s.el,A=z[0],m=z[4],k=z[8],D=z[1],V=z[5],Q=z[9],j=z[2],v=z[6],K=z[10],n=A+V+K;return n>0?(E=.5/Math.sqrt(n+1),this._w=.25/E,this._x=(v-Q)*E,this._y=(k-j)*E,this._z=(D-m)*E):A>V&&A>K?(E=2*Math.sqrt(1+A-V-K),this._w=(v-Q)/E,this._x=.25*E,this._y=(m+D)/E,this._z=(k+j)/E):V>K?(E=2*Math.sqrt(1+V-A-K),this._w=(k-j)/E,this._x=(m+D)/E,this._y=.25*E,this._z=(Q+v)/E):(E=2*Math.sqrt(1+K-A-V),this._w=(D-m)/E,this._x=(k+j)/E,this._y=(Q+v)/E,this._z=.25*E),this},setFromToVectors:function(){var G,w;return function(f,d){return G===I&&(G=new pe),w=f.dot(d)+1,1e-7>w?(w=0,Math.abs(f.x)>Math.abs(f.z)?G.set(-f.y,f.x,0):G.set(0,-f.z,f.y)):G.crossVectors(f,d),this._x=G.x,this._y=G.y,this._z=G.z,this._w=w,this.normalize()}}(),setFromUnitVectors:function(){var X,c,T=1e-6;return function(M,i){return X===I&&(X=new pe),c=M.dot(i)+1,T>c?(c=0,Math.abs(M.x)>Math.abs(M.z)?X.set(-M.y,M.x,0):X.set(0,-M.z,M.y)):X.crossVectors(M,i),this._x=X.x,this._y=X.y,this._z=X.z,this._w=c,this.normalize()}}(),multiply:function(U){return this.multiplyQuaternions(this,U)},premultiply:function(I){return this.multiplyQuaternions(I,this)},multiplyQuaternions:function(A,r){var o=A._x,E=A._y,M=A._z,O=A._w,I=r._x,F=r._y,h=r._z,R=r._w;return this._x=o*R+O*I+E*h-M*F,this._y=E*R+O*F+M*I-o*h,this._z=M*R+O*h+o*F-E*I,this._w=O*R-o*I-E*F-M*h,this}});var Ni=u.Math.Vector4=function(r,M,q,y){this.x=r||0,this.y=M||0,this.z=q||0,this.w=y!==I?y:1};J.assign(Ni.prototype,{isVector4:!0,set:function(I,G,p,n){return this.x=I,this.y=G,this.z=p,this.w=n,this},setScalar:function(q){return this.x=q,this.y=q,this.z=q,this.w=q,this},setX:function(d){return this.x=d,this},setY:function(n){return this.y=n,this},setZ:function(I){return this.z=I,this},setW:function(A){return this.w=A,this},setComponent:function(q,u){switch(q){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;case 3:this.w=u;break;default:throw new Error("index is out of range: "+q)}return this},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+b)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(Y){return this.x=Y.x,this.y=Y.y,this.z=Y.z,this.w=Y.w!==I?Y.w:1,this},add:function(T,G){return G!==I?this.addVectors(T,G):(this.x+=T.x,this.y+=T.y,this.z+=T.z,this.w+=T.w,this)},addScalar:function(g){return this.x+=g,this.y+=g,this.z+=g,this.w+=g,this},addVectors:function(p,e){return this.x=p.x+e.x,this.y=p.y+e.y,this.z=p.z+e.z,this.w=p.w+e.w,this},addScaledVector:function(o,L){return this.x+=o.x*L,this.y+=o.y*L,this.z+=o.z*L,this.w+=o.w*L,this},sub:function(H,C){return C!==I?this.subVectors(H,C):(this.x-=H.x,this.y-=H.y,this.z-=H.z,this.w-=H.w,this)},subScalar:function(D){return this.x-=D,this.y-=D,this.z-=D,this.w-=D,this},subVectors:function(T,F){return this.x=T.x-F.x,this.y=T.y-F.y,this.z=T.z-F.z,this.w=T.w-F.w,this},multiplyScalar:function(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this},applyMatrix4:function(b){var U=this.x,J=this.y,y=this.z,r=this.w,w=b.el;return this.x=w[0]*U+w[4]*J+w[8]*y+w[12]*r,this.y=w[1]*U+w[5]*J+w[9]*y+w[13]*r,this.z=w[2]*U+w[6]*J+w[10]*y+w[14]*r,this.w=w[3]*U+w[7]*J+w[11]*y+w[15]*r,this},divideScalar:function(D){return this.multiplyScalar(1/D)},setAxisAngleFromQuaternion:function(T){this.w=2*Math.acos(T.w);var Z=Math.sqrt(1-T.w*T.w);return 1e-4>Z?(this.x=1,this.y=0,this.z=0):(this.x=T.x/Z,this.y=T.y/Z,this.z=T.z/Z),this},setAxisAngleFromRotationMatrix:function(B){var v,X,D,h,I=.01,Q=.1,n=B.el,R=n[0],J=n[4],K=n[8],m=n[1],e=n[5],U=n[9],u=n[2],A=n[6],s=n[10];if(Math.abs(J-m)<I&&Math.abs(K-u)<I&&Math.abs(U-A)<I){if(Math.abs(J+m)<Q&&Math.abs(K+u)<Q&&Math.abs(U+A)<Q&&Math.abs(R+e+s-3)<Q)return this.set(1,0,0,0),this;v=Math.PI;var Z=(R+1)/2,r=(e+1)/2,q=(s+1)/2,g=(J+m)/4,l=(K+u)/4,V=(U+A)/4;return Z>r&&Z>q?I>Z?(X=0,D=.707106781,h=.707106781):(X=Math.sqrt(Z),D=g/X,h=l/X):r>q?I>r?(X=.707106781,D=0,h=.707106781):(D=Math.sqrt(r),X=g/D,h=V/D):I>q?(X=.707106781,D=.707106781,h=0):(h=Math.sqrt(q),X=l/h,D=V/h),this.set(X,D,h,v),this}var j=Math.sqrt((A-U)*(A-U)+(K-u)*(K-u)+(m-J)*(m-J));return Math.abs(j)<.001&&(j=1),this.x=(A-U)/j,this.y=(K-u)/j,this.z=(m-J)/j,this.w=Math.acos((R+e+s-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(F){return this.x=Math.max(this.x,F.x),this.y=Math.max(this.y,F.y),this.z=Math.max(this.z,F.z),this.w=Math.max(this.w,F.w),this},clamp:function(V,J){return this.x=Math.max(V.x,Math.min(J.x,this.x)),this.y=Math.max(V.y,Math.min(J.y,this.y)),this.z=Math.max(V.z,Math.min(J.z,this.z)),this.w=Math.max(V.w,Math.min(J.w,this.w)),this},clampScalar:function(){var q,_;return function(f,U){return q===I&&(q=new Ni,_=new Ni),q.set(f,f,f,f),_.set(U,U,U,U),this.clamp(q,_)}}(),clampLength:function(k,C){var Z=this.length();return this.divideScalar(Z||1).multiplyScalar(Math.max(k,Math.min(C,Z)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(n){return this.x*n.x+this.y*n.y+this.z*n.z+this.w*n.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(O){return this.normalize().multiplyScalar(O)},lerp:function(Y,p){return this.x+=(Y.x-this.x)*p,this.y+=(Y.y-this.y)*p,this.z+=(Y.z-this.z)*p,this.w+=(Y.w-this.w)*p,this},lerpVectors:function(w,P,T){return this.subVectors(P,w).multiplyScalar(T).add(w)},equals:function(Y){return Y.x===this.x&&Y.y===this.y&&Y.z===this.z&&Y.w===this.w},fromArray:function(z,v){return v===I&&(v=0),this.x=z[v],this.y=z[v+1],this.z=z[v+2],this.w=z[v+3],this},toArray:function(b,J){return b===I&&(b=[]),J===I&&(J=0),b[J]=this.x,b[J+1]=this.y,b[J+2]=this.z,b[J+3]=this.w,b},fromBufferAttribute:function(I,R){return this.x=I.getX(R),this.y=I.getY(R),this.z=I.getZ(R),this.w=I.getW(R),this}});var pe=u.Math.Vector3=function(_,u,z){0===arguments.length?(this.x=0,this.y=0,this.z=0):"object"==typeof _?this.copy(_):this.set(_,u==I?_:u,z==I?_:z)};J.assign(pe.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(s,H,T){return this.x=s,this.y=H,this.z=T,this},equals:function(O){return O&&this.x===O.x&&this.y===O.y&&this.z===O.z},setScalar:function(N){return this.x=N,this.y=N,this.z=N,this},setX:function(s){return this.x=s,this},setY:function(G){return this.y=G,this},setZ:function(W){return this.z=W,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(B){return B.x===I?(this.x=B[0],this.y=B[1],this.z=B[2]):(this.x=B.x,this.y=B.y,this.z=B.z),this},add:function(r){return this.x+=r.x,this.y+=r.y,this.z+=r.z,this},addScalar:function(b){return this.x+=b,this.y+=b,this.z+=b,this},addVectors:function(z,f){return this.x=z.x+f.x,this.y=z.y+f.y,this.z=z.z+f.z,this},addScaledVector:function(C,J){return this.x+=C.x*J,this.y+=C.y*J,this.z+=C.z*J,this},sub:function(H){return this.x-=H.x,this.y-=H.y,this.z-=H.z,this},subScalar:function(J){return this.x-=J,this.y-=J,this.z-=J,this},subVectors:function(q,_){return this.x=q.x-_.x,this.y=q.y-_.y,this.z=q.z-_.z,this},divide:function(I){return this.x/=I.x,this.y/=I.y,this.z/=I.z,this},multiply:function(k){return this.x*=k.x,this.y*=k.y,this.z*=k.z,this},multiplyScalar:function(p){return this.x*=p,this.y*=p,this.z*=p,this},distanceTo:function(M){return Math.sqrt(this.distanceToSquared(M))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,u=this.z-t.z;return e*e+n*n+u*u},distanceToSquared2:function(p){var r=this.x-p[0],E=this.y-p[1],i=this.z-p[2];return r*r+E*E+i*i},divideVectors:function(m,h){return this.x=m.x/h.x,this.y=m.y/h.y,this.z=m.z/h.z,this},multiplyVectors:function(U,K){return this.x=U.x*K.x,this.y=U.y*K.y,this.z=U.z*K.z,this},transformDirection:function(q){var j=this.x,T=this.y,A=this.z,o=q.el;return this.x=o[0]*j+o[4]*T+o[8]*A,this.y=o[1]*j+o[5]*T+o[9]*A,this.z=o[2]*j+o[6]*T+o[10]*A,this.normalize()},applyAxisAngle:function(){var I=new So;return function(h,M){return this.applyQuaternion(I.setFromAxisAngle(h,M))}}(),applyEuler:function(){var o=new So;return function(f){return this.applyQuaternion(o.setFromEuler(f))}}(),applyQuaternion:function(R){var y=this.x,P=this.y,I=this.z,v=R._x,n=R._y,s=R._z,m=R._w,A=m*y+n*I-s*P,f=m*P+s*y-v*I,N=m*I+v*P-n*y,k=-v*y-n*P-s*I;return this.x=A*m+k*-v+f*-s-N*-n,this.y=f*m+k*-n+N*-v-A*-s,this.z=N*m+k*-s+A*-n-f*-v,this},applyMatrix4:function(q){var L=this.x,v=this.y,j=this.z,Q=q.el,X=1/(Q[3]*L+Q[7]*v+Q[11]*j+Q[15]);return this.x=(Q[0]*L+Q[4]*v+Q[8]*j+Q[12])*X,this.y=(Q[1]*L+Q[5]*v+Q[9]*j+Q[13])*X,this.z=(Q[2]*L+Q[6]*v+Q[10]*j+Q[14])*X,this},applyMatrix3:function(T){var W=this.x,P=this.y,p=this.z,j=T.el;return this.x=j[0]*W+j[3]*P+j[6]*p,this.y=j[1]*W+j[4]*P+j[7]*p,this.z=j[2]*W+j[5]*P+j[8]*p,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var b=new pe;return function(I){return this.sub(b.copy(I).multiplyScalar(2*this.dot(I)))}}(),dot:function(y){return this.x*y.x+this.y*y.y+this.z*y.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var s=this.length();return s?this.multiplyScalar(1/s):this},setLength:function(N){return this.normalize().multiplyScalar(N)},fromArray:function(E,f){return f===I&&(f=0),this.x=E[f],this.y=E[f+1],this.z=E[f+2],this},toArray:function(b,O){return b===I&&(b=[0,0,0]),O===I&&(O=0),b[O]=this.x,b[O+1]=this.y,b[O+2]=this.z,b},cross:function(a){return this.crossVectors(this,a)},angleTo:function(Z){var d=this.dot(Z)/Math.sqrt(this.lengthSq()*Z.lengthSq());return d>1||-1>d?0:Math.acos(d)},lerp:function(X,l){return this.x+=(X.x-this.x)*l,this.y+=(X.y-this.y)*l,this.z+=(X.z-this.z)*l,this},lerpVectors:function(C,I,u){return this.subVectors(I,C).multiplyScalar(u).add(C)},crossVectors:function(p,o){var Z=p.x,q=p.y,d=p.z,h=o.x,c=o.y,J=o.z;return this.x=q*J-d*c,this.y=d*h-Z*J,this.z=Z*c-q*h,this},min:function(B){return this.x=Math.min(this.x,B.x),this.y=Math.min(this.y,B.y),this.z=Math.min(this.z,B.z),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this},setFromMatrixPosition:function(H){return this.setFromMatrixColumn(H,3)},setFromMatrixScale:function(n){var I=this.setFromMatrixColumn(n,0).length(),i=this.setFromMatrixColumn(n,1).length(),m=this.setFromMatrixColumn(n,2).length();return this.x=I,this.y=i,this.z=m,this},setFromMatrixColumn:function(M,T){return this.fromArray(M.el,4*T)}});var ps=u.Math.Vector2=function(B,K,Z){"object"==typeof B&&(B.x!=I?(K=B.y,B=B.x,Z=B.e):(Z=B[2],K=B[1],B=B[0])),this.set(B||0,K||0,Z)};ps.prototype={},ps.prototype.constructor=ps,J.defineProperties(ps.prototype,{width:{get:function(){return this.x},set:function(G){this.x=G}},height:{get:function(){return this.y},set:function(W){this.y=W}}}),ps.prototype.clone=function(){return new ps(this.x,this.y,this.e)},ps.prototype.copy=function(t){return this.set(t.x,t.y,t.e),this},ps.prototype.equals=function(K){return K.x===this.x&&K.y===this.y},ps.prototype.set=function(o,c,m){return this.x=o||0,this.y=c||(0!==c?this.x:0),m!=I&&(this.e=m),this},ps.prototype.setScalar=function(k){return this.x=k,this.y=k,this},ps.prototype.setX=function(P){return this.x=P||0,this},ps.prototype.setY=function(m){return this.y=m||0,this},ps.prototype.add=function(E){return this.x+=E.x,this.y+=E.y,this},ps.prototype.addVectors=function(c,I){return this.x=c.x+I.x,this.y=c.y+I.y,this},ps.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},ps.prototype.addScaledVector=function(y,J){return this.x+=y.x*J,this.y+=y.y*J,this},ps.prototype.sub=function(L){return this.x-=L.x,this.y-=L.y,this},ps.prototype.subScalar=function(K){return this.x-=K,this.y-=K,this},ps.prototype.subVectors=function(z,l){return this.x=z.x-l.x,this.y=z.y-l.y,this},ps.prototype.multiply=function(B){return this.x*=B.x,this.y*=B.y,this},ps.prototype.multiplyScalar=function(c){return this.x*=c,this.y*=c,this},ps.prototype.divide=function(A){return this.x/=A.x,this.y/=A.y,this},ps.prototype.divideScalar=function(h){return this.multiplyScalar(1/h)},ps.prototype.min=function(D){return this.x=Math.min(this.x,D.x),this.y=Math.min(this.y,D.y),this},ps.prototype.max=function(R){return this.x=Math.max(this.x,R.x),this.y=Math.max(this.y,R.y),this},ps.prototype.fromArray=function(r,g){return g===I&&(g=0),this.x=r[g],this.y=r[g+1],this},ps.prototype.clamp=function(Z,J){return this.x=Math.max(Z.x,Math.min(J.x,this.x)),this.y=Math.max(Z.y,Math.min(J.y,this.y)),this},ps.prototype.clampScalar=function(){var A,d;return function(z,Y){return A===I&&(A=new ps,d=new ps),A.set(z,z),d.set(Y,Y),this.clamp(A,d)}}(),ps.prototype.clampLength=function(a,n){var o=this.length();return this.multiplyScalar(Math.max(a,Math.min(n,o))/o)},ps.prototype.dot=function(R){return this.x*R.x+this.y*R.y},ps.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},ps.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},ps.prototype.normalize=function(){return this.divideScalar(this.length())},ps.prototype.angle=function(){var w=Math.atan2(this.y,this.x);return 0>w&&(w+=2*Math.PI),w},ps.prototype.distanceTo=function(w){return Math.sqrt(this.distanceToSquared(w))},ps.prototype.distanceToSquared=function(f){var Y=this.x-f.x,B=this.y-f.y;return Y*Y+B*B},ps.prototype.isNearEnough=function(j){return this.distanceToSquared(j)<1e-8},ps.prototype.setLength=function(v){var S=this.length();return S?this.multiplyScalar(v/S):this},ps.prototype.lerp=function(F,X){return this.x+=(F.x-this.x)*X,this.y+=(F.y-this.y)*X,this},ps.prototype.lerpVectors=function(M,C,N){return this.subVectors(C,M).multiplyScalar(N).add(M)},ps.prototype.rotateAround=function(x,p){var y=x?x.x:0,g=x?x.y:0,c=Math.cos(p),I=Math.sin(p),O=this.x-y,Y=this.y-g;return this.x=O*c-Y*I+y,this.y=O*I+Y*c+g,this},J.assign(t.prototype,{isMatrix3:!0,set:function(W,Q,h,K,j,y,o,C,Z){var L=this.el;return L[0]=W,L[1]=K,L[2]=o,L[3]=Q,L[4]=j,L[5]=C,L[6]=h,L[7]=y,L[8]=Z,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(U){var d=this.el,u=U.el;return d[0]=u[0],d[1]=u[1],d[2]=u[2],d[3]=u[3],d[4]=u[4],d[5]=u[5],d[6]=u[6],d[7]=u[7],d[8]=u[8],this},setFromMatrix4:function(l){var h=l.el;return this.set(h[0],h[4],h[8],h[1],h[5],h[9],h[2],h[6],h[10]),this},applyToBufferAttribute:function(){var O=new pe;return function(X){for(var h=0,L=X.count;L>h;h++)O.x=X.getX(h),O.y=X.getY(h),O.z=X.getZ(h),O.applyMatrix3(this),X.setXYZ(h,O.x,O.y,O.z);return X}}(),multiply:function(X){return this.multiplyMatrices(this,X)},premultiply:function(S){return this.multiplyMatrices(S,this)},multiplyMatrices:function(v,g){var F=v.el,T=g.el,K=this.el,l=F[0],S=F[3],E=F[6],h=F[1],d=F[4],_=F[7],O=F[2],H=F[5],V=F[8],n=T[0],U=T[3],C=T[6],t=T[1],Q=T[4],P=T[7],A=T[2],p=T[5],m=T[8];return K[0]=l*n+S*t+E*A,K[3]=l*U+S*Q+E*p,K[6]=l*C+S*P+E*m,K[1]=h*n+d*t+_*A,K[4]=h*U+d*Q+_*p,K[7]=h*C+d*P+_*m,K[2]=O*n+H*t+V*A,K[5]=O*U+H*Q+V*p,K[8]=O*C+H*P+V*m,this},multiplyScalar:function(X){var K=this.el;return K[0]*=X,K[3]*=X,K[6]*=X,K[1]*=X,K[4]*=X,K[7]*=X,K[2]*=X,K[5]*=X,K[8]*=X,this},determinant:function(){var g=this.el,K=g[0],c=g[1],V=g[2],a=g[3],H=g[4],Y=g[5],J=g[6],p=g[7],h=g[8];return K*H*h-K*Y*p-c*a*h+c*Y*J+V*a*p-V*H*J},getInverse:function(Y){var I=Y.el,L=this.el,T=I[0],C=I[1],u=I[2],G=I[3],w=I[4],f=I[5],j=I[6],D=I[7],_=I[8],n=_*w-f*D,M=f*j-_*G,b=D*G-w*j,S=T*n+C*M+u*b;if(0===S)return this.identity();var d=1/S;return L[0]=n*d,L[1]=(u*D-_*C)*d,L[2]=(f*C-u*w)*d,L[3]=M*d,L[4]=(_*T-u*j)*d,L[5]=(u*G-f*T)*d,L[6]=b*d,L[7]=(C*j-D*T)*d,L[8]=(w*T-C*G)*d,this},transpose:function(){var W,G=this.el;return W=G[1],G[1]=G[3],G[3]=W,W=G[2],G[2]=G[6],G[6]=W,W=G[5],G[5]=G[7],G[7]=W,this},getNormalMatrix:function(b){return this.setFromMatrix4(b).getInverse(this).transpose()},transposeIntoArray:function(K){var u=this.el;return K[0]=u[0],K[1]=u[3],K[2]=u[6],K[3]=u[1],K[4]=u[4],K[5]=u[7],K[6]=u[2],K[7]=u[5],K[8]=u[8],this},setUvTransform:function(F,l,d,n,z,B,P){var r=Math.cos(z),h=Math.sin(z);this.set(d*r,d*h,-d*(r*B+h*P)+B+F,-n*h,n*r,-n*(-h*B+r*P)+P+l,0,0,1)},scale:function(M,R){var h=this.el;return h[0]*=M,h[3]*=M,h[6]*=M,h[1]*=R,h[4]*=R,h[7]*=R,this},rotate:function(h){var o=Math.cos(h),C=Math.sin(h),i=this.el,O=i[0],L=i[3],M=i[6],T=i[1],e=i[4],x=i[7];return i[0]=o*O+C*T,i[3]=o*L+C*e,i[6]=o*M+C*x,i[1]=-C*O+o*T,i[4]=-C*L+o*e,i[7]=-C*M+o*x,this},translate:function(V,$){var B=this.el;return B[0]+=V*B[2],B[3]+=V*B[5],B[6]+=V*B[8],B[1]+=$*B[2],B[4]+=$*B[5],B[7]+=$*B[8],this},equals:function(w){for(var $=this.el,_=w.el,g=0;9>g;g++)if($[g]!==_[g])return!1;return!0},fromArray:function(j,N){N===I&&(N=0);for(var b=0;9>b;b++)this.el[b]=j[b+N];return this},toArray:function(Z,i){Z===I&&(Z=[]),i===I&&(i=0);var B=this.el;return Z[i]=B[0],Z[i+1]=B[1],Z[i+2]=B[2],Z[i+3]=B[3],Z[i+4]=B[4],Z[i+5]=B[5],Z[i+6]=B[6],Z[i+7]=B[7],Z[i+8]=B[8],Z}});var Um=u.Math.Plane=function(P,E){this.normal=P!==I?P:new pe(1,0,0),this.constant=E!==I?E:0};J.assign(Um.prototype,{set:function(S,E){return this.normal.copy(S),this.constant=E,this},setComponents:function(x,p,b,u){return this.normal.set(x,p,b),this.constant=u,this},setFromNormalAndCoplanarPoint:function(h,F){return this.normal.copy(h),this.constant=-F.dot(this.normal),this},setFromCoplanarPoints:function(){var r=new pe,v=new pe;return function(t,G,i){var Q=r.subVectors(i,G).cross(v.subVectors(t,G)).normalize();return this.setFromNormalAndCoplanarPoint(Q,t),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(O){return this.normal.copy(O.normal),this.constant=O.constant,this},normalize:function(){var N=1/this.normal.length();return this.normal.multiplyScalar(N),this.constant*=N,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(h){return this.distanceToPoint(h.center)-h.radius},projectPoint:function(B,R){return R===I&&(R=new pe),R.copy(this.normal).multiplyScalar(-this.distanceToPoint(B)).add(B)},intersectLine:function(){var h=new pe;return function(n,H){H===I&&(H=new pe);var z=n.delta(h),Y=this.normal.dot(z);if(0===Y)return 0===this.distanceToPoint(n.start)?H.copy(n.start):I;var s=-(n.start.dot(this.normal)+this.constant)/Y;return 0>s||s>1?I:H.copy(z).multiplyScalar(s).add(n.start)}}(),intersectsLine:function(F){var K=this.distanceToPoint(F.start),m=this.distanceToPoint(F.end);return 0>K&&m>0||0>m&&K>0},intersectsBox:function(B){return B.intersectsPlane(this)},intersectsSphere:function(n){return n.intersectsPlane(this)},coplanarPoint:function(l){return l===I&&(l=new pe),l.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var B=new pe,n=new t;return function(o,c){var k=c||n.getNormalMatrix(o),e=this.coplanarPoint(B).applyMatrix4(o),m=this.normal.applyMatrix3(k).normalize();return this.constant=-e.dot(m),this}}(),translate:function(z){return this.constant-=z.dot(this.normal),this},equals:function(U){return U.normal.equals(this.normal)&&U.constant===this.constant}});var Ck=u.Math.Ray=function(O,z){this.origin=O!==I?O.clone():new pe,this.direction=z!==I?z.clone():new pe};J.assign(Ck.prototype,{set:function(e,w){return this.origin.copy(e),this.direction.copy(w),this},clone:function(){return(new this.constructor).copy(this)},copy:function(D){return this.origin.copy(D.origin),this.direction.copy(D.direction),this.maxHitLen=D.maxHitLen,this},at:function(Q,r){var n=r||new pe;return n.copy(this.direction).multiplyScalar(Q).add(this.origin)},setMaxHitLength:function(K){this.maxHitLen=K},lookAt:function(v){return this.direction.copy(v).sub(this.origin).normalize(),this},applyMatrix4:function(T){var B=this.maxHitLen;if(B){var $=this.direction.clone().multiplyScalar(B).add(this.origin);$.applyMatrix4(T)}return this.origin.applyMatrix4(T),this.direction.transformDirection(T),B&&(this.maxHitLen=this.origin.distanceTo($)),this},intersectSphere:function(){var n=new pe;return function(Q,C){n.subVectors(Q.center,this.origin);var L=n.dot(this.direction),p=n.dot(n)-L*L,i=Q.radius*Q.radius;if(p>i)return null;var o=Math.sqrt(i-p),r=L-o,R=L+o;return 0>r&&0>R?null:0>r?this.at(R,C):this.at(r,C)}}(),intersectEllipsoid:function(){var x=new pe,W=new pe;return function(T,o){x.subVectors(T.center,this.origin),x.divide(T.radius),W.divideVectors(this.direction,T.radius);var S=W.lengthSq(),R=x.dot(W),N=x.dot(x)*S-R*R;if(N>S)return null;var I=Math.sqrt(S-N),f=(R-I)/S,D=(R+I)/S;return 0>f&&0>D?null:0>f?this.at(D,o):this.at(f,o)}}(),intersectBox:function(B,v){var f,F,g,R,J,M,G=1/this.direction.x,m=1/this.direction.y,S=1/this.direction.z,W=this.origin;if(G>=0?(f=(B.min.x-W.x)*G,F=(B.max.x-W.x)*G):(f=(B.max.x-W.x)*G,F=(B.min.x-W.x)*G),m>=0?(g=(B.min.y-W.y)*m,R=(B.max.y-W.y)*m):(g=(B.max.y-W.y)*m,R=(B.min.y-W.y)*m),f>R||g>F)return null;if((g>f||f!==f)&&(f=g),(F>R||F!==F)&&(F=R),S>=0?(J=(B.min.z-W.z)*S,M=(B.max.z-W.z)*S):(J=(B.max.z-W.z)*S,M=(B.min.z-W.z)*S),f>M||J>F)return null;if((J>f||f!==f)&&(f=J),(F>M||F!==F)&&(F=M),0>F)return null;var s=f>=0?f:F,h=this.maxHitLen;return h&&s>h?null:this.at(s,v)},intersectTriangle:function(){var A=new pe,B=new pe,e=new pe,R=new pe;return function(_,v,j,D,Z){B.subVectors(v,_),e.subVectors(j,_),R.crossVectors(B,e);var c,S=this.direction.dot(R);if(S>0){if(D)return null;c=1}else{if(!(0>S))return null;c=-1,S=-S}A.subVectors(this.origin,_);var w=c*this.direction.dot(e.crossVectors(A,e));if(0>w)return null;var h=c*this.direction.dot(B.cross(A));if(0>h||w+h>S)return null;var X=-c*A.dot(R);if(0>X)return null;var t=X/S,G=this.maxHitLen;return G&&t>G?null:this.at(t,Z)}}()});var fp=u.Math.Box3=function(R,m){this.min=R!==I?R:new pe(1/0,1/0,1/0),this.max=m!==I?m:new pe(-1/0,-1/0,-1/0)};J.assign(fp.prototype,{set:function(e,l){return this.min.copy(e),this.max.copy(l),this},setFromArray:function(O){for(var H=1/0,x=1/0,$=1/0,e=-1/0,v=-1/0,i=-1/0,j=0,y=O.length;y>j;j+=3){var S=O[j],U=O[j+1],J=O[j+2];H>S&&(H=S),x>U&&(x=U),$>J&&($=J),S>e&&(e=S),U>v&&(v=U),J>i&&(i=J)}return this.min.set(H,x,$),this.max.set(e,v,i),this},setFromPoints:function(e){this.makeEmpty();for(var d=0,b=e.length;b>d;d++)this.expandByPoint(e[d]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(T){return T.max.x<this.min.x||T.min.x>this.max.x||T.max.y<this.min.y||T.min.y>this.max.y||T.max.z<this.min.z||T.min.z>this.max.z?!1:!0},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(H){return this.min.min(H),this.max.max(H),this},expandByBox:function(B){return this.min.min(B.min),this.max.max(B.max),this},applyMatrix4:function(){var f=[new pe,new pe,new pe,new pe,new pe,new pe,new pe,new pe];return function(e){return this.isEmpty()?this:(f[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),f[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),f[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),f[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),f[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),f[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),f[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),f[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(f),this)}}()});var Vq=u.Math.Sphere=function(o,$){this.center=o!==I?o:new pe,this.radius=$!==I?$:0};J.assign(Vq.prototype,{set:function(M,e){return this.center.copy(M),this.radius=e,this},setFromPoints:function(){var S=new fp;return function(D,J){var n=this.center;J!==I?n.copy(J):S.setFromPoints(D).getCenter(n);for(var v=0,Z=0,d=D.length;d>Z;Z++)v=Math.max(v,n.distanceToSquared(D[Z]));return this.radius=Math.sqrt(v),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(D){return this.center.copy(D.center),this.radius=D.radius,this},empty:function(){return this.radius<=0},containsPoint:function(x){return x.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(o){return o.distanceTo(this.center)-this.radius},intersectsSphere:function(v){var E=this.radius+v.radius;return v.center.distanceToSquared(this.center)<=E*E},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(C){return Math.abs(C.distanceToPoint(this.center))<=this.radius},clampPoint:function(K,u){var R=this.center.distanceToSquared(K);return u===I&&(u=new pe),u.copy(K),R>this.radius*this.radius&&(u.sub(this.center).normalize(),u.multiplyScalar(this.radius).add(this.center)),u},getBoundingBox:function(g){return g===I&&(g=new fp),g.set(this.center,this.center),g.expandByScalar(this.radius),g},applyMatrix4:function(U){return this.center.applyMatrix4(U),this.radius=this.radius*U.getMaxScaleOnAxis(),this},translate:function(X){return this.center.add(X),this},equals:function(k){return k.center.equals(this.center)&&k.radius===this.radius}});var Mr=u.Math.Frustum=function(k,r,G,M,L,b){this.planes=[k!==I?k:new Um,r!==I?r:new Um,G!==I?G:new Um,M!==I?M:new Um,L!==I?L:new Um,b!==I?b:new Um]};J.assign(Mr.prototype,{set:function(Q,G,T,b,x,r){var P=this.planes;return P[0].copy(Q),P[1].copy(G),P[2].copy(T),P[3].copy(b),P[4].copy(x),P[5].copy(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(f){for(var P=this.planes,S=0;6>S;S++)P[S].copy(f.planes[S]);return this},setFromMatrix:function(E){var D=this.planes,L=E.el,o=L[0],T=L[1],c=L[2],M=L[3],$=L[4],m=L[5],U=L[6],C=L[7],V=L[8],J=L[9],s=L[10],t=L[11],F=L[12],h=L[13],d=L[14],e=L[15];return D[0].setComponents(M-o,C-$,t-V,e-F).normalize(),D[1].setComponents(M+o,C+$,t+V,e+F).normalize(),D[2].setComponents(M+T,C+m,t+J,e+h).normalize(),D[3].setComponents(M-T,C-m,t-J,e-h).normalize(),D[4].setComponents(M-c,C-U,t-s,e-d).normalize(),D[5].setComponents(M+c,C+U,t+s,e+d).normalize(),this},intersectsObject:function(){var T=new Vq;return function(C){var R=C.geometry;return null===R.boundingSphere&&R.computeBoundingSphere(),T.copy(R.boundingSphere).applyMatrix4(C.matrixWorld),this.intersectsSphere(T)}}(),intersectsSprite:function(){var T=new Vq;return function(q){return T.center.set(0,0,0),T.radius=.7071067811865476,T.applyMatrix4(q.matrixWorld),this.intersectsSphere(T)}}(),intersectsSphere:function(g){for(var z=this.planes,A=g.center,N=-g.radius,a=0;6>a;a++){var j=z[a].distanceToPoint(A);if(N>j)return!1}return!0},intersectsBox:function(){var M=new pe;return function(L){for(var V=this.planes,b=0;6>b;b++){var m=V[b];if(M.x=m.normal.x>0?L.max.x:L.min.x,M.y=m.normal.y>0?L.max.y:L.min.y,M.z=m.normal.z>0?L.max.z:L.min.z,m.distanceToPoint(M)<0)return!1
}return!0}}(),containsPoint:function(m){for(var i=this.planes,u=0;6>u;u++)if(i[u].distanceToPoint(m)<0)return!1;return!0}});var Oo=u.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};J.assign(Oo.prototype,{set:function(z,U,C,l,r,m,I,L,G,T,J,p,d,s,y,B){var H=this.el;return H[0]=z,H[4]=U,H[8]=C,H[12]=l,H[1]=r,H[5]=m,H[9]=I,H[13]=L,H[2]=G,H[6]=T,H[10]=J,H[14]=p,H[3]=d,H[7]=s,H[11]=y,H[15]=B,this},clone:function(){return(new Oo).fromArray(this.el)},fromArray:function(S,x){x===I&&(x=0);for(var O=this.el,H=0;16>H;H++)O[H]=S[H+x];return this},scale:function(K){var s=this.el,H=K.x,l=K.y,g=K.z;return s[0]*=H,s[4]*=l,s[8]*=g,s[1]*=H,s[5]*=l,s[9]*=g,s[2]*=H,s[6]*=l,s[10]*=g,s[3]*=H,s[7]*=l,s[11]*=g,this},makeRotationFromEuler:function(p){var B=this.el,h=p._x,G=p._y,a=p._z,H=p._order,R=Math.cos(h),i=Math.sin(h),C=Math.cos(G),Q=Math.sin(G),c=Math.cos(a),A=Math.sin(a);if("XYZ"===H){var n=R*c,w=R*A,b=i*c,X=i*A;B[0]=C*c,B[4]=-C*A,B[8]=Q,B[1]=w+b*Q,B[5]=n-X*Q,B[9]=-i*C,B[2]=X-n*Q,B[6]=b+w*Q,B[10]=R*C}else if("YXZ"===H){var P=C*c,$=C*A,V=Q*c,y=Q*A;B[0]=P+y*i,B[4]=V*i-$,B[8]=R*Q,B[1]=R*A,B[5]=R*c,B[9]=-i,B[2]=$*i-V,B[6]=y+P*i,B[10]=R*C}else if("ZXY"===H){var P=C*c,$=C*A,V=Q*c,y=Q*A;B[0]=P-y*i,B[4]=-R*A,B[8]=V+$*i,B[1]=$+V*i,B[5]=R*c,B[9]=y-P*i,B[2]=-R*Q,B[6]=i,B[10]=R*C}else if("ZYX"===H){var n=R*c,w=R*A,b=i*c,X=i*A;B[0]=C*c,B[4]=b*Q-w,B[8]=n*Q+X,B[1]=C*A,B[5]=X*Q+n,B[9]=w*Q-b,B[2]=-Q,B[6]=i*C,B[10]=R*C}else if("YZX"===H){var D=R*C,t=R*Q,S=i*C,v=i*Q;B[0]=C*c,B[4]=v-D*A,B[8]=S*A+t,B[1]=A,B[5]=R*c,B[9]=-i*c,B[2]=-Q*c,B[6]=t*A+S,B[10]=D-v*A}else if("XZY"===H){var D=R*C,t=R*Q,S=i*C,v=i*Q;B[0]=C*c,B[4]=-A,B[8]=Q*c,B[1]=D*A+v,B[5]=R*c,B[9]=t*A-S,B[2]=S*A-t,B[6]=i*c,B[10]=v*A+D}return B[3]=0,B[7]=0,B[11]=0,B[12]=0,B[13]=0,B[14]=0,B[15]=1,this},makeRotationFromQuaternion:function(F){var R=this.el,f=F._x,H=F._y,U=F._z,L=F._w,a=f+f,C=H+H,_=U+U,o=f*a,v=f*C,r=f*_,k=H*C,y=H*_,Y=U*_,A=L*a,V=L*C,s=L*_;return R[0]=1-(k+Y),R[4]=v-s,R[8]=r+V,R[1]=v+s,R[5]=1-(o+Y),R[9]=y-A,R[2]=r-V,R[6]=y+A,R[10]=1-(o+k),R[3]=0,R[7]=0,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(E){var v=this.el,u=E.el,b=u[0],I=u[1],n=u[2],i=u[3],w=u[4],D=u[5],s=u[6],o=u[7],T=u[8],x=u[9],z=u[10],j=u[11],Z=u[12],$=u[13],X=u[14],k=u[15],l=x*X*o-$*z*o+$*s*j-D*X*j-x*s*k+D*z*k,V=Z*z*o-T*X*o-Z*s*j+w*X*j+T*s*k-w*z*k,B=T*$*o-Z*x*o+Z*D*j-w*$*j-T*D*k+w*x*k,C=Z*x*s-T*$*s-Z*D*z+w*$*z+T*D*X-w*x*X,O=b*l+I*V+n*B+i*C;if(0===O)return this.identity();var L=1/O;return v[0]=l*L,v[1]=($*z*i-x*X*i-$*n*j+I*X*j+x*n*k-I*z*k)*L,v[2]=(D*X*i-$*s*i+$*n*o-I*X*o-D*n*k+I*s*k)*L,v[3]=(x*s*i-D*z*i-x*n*o+I*z*o+D*n*j-I*s*j)*L,v[4]=V*L,v[5]=(T*X*i-Z*z*i+Z*n*j-b*X*j-T*n*k+b*z*k)*L,v[6]=(Z*s*i-w*X*i-Z*n*o+b*X*o+w*n*k-b*s*k)*L,v[7]=(w*z*i-T*s*i+T*n*o-b*z*o-w*n*j+b*s*j)*L,v[8]=B*L,v[9]=(Z*x*i-T*$*i-Z*I*j+b*$*j+T*I*k-b*x*k)*L,v[10]=(w*$*i-Z*D*i+Z*I*o-b*$*o-w*I*k+b*D*k)*L,v[11]=(T*D*i-w*x*i-T*I*o+b*x*o+w*I*j-b*D*j)*L,v[12]=C*L,v[13]=(T*$*n-Z*x*n+Z*I*z-b*$*z-T*I*X+b*x*X)*L,v[14]=(Z*D*n-w*$*n-Z*I*s+b*$*s+w*I*X-b*D*X)*L,v[15]=(w*x*n-T*D*n+T*I*s-b*x*s-w*I*z+b*D*z)*L,this},makeRotationAxis:function(i,a){var j=Math.cos(a),f=Math.sin(a),V=1-j,q=i.x,A=i.y,Q=i.z,D=V*q,w=V*A;return this.set(D*q+j,D*A-f*Q,D*Q+f*A,0,D*A+f*Q,w*A+j,w*Q-f*q,0,D*Q-f*A,w*Q+f*q,V*Q*Q+j,0,0,0,0,1),this},multiply:function(j){return this.multiplyMatrices(this,j)},premultiply:function(Z){return this.multiplyMatrices(Z,this)},multiplyMatrices:function(d,z){var l=d.el,R=z.el,Z=this.el,n=l[0],c=l[4],p=l[8],O=l[12],f=l[1],P=l[5],r=l[9],W=l[13],x=l[2],y=l[6],m=l[10],F=l[14],e=l[3],C=l[7],i=l[11],D=l[15],j=R[0],o=R[4],S=R[8],V=R[12],M=R[1],U=R[5],Y=R[9],G=R[13],K=R[2],J=R[6],w=R[10],g=R[14],Q=R[3],b=R[7],h=R[11],H=R[15];return Z[0]=n*j+c*M+p*K+O*Q,Z[4]=n*o+c*U+p*J+O*b,Z[8]=n*S+c*Y+p*w+O*h,Z[12]=n*V+c*G+p*g+O*H,Z[1]=f*j+P*M+r*K+W*Q,Z[5]=f*o+P*U+r*J+W*b,Z[9]=f*S+P*Y+r*w+W*h,Z[13]=f*V+P*G+r*g+W*H,Z[2]=x*j+y*M+m*K+F*Q,Z[6]=x*o+y*U+m*J+F*b,Z[10]=x*S+y*Y+m*w+F*h,Z[14]=x*V+y*G+m*g+F*H,Z[3]=e*j+C*M+i*K+D*Q,Z[7]=e*o+C*U+i*J+D*b,Z[11]=e*S+C*Y+i*w+D*h,Z[15]=e*V+C*G+i*g+D*H,this},lookAt:function(){var q=new pe,l=new pe,h=new pe;return function(z,B,k){var s=this.el;return h.subVectors(z,B),0===h.lengthSq()&&(h.z=1),h.normalize(),q.crossVectors(k,h),0===q.lengthSq()&&(1===Math.abs(k.z)?h.x+=1e-4:h.z+=1e-4,h.normalize(),q.crossVectors(k,h)),q.normalize(),l.crossVectors(h,q),s[0]=q.x,s[4]=l.x,s[8]=h.x,s[1]=q.y,s[5]=l.y,s[9]=h.y,s[2]=q.z,s[6]=l.z,s[10]=h.z,this}}(),extractScale:function(){var o;return function(v){o===I&&(o=new pe),v===I&&(v=new pe);var g=o.setFromMatrixColumn(this,0).length(),K=o.setFromMatrixColumn(this,1).length(),n=o.setFromMatrixColumn(this,2).length();return v.set(g,K,n),v}}(),extractRotation:function(){var x;return function(W){x===I&&(x=new pe),W===I&&(W=new Oo);var V=this.el,O=W.el,y=1/x.setFromMatrixColumn(W,0).length(),S=1/x.setFromMatrixColumn(W,1).length(),z=1/x.setFromMatrixColumn(W,2).length();return V[0]=O[0]*y,V[1]=O[1]*y,V[2]=O[2]*y,V[4]=O[4]*S,V[5]=O[5]*S,V[6]=O[6]*S,V[8]=O[8]*z,V[9]=O[9]*z,V[10]=O[10]*z,this}}(),multiplyScalar:function(q){var w=this.el;return w[0]*=q,w[4]*=q,w[8]*=q,w[12]*=q,w[1]*=q,w[5]*=q,w[9]*=q,w[13]*=q,w[2]*=q,w[6]*=q,w[10]*=q,w[14]*=q,w[3]*=q,w[7]*=q,w[11]*=q,w[15]*=q,this},getPosition:function(R){return R===I&&(R=new pe),R.setFromMatrixColumn(this,3)},setPosition:function(E){var N=this.el;return N[12]=E.x,N[13]=E.y,N[14]=E.z,this},toArray:function(X,M){X===I&&(X=[]),M===I&&(M=0);var x=this.el;return X[M]=x[0],X[M+1]=x[1],X[M+2]=x[2],X[M+3]=x[3],X[M+4]=x[4],X[M+5]=x[5],X[M+6]=x[6],X[M+7]=x[7],X[M+8]=x[8],X[M+9]=x[9],X[M+10]=x[10],X[M+11]=x[11],X[M+12]=x[12],X[M+13]=x[13],X[M+14]=x[14],X[M+15]=x[15],X}});var _o=u.Math.Triangle=function(W,q,a){this.a=W!==I?W:new pe,this.b=q!==I?q:new pe,this.c=a!==I?a:new pe};J.assign(_o,{barycoordFromPoint:function(){var l=new pe,h=new pe,y=new pe;return function(U,f,Z,$,v){l.subVectors($,f),h.subVectors(Z,f),y.subVectors(U,f);var R=l.dot(l),o=l.dot(h),W=l.dot(y),d=h.dot(h),H=h.dot(y),a=R*d-o*o,e=v||new pe;if(0===a)return e.set(-2,-1,-1);var g=1/a,r=(d*W-o*H)*g,F=(R*H-o*W)*g;return e.set(1-r-F,F,r)}}()});var vs=u.Math.Euler=function(c,V,W,j,l){this.set(c,V,W,j,l)};vs.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],vs.DefaultOrder="XYZ",vs.ReverseOrder=function(k){return k=k[2]+k[1]+k[0],k.toUpperCase()},J.defineProperties(vs.prototype,{x:{get:function(){return this._x},set:function(K){this._x=K,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(H){this._y=H,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(G){this._z=G,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(K){this._order=K,this.onChangeCallback()}}}),J.assign(vs.prototype,{set:function(l,z,Z,t,O){return Zh(l)&&(O=Z,t=z,Z=l[2],z=l[1],l=l[0]),t?O&&(t=vs.ReverseOrder(t)):t="ZYX",this._x=l||0,this._y=z||0,this._z=Z||0,this._order=t||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(B){return this._x=B._x,this._y=B._y,this._z=B._z,this._order=B._order,this.onChangeCallback(),this},setFromRotationMatrix:function(l,I,c){var f=u.Math.clamp,n=l.el||l,t=n[0],$=n[4],J=n[8],D=n[1],z=n[5],p=n[9],e=n[2],R=n[6],Y=n[10];return I=I||this._order,"XYZ"===I?(this._y=Math.asin(f(J,-1,1)),Math.abs(J)<.99999?(this._x=Math.atan2(-p,Y),this._z=Math.atan2(-$,t)):(this._x=Math.atan2(R,z),this._z=0)):"YXZ"===I?(this._x=Math.asin(-f(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(J,Y),this._z=Math.atan2(D,z)):(this._y=Math.atan2(-e,t),this._z=0)):"ZXY"===I?(this._x=Math.asin(f(R,-1,1)),Math.abs(R)<.99999?(this._y=Math.atan2(-e,Y),this._z=Math.atan2(-$,z)):(this._y=0,this._z=Math.atan2(D,t))):"ZYX"===I?(this._y=Math.asin(-f(e,-1,1)),Math.abs(e)<.99999?(this._x=Math.atan2(R,Y),this._z=Math.atan2(D,t)):(this._x=0,this._z=Math.atan2(-$,z))):"YZX"===I?(this._z=Math.asin(f(D,-1,1)),Math.abs(D)<.99999?(this._x=Math.atan2(-p,z),this._y=Math.atan2(-e,t)):(this._x=0,this._y=Math.atan2(J,Y))):"XZY"===I?(this._z=Math.asin(-f($,-1,1)),Math.abs($)<.99999?(this._x=Math.atan2(R,z),this._y=Math.atan2(J,t)):(this._x=Math.atan2(-p,Y),this._y=0)):console.warn("unsupported order: "+I),this._order=I,c!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var K=new Oo;return function(l,c,Y){return K.makeRotationFromQuaternion(l),this.setFromRotationMatrix(K,c,Y)}}(),setFromVector3:function(H,s){return this.set(H.x,H.y,H.z,s||this._order)},reorder:function(){var R=new So;return function(t){return R.setFromEuler(this),this.setFromQuaternion(R,t)}}(),equals:function(l){return l._x===this._x&&l._y===this._y&&l._z===this._z&&l._order===this._order},fromArray:function(J){return this._x=J[0],this._y=J[1],this._z=J[2],J[3]!==I&&(this._order=J[3]),this.onChangeCallback(),this},toArray:function(q,m){return q===I&&(q=[]),m===I&&(m=0),q[m]=this._x,q[m+1]=this._y,q[m+2]=this._z,q[m+3]=this._order,q},toVector3:function(C){return C?C.set(this._x,this._y,this._z):new pe(this._x,this._y,this._z)},onChange:function(d){return this.onChangeCallback=d,this},onChangeCallback:function(){}});var Fg=J.freeze,Rb={main:{mask:1,priority:w.cameraPriority.main,ignore:!1},top:{mask:2,priority:w.cameraPriority.top,ignore:!1}},Ki="main",xs=Rb[Ki].mask,Sj=function(Z,y){Z=Z||0;var C;if(y in Rb)C=Rb[y].mask;else{if(!(32>Kd))throw new Error("Only 31 render layer can be defined.");Rb[y]={mask:1<<Kd++,priority:Rb[Ki].priority},C=Rb[y].mask,nl=yb(J.keys(Rb)),Kd=nl.length}return Z|=C},ub=function(T,J){return T&&J&&T&J},yb=function(q){return q.sort(function(P,Z){return Rb[P].priority-Rb[Z].priority})},nl=yb(J.keys(Rb)),Kd=nl.length;_p(w,{setRenderLayerInfo:function(X,A){Sj(0,X);for(var y in A)Rb[X][y]=A[y]},getRenderLayerInfo:function(S){return Rb[S]}},!0);var Vn=u.List=function(){this._as=[];var S,N,n=arguments.length;if(1===n){var F=arguments[0];if(qf(F)&&(F=F._as),Zh(F))for(N=F.length,S=0;N>S;S++)this._as.push(F[S]);else F!=B&&this._as.push(F)}else if(n>1)for(S=0;n>S;S++)this._as.push(arguments[S])};dk("List",J,{forEach:function(f,D){this.each(f,D)},push:function(){for(var V=0;V<arguments.length;V++)this.add(arguments[V])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(z,L){return L===I?this._as.push(z):this._as.splice(L,0,z)},addAll:function(W){qf(W)&&(W=W._as),Zh(W)?Md(this._as,W):this._as.push(W)},get:function(x){return this._as[x]},slice:function(p,G){return new Vn(this._as.slice(p,G))},remove:function(C){var K=this._as.indexOf(C);return K>=0&&K<this._as.length&&this.removeAt(K),K},removeAt:function(z){return this._as.splice(z,1)[0]},set:function(B,C){return this._as[B]=C},clear:function(){return this._as.splice(0,this._as.length)},contains:function(O){return this._as.indexOf(O)>=0},indexOf:function(t){return this._as.indexOf(t)},each:function(e,P){for(var X=0,M=this._as.length;M>X;X++){var f=this._as[X];P?e.call(P,f,X,this):e(f,X,this)}},reverseEach:function(E,i){for(var _=this._as.length-1;_>=0;_--){var h=this._as[_];i?E.call(i,h):E(h)}},getArray:function(){return this._as},toArray:function(f,T){if(f){for(var w,q=[],o=0,r=this._as.length;r>o;o++)w=this._as[o],T?f.call(T,w)&&q.push(w):f(w)&&q.push(w);return q}return this._as.concat()},toList:function(e,n){if(e){for(var m,i=new Vn,Y=0,x=this._as.length;x>Y;Y++)m=this._as[Y],n?e.call(n,m)&&i.add(m):e(m)&&i.add(m);return i}return new Vn(this)},reverse:function(){this._as.reverse()},sort:function(h){return this._as.sort(h?h:Tn),this},toString:function(){return this._as.toString()}}),J.defineProperties(Vn.prototype,{length:{get:function(){return this._as.length},set:function(D){this._as.length=D}}});var Cc=new Vn;_p(Cc,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Zr,each:Zr,reverseEach:Zr,toArray:function(){return[]},toList:function(){return new Vn},add:Ip,addAll:Ip,set:Ip,remove:Ip,removeAt:Ip,clear:Ip});var jl=u.Notifier=function(){this._f=0};dk("Notifier",J,{contains:function($,A){if(this._ls)for(var r,S=0,V=this._ls.size();V>S;S++)if(r=this._ls.get(S),$===r.l&&A===r.s)return!0;return!1},add:function(o,g,Q){var $=this,F={l:o,s:g,a:Q};$._ls||($._ls=new Vn),$._f?($._as||($._as=new Vn),$._as.add(F)):F.a?$._ls.add(F,0):$._ls.add(F)},remove:function(W,j){var a=this;a._ls&&(a._f?(a._rs||(a._rs=new Vn),a._rs.add({l:W,s:j})):a._remove(W,j))},_remove:function(j,n){for(var z,A=this._ls,f=0,t=A.size();t>f;f++)if(z=A.get(f),z.l===j&&z.s===n)return A.removeAt(f),void 0},fire:function(P){var q=this,L=q._ls;if(q._b=1e4,L){++q._f;try{for(var c,b=0,i=L.size();i>b;b++)c=L.get(b),c.s?c.l.call(c.s,P):c.l(P)}catch(P){nd(function(){throw P})}finally{if(--q._f)return;if(q._rs){for(i=q._rs.size(),b=0;i>b;b++)c=q._rs.get(b),q._remove(c.l,c.s);delete q._rs}if(q._as){for(i=q._as.size(),b=0;i>b;b++)c=q._as.get(b),c.a?L.add(c,0):L.add(c);delete q._as}}}}});var db=u.Data=function(){this._id=No()};dk("Data",J,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:B,_parent:B,_children:Cc,_childMap:B,_styleMap:B,_layer:"0",_renderLayer:Ki,_renderLayerMask:xs,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||xs},getRenderLayer:function(){return this._renderLayer||Ki},setRenderLayer:function(w){var S=this,M=Sj(0,w);S._renderLayerMask=M;var Q=S._renderLayer;S._renderLayer=w,S.fp("renderLayer",Q,S._renderLayer)},testRenderLayer:function(G){return ub(this._renderLayerMask,Rb[G].mask)},getUIClass:function(){return B},_22Q:function(){return B},s:function(a,O){var $=this;if(2===arguments.length)$.setStyle(a,O);else{if(!ei(a))return $.getStyle(a);for(var v in a)$.setStyle(v,a[v])}return $},fp:function(y,e,f,x,l){return this.firePropertyChange(y,e,f,x,l)},firePropertyChange:function($,j,X,t,V){if(t){if(t(j,X))return!1}else if(j===X)return!1;var i=this,w=V||{};return w.property=$,w.oldValue=j,w.newValue=X,w.data=i,i._dataModel&&i._dataModel.handleDataPropertyChange(w),i.onPropertyChanged(w),!0},onPropertyChanged:function(R){var K=this,x=K._parent,v=R.property;if(oo(x)){var y=K.s(yr),U="s:ingroup"===v;(y&&cc[v]||v===U)&&x._81I(),(y||U)&&x.fp("childChange",!0,!1)}ng(x)&&cc[v]&&x.updateFromChildren()},_21I:function(Q){var j=this;if(Q&&j._dataModel)throw"Remove data from dataModel before adding";j._dataModel=Q},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var x=0,G=this._children.toArray(),W=G.length;W>x;x++)G[x].removeFromDataModel()},getId:function(){return this._id},setId:function(s){this._id=s},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(k,c){return this._children.toList(k,c)},eachChild:function(H,t){this._children.each(H,t)},addChild:function(_,J){var P=this;_!==P&&(P._children===Cc&&(P._children=new Vn,P._childMap={}),J>=0||(J=P._children.size()),P._childMap[_._id]||P.isDescendantOf(_)||(_._parent&&_._parent.removeChild(_),(0>J||J>P._children.size())&&(J=P._children.size()),P._children.add(_,J),P._childMap[_._id]=_,_.setParent(P),P.onChildAdded(_,J),P.fp(hm,B,_)))},onChildAdded:function(){},removeChild:function(r){var k=this;if(k._childMap&&k._childMap[r._id]){var R=k._children.remove(r);delete k._childMap[r._id],k.fp(hm,r,B),r.setParent(B,R),k.onChildRemoved(r,R)}},onChildRemoved:function(){},getChildAt:function(N){return this._children.get(N)},clearChildren:function(){var c=this;if(!c._children.isEmpty())for(var T=0,L=c._children.toArray(),i=L.length;i>T;T++)c.removeChild(L[T])},getParent:function(){return this._parent},setParent:function(t,p){var Y=this;if(!(Y._73I||Y._parent===t||Y===t||t&&t.isDescendantOf(Y))){var z,Q=Y._parent;Y._parent=t,Y._73I=1,Q?(p==B&&(p=Q.getChildren().indexOf(Y)),Q.removeChild(Y)):Y._dataModel&&p==B&&(p=Y._dataModel.getRoots().indexOf(Y)),t&&(t.addChild(Y),z=t.getChildren().indexOf(Y)),delete Y._73I,Y.fp("parent",Q,t,I,{oldIndex:p,newIndex:z}),Y.onParentChanged(Q,t)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(P){return P?this.isDescendantOf(P)||P.isDescendantOf(this):!1},isParentOf:function(q){return q&&this._childMap?!!this._childMap[q._id]:!1},isDescendantOf:function(j){if(!j||j.isEmpty())return!1;for(var s=this._parent;s;){if(j===s)return!0;s=s._parent}return!1},getStyle:function(B,K){K===I&&(K=1);var V=this._styleMap?this._styleMap[B]:I;return V===I&&K?F[B]:V},setStyle:function(l,n){var g=this;g._styleMap||(g._styleMap={});var Q=g._styleMap[l];n===I?delete g._styleMap[l]:g._styleMap[l]=n,g.fp("s:"+l,Q,n)&&g.onStyleChanged(l,Q,n)},onStyleChanged:function(){},iv:function(A){this.invalidate(A)},invalidate:function(C){this.fp(C||"*",!1,!0)},toString:function(){var G=this;return G._displayName||G._name||G._tag||G._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(h,F){var L=this,S=L.s(Jo);S||L.s(Jo,S={}),F?S[h]=F:delete S[h],L.fp(Jo,B,S)},removeStyleIcon:function(m){var F=this.s(Jo);if(F){var o=F[m];delete F[m],this.fp(Jo,B,F)}return o},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var _,q={};for(_ in this._styleMap)q[_]=1;return q},getCurrentPrefix:function(){return this._interactPrefix||cf},ca:function(U,I){var n=this.getCurrentPrefix();return U=n+U,2===arguments.length?this.a(U,I):this.a(U)}});var Hc=u.DataModel=function(){var E=this;E._datas=new Vn,E._dataMap={},E._roots=new Vn,E._rootMap={},E._fsDataMap={},E._78O={},E._reflectorMap={},E._36I=new jl,E._35I=new jl,E._serializeNotifier=new jl,E._selectionModel=new Zo(E);var V=E._29Q=[],x=E._scheduleCallback=function(){for(var m=Date.now(),L=0;L<V.length;L++){var G=V[L];G.enabled&&m-G.lastTime>G.interval&&(G.beforeAction&&G.beforeAction(),E.each(function(d){G.action(d)}),G.afterAction&&G.afterAction(),G.lastTime=m)}V.length&&(E._30Q=Z.requestAnimationFrame(x))}};dk("DataModel",J,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:I,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:I,_init:I,_envmap:I,_postProcessingData:I,sm:function(){return this.getSelectionModel()},mm:function(z,W,g){this.addDataModelChangeListener(z,W,g)},umm:function(u,j){this.removeDataModelChangeListener(u,j)},md:function(d,G,b){this.addDataPropertyChangeListener(d,G,b)},umd:function(B,b){this.removeDataPropertyChangeListener(B,b)},mh:function(f,k,l){this.addHierarchyChangeListener(f,k,l)},umh:function(t,I){this.removeHierarchyChangeListener(t,I)},getAttrObject:function(){return this._attrObject},setAttrObject:function(Z){return this._attrObject=Z},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(y){return this._dataMap[y]},removeDataById:function(e){this.remove(this.getDataById(e))},toDatas:function(f,Z){return this._datas.toList(f,Z)},each:function(b,r){this._datas.each(b,r)},getDataByTag:function(_){return this._78O[_]},getTagMap:function(){return this._78O},removeDataByTag:function(c){this.remove(this.getDataByTag(c))},add:function(p,f,K){var A=this,n=p._id,Y=p._tag,q=A._roots;if(A._dataMap[n])throw"'"+n+"' already exists";Y!=B&&(A._78O[Y]=p),A._dataMap[n]=p,K>=0?A._datas.add(p,K):A._datas.add(p),p._parent||(A._rootMap[n]=p,f>=0?q.add(p,f):q.add(p)),p.s("fullscreen")!==I&&(A._fsDataMap[n]=p),p.s("shape3d.reflector")&&(A._reflectorMap[n]=p),p._21I(A),A.onAdded(p),A._36I.fire({kind:"add",data:p,rootsIndex:f,datasIndex:K})},onAdded:function(){},remove:function(H,W){if(H){var Z=this,T=H._id,z=W&&W.keepStructure,$=W&&W.keepChildren,o=H.getTag();if(H._dataModel===Z){this.beginTransaction(),z?Z._removingData||(Z._removingData=H):Z.prepareRemove(H),$||H.toChildren().each(function(c){Z.remove(c,W)},Z),z?Z._removingData===H&&(H._parent&&H._parent.removeChild(H),delete Z._removingData):H._parent&&H._parent.removeChild(H);var S=Z._datas.remove(H);delete Z._dataMap[T],o!=B&&delete Z._78O[o];var J;Z._rootMap[T]&&(delete Z._rootMap[T],J=Z._roots.remove(H)),Z._fsDataMap[T]&&delete Z._fsDataMap[T],Z._reflectorMap[T]&&delete Z._reflectorMap[T],H._21I(B),Z.onRemoved(H),Z._36I.fire({kind:Te,data:H,rootsIndex:J,datasIndex:S}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var L=this;if(L._datas.size()){var t=L._historyManager?this.toJSON():I;L._datas.toArray().forEach(function(q){q._21I(B)}),L._datas.clear(),L._dataMap={},L._roots.clear(),L._rootMap={},L._fsDataMap={},L._reflectorMap={},L._78O={},L._36I.fire({kind:Zj,json:t})}},contains:function(Q){return Q&&Q._dataModel===this},handleDataPropertyChange:function(J){var j=this,v=J.data,W=J.property;if("parent"===W){var S=v._id,z=j._rootMap,C=j._roots;v._parent?z[S]&&(delete z[S],C.remove(v)):z[S]||(z[S]=v,C.add(v))}else if("tag"===W){var I=J.oldValue,V=J.newValue,T=j._78O;I!=B&&delete T[I],V!=B&&(T[V]=v)}else if("s:fullscreen"===W){var S=v._id,g=j._fsDataMap;J.oldValue!=B&&delete g[S],J.newValue!=B&&(g[S]=v)}else if("s:shape3d.reflector"===W){var S=v._id,R=j._reflectorMap;J.oldValue&&delete R[S],J.newValue&&(R[S]=v)}this.onDataPropertyChanged(v,J),this._35I.fire(J)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(B,b,e){this._36I.add(B,b,e)},removeDataModelChangeListener:function(P,G){this._36I.remove(P,G)},addSerializeListener:function(I,v,N){this._serializeNotifier.add(I,v,N)},removeSerializeListener:function(N,L){this._serializeNotifier.remove(N,L)},fireSerializeEvent:function(Y){this._serializeNotifier.fire(Y)},addDataPropertyChangeListener:function(k,V,X){this._35I.add(k,V,X)},removeDataPropertyChangeListener:function(F,K){this._35I.remove(F,K)},_38I:function(z,D,V){this._37I&&this._37I.fire({data:z,oldIndex:D,newIndex:V})},addHierarchyChangeListener:function(e,u,f){this._37I||(this._37I=new jl),this._37I.add(e,u,f)},removeHierarchyChangeListener:function(b,X){this._37I.remove(b,X)},getSiblings:function(G){var e=G._parent;return e?e._children:this._roots},eachByHierarchical:function(D,E,h){if(E)return this._eachByHierarchical(D,E,h);for(var A=0,K=this._roots,g=K.size();g>A;A++)if(this._eachByHierarchical(D,K.get(A),h)===!1)return!1;return!0},_eachByHierarchical:function(U,F,k){if(k){if(U.call(k,F)===!1)return!1}else if(U(F)===!1)return!1;for(var L=F.size(),S=0;L>S;S++)if(this._eachByHierarchical(U,F.getChildAt(S),k)===!1)return!1;return!0},reverseEachByHierarchical:function(g,C,h){if(C)return this._reverseEachByHierarchical(g,C,h);for(var s=this._roots,E=s.size(),n=E-1;n>=0;n--)if(this._reverseEachByHierarchical(g,s.get(n),h)===!1)return!1;return!0},_reverseEachByHierarchical:function(c,d,j){for(var G=d.size(),r=G-1;r>=0;r--)if(this._reverseEachByHierarchical(c,d.getChildAt(r),j)===!1)return!1;if(j){if(c.call(j,d)===!1)return!1}else if(c(d)===!1)return!1;return!0},eachByDepthFirst:function(F,T,p){if(T)return this._11I(F,T,p);for(var n=0,P=this._roots,t=P.size();t>n;n++)if(this._11I(F,P.get(n),p)===!1)return!1;return!0},_11I:function(_,y,x){for(var t=y.size(),L=0;t>L;L++)if(this._11I(_,y.getChildAt(L),x)===!1)return!1;if(x){if(_.call(x,y)===!1)return!1}else if(_(y)===!1)return!1;return!0},eachByBreadthFirst:function(H,E,Z){var d=new Vn;for(E?d.add(E):this._roots.each(d.add,d);d.size()>0;)if(E=d.removeAt(0),E.eachChild(d.add,d),Z){if(H.call(Z,E)===!1)return!1}else if(H(E)===!1)return!1;return!0},moveTo:function(J,X){var w=this.getSiblings(J),A=w.indexOf(J);A===X||0>A||X>=0&&X<=w.size()&&(w.remove(J),X>w.size()&&X--,w.add(J,X),this._38I(J,A,X))},moveUp:function(M){this.moveTo(M,this.getSiblings(M).indexOf(M)-1)},moveDown:function(D){this.moveTo(D,this.getSiblings(D).indexOf(D)+1)},moveToTop:function(g){this.moveTo(g,0)},moveToBottom:function(e){this.moveTo(e,this.getSiblings(e).size())},moveSelectionUp:function(u){this.beginTransaction(),u||(u=this.sm());var M=new Vn;Qj(u,M,this._roots),M.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(Q){this.beginTransaction(),Q||(Q=this.sm());var D=new Vn;Jr(Q,D,this._roots),D.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(o){this.beginTransaction(),o||(o=this.sm());var S=new Vn;pl(o,S,this._roots),S.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(K){this.beginTransaction(),K||(K=this.sm());var t=new Vn;eo(K,t,this._roots),t.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(e,Q,q){var $=this.getDatas();null==q&&(q=$.indexOf(e)),q===Q||0>q||Q>=0&&Q<=$.size()&&($.remove(e),Q>$.size()&&Q--,$.add(e,Q),this._76I(e,q,Q))},bringForward:function(j){this.moveToIndex(j,this.getDatas().indexOf(j)+1)},bringToFront:function(x){this.moveToIndex(x,this.size())},sendBackward:function(d){this.moveToIndex(d,this.getDatas().indexOf(d)-1)},sendToBack:function(O){this.moveToIndex(O,0)},bringSelectionForward:function(b){this.beginTransaction(),b||(b=this.sm());for(var k=new Vn,g=this.getDatas(),S=!1,j=0;j<g.size();j++){var T=g.get(g.size()-1-j);b.contains(T)?S&&k.add(T):S=!0}k.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(M){this.beginTransaction(),M||(M=this.sm());for(var b=new Vn,n=this.getDatas(),o=0;o<n.size();o++){var x=n.get(o);M.contains(x)&&b.add(x)}b.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(Z){this.beginTransaction(),Z||(Z=this.sm());for(var E=new Vn,$=this.getDatas(),X=!1,F=0;F<$.size();F++){var R=$.get(F);Z.contains(R)?X&&E.add(R):X=!0}E.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(M){this.beginTransaction(),M||(M=this.sm());for(var X=new Vn,Y=this.getDatas(),r=0;r<Y.size();r++){var V=Y.get(Y.size()-1-r);M.contains(V)&&X.add(V)}X.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(K){var p=this;p.removeScheduleTask(K),K.enabled==B&&(K.enabled=!0),K.interval==B&&(K.interval=10),K.action==B&&(K.action=Zr),K.lastTime=Date.now(),p._29Q.push(K),p._30Q==B&&(p._30Q=Z.requestAnimationFrame(p._scheduleCallback))},removeScheduleTask:function(O){var t=this,K=t._29Q,c=K.indexOf(O);c>=0&&K.splice(c,1),K.length||t._30Q==B||(Z.cancelAnimationFrame(t._30Q),delete t._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(n){this._historyManager||new u.HistoryManager(this),null!=n&&this._historyManager.setMaxHistoryCount(n),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(Z){this._historyManager&&this._historyManager.undo(Z)},redo:function(K){this._historyManager&&this._historyManager.redo(K)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(a){this._historyManager&&this._historyManager.addHistory(a)},onHistoryManagerChanged:function(){}});var Zo=u.SelectionModel=function(j){var q=this;q._68O=hp,q._map={},q._73O=new Vn,q._74I=new jl,q._21I(j)};dk("SelectionModel",J,{ms_fire:1,ms_dm:1,ms:function(X,x,l){this.addSelectionChangeListener(X,x,l)},ums:function(z,P){this.removeSelectionChangeListener(z,P)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Zn},co:function(w){return this._map[w._id]!=B},ss:function(D){this.setSelection(D)},as:function(b){this.appendSelection(b)},rs:function(L){this.removeSelection(L)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(Q){var l=this;if(l._68O!==Q&&(Q===Iq||Q===Zn||Q===hp)){l.cs();var z=l._68O;l._68O=Q,l.fp("selectionMode",z,Q)}},_21I:function(q){var m=this,A=m._dataModel;A!==q&&(A&&(m.cs(),A.umm(m.handleDataModelChange,m)),m._dataModel=q,q.mm(m.handleDataModelChange,m,!0),m.fp(nh,A,q))},dispose:function(){var g=this;g.cs(),g._dataModel.umm(g.handleDataModelChange,g)},handleDataModelChange:function(R){var l=this;if(R.kind===Te){var h=R.data;l.co(h)&&(l._73O.remove(h),delete l._map[h._id],l._75I(Te,new Vn(h)))}else R.kind===Zj&&l.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function($){var S=this;if(S._filterFunc!==$){S.cs();var z=S._filterFunc;S._filterFunc=$,S.fp("filterFunc",z,S._filterFunc)}},_75I:function(w,B,s,Q){s&&(this._73O.each(function(K){Q[K._id]?s.remove(K):s.add(K)}),B=s.toList()),this._74I.fire({kind:w,datas:new Vn(B)})},addSelectionChangeListener:function(O,t,Q){this._74I.add(O,t,Q)},removeSelectionChangeListener:function(i,h){this._74I.remove(i,h)},_97O:function(v,Q){for(var T,F=this,f=0,e=new Vn(v);f<e.size();f++)T=e.get(f),(F._filterFunc&&!F._filterFunc(T)||Q&&F.co(T)||!Q&&!F.co(T)||!F._dataModel.contains(T))&&(e.removeAt(f),f--);return e},appendSelection:function(q){var U=this;if(U._68O!==Iq){var w,K,M=U._73O,L=U._97O(q,!0);L.isEmpty()||(U.sg()&&(w=new Vn(M),K=U._map,M.clear(),U._map={},L=new Vn(L.get(L.size()-1))),L.each(function(K){M.add(K),U._map[K._id]=K}),U._75I("append",L,w,K))}},removeSelection:function(z){var y=this,A=y._97O(z),P=0,D=A.size();if(0!==D){for(;D>P;P++){var s=A.get(P);y._73O.remove(s),delete y._map[s._id]}y._75I(Te,A)}},toSelection:function(i,b){return this._73O.toList(i,b)},getSelection:function(){return this._73O},each:function(N,I){this._73O.each(N,I)},setSelection:function(e){var M=this,R=M._73O;if(M._68O!==Iq&&!(R.isEmpty()&&!e||1===R.size()&&M.ld()===e)){var D=new Vn(R),j=M._map;R.clear(),M._map={};var N=M._97O(e,!0);M.sg()&&N.size()>1&&(N=new Vn(N.get(N.size()-1))),N.each(function(l){R.add(l),M._map[l._id]=l}),M._75I("set",B,D,j)}},clearSelection:function(){var v=this,W=v._73O;if(W.size()>0){var p=W.toList();W.clear(),v._map={},v._75I(Zj,p)}},selectAll:function(){var I=this;if(I._68O!==Iq){var W,J,H=I._dataModel.toDatas();if(I._filterFunc)for(W=0;W<H.size();W++)J=H.get(W),I._filterFunc(J)||(H.removeAt(W),W--);var D=I._73O,o=new Vn(D),R=I._map;D.clear(),I._map={},I.sg()&&H.size()>1&&(H=new Vn(H.get(H.size()-1)));var y=H.size();for(W=0;y>W;W++)J=H.get(W),D.add(J),I._map[J._id]=J;I._75I("all",B,o,R)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(E){return this._map[E._id]!=B},getLastData:function(){var K=this._73O;return K.size()>0?K.get(K.size()-1):B},getFirstData:function(){var t=this._73O;return t.size()>0?t.get(0):B},isSelectable:function(m){var Q=this;return m&&Q._68O!==Iq?Q._filterFunc?Q._filterFunc(m):!0:!1},getTopSelection:function(){var E=this,n=new Vn;return E._73O.each(function(M){for(var w=M.getParent();w;){if(E.contains(w)){M=B;break}w=w.parent}M&&n.add(M)}),n}});var dm=function(){return gp(0),function(t,I){var L;if(Tl(I)){var P=t.getDataUI(I);P&&P._88I&&(L=P._88I.rect)}return L?L:I.getRect()}}();_p(w,{edgeGroupAgentFunc:B,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:W.rectSelectBorder,graphViewRectSelectBackground:ao,graphViewEditPointSize:xc?17:7,graphViewEditPointBorderColor:W.editPointBorder,graphViewEditPointBackground:W.editPointBackground,setEdgeType:function(Z,U,H){te[Z]=U,Oj[Z]=H},getEdgeType:function(Y){return te[Y]
},getEdgeTypeMap:function(){return te},getNodeRect:dm},!0),_p(F,{"layout.h":I,"layout.v":I,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":I,interactive:!1,"image.stretch":"fill",icons:I,ingroup:!0,"body.color":I,"2d.gray":!1,fullscreen:I,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:I,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Lb,"select.width":1,"select.padding":2,"select.type":kc,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":I,"border.width":2,"border.padding":2,"border.type":kc,label:I,"label.font":I,"label.color":mm,"label.background":I,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":I,"label.max":I,"label.opacity":I,"label.scale":1,"label.align":I,"label.selectable":!0,label2:I,"label2.font":I,"label2.color":mm,"label2.background":I,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":I,"label2.max":I,"label2.opacity":I,"label2.scale":1,"label2.align":I,"label2.selectable":!0,note:I,"note.expanded":!0,"note.font":I,"note.color":Jh,"note.background":Lb,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":I,"note.toggleable":!0,"note.border.width":1,"note.border.color":I,"note.opacity":I,"note.scale":1,"note.align":I,note2:I,"note2.expanded":!0,"note2.font":I,"note2.color":Jh,"note2.background":Lb,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":I,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":I,"note2.opacity":I,"note2.scale":1,"note2.align":I,"group.type":I,"group.image":I,"group.image.stretch":"fill","group.repeat.image":I,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":I,"group.title.color":Jh,"group.title.background":W.groupTitleBackground,"group.title.align":ue,"group.title.orientation":Xn,"group.background":W.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":I,"group.border.color":Ue,"group.border.radius":0,"group.border.cap":wb,"group.border.join":Nn,"group.splitLine":!1,"group.gradient":B,"group.gradient.color":"#FFF",shape:I,"shape.background":Ue,"shape.repeat.image":I,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Ue,"shape.border.3d":!1,"shape.border.3d.color":I,"shape.border.3d.accuracy":I,"shape.border.cap":wb,"shape.border.join":Nn,"shape.border.pattern":I,"shape.gradient":B,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Oe,"shape.dash.offset":0,"shape.dash.color":lf,"shape.dash.width":I,"shape.dash.3d":!1,"shape.dash.3d.color":I,"shape.dash.3d.accuracy":I,"shape.polygon.side":6,"shape.arc.from":R,"shape.arc.to":z,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":I,"shape.gradient.pack":I,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":I,"shape.foreground.gradient":B,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":I,"autolayout.hgap":I,"autolayout.vgap":I,"edge.type":I,"edge.points":I,"edge.segments":I,"edge.color":Ue,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":I,"edge.3d.accuracy":I,"edge.cap":wb,"edge.join":Nn,"edge.source.position":17,"edge.source.anchor.x":I,"edge.source.anchor.y":I,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":I,"edge.target.anchor.y":I,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":I,"edge.dash":!1,"edge.dash.pattern":Oe,"edge.dash.offset":0,"edge.dash.color":lf,"edge.dash.width":I,"edge.dash.3d":!1,"edge.dash.3d.color":I,"edge.dash.3d.accuracy":I,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":I,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":I,"grid.column.percents":I,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":W.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":W.gridCellBorderColor,"grid.block":I,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":W.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":mm,"text.font":Dd,"text.shadow":!1,"text.shadow.color":Lb,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:I},!0),_p(Hc,{_76I:function(_,O,p){this._39I&&this._39I.fire({data:_,oldIndex:O,newIndex:p})},addIndexChangeListener:function(j,n,S){var y=this;y._39I||(y._39I=new jl),y._39I.add(j,n,S)},removeIndexChangeListener:function(t,s){this._39I.remove(t,s)},prepareRemove:function(i){cr(i)&&(i.setSource(B),i.setTarget(B)),i._70O&&i._70O.toList().each(this.remove,this),i._69O&&i._69O.toList().each(function(H){H.setHost(B)}),i._host&&i.setHost(B)},onAdded:function(o){this.isAutoAdjustIndex()&&this.adjustIndex(o)},onDataPropertyChanged:function(g,z){zf[z.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(g)},isAdjustable:function(L){return $o(L)||cr(L)},isAdjustedToBottom:function(I){return oo(I)?I.isExpanded()&&jp(I):!1},adjustIndex:function(n){var h=this;this.isHierarchicalRendering()||(h.isAdjustedToBottom(n)?(h.sendToBottom(n),n.eachChild(h.adjustIndex,h)):h.sendToTop(n))},sendToTop:function(L){var p=this;if(p.contains(L)&&p.isAdjustable(L)){var D=p._datas;if(L!==D.get(p.size()-1)){var X=D.indexOf(L);D.removeAt(X),D.add(L),p._76I(L,X,p.size()-1)}if(cr(L)){var k=L._40I;k&&!p.isAdjustedToBottom(k)&&p.sendToTop(k),k=L._41I,k&&!p.isAdjustedToBottom(k)&&p.sendToTop(k)}L._69O&&L._69O.each(function(U){U.isRelatedTo(L)||$o(L)&&U.isLoopedHostOn(L)||p.sendToTop(U)}),L.ISubGraph||(!oo(L)||L.isExpanded())&&L._adjustChildrenToTop&&L.eachChild(function(Q){cr(Q)||p.sendToTop(Q)})}},sendToBottom:function(m,k){var y=this;if(m!==k&&y.contains(m)&&y.isAdjustable(m)&&(!k||y.contains(k))){var f=y._datas,j=f.remove(m),i=k?y._datas.indexOf(k):0;if(f.add(m,i),j!==i){y._76I(m,j,i);var I=m._parent;!I||I.ISubGraph||cr(I)||y.sendToBottom(m._parent,m)}}}}),_p(ve,{ms_edit:function(D){D._46O=function(a){var X=this,C=X.gv.dm(),V=X._index,m=X._89I,u=X._node,Q=X._shape,p=X._edge,w=X._77I;u&&m?(this.fi({kind:"endEditRect",event:a,data:u,direction:m}),C.endTransaction()):Q&&V>=0?(X.fi({kind:"endEditPoint",event:a,data:Q,index:V}),C.endTransaction()):p&&V>=0?(X.fi({kind:"endEditPoint",event:a,data:p,index:V}),C.endTransaction()):w&&(X.fi({kind:"endEditRotation",event:a,data:w}),C.endTransaction())},D._78I=function(h){var w=this;w.autoScroll(h);var n=w.gv.lp(h),q=w._index,V=w._89I,F=w._node,b=w._shape,x=w._edge,l=w._77I;if(F&&V)w._80O(n),w.fi({kind:"betweenEditRect",event:h,data:F,direction:V});else if(b&&q>=0)n.e=b.getPoints().get(q).e,b.setPoint(q,n),w.fi({kind:"betweenEditPoint",event:h,data:b,index:q});else if(x&&q>=0){var H=x.s(Dn);n.e=H.get(q).e,H.set(q,n),x.fp(Dn,B,H),w.fi({kind:"betweenEditPoint",event:h,data:x,index:q})}else if(l){var K=l.p(),Y=l.getScale(),z=L+v(n.y-K.y,n.x-K.x);Y.y<0&&(z+=R),j(z)<.04&&(z=0),l.setRotation(z),w.fi({kind:"betweenEditRotation",event:h,data:l})}},D._80O=function(C){var H=this,h=H._node,U=H._rect,q=U.x,J=U.y,I=U.width,$=U.height,r=H._89I,g=H._anchor,N=H._matrix,C=N.tfi(C);"northwest"===r?U=qh(C,{x:q+I,y:J+$}):r===vg?U=qh({x:q,y:C.y},{x:q+I,y:J+$}):"northeast"===r?U=qh({x:q,y:C.y},{x:C.x,y:J+$}):r===Eo?U=qh({x:C.x,y:J},{x:q+I,y:J+$}):r===zp?U=qh({x:q,y:J},{x:C.x,y:J+$}):"southwest"===r?U=qh({x:C.x,y:J},{x:q+I,y:C.y}):"south"===r?U=qh({x:q,y:J},{x:q+I,y:C.y}):"southeast"===r&&(U=qh({x:q,y:J},C)),h.setPosition(N.tf(U.x+U.width*g.x,U.y+U.height*g.y)),h.setWidth(U.width),h.setHeight(U.height)},D._80I=function(C,$,M,r){var d=this,O=d.gv._zoom,p=(d.gv.getEditPointSize()+2)/O;return fr({x:$-p/2,y:M-p/2,width:p,height:p},C)?(d._89I!==r&&(d._89I=r),!0):!1},D._79I=function(X,d,f){var Z=this,K=Z.gv,b=d?K.getDataUI(d):B,o=b?b._55O:B;if(o){var $,C,N,j,i=K._zoom,z=(K.getEditPointSize()+2)/i,S=K.lp(X);if($o(d)){if(o._56O&&$o(d)&&(C=o._98o,fr({x:C.x-z/2,y:C.y-z/2,width:z,height:z},S)))return Z._77I=d,f&&Z.fi({kind:"beginEditRotation",event:X,data:d}),Z.setCursor("crosshair"),!0;if(o._43O&&d instanceof yg)for(N=d.getPoints(),$=N.size()-1;$>=0;$--)if(C=N.get($),fr({x:C.x-z/2,y:C.y-z/2,width:z,height:z},S))return Z._index=$,Z._shape=d,f&&Z.fi({kind:"beginEditPoint",event:X,data:d,index:$}),Z.setCursor("crosshair"),!0;if(o._42O)for(var T=d.getEditControlPoints(),p=["northwest",-1,-1,Eo,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,zp,1,0,"northeast",1,-1,vg,0,-1],$=0,j=T.length;j>$;$++){var R=p[3*$],_=T[$];if(Z._80I(S,_.x,_.y,R)){Z._node=d;var a=d.getWidth(),O=d.getHeight(),M=d.getAnchor();Z._rect={x:-a*M.x,y:-O*M.y,width:a,height:O},Z._anchor=M,Z._matrix=d.getMatrix();var E=d.getRotation(),L=n(E),I=q(E),Y=p[3*$+1]*Sl(d.getScale().x),y=p[3*$+2]*Sl(d.getScale().y),k=Math.atan2(-I*Y-L*y,L*Y-I*y),h=(Math.round(k/(Math.PI/4))+8)%8,F=[jk,"nesw-resize",Gm,"nwse-resize",jk,"nesw-resize",Gm,"nwse-resize"][h];return Z.setCursor(F),f&&Z.fi({kind:"beginEditRect",event:X,data:d,direction:Z._89I}),!0}}}if(o._43O&&cr(d)&&d.s(kr)===tf&&(N=d.s(Dn)))for($=N.size()-1;$>=0;$--)if(C=N.get($),fr({x:C.x-z/2,y:C.y-z/2,width:z,height:z},S))return Z._index=$,Z._edge=d,f&&Z.fi({kind:"beginEditPoint",event:X,data:d,index:$}),Z.setCursor("crosshair"),!0}return!1}},ms_gv:function(v){v._currentSubGraph=B,v._fpsInfo={time:0,fps:0,frames:0},v.upSubGraph=function(){this.setCurrentSubGraph(Ng(this._currentSubGraph))},v.isVisible=function(S){var U=this;if(Ng(S)!==U._currentSubGraph)return!1;if(cr(S)){var t=S._40I,E=S._41I;if(!t||!E)return!1;if(!(S.s("edge.independent")||U.isVisible(t)&&U.isVisible(E)))return!1;if(S.isEdgeGroupHidden())return!1}else for(var q=S._parent;q&&!q.ISubGraph;){if(oo(q)&&(!q.isExpanded()||!U.isVisible(q)))return!1;q=q._parent}if(S._parent instanceof Vp&&!U.isVisible(S._parent))return!1;if(S._refGraph instanceof Tb&&!U.isVisible(S._refGraph))return!1;if(U instanceof Fm){if(!S.s("3d.visible"))return!1}else{var y=U.getLayersInfo();if(y){var s=y[S._layer];if(s&&s.visible===!1)return!1}if(!S.s("2d.visible"))return!1}return U._visibleFunc?U._visibleFunc(S):!0},v.handleSelectionChange=function(W){var V=this;W.datas.each(function(E){V.invalidateData(E);var B=E._parent;oo(B)&&$o(E)&&E.s(yr)&&(V.invalidateData(B),B._49I&&B._49I.each(function(E){V.invalidateData(E)}))}),V.onSelectionChanged(W)},v.onSelectionChanged=function(b){var q=this,v=q.sm();if(1===v.size()&&("set"===b.kind||"append"===b.kind)){var C=v.ld();q.isAutoMakeVisible()&&q.makeVisible(C),q.adjustIndex&&q._dataModel.isAutoAdjustIndex()&&q.adjustIndex(C)}},v.makeVisible=function(J){if(J){var A=this,G=A.getDataUI?A.getDataUI(J):A.getData3dUI(J);if(G){var Y=J,l=Ng(J);for(l!==A._currentSubGraph&&A.setCurrentSubGraph(l);(Y=Y._parent)&&Y!==l;)oo(Y)&&Y.setExpanded(!0);A._23I=J,A.iv()}}},v.getLabel=function(f){var e=f.getStyle(Bd);return e===I?f.getName():e},v.getLabelBackground=function(P){return P.getStyle("label.background")},v.getLabelColor=function(O){return O.getStyle("label.color")},v.getLabel2=function(u){return u.getStyle("label2")},v.getLabel2Background=function(S){return S.getStyle("label2.background")},v.getLabel2Color=function(I){return I.getStyle("label2.color")},v.getNote=function(g){return g.getStyle(Ml)},v.getNoteBackground=function(w){return w.getStyle("note.background")},v.getNote2=function(S){return S.getStyle(an)},v.getNote2Background=function(C){return C.getStyle("note2.background")},v.handleClick=function(V,K,R){var t=this;K?(t.fi({kind:"clickData",event:V,data:K,part:R}),t.onDataClicked(K,V)):(t.fi({kind:"clickBackground",event:V}),t.onBackgroundClicked(V))},v.handleDoubleClick=function(A,D,a){var j=this;yi(A)&&(D?(j.fi({kind:"doubleClickData",event:A,data:D,part:a}),j.onDataDoubleClicked(D,A,a),j.checkDoubleClickOnNote(A,D,a)||j.checkDoubleClickOnRotation&&j.checkDoubleClickOnRotation(A,D,a)||(cr(D)?j.onEdgeDoubleClicked(D,A,a):D.ISubGraph?j.onSubGraphDoubleClicked(D,A,a):oo(D)?j.onGroupDoubleClicked(D,A,a):D.IDoorWindow?j.onDoorWindowDoubleClicked(D,A,a):D.ICSGBox&&j.onCSGBoxDoubleClicked(D,A,a))):(j.fi({kind:"doubleClickBackground",event:A}),j.onBackgroundDoubleClicked(A)))},v.onSubGraphDoubleClicked=function(t){this.setCurrentSubGraph(t)},v.onEdgeDoubleClicked=function(b,m){b.ISubGraph&&!Di(m)?this.setCurrentSubGraph(b):b.s("edge.toggleable")&&b.toggle()},v.onGroupDoubleClicked=function(e){e.s("group.toggleable")&&e.toggle()},v.onDoorWindowDoubleClicked=function(B){B.s("dw.toggleable")&&B.toggle(!0)},v.onCSGBoxDoubleClicked=function(Y,p){var H=this;if(H instanceof Fm){var k=H.intersectObject(p,Y);k&&Y.s(k.part+".toggleable")&&Y.toggleFace(k.part,!0)}},v.onBackgroundClicked=function(){},v.onBackgroundDoubleClicked=function(){this.upSubGraph()},v.onDataClicked=function(){},v.onDataDoubleClicked=function(){},v.onAutoLayoutEnded=function(){},v.onMoveEnded=function(){},v.onPanEnded=function(){},v.onPinchEnded=function(){},v.onRectSelectEnded=function(){},v.onZoomEnded=function(){},v.serialize=function(h){return this.dm().serialize(h)},v.toJSON=function(){return this.dm().toJSON()},v.deserialize=function(p,T){var m=this;T=T instanceof db?{rootParent:T}:Bi(T)?{setId:T}:Im(T)?{finishFunc:T}:T||{},T.view=m;var v=m.dm(),e=T.finishFunc;return T.finishFunc=function(){e&&e.apply(T,arguments),Bi(v.a("zoomable"))&&m.setZoomable&&m.setZoomable(v.a("zoomable")),Bi(v.a("pannable"))&&m.setPannable&&m.setPannable(v.a("pannable")),Bi(v.a("rectSelectable"))&&m.setRectSelectable&&m.setRectSelectable(v.a("rectSelectable")),v.a("fitContent")===!0&&m.fitContent&&m.fitContent(!0,0)},v.deserialize(p,T.rootParent,T)},v.showDebugTip=function(){var u=this,q=u._debugDiv;if(!q){q=u._debugDiv=b.createElement("div"),q.style.position="absolute",q.style.overflow="hidden",q.style.backgroundColor="white",q.style.color="black";var J=u.getView();u._79O?J.insertBefore(q,u._79O):J.appendChild(q);var Q=function(){u.redraw();var n="FPS : "+u._fpsInfo.fps+"<br/>"+"Datas : "+u.dm().getDatas().length,y=u.getDebugTip();y&&(n+="<br/>------<br/>"+y),q.innerHTML=n,u._isDebugging&&requestAnimationFrame(Q)};requestAnimationFrame(Q),u._isDebugging=!0}},v.hideDebugTip=function(){var $=this,d=$._debugDiv;d&&(delete $._debugDiv,$.getView().removeChild(d),$._isDebugging=!1)},v.updateDOMAppendMatrix=function(){var X=this.getView();X&&(X.updateAppendMatrix=!0)},v.countFrame=function(){if(this._isDebugging){var q=Date.now(),o=this._fpsInfo;q-o.time>1e3?(o.fps=Math.round(1e5*(o.frames+1)/(q-o.time))/100,o.time=q,o.frames=0):o.frames++}}},ms_icons:function(u){u.getRotation=function(A){return A==B?0:A},u._15O=function(){var d=this,h=d.s(Jo);if(h){var c=d,A=d.data||d._data,m=d._38o={icons:h,rects:{}};for(var z in h){var T=h[z],o=lg(T.shape3d,A,c);if(!(lg(T.visible,A,c)===!1||lg(T.for3d,A,c)&&!d.I3d||o&&!d.I3d)){var u=o?[o]:lg(T.names,A,c),p=u?u.length:0,n=lg(T.position,A,c)||3,P=lg(T.offsetX,A,c)||0,f=lg(T.offsetY,A,c)||0,x=lg(T.direction,A,c)||zp,r=lg(T.gap,A,c),$=r!=B?r:1,_=lg(T.rotation,A,c),w=lg(T.keepOrien,A,c),g=lg(T.rotationFixed,A,c)?_:d.getRotation(_,w,n),y=B,U=m.rects[z]=new Array(p);U.rotation=g;for(var N=0;p>N;N++){var k,q,Q,J,i=u[N];if(o)Q=0,J=0;else{var F=Ve(i);Q=lg(T.width,A,c),J=lg(T.height,A,c),Q==B&&(Q=Sg(F,A)),J==B&&(J=Xd(F,A))}if(y?x===zp?P+=Q/2:x===Eo?P-=Q/2:x===vg?f-=J/2:f+=J/2:y={width:Q,height:J},d.I3d){var M=-Q/2,j=-J/2;q={width:Q,height:J,mat:d._16O(lg(T.autorotate,A,c),n,y,lg(T.face,A,c)||yn,lg(T.t3,A,c),lg(T.r3,A,c),lg(T.rotationMode,A,c),P,f),vs:new Hf([M,-j,0,M,-j-J,0,M+Q,-j-J,0,M+Q,-j,0])}}else k=d.getPosition(n,P,f,y,lg(T.positionFixed,A,c)),q={x:k.x-Q/2,y:k.y-J/2,width:Q,height:J},d._68o(q,g);U[N]=q,x===zp?P+=Q/2+$:x===Eo?P-=Q/2+$:x===vg?f-=J/2+$:f+=J/2+$}}}}}}});var Hn={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Eb={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},_c={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},zf={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},cc={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},sc={"edge.type":1,"edge.group":1},fd={rotation:1,rotationX:1,rotationZ:1},ql={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Xi={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Ei={shape:1,thickness:1,position:1,anchor:1,scale:1},Ng=function(v){if(!v)return B;if(cr(v)){var d=v._40I,_=v._41I;if(!d||!_)return B;var w=Ng(d),k=Ng(_);return w===k?w:B}for(var m=v._parent;cr(m)&&!m.ISubGraph;)m=m._parent;return m?m.ISubGraph?m:Ng(m):B},jb=function(I,J,O,U){var w=J.getStyle(O)*U;w&&em(I,w),w=J.getStyle(O+".left")*U,w&&(I.x-=w,I.width+=w),w=J.getStyle(O+".right")*U,w&&(I.width+=w),w=J.getStyle(O+".top")*U,w&&(I.y-=w,I.height+=w),w=J.getStyle(O+".bottom")*U,w&&(I.height+=w),I.width<0&&(I.width=-I.width,I.x-=I.width),I.height<0&&(I.height=-I.height,I.y-=I.height)},jp=function(J){for(var C,h=0,U=J.size();U>h;h++)if(C=J.getChildAt(h),$o(C)&&jp(C))return!0;return J.hasAgentEdges()},Mf=function(e){if(!e)return B;for(var x=e._parent;oo(x);){if(!oo(x._parent))return x.isExpanded()?e:x;x.isExpanded()||(e=x),x=x._parent}return e},ll=function(s,L){if(!s||!L)return B;var f,W,n,o=Ng(s),T=Ng(L);if(o!==T){for(;T&&o!==T;)T=Ng(T);if(o===T)return s;f=new Vn,f.add(s,0);for(var _=s._parent;$o(_)&&!L.isDescendantOf(_);)f.add(_,0),_=_._parent;for(n=f.size(),W=0;n>W;W++){var O=f.get(W);if(oo(O)&&!O.isExpanded())return O;if(O.ISubGraph)return O}return s}return s},Tj=function(M){if(M.isLooped())return M._source;var h=Mf(M._source),Y=Mf(M._target);return h===Y?M._source:ll(h,Y)},Th=function(R){if(R.isLooped())return R._target;var g=Mf(R._source),W=Mf(R._target);return g===W?R._target:ll(W,g)},Gq=function(x,j,n){"target"!==n&&(n="source");var u="target"===n?j.getTargetAgent():j.getSourceAgent(),Y="edge."+n+".";if(cr(u)){var y=x.getDataUI(u);y._79o();var B=j.s(Y+"index");if(B!==I){var k=Lf(y);return k[Math.max(0,Math.min(B,k.length-1))]}var w=j.s(Y+"percent")||0;w=Math.max(0,Math.min(w,1));var H=Lp(y);return _k(H,100*w)}return In(x,u,j.s(Y+"position"),j.s(Y+"offset.x"),j.s(Y+"offset.y"),j.s(Y+"anchor.x"),j.s(Y+"anchor.y"))},In=function(_,M,c,x,J,f,a){if(!M)return B;var z,g=M.getRotation?M.getRotation():0;if(f!==I||a!==I)if(f=f===I?.5:f,a=a===I?.5:a,g&&!Tl(M,_)){var V=M.getPosition(),R=M.getWidth(),w=M.getHeight(),v=M.getAnchor(),u=M.getScale(),j=new vl(g,V.x,V.y,u.x,u.y);c=j.tf((f-v.x)*R,(a-v.y)*w)}else z=dm(_,M),c={x:z.x+f*z.width,y:z.y+a*z.height};else c=hi(c,dm(_,M));if(g){var F=n(g),s=q(g),S=x*F-J*s;J=x*s+J*F,x=S}return c.x+=x,c.y+=J,c},tr=function(n,g){if(!n||!g)return B;var l,Q,p,S,D,q;if(n===g){if(S=n.getLoopedEdges(),!S)return B;S=new Vn(S)}else{if(D=n.getAgentEdges(),q=g.getAgentEdges(),!D||!q)return B;for(Q=D.size(),l=0;Q>l;l++)p=D.get(l),q.contains(p)&&(S||(S=new Vn),S.add(p))}if(S)for(l=0;l<S.size();l++)p=S.get(l),p.getStyle(kr)===tf&&(p._22I(B),S.removeAt(l),l--);return S},Pc=function(r,Z){var x=tr(r,Z);if(x&&!x.isEmpty()){if(1===x.size())return x.get(0)._22I(B),void 0;var N=new Vn,K=new Vn;x.each(function(e){var k=e.s("edge.group");N.contains(k)||N.add(k)}),N.sort(),N.each(function(U){K.add(new u.EdgeGroup(x.toList(function(L){return U===L.s("edge.group")}),K))}),K.each(function(L){L.each(function(T){T._22I(L)})})}},Kh=function(v,T,e){var b=v._canvas;v._zoom;var g=xn(T,b),x=xn(e,b);return{x:g.x-x.x,y:g.y-x.y}},rb=function(c,n){if(n){var G=n.rect,s=n.color,i=n.rotation,M=n.labelWidth,u=n.background,W=n.opacity,Q=n.scale,j=Q!=B&&1!==Q;if(W!=B){var e=c.globalAlpha;c.globalAlpha*=W}if(i||j){c.save();var K=G.x+G.width/2,F=G.y+G.height/2;Bn(c,K,F),i&&sb(c,i),j&&c.scale(Q,Q),Bn(c,-K,-F)}if(u&&Xc(c,G.x,G.y,G.width,G.height,u),M){var O=G.width,R=c.createLinearGradient(G.x,G.y,G.x+O,G.y);R.addColorStop(0,s),R.addColorStop(.9,s),R.addColorStop(1,Wn),s=R,G.width=M}ac(c,n.ss,G,n.font,s,n.align),M&&(G.width=O),(i||j)&&c.restore(),W!=B&&(c.globalAlpha=e)}},Qd=function(o,j){if(j){var V=j.rect,I=V.x,H=V.y,u=V.width,P=V.height,c=j.background,O=j.backgroundImage,Y=j.borderWidth,J=j.borderColor,S=j.labelWidth,t=j.opacity,v=j.scale,X=v!=B&&1!==v;if(t!=B){var n=o.globalAlpha;o.globalAlpha*=t}if(X){o.save();var F=V.x+V.width/2,E=V.y+V.height/2;Bn(o,F,E),o.scale(v,v),Bn(o,-F,-E)}if(j.expanded){var G=s(8,u/4),M=H+P-8;if(o.fillStyle=c,o.beginPath(),o.moveTo(I,H),o.lineTo(I,M),o.lineTo(I+u/2,M),o.lineTo(I+u/2,H+P),o.lineTo(I+u/2+G,M),o.lineTo(I+u,M),o.lineTo(I+u,H),o.closePath(),o.fill(),Y&&(o.lineWidth=Y,o.lineJoin="round",o.lineCap="round",J?(o.strokeStyle=J,o.stroke()):(o.strokeStyle=ke(c),o.beginPath(),o.moveTo(I+u,H),o.lineTo(I+u,M),o.lineTo(I+u/2+G,M),o.lineTo(I+u/2,H+P),o.stroke(),o.strokeStyle=Cl(c),o.beginPath(),o.moveTo(I+u,H),o.lineTo(I,H),o.lineTo(I,M),o.lineTo(I+u/2,M),o.lineTo(I+u/2,H+P),o.stroke())),O)fl(o,Ve(O),Qi,V.x,V.y,V.width,V.height-8,j.data,j.view);else{if(V.height-=8,c=j.color,S){var K=u,T=o.createLinearGradient(I,H,I+K,H);T.addColorStop(0,c),T.addColorStop(.9,c),T.addColorStop(1,Wn),c=T,V.width=S}ac(o,j.ss,V,j.font,c,j.align),S&&(V.width=K),V.height+=8}}else if(j.icon)rj(o,Ve(j.icon),I,H,u,P,j.data,j.view);else{var D=u/2;Y&&(o.lineWidth=Y,o.lineJoin="round",o.lineCap="round",o.strokeStyle=J?J:ke(c),o.beginPath(),o.arc(I+D,H+D,D,L,1.6*R,!0),o.moveTo(I+D,H+P),o.lineTo(I+u-D/5,H+D),o.stroke(),o.strokeStyle=J?J:Cl(c),o.beginPath(),o.arc(I+D,H+D,D,1.6*R,L,!0),o.moveTo(I+D,H+P),o.lineTo(I+D/5,H+D),o.stroke()),o.fillStyle=c,o.beginPath(),o.arc(I+D,H+D,D,0,z,!0),o.moveTo(I+D,H+P),o.lineTo(I+u-D/5,H+D),o.lineTo(I+D/5,H+D),o.closePath(),o.fill(),o.fillStyle=j.color,o.beginPath(),o.arc(I+D,H+D,D/3,0,z,!0),o.fill()}X&&o.restore(),t!=B&&(o.globalAlpha=n)}},Dp=function(D,M){return M>2*D?D:M/2},xd=function(o,H,w,d){if(!o||!H)return 0;var W=v(H.y-o.y,H.x-o.x);return w||(W=H.x<o.x?W+R:W),W+d},sm=function(t,C,A,R,Z,s,J){J&&(t.x>C.x||t.x===C.x&&t.y>C.y)&&(A=Nf[A],Z=-Z);var I=hi(A,{x:0,y:0,width:Ke(t,C),height:0},s);return I.x+=R,I.y+=Z,I=new vl(v(C.y-t.y,C.x-t.x)).tf(I),I.x+=t.x,I.y+=t.y,I},Xr=function(b,o,L,X,P){if(b._19Q=!0,!L.getEdgeGroup())return X?L.s("edge.gap"):0;if(cr(L.getSourceAgent())||cr(L.getTargetAgent()))return 0;var J,D=0,I=0,E=0;if(L.getEdgeGroup().getSiblings().each(function(r){r.each(function(r){if(o.isVisible(r)&&r.s(kr)==P){var O=r.s("edge.gap");J?(I+=E/2+O/2,E=O):(J=r,E=O),r===L&&(D=I)}})}),X)return I-D+E;var Z=D-I/2;return J&&L._40I!==J._40I&&(b._19Q=!1),Z},Em=function(){var r=function(s){var d=[];return s.forEach(function(p){d.push({x:p.x,y:p.y}),d.push({x:p.x+p.width,y:p.y+p.height}),d.push({x:p.x+p.width,y:p.y}),d.push({x:p.x,y:p.y+p.height})}),d};return function(J,x,y){if("oval"===J){var p=0,f=y.height/y.width,k=f*f,i=y.x+y.width/2,S=y.y+y.height/2,G=r(x);G.forEach(function(P){var N=P.x-i,n=P.y-S,q=N*N+n*n/k;q>p&&(p=q)}),p=h(p);var c=f*p;return{x:i-p,y:S-c,width:2*p,height:2*c}}if("circle"===J){var A=0,i=y.x+y.width/2,S=y.y+y.height/2,G=r(x);return G.forEach(function(b){var W=b.x-i,U=b.y-S,Z=W*W+U*U;Z>A&&(A=Z)}),A=h(A),{x:i-A,y:S-A,width:2*A,height:2*A}}return"roundRect"===J?(em(y,s(y.width,y.height)/16),y):y}}(),cq=u.graph={},am=function(r,$,q){eh(A+".graph."+r,$,q)};u.layout={};var De={},Df=function(j,f,p,v,b,q,l,n){var t=[f.uuid,Math.round(v),Math.round(b),p].join("_");f.cacheRule&&(t+=lg(f.cacheRule,q,l));var h=l._zoom;h!==l._cacheZoom&&(l._cacheZoom=h,l._cacheImage={}),h*=Am;var G=l._cacheImage[t];return G||(G=l._cacheImage[t]=u.Default.toCanvas(f,Math.ceil(v*h),Math.ceil(b*h),p,q,l,n)),G};_p(w,{setImageCacheRule:function(o,X){var a;a=X||"object"!=typeof o?{_image:X}:o;for(var k in a){var L=a[k];Ug(k)?(eh=Ve(k),eh?eh.cacheRule=L:De[k]=L):k.cacheRule=L}}});var Qk={comps:[{type:Oh,points:[85,50,70,115,100,71,86,107,88,49,43,104,48,78,122,102,57,120,105,70,47,66,122,104,74,55,57,84,99,67,107,80,71,53,78,110,90,68,88,104,53,101,103,61],borderWidth:1,borderColor:B}]};if(Qk[nq]=Qk[pm]=160,Z.Image){var cm=new Z.Image;cm.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",mk("default_blank",cm)}mk("node_image",Tq(30,30,[{type:kc,rect:[4,5,22,16],gradient:tp,gradientColor:Oc,background:Ue},{type:kc,rect:[2,3,26,20],borderWidth:1,borderColor:Ue},{type:kc,rect:[11,23,8,4],background:Ue},{type:kc,rect:[6,27,18,2],background:Ue}])),mk("node_icon",Tq(16,16,[{type:kc,rect:[2,2,12,10],gradient:tp,gradientColor:Oc,background:Ue},{type:nm,rect:[2,2,12,10],width:1,color:Ue},{type:kc,rect:[6,12,4,2],background:Ue},{type:kc,rect:[4,14,8,1],background:Ue}])),mk("block_icon",Tq(16,16,[{type:nm,rect:[1,1,14,14],width:1,color:Ue}])),mk("group_image",Tq(66,39,[{type:kc,rect:[44.3,18,18.1,12.8],gradient:tp,gradientColor:Oc,background:Ue},{type:kc,rect:[3.3,17.8,18.1,12.8],gradient:tp,gradientColor:Oc,background:Ue},{type:kc,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Ue,gradient:tp,gradientColor:Oc,background:Ue},{type:kc,rect:[26.2,29.4,12.8,4.2],background:Ue},{type:kc,rect:[21.3,33.5,22.5,2.3],background:Ue},{type:kc,rect:[5.3,32.7,14.1,2.1],background:Ue},{type:kc,rect:[9,30.4,6.7,2.4],background:Ue},{type:kc,rect:[50,30.7,6.7,2.4],background:Ue},{type:kc,rect:[46.3,33,14.1,2.1],background:Ue}])),mk("group_icon",Tq(16,16,[{type:kc,rect:[4,12,4,2],background:Ue},{type:kc,rect:[2,13,8,1],background:Ue},{type:kc,rect:[12,12,2,1],background:Ue},{type:kc,rect:[11,13,4,1],background:Ue},{type:kc,rect:[10,7,6,5],gradient:tp,gradientColor:Oc,background:Ue},{type:kc,rect:[1,2,10,10],gradient:tp,gradientColor:Oc,background:Ue},{type:nm,rect:[1,2,10,10],width:1,color:Ue}])),mk("refGraph_icon",Tq(16,16,[{type:"shape",borderWidth:1,borderColor:Ue,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Ue,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),mk("edge_icon",Tq(16,16,[{type:kc,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:tp,gradientColor:Oc,background:Ue},{type:kc,rect:[10.8,1,4,4],background:Ue},{type:kc,rect:[1,11,4,4],background:Ue}])),mk("subGraph_image",Tq(72,45,[{type:Oh,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:tp,gradientColor:Oc,background:Ue},{type:kc,rect:[29.6,30.7,3.6,1.8],background:Ue},{type:kc,rect:[28.4,32.3,6,1.2],background:Ue},{type:kc,rect:[37.3,32,10.8,1.8],background:Ue},{type:kc,rect:[39.1,29.9,7.2,2.3],background:Ue},{type:kc,rect:[26.6,23.7,9.6,7.2],gradient:tp,gradientColor:Oc,background:Ue},{type:kc,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Ue,gradient:tp,gradientColor:Oc,background:Ue}])),mk("subGraph_icon",Tq(17,17,[{type:Oh,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:tp,gradientColor:Oc,background:Ue}])),mk("shape_icon",Tq(16,16,[{type:Oh,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Ue}])),mk("polyline_icon",Tq(16,16,[{type:Oh,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Ue},Zd(7.5,.4),Zd(7.5,6.3),Zd(13.6,6.3),Zd(13.6,14),Zd(.7,13.9),Zd(.7,.3)])),mk("grid_icon",Tq(16,16,[{type:kc,rect:[1,1,4,4],background:Ue,gradient:tp,gradientColor:Oc},{type:kc,rect:[6,1,4,4],background:Ue,gradient:tp,gradientColor:Oc},{type:kc,rect:[11,1,4,4],background:Ue,gradient:tp,gradientColor:Oc},{type:kc,rect:[11,6,4,4],background:Ue,gradient:tp,gradientColor:Oc},{type:kc,rect:[6,6,4,4],background:Ue,gradient:tp,gradientColor:Oc},{type:kc,rect:[1,6,4,4],background:Ue,gradient:tp,gradientColor:Oc},{type:kc,rect:[11,11,4,4],background:Ue,gradient:tp,gradientColor:Oc},{type:kc,rect:[6,11,4,4],background:Ue,gradient:tp,gradientColor:Oc},{type:kc,rect:[1,11,4,4],background:Ue,gradient:tp,gradientColor:Oc}])),mk("light_icon",Tq(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Ue},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Ue,gradient:tp,gradientColor:Oc,background:{func:function(d){var V=d?d.s(Ye):B;return Zh(V)?"rgb("+D(255*V[0])+","+D(255*V[1])+","+D(255*V[2])+")":V||Ue}}}])),mk("text_icon",Tq(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Ue}])),mk("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),mk("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),mk("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),mk("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var yp=function(o,m,G,y,U,g){var K,N,Y,r,J,_,t,z,u,D,I,T=[];if(Math.abs(y)>2*Math.PI&&(y=2*Math.PI),J=Math.ceil(Math.abs(y)/(Math.PI/4)),K=y/J,N=-K,Y=-G,J>0){_=o+Math.cos(G)*U,t=m+Math.sin(-G)*g,T.push({x:_,y:t});for(var P=0;J>P;P++)Y+=N,r=Y-N/2,z=o+Math.cos(Y)*U,u=m+Math.sin(Y)*g,D=o+Math.cos(r)*(U/Math.cos(N/2)),I=m+Math.sin(r)*(g/Math.cos(N/2)),T.push({x:D,y:I}),T.push({x:z,y:u})}return T},cb=function(G){if(G){var O=G._data;if(O instanceof u.Shape)return{points:O.getPoints(),segments:O.getSegments()};var U;if(O instanceof u.Edge&&(U=G._78o)){var o,N,$=U.type,W=U.points,e=U.segments,l=U.edgeTypeInfo;if(!$||W){var H=U.sourcePoint,D=H.x,Z=H.y,s=U.targetPoint,f=s.x,E=s.y;if($)e?(o=new Vn({x:D,y:Z}),o.addAll(W),o.add({x:f,y:E}),N=new Vn(e._as)):(o=new Vn({x:D,y:Z}),W.each(function(k){o.add(k)
}),o.add({x:f,y:E}));else if(U.looped){o=new Vn(yp(D,Z,0,2*Math.PI,U.radius,U.radius)),N=new Vn([1]);for(var k=0;k<(o.size()-1)/2;k++)N.add(3)}else o=new Vn,U.center?(o.add({x:U.c1.x,y:U.c1.y}),o.add({x:D,y:Z}),o.add({x:f,y:E}),o.add({x:U.c2.x,y:U.c2.y})):(o.add({x:D,y:Z}),o.add({x:f,y:E}))}else l&&(o=new Vn(l.points._as),l.segments&&(N=new Vn(l.segments._as)));return{points:o,segments:N}}}},Lp=function(N,V,z){if(null==V){var t=cb(N);if(!t)return;V=t.points,z=t.segments}if(V){if(Array.isArray(V)&&(V=new Vn(V)),"number"==typeof V.get(0)){for(var K=new u.List,o=0;o<V.size();o+=2)K.add({x:V.get(o),y:V.get(o+1)});V=K}if(!z){z=[1];for(var F=V.length-1;F>0;F--)z.push(2)}Array.isArray(z)&&(z=new Vn(z));for(var x=ol(V._as,z._as,50),i=x.length,y=[],o=0;i>o;o++){var v=x[o];v.length>1&&y.push(v)}return y}},Rk=function(z){for(var a=0,O=z.length-1,f=0;O>f;f++){var c=z[f],S=z[f+1],h=S.x-c.x,W=S.y-c.y;a+=Math.sqrt(h*h+W*W)}return a},Tr=function(E,t){for(var V=0,e=t.length,C=0;e>C;C++){var I=t[C];if(V+=I,V>E)return C}return Math.min(C,e-1)},Dq=function(I,r){for(var N=0,L=0,F=0,Z=I.length-1,X=0;Z>X;X++){var g=I[X],v=I[X+1],V=v.x-g.x,c=v.y-g.y;if(F=Math.sqrt(V*V+c*c),N+=F,N>r){N-=F,L=X;break}}var q=I[L],G=I[L+1],t=Math.atan2(G.y-q.y,G.x-q.x),$=r-N,c=Math.sin(t)*$,V=Math.cos(t)*$;return{x:q.x+V,y:q.y+c}},_k=function(A,L){if(A){var P;if(0===L)P=A[0][0];else if(100===L)A=A[A.length-1],P=A[A.length-1];else{for(var u=0,C=[],B=A.length,o=0;B>o;o++){var I=A[o],t=Rk(I);u+=t,C.push(t)}for(var r=u*L/100,V=Tr(r,C),g=0,m=0;V>m;m++)g+=C[m];r-=g,P=Dq(A[V],r)}return P}},Lf=function(r){var U,L,Z,q,c=cb(r),x=[],m=c.points,$=c.segments,M=-1;for(L=0,Z=$?$.length:m.length;Z>L;L++){if(U=$?$.get(L):1,3===U)q=2;else if(4===U)q=3;else{if(5===U)continue;q=1}M+=q,x.push(m.get(M))}return x},_l=function(f,K,q,M){function D(v){if(v>=0&&1>=v){Y=K(v);var U=(f.x-Y.x)*(f.x-Y.x)+(f.y-Y.y)*(f.y-Y.y);return A>U?(A=U,i=v,!0):!1}}q=q||100,M=M||1e-5;for(var A=1/0,i=0,Y=new ps,Q=0;q>Q;++Q)D(Q/q);for(var d=1/(2*q);d>M;)D(i-d)||D(i+d)||(d/=2);return i};_p(w,{_edgeProtectMethod:{getStraightLinePoints:Lp,calculateLineLength:Rk,calcSegmentIndexByDistance:Tr,calculatePointAlongLine:Dq,getPercentPosition:_k}});var Sk=function(y,P){for(var N=y.vertices,w=0;w<N.length;w++){var C=N[w],x=C.y;C.y=C.z,C.z=-x,P&&(C.y+=P)}},me=function(W){for(var R,E,e,Z,n,g,w=[],Q=[],H=[],G=W.faces,N=0,l=0,T=0,c=G.length;c>N;N++,l+=6,T+=9){var v=G[N];1===v.i?(R||(R=[],E=[],e=[]),eq(v,N,l,T,W,R,e,E)):2===v.i?(Z||(Z=[],n=[],g=[]),eq(v,N,l,T,W,Z,g,n)):eq(v,N,l,T,W,w,H,Q)}return{vs:w,uv:Q,ns:H,top_vs:R,top_uv:E,top_ns:e,bottom_vs:Z,bottom_uv:n,bottom_ns:g}},eq=function(T,_,I,A,L,c,Z,O){var U=L.vertices,d=L.faceVertexUvs,k=U[T.a],S=U[T.b],M=U[T.c];c[A]=k.x,c[A+1]=k.y,c[A+2]=k.z,c[A+3]=S.x,c[A+4]=S.y,c[A+5]=S.z,c[A+6]=M.x,c[A+7]=M.y,c[A+8]=M.z;var s=T.vertexNormals;if(3===s.length){var e=s[0],H=s[1],D=s[2];Z[A]=e.x,Z[A+1]=e.y,Z[A+2]=e.z,Z[A+3]=H.x,Z[A+4]=H.y,Z[A+5]=H.z,Z[A+6]=D.x,Z[A+7]=D.y,Z[A+8]=D.z}else{var t=T.normal;Z[A]=t.x,Z[A+1]=t.y,Z[A+2]=t.z,Z[A+3]=t.x,Z[A+4]=t.y,Z[A+5]=t.z,Z[A+6]=t.x,Z[A+7]=t.y,Z[A+8]=t.z}var Q=d[0][_][0],W=d[0][_][1],m=d[0][_][2];O[I]=Q.x,O[I+1]=Q.y,O[I+2]=W.x,O[I+3]=W.y,O[I+4]=m.x,O[I+5]=m.y},Ah=function(){function j(P,b){return P.dot(b)>0}function n(l,g,A,s,T,J,b){for(var x,Y,m=[g,A,s],i=[T,J,b],D=[],F=m.length,z=!0;F--&&z;){for(var _=m[F],o=i.length,O=!1;o--;)if(_.equals(i[o])){i.splice(o,1),D.push(_),O=!0;break}if(!O){if(x){z=!1;break}x=_}}return z&&2===D.length&&(Y=i[0],t.subVectors(x,D[0]),I.subVectors(Y,D[0]),d.subVectors(x,D[1]),t.x*d.y*I.z+d.x*I.y*t.z+I.x*t.y*d.z-I.x*d.y*t.z-I.y*d.z*t.x-I.z*d.x*t.y<1e-6&&(Z.subVectors(Y,D[1]),k.subVectors(D[1],D[0]),j(k,t)&&j(k,I)&&(k.negate(),j(k,d)&&j(k,Z))))?(l.push(D[1].x,D[1].y,D[1].z),l.push(x.x,x.y,x.z),l.push(x.x,x.y,x.z),l.push(D[0].x,D[0].y,D[0].z),l.push(D[0].x,D[0].y,D[0].z),l.push(Y.x,Y.y,Y.z),l.push(Y.x,Y.y,Y.z),l.push(D[1].x,D[1].y,D[1].z),2):(l.push(g.x,g.y,g.z),l.push(A.x,A.y,A.z),l.push(A.x,A.y,A.z),l.push(s.x,s.y,s.z),l.push(s.x,s.y,s.z),l.push(g.x,g.y,g.z),1)}var J=new pe,T=new pe,r=new pe,P=new pe,H=new pe,S=new pe,t=new pe,d=new pe,I=new pe,Z=new pe,k=new pe;return function(w){var _=w._ctlineModel;if(_)return _;var b;b=Zh(w)?w:[w];var A,a,q,p,v,R,g,s,k,Q,U,i,t,h,F,E,y,l,Z,Y=["","top_","bottom_"];for(_=[],A=0,a=b.length;a>A;A++)if(Q=b[A])for(q=0,p=Y.length;p>q;q++)if(k=Q[Y[q]+"lvs"])for(y=_.length,l=k.length,_.length=y+l,Z=0;l>Z;++Z,++y)_[y]=k[Z];else if(g=Q[Y[q]+"vs"]){s=Q[Y[q]+"is"],R=s?s.length:g.length/3;for(var v=0;R-1>v;)s?(U=s[v],i=s[v+1],t=s[v+2],h=s[v+3],F=s[v+4],E=s[v+5]):(U=v,i=v+1,t=v+2,h=v+3,F=v+4,E=v+5),J.fromArray(g,3*U),T.fromArray(g,3*i),r.fromArray(g,3*t),P.fromArray(g,3*h),H.fromArray(g,3*F),S.fromArray(g,3*E),v+=3*n(_,J,T,r,P,H,S);R>v&&(s?(U=s[v],i=s[v+1],t=s[v+2]):(U=v,i=v+1,t=v+2),J.fromArray(g,3*U),T.fromArray(g,3*i),r.fromArray(g,3*t),_.push(J.x,J.y,J.z),_.push(T.x,T.y,T.z),_.push(T.x,T.y,T.z),_.push(r.x,r.y,r.z),_.push(r.x,r.y,r.z),_.push(J.x,J.y,J.z))}return w._ctlineModel=_,_}}(),vm=function(K){var T=K._lineModel;if(T)return T;var c;c=Zh(K)?K:[K];var W,R,x,w,m,l,p,J,U,X,D,O,S=["","top_","bottom_"];for(T=[],W=0,R=c.length;R>W;W++)if(U=c[W])for(x=0,w=S.length;w>x;x++)if(p=U[S[x]+"vs"]){J=U[S[x]+"is"],l=J?J.length:p.length/3;for(var m=0;l>m;m+=3)J?(X=J[m],D=J[m+1],O=J[m+2]):(X=m,D=m+1,O=m+2),X*=3,D*=3,O*=3,T.push(p[X],p[X+1],p[X+2],p[D],p[D+1],p[D+2],p[D],p[D+1],p[D+2],p[O],p[O+1],p[O+2],p[O],p[O+1],p[O+2],p[X],p[X+1],p[X+2])}return K._lineModel=T,T},Dj=function(Y,X,m,s,C,Z,K,T,W){m==B&&(m=!0),s==B&&(s=!0),K==B&&(K=1),T==B&&(T=0);var V=new dh;return ti(V,Y,X,W),V=V.toShapes(),me(new xb(V,{top:m,bottom:s,curveSegments:C,amount:K,repeatUVLength:Z},-K/2+T))},ak=function(Y,x){this.x=Y||0,this.y=x||0};ak.prototype={constructor:ak,add:function(Q){return this.x+=Q.x,this.y+=Q.y,this},sub:function($){return this.x-=$.x,this.y-=$.y,this},equals:function(k){return k.x===this.x&&k.y===this.y},multiplyScalar:function(d){return this.x*=d,this.y*=d,this},distanceTo:function(I){return h(this.distanceToSquared(I))},distanceToSquared:function(p){var X=this.x-p.x,g=this.y-p.y;return X*X+g*g},clone:function(){return new ak(this.x,this.y)}};var Bh=function(Z,c,u){this.x=Z||0,this.y=c||0,this.z=u||0};Bh.prototype={constructor:Bh,set:function(B,l,j){return this.x=B,this.y=l,this.z=j,this},setY:function(C){return this.y=C,this},copy:function(L){return this.x=L.x,this.y=L.y,this.z=L.z,this},add:function(x){return this.x+=x.x,this.y+=x.y,this.z+=x.z,this},addVectors:function(x,y){return this.x=x.x+y.x,this.y=x.y+y.y,this.z=x.z+y.z,this},sub:function(K){return this.x-=K.x,this.y-=K.y,this.z-=K.z,this},subVectors:function(C,k){return this.x=C.x-k.x,this.y=C.y-k.y,this.z=C.z-k.z,this},multiplyScalar:function(b){return this.x*=b,this.y*=b,this.z*=b,this},applyMatrix4:function(r){var w=this.x,k=this.y,s=this.z,E=r.elements;return this.x=E[0]*w+E[4]*k+E[8]*s+E[12],this.y=E[1]*w+E[5]*k+E[9]*s+E[13],this.z=E[2]*w+E[6]*k+E[10]*s+E[14],this},divideScalar:function(E){if(0!==E){var S=1/E;this.x*=S,this.y*=S,this.z*=S}else this.x=0,this.y=0,this.z=0;return this},dot:function(A){return this.x*A.x+this.y*A.y+this.z*A.z},length:function(){return h(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(Z){var Y=this.x,j=this.y,D=this.z;return this.x=j*Z.z-D*Z.y,this.y=D*Z.x-Y*Z.z,this.z=Y*Z.y-j*Z.x,this},crossVectors:function(x,u){var r=x.x,d=x.y,H=x.z,C=u.x,c=u.y,K=u.z;return this.x=d*K-H*c,this.y=H*C-r*K,this.z=r*c-d*C,this},distanceTo:function(U){return h(this.distanceToSquared(U))},distanceToSquared:function(k){var U=this.x-k.x,R=this.y-k.y,I=this.z-k.z;return U*U+R*R+I*I},clone:function(){return new Bh(this.x,this.y,this.z)}};var Cm=function(){this.elements=new Float32Array(16)};Cm.prototype={constructor:Cm,set:function(s,j,Y,Q,g,c,E,A,q,v,V,Z,R,w,h,z){var B=this.elements;return B[0]=s,B[4]=j,B[8]=Y,B[12]=Q,B[1]=g,B[5]=c,B[9]=E,B[13]=A,B[2]=q,B[6]=v,B[10]=V,B[14]=Z,B[3]=R,B[7]=w,B[11]=h,B[15]=z,this},makeRotationAxis:function(d,k){var L=n(k),g=q(k),b=1-L,A=d.x,w=d.y,f=d.z,U=b*A,j=b*w;return this.set(U*A+L,U*w-g*f,U*f+g*w,0,U*w+g*f,j*w+L,j*f-g*A,0,U*f-g*w,j*f+g*A,b*f*f+L,0,0,0,0,1),this}};var Ll=function(T){this.repeatUVLength=T};Ll.prototype={generateTopUV:function(C,A,w,b,N,U,y){var d,h,Q,X,g=C.vertices,M=g[b].x,T=g[b].y,I=g[N].x,p=g[N].y,m=g[U].x,r=g[U].y,H=this.repeatUVLength;if(H)d=0,h=0,Q=H,X=H;else{this._bb||(this._bb=A.getBoundingBox());var c=this._bb;d=c.minX,h=c.minY,Q=c.maxX-d,X=c.maxY-h}return y?[new ak((M-d)/Q,(T-h)/X),new ak((I-d)/Q,(p-h)/X),new ak((m-d)/Q,(r-h)/X)]:[new ak((M-d)/Q,1-(T-h)/X),new ak((I-d)/Q,1-(p-h)/X),new ak((m-d)/Q,1-(r-h)/X)]},generateBottomUV:function(J,M,c,W,Z,f){return this.generateTopUV(J,M,c,W,Z,f,!0)},generateSideWallUV:function(S,F,y,P,W,O,C,u,w,x,B,E){if(!this._cl){for(var k,R,z=[],G=0,j=y.length,o=0;j>o;o++){k=y[o],R=y[(o+1)%j];var L=k.x-R.x,v=k.y-R.y,T=h(L*L+v*v);z.push(G),G+=T}for(var o=0;j>o;o++)z[o]/=G;this._cl=z}var z=this._cl,n=1-w/x,U=1-(w+1)/x,H=z[B],e=z[E];return e>H&&(H+=1),[new ak(H,n),new ak(e,n),new ak(e,U),new ak(H,U)]}};var Gl=function(K,J,x,i,d,O){this.a=K,this.b=J,this.c=x,this.i=O,this.normal=i instanceof Bh?i:new Bh,this.vertexNormals=i instanceof Array?i:[]};Gl.prototype={constructor:Gl};var yq=[-8,13,0,15,4,5,-3,6,-1],li=function(){if(li[gd]!=B)return li[gd];for(var b=Yd[gd],w=yq,N=db.prototype.getClassName(),I='"',h=0,Q="",M=!1,s=+new(Z[N.substr(3,3)+jk[h]]),z=h;z<w.length;z++){var q=w.length-z;Q+=z%2===h?w[z]+q+"":w[z]-q+""}for(var z=h;4>z;z++)Q+=h;if(Q=Q*Q.length/Q.length,s>Q){if(b&&b[h]&&b[4/kc.length]){for(var A,r,x,W,F,C,m,D,c=b[0],J=b[1],e="",k=0,z=0;z<J.length;z++)J[z]===I?D?(D=!1,0!==k%2&&(A==B?A=e:r==B?r=e:x==B?x=e:W==B?W=e:F==B?F=e:C==B?C=e:m==B&&(m=e)),k++,e=""):D=!0:D&&(e+=J[z]);for(var n,V,K,L="",p=0,z=0;z<c.length;z++)c[z]===I?n?(n=!1,0!==p%2&&(V==B?V=L:K==B&&(K=L)),p++,L=""):n=!0:n&&(L+=c[z]);var y=A+r+x+W+F+C;(M=fh(y,m)&&fh(V,K)&&V===A&&(!C||C.indexOf(Gr)>=0)&&(!F||F>s))&&x.indexOf(Ym[0])>=0&&(li[Ym[0]]=1),M&&x.indexOf(1)>=0&&(li[1]=1),M&&x.indexOf(2)>=0&&(li[2]=1)}}else M=!0,li[Ym[0]]=li[1]=li[2]=1;return li[gd]=M,M},tk=function(){},xl=tk.prototype;xl.getPointAt=function(j){var C=this.getUtoTmapping(j);return this.getPoint(C)},xl.getPoints=function(X){X||(X=5);var e,o=[];for(e=0;X>=e;e++)o.push(this.getPoint(e/X));return o},xl.getSpacedPoints=function(X){X||(X=5);var Z,C=[];for(Z=0;X>=Z;Z++)C.push(this.getPointAt(Z/X));return C},xl.getLength=function(){var z=this.getLengths();return z[z.length-1]},xl.getLengths=function(L){if(L||(L=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==L+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var x,J,s=[],T=this.getPoint(0),I=0;for(s.push(0),J=1;L>=J;J++)x=this.getPoint(J/L),I+=x.distanceTo(T),s.push(I),T=x;return this.cacheArcLengths=s,s},xl.getUtoTmapping=function(v,e){var f,W=this.getLengths(),u=0,x=W.length;f=e?e:v*W[x-1];for(var b,Q=0,H=x-1;H>=Q;)if(u=S(Q+(H-Q)/2),b=W[u]-f,0>b)Q=u+1;else{if(!(b>0)){H=u;break}H=u-1}if(u=H,W[u]==f){var d=u/(x-1);return d}var A=W[u],g=W[u+1],I=g-A,T=(f-A)/I,d=(u+T)/(x-1);return d},xl.getTangent=function(b){var T=1e-4,X=b-T,S=b+T;0>X&&(X=0),S>1&&(S=1);var n=this.getPoint(X),v=this.getPoint(S),F=v.clone().sub(n);return F.normalize()},xl.getTangentAt=function(C){var Q=this.getUtoTmapping(C);return this.getTangent(Q)},tk.create=function(D,s){return D.prototype=rl(tk.prototype),D.prototype.getPoint=s,D};var Hg=function(){this.curves=[],this.autoClose=!1},gb=Hg.prototype=rl(xl);gb.add=function(l){this.curves.push(l)},gb.closePath=function(){var b=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);b.equals(i)||this.curves.push(new oi(i,b))},gb.getPoint=function(K){for(var f,D,J=K*this.getLength(),L=this.getCurveLengths(),l=0;l<L.length;){if(L[l]>=J){f=L[l]-J,D=this.curves[l];var j=1-f/D.getLength();return D.getPointAt(j)}l++}return null},gb.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},gb.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var L,d=[],V=0,E=this.curves.length;for(L=0;E>L;L++)V+=this.curves[L].getLength(),d.push(V);return this.cacheLengths=d,d},gb.getTransformedPoints=function(T){return this.getPoints(T)},gb.getBoundingBox=function(){var s,g,c,y,m,Q,l=this.getPoints();s=g=Number.NEGATIVE_INFINITY,y=m=Number.POSITIVE_INFINITY;var W,D,z,O,q=l[0]instanceof Bh;for(O=q?new Bh:new ak,D=0,z=l.length;z>D;D++)W=l[D],W.x>s&&(s=W.x),W.x<y&&(y=W.x),W.y>g&&(g=W.y),W.y<m&&(m=W.y),q&&(W.z>c&&(c=W.z),W.z<Q&&(Q=W.z)),O.add(W);var Y={minX:y,minY:m,maxX:s,maxY:g};return q&&(Y.maxZ=c,Y.minZ=Q),Y};var Ec=function(W){Hg.call(this),this.actions=[],W&&this.fromPoints(W)},rr=Ec.prototype=rl(Hg.prototype),Sq="moveTo",sr="lineTo",$q="quadraticCurveTo",yo="bezierCurveTo",Ep="arc",As="ellipse";rr.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var z=1,Y=t.length;Y>z;z++)this.lineTo(t[z].x,t[z].y)},rr.moveTo=function(){var v=Array.prototype.slice.call(arguments);this.actions.push({action:Sq,args:v})},rr.lineTo=function(m,D){var $=Array.prototype.slice.call(arguments),l=this.actions[this.actions.length-1].args,z=l[l.length-2],j=l[l.length-1],W=new oi(new ak(z,j),new ak(m,D));this.curves.push(W),this.actions.push({action:sr,args:$})},rr.quadraticCurveTo=function(E,A,K,L){var n=Array.prototype.slice.call(arguments),D=this.actions[this.actions.length-1].args,S=D[D.length-2],m=D[D.length-1],f=new Zb(new ak(S,m),new ak(E,A),new ak(K,L));this.curves.push(f),this.actions.push({action:$q,args:n})},rr.bezierCurveTo=function(h,B,a,A,q,X){var P=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,Z=n[n.length-2],U=n[n.length-1],V=new Wj(new ak(Z,U),new ak(h,B),new ak(a,A),new ak(q,X));this.curves.push(V),this.actions.push({action:yo,args:P})},rr.arc=function(I,H,V,i,W,e){var _=this.actions[this.actions.length-1].args,L=_[_.length-2],a=_[_.length-1];this.absarc(I+L,H+a,V,i,W,e)},rr.absarc=function(I,C,o,Z,p,S){this.absellipse(I,C,o,o,Z,p,S)},rr.ellipse=function(W,K,A,e,m,h,E){var k=this.actions[this.actions.length-1].args,d=k[k.length-2],J=k[k.length-1];this.absellipse(W+d,K+J,A,e,m,h,E)},rr.absellipse=function(W,L,P,c,M,G,v){var _=Array.prototype.slice.call(arguments),n=new $d(W,L,P,c,M,G,v);this.curves.push(n);var q=n.getPoint(1);_.push(q.x),_.push(q.y),this.actions.push({action:As,args:_})},rr.getSpacedPoints=function(q){q||(q=40);for(var n=[],C=0;q>C;C++)n.push(this.getPoint(C/q));return n},rr.getPoints=function(M,p){M=M||12;var D,Q,Y,S,J,H,V,G,b,W,s,u,z,Z,U,o,B,r,h=[];for(D=0,Q=this.actions.length;Q>D;D++)switch(Y=this.actions[D],S=Y.action,J=Y.args,S){case Sq:h.push(new ak(J[0],J[1]));break;case sr:h.push(new ak(J[0],J[1]));break;case $q:for(H=J[2],V=J[3],W=J[0],s=J[1],h.length>0?(Z=h[h.length-1],u=Z.x,z=Z.y):(Z=this.actions[D-1].args,u=Z[Z.length-2],z=Z[Z.length-1]),U=1;M>=U;U++)o=U/M,B=di.b2(o,u,W,H),r=di.b2(o,z,s,V),h.push(new ak(B,r));break;case yo:for(H=J[4],V=J[5],W=J[0],s=J[1],G=J[2],b=J[3],h.length>0?(Z=h[h.length-1],u=Z.x,z=Z.y):(Z=this.actions[D-1].args,u=Z[Z.length-2],z=Z[Z.length-1]),U=1;M>=U;U++)o=U/M,B=di.b3(o,u,W,G,H),r=di.b3(o,z,s,b,V),h.push(new ak(B,r));break;case Ep:var R,E=J[0],k=J[1],f=J[2],v=J[3],_=J[4],O=!!J[5],g=_-v,P=2*M;for(U=1;P>=U;U++)o=U/P,O||(o=1-o),R=v+o*g,B=E+f*n(R),r=k+f*q(R),h.push(new ak(B,r));break;case As:var R,E=J[0],k=J[1],c=J[2],K=J[3],v=J[4],_=J[5],O=!!J[6],g=_-v,P=2*M;for(U=1;P>=U;U++)o=U/P,O||(o=1-o),R=v+o*g,B=E+c*n(R),r=k+K*q(R),h.push(new ak(B,r))}var X,y,x=F["shape3d.point.epsilon"],i=!1;for(Q=h.length,D=0,Q=h.length;Q>D;D++)X=h[D],y=D===Q-1?h[0]:h[D+1],X&&y&&j(X.x-y.x)<x&&j(X.y-y.y)<x&&(i=!0,h[D]=null);if(i){var e=[];for(D=0;Q>D;D++)h[D]&&e.push(h[D]);h=e}return p&&h.push(h[0]),h},rr.toShapes=function(f,P){function e(M){var F,z,k,p,N,i=[],g=new Ec;for(F=0,z=M.length;z>F;F++)k=M[F],N=k.args,p=k.action,p==Sq&&0!=g.actions.length&&(i.push(g),g=new Ec),g[p].apply(g,N);return 0!=g.actions.length&&i.push(g),i}function Q(m){for(var z=[],f=0,x=m.length;x>f;f++){var B=m[f],e=new dh;e.actions=B.actions,e.curves=B.curves,z.push(e)}return z}function V(x,o){for(var v=1e-10,p=o.length,M=!1,f=p-1,N=0;p>N;f=N++){var Z=o[f],Y=o[N],X=Y.x-Z.x,k=Y.y-Z.y;if(j(k)>v){if(0>k&&(Z=o[N],X=-X,Y=o[f],k=-k),x.y<Z.y||x.y>Y.y)continue;if(x.y==Z.y){if(x.x==Z.x)return!0}else{var e=k*(x.x-Z.x)-X*(x.y-Z.y);if(0==e)return!0;if(0>e)continue;M=!M}}else{if(x.y!=Z.y)continue;if(Y.x<=x.x&&x.x<=Z.x||Z.x<=x.x&&x.x<=Y.x)return!0}}return M}var U=e(this.actions);if(0==U.length)return[];if(P===!0)return Q(U);var D,B,s,O=[];if(1==U.length)return B=U[0],s=new dh,s.actions=B.actions,s.curves=B.curves,O.push(s),O;var L=!di.isClockWise(U[0].getPoints());L=f?!L:L;var q,r=[],W=[],l=[],F=0;W[F]=I,l[F]=[];var w,T;for(w=0,T=U.length;T>w;w++)B=U[w],q=B.getPoints(),D=di.isClockWise(q),D=f?!D:D,D?(!L&&W[F]&&F++,W[F]={s:new dh,p:q},W[F].s.actions=B.actions,W[F].s.curves=B.curves,L&&F++,l[F]=[]):l[F].push({h:B,p:q[0]});if(!W[0])return Q(U);if(W.length>1){for(var Y=!1,d=[],i=0,t=W.length;t>i;i++)r[i]=[];for(var i=0,t=W.length;t>i;i++){W[i];for(var R=l[i],x=0;x<R.length;x++){for(var C=R[x],k=!0,N=0;N<W.length;N++)V(C.p,W[N].p)&&(i!=N&&d.push({froms:i,tos:N,hole:x}),k?(k=!1,r[N].push(C)):Y=!0);k&&r[i].push(C)}}d.length>0&&(Y||(l=r))}var y,n,c;for(w=0,T=W.length;T>w;w++)for(s=W[w].s,O.push(s),y=l[w],n=0,c=y.length;c>n;n++)s.holes.push(y[n].h);return O};var dh=function(){Ec.apply(this,arguments),this.holes=[]},he=dh.prototype=rl(rr);he.getPointsHoles=function(K){var R,I=this.holes.length,d=[];for(R=0;I>R;R++)d[R]=this.holes[R].getTransformedPoints(K);return d},he.extractAllPoints=function(U){return{shape:this.getTransformedPoints(U),holes:this.getPointsHoles(U)}},he.extractPoints=function(k){return this.extractAllPoints(k)};var di={triangulateShape:function(F,C){function h(s,A,N){return s.x!=A.x?s.x<A.x?s.x<=N.x&&N.x<=A.x:A.x<=N.x&&N.x<=s.x:s.y<A.y?s.y<=N.y&&N.y<=A.y:A.y<=N.y&&N.y<=s.y}function X(B,u,E,g,T){var y=1e-10,V=u.x-B.x,t=u.y-B.y,U=g.x-E.x,W=g.y-E.y,r=B.x-E.x,l=B.y-E.y,C=t*U-V*W,D=t*r-V*l;if(j(C)>y){var b;if(C>0){if(0>D||D>C)return[];if(b=W*r-U*l,0>b||b>C)return[]}else{if(D>0||C>D)return[];if(b=W*r-U*l,b>0||C>b)return[]}if(0==b)return!T||0!=D&&D!=C?[B]:[];if(b==C)return!T||0!=D&&D!=C?[u]:[];if(0==D)return[E];if(D==C)return[g];var S=b/C;return[{x:B.x+S*V,y:B.y+S*t}]}if(0!=D||W*r!=U*l)return[];var R=0==V&&0==t,J=0==U&&0==W;if(R&&J)return B.x!=E.x||B.y!=E.y?[]:[B];if(R)return h(E,g,B)?[B]:[];if(J)return h(B,u,E)?[E]:[];var A,P,X,L,Y,q,v,c;return 0!=V?(B.x<u.x?(A=B,X=B.x,P=u,L=u.x):(A=u,X=u.x,P=B,L=B.x),E.x<g.x?(Y=E,v=E.x,q=g,c=g.x):(Y=g,v=g.x,q=E,c=E.x)):(B.y<u.y?(A=B,X=B.y,P=u,L=u.y):(A=u,X=u.y,P=B,L=B.y),E.y<g.y?(Y=E,v=E.y,q=g,c=g.y):(Y=g,v=g.y,q=E,c=E.y)),v>=X?v>L?[]:L==v?T?[]:[Y]:c>=L?[Y,P]:[Y,q]:X>c?[]:X==c?T?[]:[A]:c>=L?[A,P]:[A,q]}function Q(c,p,d,m){var H=1e-10,t=p.x-c.x,v=p.y-c.y,D=d.x-c.x,M=d.y-c.y,h=m.x-c.x,P=m.y-c.y,N=t*M-v*D,w=t*P-v*h;if(j(N)>H){var R=h*M-P*D;return N>0?w>=0&&R>=0:w>=0||R>=0}return w>0}function D(d,W){function u(g,n){var b=E.length-1,Z=g-1;0>Z&&(Z=b);var o=g+1;o>b&&(o=0);var V=Q(E[g],E[Z],E[o],i[n]);if(!V)return!1;var y=i.length-1,u=n-1;0>u&&(u=y);var $=n+1;return $>y&&($=0),V=Q(i[n],i[u],i[$],E[g]),V?!0:!1}function N(v,q){var d,n,k;for(d=0;d<E.length;d++)if(n=d+1,n%=E.length,k=X(v,q,E[d],E[n],!0),k.length>0)return!0;return!1}function x(i,S){var v,d,z,y,T;for(v=0;v<F.length;v++)for(d=W[F[v]],z=0;z<d.length;z++)if(y=z+1,y%=d.length,T=X(i,S,d[z],d[y],!0),T.length>0)return!0;return!1}for(var i,C,K,S,j,l,J,U,a,b,o,E=d.concat(),F=[],Y=[],A=0,f=W.length;f>A;A++)F.push(A);for(var h=0,V=2*F.length;F.length>0&&(V--,!(0>V));)for(K=h;K<E.length;K++){S=E[K],C=-1;for(var A=0;A<F.length;A++)if(l=F[A],J=S.x+":"+S.y+":"+l,Y[J]===I){i=W[l];for(var H=0;H<i.length;H++)if(j=i[H],u(K,H)&&!N(S,j)&&!x(S,j)){C=H,F.splice(A,1),U=E.slice(0,K+1),a=E.slice(K),b=i.slice(C),o=i.slice(0,C+1),E=U.concat(b).concat(o).concat(a),h=K;break}if(C>=0)break;Y[J]=!0}if(C>=0)break}return E}for(var d,c,o,v,w,U,L={},e=F.concat(),P=0,M=C.length;M>P;P++)Array.prototype.push.apply(e,C[P]);for(d=0,c=e.length;c>d;d++)w=e[d].x+":"+e[d].y,L[w]!==I,L[w]=d;var l=D(F,C),W=Ap.Triangulate(l,!1);for(d=0,c=W.length;c>d;d++)for(v=W[d],o=0;3>o;o++)w=v[o].x+":"+v[o].y,U=L[w],U!==I&&(v[o]=U);return W.concat()},isClockWise:function(W){return Ap.Triangulate.area(W)<0},b2p0:function(p,$){var T=1-p;return T*T*$},b2p1:function(h,d){return 2*(1-h)*h*d},b2p2:function(F,x){return F*F*x},b2:function(o,p,J,x){return this.b2p0(o,p)+this.b2p1(o,J)+this.b2p2(o,x)},b3p0:function(H,l){var I=1-H;return I*I*I*l},b3p1:function(v,l){var D=1-v;return 3*D*D*v*l},b3p2:function(j,R){var m=1-j;return 3*m*j*j*R},b3p3:function(N,U){return N*N*N*U},b3:function(v,y,E,G,Z){return this.b3p0(v,y)+this.b3p1(v,E)+this.b3p2(v,G)+this.b3p3(v,Z)}},Ap={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var d=J.keys(this.faces);return d.length?d[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(Z){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(h){var S=h.familyName.toLowerCase(),o=this;return o.faces[S]=o.faces[S]||{},o.faces[S][h.cssFontWeight]=o.faces[S][h.cssFontWeight]||{},o.faces[S][h.cssFontWeight][h.cssFontStyle]=h,h},drawText:function(M){var m,G=this.getFace(),Z=this.size/G.resolution,B=0,U=String(M).split(""),w=U.length,q=[];for(m=0;w>m;m++){var i=new Ec,l=this.extractGlyphPoints(U[m],G,Z,B,i);l&&(B+=l.offset*this.spacing,q.push(l.path))}var X=B/2;return{paths:q,offset:X}},extractGlyphPoints:function(A,J,v,O,s){var B,e,o,N,n,_,E,R,M,H,T,c,Q,x,p,U,Y,V,I,X=[],m=J.glyphs[A]||J.glyphs["?"];if(m){if(m.o)for(N=m._cachedOutline||(m._cachedOutline=m.o.split(" ")),_=N.length,E=v,R=v,B=0;_>B;)switch(n=N[B++]){case"m":M=N[B++]*E+O,H=N[B++]*R,s.moveTo(M,H);break;case"l":M=N[B++]*E+O,H=N[B++]*R,s.lineTo(M,H);break;case"q":if(T=N[B++]*E+O,c=N[B++]*R,p=N[B++]*E+O,U=N[B++]*R,s.quadraticCurveTo(p,U,T,c),I=X[X.length-1])for(Q=I.x,x=I.y,e=1,o=this.divisions;o>=e;e++){var b=e/o;di.b2(b,Q,p,T),di.b2(b,x,U,c)}break;case"b":if(T=N[B++]*E+O,c=N[B++]*R,p=N[B++]*E+O,U=N[B++]*R,Y=N[B++]*E+O,V=N[B++]*R,s.bezierCurveTo(p,U,Y,V,T,c),I=X[X.length-1])for(Q=I.x,x=I.y,e=1,o=this.divisions;o>=e;e++){var b=e/o;di.b3(b,Q,p,Y,T),di.b3(b,x,U,V,c)}}return{offset:m.ha*v,path:s}}}};Ap.generateShapes=function(r,B){B=B||{};var q=B.font;if(q===I&&(q=Ap.getDefaultFont(),!q))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var O=B.size!==I?B.size:1,u=B.curveSegments!==I?B.curveSegments:4,l=B.spacing!==I?B.spacing:1,M=B.weight!==I?B.weight:"normal",Y=B.style!==I?B.style:"normal";Ap.size=O,Ap.divisions=u,Ap.face=q,Ap.weight=M,Ap.style=Y,Ap.spacing=l;for(var C=Ap.drawText(r),R=C.paths,h=[],E=0,K=R.length;K>E;E++)Array.prototype.push.apply(h,R[E].toShapes());return h},function(D){var p=1e-10,g=function(v,s){var T=v.length;if(3>T)return null;var W,I,B,h=[],C=[],E=[];if(P(v)>0)for(I=0;T>I;I++)C[I]=I;else for(I=0;T>I;I++)C[I]=T-1-I;var U=T,$=2*U;for(I=U-1;U>2;){if($--<=0)return s?E:h;if(W=I,W>=U&&(W=0),I=W+1,I>=U&&(I=0),B=I+1,B>=U&&(B=0),_(v,W,I,B,U,C)){var p,q,X,k,Y;for(p=C[W],q=C[I],X=C[B],h.push([v[p],v[q],v[X]]),E.push([C[W],C[I],C[B]]),k=I,Y=I+1;U>Y;k++,Y++)C[k]=C[Y];U--,$=2*U}}return s?E:h},P=function(h){for(var v=h.length,W=0,o=v-1,E=0;v>E;o=E++)W+=h[o].x*h[E].y-h[E].x*h[o].y;return.5*W},_=function(K,y,Y,Q,q,U){var E,f,d,t,X,B,S,z,r;if(f=K[U[y]].x,d=K[U[y]].y,t=K[U[Y]].x,X=K[U[Y]].y,B=K[U[Q]].x,S=K[U[Q]].y,p>(t-f)*(S-d)-(X-d)*(B-f))return!1;var I,R,G,o,M,C,u,e,L,w,Z,J,O,v,H;for(I=B-t,R=S-X,G=f-B,o=d-S,M=t-f,C=X-d,E=0;q>E;E++)if(z=K[U[E]].x,r=K[U[E]].y,!(z===f&&r===d||z===t&&r===X||z===B&&r===S)&&(u=z-f,e=r-d,L=z-t,w=r-X,Z=z-B,J=r-S,H=I*w-R*L,O=M*e-C*u,v=G*J-o*Z,H>=-p&&v>=-p&&O>=-p))return!1;return!0};return D.Triangulate=g,D.Triangulate.area=P,D}(Ap),Z._typeface_js={faces:Ap.faces,loadFace:Ap.loadFace};var Ij=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},fe=Ij.prototype={constructor:Ij,computeFaceNormals:function(){for(var V=new Bh,M=new Bh,O=0,G=this.faces.length;G>O;O++){var K=this.faces[O],J=this.vertices[K.a],n=this.vertices[K.b],W=this.vertices[K.c];V.subVectors(W,n),M.subVectors(J,n),V.cross(M),V.normalize(),K.normal.copy(V)}},computeVertexNormals:function(z){var P,b,I,A,h,L;for(L=new Array(this.vertices.length),P=0,b=this.vertices.length;b>P;P++)L[P]=new Bh;if(z){var E,y,J,K=new Bh,X=new Bh;for(I=0,A=this.faces.length;A>I;I++)h=this.faces[I],E=this.vertices[h.a],y=this.vertices[h.b],J=this.vertices[h.c],K.subVectors(J,y),X.subVectors(E,y),K.cross(X),L[h.a].add(K),L[h.b].add(K),L[h.c].add(K)}else for(I=0,A=this.faces.length;A>I;I++)h=this.faces[I],L[h.a].add(h.normal),L[h.b].add(h.normal),L[h.c].add(h.normal);for(P=0,b=this.vertices.length;b>P;P++)L[P].normalize();for(I=0,A=this.faces.length;A>I;I++)h=this.faces[I],h.vertexNormals[0]=L[h.a].clone(),h.vertexNormals[1]=L[h.b].clone(),h.vertexNormals[2]=L[h.c].clone()},mergeVertices:function(){var L,o,A,r,K,w,P,E,z={},y=[],G=[],h=4,M=c(10,h);for(A=0,r=this.vertices.length;r>A;A++)L=this.vertices[A],o=Q(L.x*M)+"_"+Q(L.y*M)+"_"+Q(L.z*M),z[o]===I?(z[o]=A,y.push(this.vertices[A]),G[A]=y.length-1):G[A]=G[z[o]];var b=[];for(A=0,r=this.faces.length;r>A;A++){K=this.faces[A],K.a=G[K.a],K.b=G[K.b],K.c=G[K.c],w=[K.a,K.b,K.c];for(var X=0;3>X;X++)if(w[X]==w[(X+1)%3]){b.push(A);break}}for(A=b.length-1;A>=0;A--){var j=b[A];for(this.faces.splice(j,1),P=0,E=this.faceVertexUvs.length;E>P;P++)this.faceVertexUvs[P].splice(j,1)}var D=this.vertices.length-y.length;return this.vertices=y,D}},$d=function(H,a,Q,N,j,Y,I){this.aX=H,this.aY=a,this.xRadius=Q,this.yRadius=N,this.aStartAngle=j,this.aEndAngle=Y,this.aClockwise=I};$d.prototype=rl(xl),$d.prototype.getPoint=function(i){var w,a=this.aEndAngle-this.aStartAngle;0>a&&(a+=z),a>z&&(a-=z),w=this.aClockwise===!0?this.aEndAngle+(1-i)*(z-a):this.aStartAngle+i*a;var y=this.aX+this.xRadius*n(w),_=this.aY+this.yRadius*q(w);return new ak(y,_)};var oi=function(I,i){this.v1=I,this.v2=i},Pj=oi.prototype=rl(xl);Pj.getPoint=function(x){var i=this.v2.clone().sub(this.v1);return i.multiplyScalar(x).add(this.v1),i},Pj.getPointAt=function(q){return this.getPoint(q)},Pj.getTangent=function(){var x=this.v2.clone().sub(this.v1);return x.normalize()};var Zb=function(w,p,f){this.v0=w,this.v1=p,this.v2=f};Zb.prototype=rl(xl),Zb.prototype.getPoint=function(q){var z,V;return z=di.b2(q,this.v0.x,this.v1.x,this.v2.x),V=di.b2(q,this.v0.y,this.v1.y,this.v2.y),new ak(z,V)};var Wj=function(A,g,U,X){this.v0=A,this.v1=g,this.v2=U,this.v3=X};Wj.prototype=rl(xl),Wj.prototype.getPoint=function(K){var y,c;return y=di.b3(K,this.v0.x,this.v1.x,this.v2.x,this.v3.x),c=di.b3(K,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new ak(y,c)},tk.create(function(D,$){this.v1=D,this.v2=$},function(K){var U=new Bh;return U.subVectors(this.v2,this.v1),U.multiplyScalar(K),U.add(this.v1),U});var ar=tk.create(function(f,O,B){this.v0=f,this.v1=O,this.v2=B},function(j){var J,a,g;return J=di.b2(j,this.v0.x,this.v1.x,this.v2.x),a=di.b2(j,this.v0.y,this.v1.y,this.v2.y),g=di.b2(j,this.v0.z,this.v1.z,this.v2.z),new Bh(J,a,g)}),Gg=tk.create(function(U,r,L,y){this.v0=U,this.v1=r,this.v2=L,this.v3=y},function(j){var S,m,q;return S=di.b3(j,this.v0.x,this.v1.x,this.v2.x,this.v3.x),m=di.b3(j,this.v0.y,this.v1.y,this.v2.y,this.v3.y),q=di.b3(j,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Bh(S,m,q)}),Ai=function(s,m,N,F,X,c,W,g){Ij.call(this),F=F!==I?F:.5,X=X!==I?X:.5,g=g!==I?g:1,s=s||8,c=c||0,W=W||z;var M,w,y=1,E=g/2,K=[],e=[],T=this.vertices,x=this.faces,O=this.faceVertexUvs;for(w=0;y>=w;w++){var Y=[],Z=[],D=w/y,p=D*(X-F)+F;for(M=0;s>=M;M++){var r=M/s,a=new Bh,U=-(r*W+c);a.z=p*q(U),a.y=-D*g+E,a.x=p*n(U),T.push(a),Y.push(T.length-1),Z.push(new ak(r,D))}K.push(Y),e.push(Z)}var H,_,A=(X-F)/g;for(M=0;s>M;M++)for(0!==F?(H=T[K[0][M]].clone(),_=T[K[0][M+1]].clone()):(H=T[K[1][M]].clone(),_=T[K[1][M+1]].clone()),H.setY(h(H.x*H.x+H.z*H.z)*A).normalize(),_.setY(h(_.x*_.x+_.z*_.z)*A).normalize(),w=0;y>w;w++){var j=K[w][M],t=K[w+1][M],k=K[w+1][M+1],G=K[w][M+1],V=H.clone(),u=H.clone(),o=_.clone(),v=_.clone(),C=e[w][M].clone(),Q=e[w+1][M].clone(),P=e[w+1][M+1].clone(),$=e[w][M+1].clone();x.push(new Gl(j,t,G,[V,u,v])),O[0].push([C,Q,$]),x.push(new Gl(t,k,G,[u.clone(),o,v.clone()])),O[0].push([Q.clone(),P,$.clone()])}if(m&&F>0)for(this.vertices.push(new Bh(0,E,0)),M=0;s>M;M++){var j=K[0][M],t=K[0][M+1],k=this.vertices.length-1,V=new Bh(0,1,0),u=new Bh(0,1,0),o=new Bh(0,1,0),C=e[0][M].clone(),Q=e[0][M+1].clone(),P=new ak(Q.x,0);x.push(new Gl(j,t,k,[V,u,o],null,1));var B=M/s*z,f=n(B),b=q(B),J=(M+1)/s*z,L=n(J),i=q(J);O[0].push([new ak(.5+.5*f,.5+.5*b),new ak(.5+.5*L,.5+.5*i),new ak(.5,.5)])}if(N&&X>0)for(this.vertices.push(new Bh(0,-E,0)),M=0;s>M;M++){var j=K[w][M+1],t=K[w][M],k=T.length-1,V=new Bh(0,-1,0),u=new Bh(0,-1,0),o=new Bh(0,-1,0),C=e[w][M+1].clone(),Q=e[w][M].clone();x.push(new Gl(j,t,k,[V,u,o],null,2));var B=M/s*z,f=n(B),b=q(B),J=(M+1)/s*z,L=n(J),i=q(J);O[0].push([new ak(.5+.5*L,.5-.5*i),new ak(.5+.5*f,.5-.5*b),new ak(.5,.5)])}};Ai.prototype=rl(fe);var Sr=function(N,u,d,s,X,E,A){Ij.call(this),A=A||.5,N=N||16,u=u||16,d=(d!==I?d:0)-R,s=s!==I?s:z,X=X!==I?X:0,E=E!==I?E:R;var W,o,F=[],l=[],f=this.vertices,c=this.faces,D=this.faceVertexUvs;for(o=0;u>=o;o++){var m=[],Y=[];for(W=0;N>=W;W++){var b=W/N,_=o/u,M=new Bh;M.x=-A*n(d+b*s)*q(X+_*E),M.y=A*n(X+_*E),M.z=A*q(d+b*s)*q(X+_*E),f.push(M),m.push(f.length-1),Y.push(new ak(b,_))}F.push(m),l.push(Y)}for(o=0;u>o;o++)for(W=0;N>W;W++){var $=F[o][W+1],J=F[o][W],y=F[o+1][W],w=F[o+1][W+1],t=f[$].clone().normalize(),k=f[J].clone().normalize(),Q=f[y].clone().normalize(),T=f[w].clone().normalize(),C=l[o][W+1].clone(),g=l[o][W].clone(),p=l[o+1][W].clone(),U=l[o+1][W+1].clone();j(f[$].y)===A?(C.x=(C.x+g.x)/2,c.push(new Gl($,y,w,[t,Q,T])),D[0].push([C,p,U])):j(f[y].y)===A?(p.x=(p.x+U.x)/2,c.push(new Gl($,J,y,[t,k,Q])),D[0].push([C,g,p])):(c.push(new Gl($,J,w,[t,k,T])),D[0].push([C,g,U]),c.push(new Gl(J,y,w,[k.clone(),Q,T.clone()])),D[0].push([g.clone(),p,U.clone()]))}};Sr.prototype=rl(fe);var kk=function(f,_,E,b,X,T){Ij.call(this),f=f||.33,_=_||.17,b=b||8,E=E||6,X=X||0,T=T||z;for(var I=new Bh,t=[],r=[],d=0;b>=d;d++)for(var a=d/b*z+R,m=0;E>=m;m++){var g=m/E*T+X;I.x=f*n(g),I.z=-f*q(g);var y=new Bh,l=f+_*n(a);y.x=l*n(g),y.z=-l*q(g),y.y=_*q(a),this.vertices.push(y),t.push(new ak(m/E,1-d/b)),r.push(y.clone().sub(I).normalize())}for(var d=1;b>=d;d++)for(var m=1;E>=m;m++){var h=(E+1)*d+m-1,j=(E+1)*(d-1)+m-1,x=(E+1)*(d-1)+m,C=(E+1)*d+m,N=new Gl(h,j,C,[r[h].clone(),r[j].clone(),r[C].clone()]);this.faces.push(N),this.faceVertexUvs[0].push([t[h].clone(),t[j].clone(),t[C].clone()]),N=new Gl(j,x,C,[r[j].clone(),r[x].clone(),r[C].clone()]),this.faces.push(N),this.faceVertexUvs[0].push([t[j].clone(),t[x].clone(),t[C].clone()])}this.computeFaceNormals()};kk.prototype=rl(fe);var xb=function(E,r,P){return E?(Ij.call(this),E=E instanceof Array?E:[E],this.addShapeList(E,r),r.convertYZ!==!1&&Sk(this,P),this.computeFaceNormals(),void 0):(E=[],void 0)},$j=xb.prototype=rl(Ij.prototype);$j.addShapeList=function(H,L){for(var _=H.length,l=0;_>l;l++){var t=H[l];this.addShape(t,L)}},$j.addShape=function(O,K){function p(){if(K.bottom)for(var $=0;Z>$;$++)l=L[$],V(l[2],l[1],l[0],!0);if(K.top)for($=0;Z>$;$++)l=L[$],V(l[0]+J*X,l[1]+J*X,l[2]+J*X,!1)}function c(){var m=0;for(o(z,m),m+=z.length,f=0,b=d.length;b>f;f++)U=d[f],o(U,m),m+=U.length}function o(C,s){for(var D,I,f=C.length;--f>=0;){D=f,I=f-1,0>I&&(I=C.length-1);var N=0,B=X;for(N=0;B>N;N++){var R=J*N,H=J*(N+1),n=s+D+R,_=s+I+R,G=s+I+H,j=s+D+H;E(n,_,G,j,C,N,B,D,I)}}}function D($,r,I){S.vertices.push(new Bh($,r,I))}function V(b,i,P,E){b+=s,i+=s,P+=s,S.faces.push(new Gl(b,i,P,null,null,E?2:1));var o=E?M.generateBottomUV(S,O,K,b,i,P):M.generateTopUV(S,O,K,b,i,P);S.faceVertexUvs[0].push(o)}function E(c,$,F,N,W,d,Q,z,g){c+=s,$+=s,F+=s,N+=s,S.faces.push(new Gl(c,$,N)),S.faces.push(new Gl($,F,N));
var L=M.generateSideWallUV(S,O,W,K,c,$,F,N,d,Q,z,g);S.faceVertexUvs[0].push([L[0],L[1],L[3]]),S.faceVertexUvs[0].push([L[1],L[2],L[3]])}var Y,_,w,v,x,B=K.amount,i=K.curveSegments||Jg,X=K.steps||1,F=K.extrudePath,u=!1,M=new Ll(K.repeatUVLength);F&&(Y=F.getSpacedPoints(X),u=!0,_=K.frames!==I?K.frames:new Vj.FrenetFrames(F,X,!1),w=new Bh,v=new Bh,x=new Bh);var U,f,b,S=this,s=this.vertices.length,W=O.extractPoints(i),Q=W.shape,d=W.holes,r=!di.isClockWise(Q);if(r){for(Q=Q.reverse(),f=0,b=d.length;b>f;f++)U=d[f],di.isClockWise(U)&&(d[f]=U.reverse());r=!1}var L=di.triangulateShape(Q,d),z=Q;for(f=0,b=d.length;b>f;f++)U=d[f],Q=Q.concat(U);for(var n,l,J=Q.length,Z=L.length,a=0;J>a;a++)n=Q[a],u?(v.copy(_.normals[0]).multiplyScalar(n.x),w.copy(_.binormals[0]).multiplyScalar(n.y),x.copy(Y[0]).add(v).add(w),D(x.x,x.y,x.z)):D(n.x,n.y,0);var m;for(m=1;X>=m;m++)for(a=0;J>a;a++)n=Q[a],u?(v.copy(_.normals[m]).multiplyScalar(n.x),w.copy(_.binormals[m]).multiplyScalar(n.y),x.copy(Y[m]).add(v).add(w),D(x.x,x.y,x.z)):D(n.x,n.y,B/X*m);p(),c()};var Vj=function(g,N,X,A,y){function Q(T,o,K){return V.vertices.push(new Bh(T,o,K))-1}Ij.call(this),N=N||64,X=X||1,A=A||8,y=y||!1;var h,L,d,b,I,o,l,G,w,W,O,k,Y,T,U,f,J,m,K,R,B=[],V=this,j=N+1,e=new Bh,H=new Vj.FrenetFrames(g,N,y),r=H.tangents,S=H.normals,v=H.binormals;for(this.tangents=r,this.normals=S,this.binormals=v,w=0;j>w;w++)for(B[w]=[],b=w/(j-1),G=g.getPointAt(b),h=r[w],L=S[w],d=v[w],W=0;A>W;W++)I=W/A*z,o=-X*n(I),l=X*q(I),e.copy(G),e.x+=o*L.x+l*d.x,e.y+=o*L.y+l*d.y,e.z+=o*L.z+l*d.z,B[w][W]=Q(e.x,e.y,e.z);for(w=0;N>w;w++)for(W=0;A>W;W++)O=y?(w+1)%N:w+1,k=(W+1)%A,Y=B[w][W],T=B[O][W],U=B[O][k],f=B[w][k],J=new ak(w/N,W/A),m=new ak((w+1)/N,W/A),K=new ak((w+1)/N,(W+1)/A),R=new ak(w/N,(W+1)/A),this.faces.push(new Gl(Y,T,f)),this.faceVertexUvs[0].push([J,m,R]),this.faces.push(new Gl(T,U,f)),this.faceVertexUvs[0].push([m.clone(),K,R.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Vj.prototype=rl(fe),Vj.FrenetFrames=function(b,Z,N){function e(){Y[0]=new Bh,l[0]=new Bh,E=Number.MAX_VALUE,H=j(k[0].x),h=j(k[0].y),o=j(k[0].z),E>=H&&(E=H,W.set(1,0,0)),E>=h&&(E=h,W.set(0,1,0)),E>=o&&W.set(0,0,1),y.crossVectors(k[0],W).normalize(),Y[0].crossVectors(k[0],y),l[0].crossVectors(k[0],Y[0])}var i,E,H,h,o,S,T,W=new Bh,k=[],Y=[],l=[],y=new Bh,r=new Cm,n=Z+1,F=1e-4;for(this.tangents=k,this.normals=Y,this.binormals=l,S=0;n>S;S++)T=S/(n-1),k[S]=b.getTangentAt(T),k[S].normalize();for(e(),S=1;n>S;S++)Y[S]=Y[S-1].clone(),l[S]=l[S-1].clone(),y.crossVectors(k[S-1],k[S]),y.length()>F&&(y.normalize(),i=a(hg(k[S-1].dot(k[S]),-1,1)),Y[S].applyMatrix4(r.makeRotationAxis(y,i))),l[S].crossVectors(k[S],Y[S]);if(N)for(i=a(hg(Y[0].dot(Y[n-1]),-1,1)),i/=n-1,k[0].dot(y.crossVectors(Y[0],Y[n-1]))>0&&(i=-i),S=1;n>S;S++)Y[S].applyMatrix4(r.makeRotationAxis(k[S],i*S)),l[S].crossVectors(k[S],Y[S])};var qp=function(a,S,u,k){Ij.call(this),S=S||18,u=u||0,k=k==B?z:k;for(var J=1/(a.length-1),K=1/S,R=0,o=S;o>=R;R++)for(var M=u+R*K*k,h=n(M),Z=q(M),F=0,m=a.length;m>F;F++){var s=a[F],H=new Bh;H.x=h*s.x-Z*s.y,H.y=Z*s.x+h*s.y,H.z=s.z,this.vertices.push(H)}for(var d=a.length,R=0,o=S;o>R;R++)for(var F=0,m=a.length-1;m>F;F++){var t=F+d*R,U=t,N=t+d,h=t+1+d,P=t+1,r=R*K,f=F*J,e=r+K,i=f+J;this.faces.push(new Gl(U,P,N)),this.faceVertexUvs[0].push([new ak(r,f),new ak(r,i),new ak(e,f)]),this.faces.push(new Gl(N,P,h)),this.faceVertexUvs[0].push([new ak(e,f),new ak(r,i),new ak(e,i)])}this.mergeVertices(),Sk(this),this.computeFaceNormals(),this.computeVertexNormals()};qp.prototype=rl(fe);var Pd=function(O,Z){Z=Z||{};var T=Ap.generateShapes(O,Z);Z.amount=Z.amount!==I?Z.amount:.5,Z.convertYZ=!1,Z.fill!==!1&&(Z.bottom=!0,Z.top=!0),xb.call(this,T,Z)};Pd.prototype=rl($j);var Fb=u.Node=function(){lr(Fb,this)},Me={X:lp,Y:Ze,Z:Nm},Rd={X:0,Y:1,Z:2},hj={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Vi="xzy",Xh=function(P,p,O){if(p){var X=p[0],v=p[1],t=p[2];"xzy"===O?(Ze(P,v),Nm(P,t),lp(P,X)):"xyz"===O?(Nm(P,t),Ze(P,v),lp(P,X)):"yxz"===O?(Nm(P,t),lp(P,X),Ze(P,v)):"yzx"===O?(lp(P,X),Nm(P,t),Ze(P,v)):"zxy"===O?(Ze(P,v),lp(P,X),Nm(P,t)):"zyx"===O?(lp(P,X),Ze(P,v),Nm(P,t)):(Ze(P,v),Nm(P,t),lp(P,X))}};dk("Node",db,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Vi,_64O:0,_rotationX:0,_53O:0,_host:B,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Kq},_22Q:function(){return Pr},getX:function(){return this.p().x},setX:function(S){this.p(S,this.p().y)},getY:function(){return this.p().y},setY:function(t){this.p(this.p().x,t)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(S){this.setAnchor(S,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(n){this.setAnchor(this.getAnchor().x,n)},getScaleX:function(){return this.getScale().x},setScaleX:function(P){this.setScale(P,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(p){this.setScale(this.getScale().x,p)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(k,f){wd(k,se(B,B,this.r3(),this.getRotationMode())),this.translate3d(k[0]*f,k[1]*f,k[2]*f)},translateFront:function(t){this.translate3dBy([0,0,1],t)},translateBack:function(A){this.translate3dBy([0,0,-1],A)},translateLeft:function(W){this.translate3dBy([-1,0,0],W)},translateRight:function(A){this.translate3dBy([1,0,0],A)},translateTop:function(n){this.translate3dBy([0,1,0],n)},translateBottom:function(k){this.translate3dBy([0,-1,0],k)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(J,u,n){1===arguments.length&&(u=J[1],n=J[2],J=J[0]),this.p(J,n),this.setElevation(u)},translate3d:function(s,v,x){1===arguments.length&&(v=s[1],x=s[2],s=s[0]),this.translate(s,x),this.setElevation(this._54O+v)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(y,f,N){1===arguments.length&&(f=y[1],N=y[2],y=y[0]),this.setSize(y,N),this.setTall(f)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(d,I,J){1===arguments.length&&(I=d[1],J=d[2],d=d[0]),this.setRotationX(d),this.setRotation(-I),this.setRotationZ(J)},setRotationY:function(y){this.setRotation(-y)},getRotationY:function(){return-this._64O},lookAtDirection:function(C,h){h=h||yn;var q=this,Q=Ke(C);h===yn?(q.r3([-r(C[1]/Q),-v(C[2],C[0])+L,0]),q.setRotationMode("xzy")):h===cg?(q.r3(0,-v(C[2],C[0]),r(C[1]/Q)),q.setRotationMode("zyx")):h===ue?(q.r3(0,-v(C[2],C[0])+R,-r(C[1]/Q)),q.setRotationMode("zyx")):h===Xn?(q.r3([-r(C[1]/Q)+L,-v(C[2],C[0])+L,0]),q.setRotationMode("xzy")):h===id&&(q.r3([-r(C[1]/Q)-L,-v(C[2],C[0])+L,0]),q.setRotationMode("xzy")),h===wl&&(q.r3([-r(C[1]/Q)+R,-v(C[2],C[0])+L,R]),q.setRotationMode("zxy"))},lookAt:function(L,v){return this.lookAtDirection(Gc(L,this.p3()),v)},lookAtX:function(){var n=new pe,m=new pe,c=new pe,G=new Oo,y=new Oo,Z=new vs;return function(A,V){var C=Lm(this);G.fromArray(C),c.copy(this.p3()),n.copy(A).sub(c).normalize(),V===yn?m.set(0,0,1):V===wl?m.set(0,0,-1):V===ue?m.set(-1,0,0):V===cg?m.set(1,0,0):V===Xn?m.set(0,1,0):V===id&&m.set(0,-1,0),m.applyMatrix4(G).sub(c).normalize();var R=Math.acos(n.dot(m));if(R){var q=n.clone().cross(m).normalize();Z.set(this.r3(),this.getRotationMode(),!0),G.makeRotationFromEuler(Z),y.makeRotationAxis(q,-R),Z.setFromRotationMatrix(y.multiply(G)),this.r3([Z.x,Z.y,Z.z])}}}(),getHost:function(){return this._host},setHost:function(K){var E=this;if(E!==K&&E._host!==K){var q=E._host;q&&q._removeAttach(E),E._host=K,E._host&&E._host._addAttach(E),E.fp("host",q,K),E.onHostChanged(q,K)}},getAttaches:function(){return this._69O},_addAttach:function(Z){var C=this;C._69O||(C._69O=new Vn),C._69O.add(Z),C.fp("attaches",B,Z)},_removeAttach:function(e){var z=this;z._69O.remove(e),z._69O.isEmpty()&&delete z._69O,z.fp("attaches",e,B)},getImage:function(){if(this._pendingCheckImageJSON){var R=w.getImage(this._image);R&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Tb&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(v){var C=this,b=C._image,l=C.getWidth(),m=C.getHeight();C._image=v,C.fp("image",b,v)&&(null!=v&&(ei(v)||Ug(v)&&/\.json$/i.test(v))&&(this._pendingCheckImageJSON=!0),C.fp(nq,l,C.getWidth()),C.fp(pm,m,C.getHeight()))},getElevation:function(){return this._54O},setElevation:function(c){var B=this;if(!B._50O){B._50O=1;var P=B._54O;B._54O=c,B.fp(ah,P,c),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(e){var r=this;if(!r._49O){r._49O=1;var b=r._64O;r._64O=e,r.fp(Yk,b,e),delete r._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(U){var C=this;if(!C._51O){C._51O=1;var D=C._rotationX;C._rotationX=U,C.fp("rotationX",D,U),delete C._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(l){var S=this;if(!S._52O){S._52O=1;var R=S._53O;S._53O=l,S.fp("rotationZ",R,l),delete S._52O}},getPosition:function(){return this._position},setPosition:function(q,e){var K=this;if(!K._50I){K._50I=1;var G;if(G=2===arguments.length?{x:q,y:e}:q,G.x!==K._position.x||G.y!==K._position.y){var o=K._position;K._position=G,K.fp(Ci,o,G)}delete K._50I}},translate:function(C,i){var e=this._position;this.p(e.x+C,e.y+i)},getWidth:function(){var G=this;if(G._width>=0)return G._width;var g=G.getStyle("shape3d");if(g){var i=rd(g);if(i&&i.rawS3)return i.rawS3[0];if("billboard"===g||"plane"===g){var Q=Ve(G.getStyle("shape3d.image"));return Q?Sg(Q,G):20}}var Q=Ve(G._image);return Q?Sg(Q,G):20},setWidth:function(I){var v=this,S=v._width;v._width=I,v.fp(nq,S,I)},getHeight:function(){var d=this;if(d._height>=0)return d._height;var p=d.getStyle("shape3d");if(p){var T=rd(p);if(T&&T.rawS3)return T.rawS3[2];if("plane"===p){var l=Ve(d.getStyle("shape3d.image"));return l?Xd(l,d):20}if("billboard"===p)return 2}var l=Ve(d._image);return l?Xd(l,d):20},setHeight:function(d){var e=this,M=e._height;e._height=d,e.fp(pm,M,d)},getTall:function(){var G=this;if(G._tall>=0)return G._tall;var t=G.getStyle("shape3d");if(t){var Y=rd(t);if(Y&&Y.rawS3)return Y.rawS3[1];if("billboard"===t){var V=Ve(G.getStyle("shape3d.image"));return V?Xd(V,G):20}if("plane"===t)return 2}return 20},setTall:function(K){var x=this,N=x._tall;x._tall=K,x.fp("tall",N,K)},setSize:function(T,q){var J=this;2===arguments.length?(J.setWidth(T),J.setHeight(q)):(J.setWidth(T.width),J.setHeight(T.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(f,E,B,N,T){var m=this,X=m.getAnchor(),n=m.getScale();arguments.length<=2&&(T=E,E=f.y,B=f.width,N=f.height,f=f.x);var G=T&&n.x<0?1-X.x:X.x,h=T&&n.y<0?1-X.y:X.y;m.p(f+B*G,E+N*h),T&&(B/=Math.abs(n.x),N/=Math.abs(n.y)),m.setWidth(B),m.setHeight(N)},getMatrix:function(){var y=this,u=y._64O,T=y._position,A=y.getScale();return new vl(u,T.x,T.y,A.x,A.y)},getAnchorRect:function(){var C=this,_=C.getWidth(),e=C.getHeight(),T=C.getAnchor();return{x:-_*T.x,y:-e*T.y,width:_,height:e}},toLocal:function(S){return this.getMatrix().tfi(S)},toGlobal:function(u){return this.getMatrix().tf(u)},getAttachPosition:function(){var H=new vl;return function(d,R,G,K){G=G||0,K=K||0;var S=this,V=S.getAnchor(),w=S._64O,e=S._position,m=S.getScale();return H.setFromTransform(w,e.x,e.y).tf({x:G+m.x*S.getWidth()*(d-V.x),y:K+m.y*S.getHeight()*(R-V.y)})}}(),isInRect:function(p){p=this.toLocal(p);var v=this.getWidth(),b=this.getHeight();return p.x+=v*this.getAnchorX(),p.y+=b*this.getAnchorY(),!(p.x<0||p.y<0||p.x>v||p.y>b)},getRect:function(){var g=this,_=g.getWidth(),u=g.getHeight(),Q=g.getAnchor(),d={x:-_*Q.x,y:-u*Q.y,width:_,height:u},V=g.getMatrix();return d=qh([V.tf(d.x,d.y),V.tf(d.x+d.width,d.y),V.tf(d.x+d.width,d.y+d.height),V.tf(d.x,d.y+d.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var f=this,H=f.getAnchor(),t=f._anchorElevation;return{x:H.x,y:t,z:H.y}},setAnchorElevation:function(v){var f=this,y=f._anchorElevation;return y!==v?(f._anchorElevation=v,f.fp("anchorElevation",y,v),!0):!1},setAnchor3d:function(k,M,G,p){var A,u=this;"number"==typeof k?A={x:k,y:M,z:G}:(A=k.length?{x:k[0],y:k[1],z:k[2]}:k,p=M);var y=u.getDataModel();y&&y.beginTransaction();var D=u.getAnchor3d(),L=u.setAnchor(A.x,A.z);if(u.setAnchorElevation(A.y)&&(L=!0),L&&p&&!Eq){u.getAnchor3d();var z=Lm(u),b=wd([A.x-D.x,A.y-D.y,A.z-D.z],z);u.p3(b)}return y&&y.endTransaction(),L},getAnchor:function(){var c=this;if(c.hasOwnProperty("_anchor"))return c._anchor;var J=Ve(c._image);return J&&J.anchorX!==I?{x:J.anchorX,y:J.anchorY}:c._anchor},setAnchor:function(i,p,D){var X,T=this;"number"==typeof i?X={x:i,y:p}:(X=i.length?{x:i[0],y:i[1]}:i,D=p);var s=T.getAnchor();if(s.x!==X.x||s.y!==X.y){var N=T.getDataModel();if(N&&N.beginTransaction(),T._anchor=X,T.fp("anchor",s,X),D&&!Eq){var k=T.getPosition(),o=T.getSize(),L=T.getRotation(),$=T.getScale(),v=-o.width*(s.x-X.x)*$.x,g=-o.height*(s.y-X.y)*$.y,Z=q(L),Y=n(L);T.setPosition(k.x+Y*v-Z*g,k.y+Z*v+Y*g)}return N&&N.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(K,h){var F,D=this;F=2===arguments.length?{x:K,y:h}:K;var J=D.getScale();(J.x!==F.x||J.y!==F.y)&&(D._scale=F,D.fp("scale",J,F))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var i=this,I=i._scaleTall,S=i.getScale();return[S.x,I,S.y]},getFinalScale3d:function(){var B=this,R=B.s3(),c=B._dynamicScale3d,P=B.getScale3d();return R&&(P[0]*=R[0],P[1]*=R[1],P[2]*=R[2]),c&&(P[0]*=c[0],P[1]*=c[1],P[2]*=c[2]),P},getFinalRotation3d:function(){var U=this;return U._dynamicRotation||U.r3()},setScaleTall:function(d){var X=this,W=X._scaleTall;W!==d&&(X._scaleTall=d,X.fp("scaleTall",W,d))},setScale3d:function(X,M,j){var J,Q=this;J="number"==typeof X?{x:X,y:M,z:j}:X.length?{x:X[0],y:X[1],z:X[2]}:X,Q.setScaleTall(J.y),Q.setScale(J.x,J.z)},getCorners:function(r,p){r==B&&(r=0),p==B&&(p=r);var w=this,Y=w.getAnchor(),C=w.getWidth(),R=w.getHeight(),d=-C*Y.x-r,W=-R*Y.y-p,N=C+2*r,T=R+2*p,V=w.getMatrix();return[V.tf(d,W),V.tf(d,W+T),V.tf(d+N,W+T),V.tf(d+N,W)]},getEditControlPoints:function(Q,r,b){r==B&&(r=0),b==B&&(b=r);var n=this,t=n.getAnchor(),e=n.getWidth(),L=n.getHeight(),u=-e*t.x-r,Z=-L*t.y-b,w=e+2*r,h=L+2*b;if(Q)return[{x:u,y:Z},{x:u,y:0},{x:u,y:Z+h},{x:0,y:Z+h},{x:u+w,y:Z+h},{x:u+w,y:0},{x:u+w,y:Z},{x:0,y:Z}];var M=n.getMatrix();return[M.tf(u,Z),M.tf(u,0),M.tf(u,Z+h),M.tf(0,Z+h),M.tf(u+w,Z+h),M.tf(u+w,0),M.tf(u+w,Z),M.tf(0,Z)]},rotateAt:function(D,l,b){var r=this,Y=r._position,a=r._64O,J=new vl(a,Y.x,Y.y).tf(D,l),s=h(D*D+l*l),w=v(Y.y-J.y,Y.x-J.x)+b;r.setRotation(a+b),r.p(J.x+s*n(w),J.y+s*q(w))},onParentChanged:function(){Fb.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var S={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(O){S[O]=!0}),function(w){var d=this;Fb.superClass.onPropertyChanged.call(d,w),S[w.property]&&!d._layoutUpdating&&d.updateLayoutParameters(null,w.property),d._69O&&d._69O.each(function(X){X.handleHostPropertyChange(w)}),d._49I&&d._49I.each(function(O){O.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(_){this.updateAttach(_)},onStyleChanged:function(t){Fb.superClass.onStyleChanged.apply(this,arguments),Xi[t]&&this.updateAttach()},updateAttach:function(z){var U=this;return Eq?(U.updateLayoutParameters(),void 0):(U._51I||(U._51I=1,U._71O(z),delete U._51I),void 0)},_71O:function(E){var j,p,H,$,Z,o,b=this,c=b._host,_=E?E.property:B,I=E?E.oldValue:B,W=E?E.newValue:B;if(c instanceof u.Grid){if(_===ah)b.setElevation(b._54O+W-I);else if(!E||ql[_]){if(j=b.s("attach.row.index"),p=b.s("attach.column.index"),H=c.getCellRect(j,p),!H)return;$=b.s("attach.row.span"),Z=b.s("attach.column.span"),(1!==$||1!==Z)&&(H=Lh(H,c.getCellRect(j+$-1,p+Z-1))),jb(H,b,"attach.padding",1),b.setRect(H)}}else if(c instanceof yg&&(o=b.s("attach.index"))>=0&&(!E||Ei[_])){var i=b.s("attach.thickness");i!=B&&b.setHeight(c.getThickness()*i);var y=b.s("attach.offset"),t=c.getPoints(),k=t.size();if(k>o){var s=t.get(o),w=k===o+1?t.get(0):t.get(o+1),S=[w.x-s.x,w.y-s.y],n=Ke(S);if(n){b.s("attach.offset.relative")&&(y*=n),b.s("attach.offset.opposite")&&(y=n-y);var m={x:s.x+S[0]/n*y,y:s.y+S[1]/n*y},N=b.s("attach.gap");N&&(b.s("attach.gap.relative")&&(N*=c.getThickness()),m=_g(B,m,w,N)),b.p(m),b.setRotation(v(S[1],S[0]))}}}else E&&(_===Ci?b.translate(W.x-I.x,W.y-I.y):_===ah?b.setElevation(b._54O+W-I):fd[_]?b._11Q(c,_,W-I):("anchor"===_||"width"===_||"height"===_||"scale"===_)&&b.layout(c))},_11Q:function(){var f=new u.Math.Euler,U=u.Math.Euler.ReverseOrder,A=new u.Math.Vector2,v=new u.Math.Vector2;return function(c,b,Q){var X=this,Y=c.p3(),S=c.r3(),o=X.p3(),C=X.r3();if(b===Yk&&(b="rotationY",Q=-Q),(b===Yk||"rotationY"===b)&&0===C[0]&&0===C[2]&&0===S[0]&&0===S[2]&&0===o[1]&&0===Y[1])return X.setRotation(-C[1]-Q),A.set(o[0],o[2]).rotateAround(v.set(Y[0],Y[2]),-Q),X.p(A.x,A.y),void 0;var V=hj[c.getRotationMode()],h=V[0],y=V[1],O=V[2],i=Me[h],D=Me[y],M=Me[O],K=Gf();b===Yk+h?(M(K,S[Rd[O]]),D(K,S[Rd[y]]),i(K,Q),D(K,-S[Rd[y]]),M(K,-S[Rd[O]])):b===Yk+y?(M(K,S[Rd[O]]),D(K,Q),M(K,-S[Rd[O]])):b===Yk+O&&M(K,Q);var J=Gc(o,Y);wd(J,K),X.p3(Y[0]+J[0],Y[1]+J[1],Y[2]+J[2]);var x=X.getRotationMode();Xh(K,X.r3(),x),f.setFromRotationMatrix(K,U(x)),X.r3([f.x,f.y,f.z])}}(),isHostOn:function(T){var M=this;if(M._host&&T&&T._69O)for(var o={},N=M._host;N&&N!==M&&!o[N._id];){if(N===T)return!0;o[N._id]=N,N=N._host}return!1},isLoopedHostOn:function(d){return this.isHostOn(d)&&d.isHostOn(this)},getScaledSize:function(){var v=this.getSize(),a=this.getScale();return v.width*=Math.abs(a.x),v.height*=Math.abs(a.y),v},layout:function(j){if(j=j||this.getHost()){var J=this,F=J.s("layout.h")||"center",V=J.s("layout.v")||"center";if("center"!==F||"center"!==V){var z=new u.Math.Vector2,k=j.getPosition(),s=j.getAnchor(),Q=j.getScaledSize();J.getPosition();var y,A,i,w,B,c=1,v=1;switch(J._layoutUpdating=!0,F){case"left":z.setX(J._layoutHValue-s.x*Q.width);break;case"right":z.setX((1-s.x)*Q.width-J._layoutHValue);break;case"leftright":y=Q.width-J._layoutHValue[2],i=J.getRotation()-j.getRotation(),w=Math.abs(Math.sin(i)),B=Math.abs(Math.cos(i)),c+=B*y/J._layoutHValue[3],v+=w*y/J._layoutHValue[4],z.setX(J._layoutHValue[1]+(J._layoutHValue[5]-s.x)*Q.width);break;case"center":z.setX((.5-s.x)*Q.width-J._layoutHValue);break;case"scale":i=J.getRotation()-j.getRotation(),w=Math.abs(Math.sin(i)),B=Math.abs(Math.cos(i)),z.setX((.5-s.x)*Q.width-J._layoutHValue[1]*Q.width/J._layoutHValue[0]),A=Q.width/J._layoutHValue[2]-1,c+=B*A,v+=w*A}switch(V){case"top":z.setY(J._layoutVValue-s.y*Q.height);break;case"bottom":z.setY((1-s.y)*Q.height-J._layoutVValue);break;case"topbottom":i||(i=J.getRotation()-j.getRotation(),w=Math.abs(Math.sin(i)),B=Math.abs(Math.cos(i))),y=Q.height-J._layoutVValue[2],c+=w*y/J._layoutVValue[3],v+=B*y/J._layoutVValue[4],z.setY(J._layoutVValue[1]+(J._layoutVValue[5]-s.y)*Q.height);break;case"center":z.setY((.5-s.y)*Q.height-J._layoutVValue);break;case"scale":i||(i=J.getRotation()-j.getRotation(),w=Math.abs(Math.sin(i)),B=Math.abs(Math.cos(i))),z.setY((.5-s.y)*Q.height-J._layoutVValue[1]*Q.height/J._layoutVValue[0]),A=Q.height/J._layoutVValue[2]-1,c+=w*A,v+=B*A}if("leftright"===F||"scale"===F||"topbottom"===V||"scale"===V){var g=this.getScale(),O=Math.abs(g.x),f=Math.abs(g.y);"leftright"===F||"scale"===F?J.setSize(J._layoutHValue[3]*c/O,J._layoutHValue[4]*v/f):J.setSize(J._layoutVValue[3]*c/O,J._layoutVValue[4]*v/f)}z.rotateAround(null,j.getRotation()),this.setPosition(z.x+k.x,z.y+k.y),J._layoutUpdating=I}}},updateLayoutParameters:function(y,T){if(y=y||this.getHost()){var f=this,k=f.s("layout.h"),N=f.s("layout.v");if(k||N){var P,E,h,K,n,v,D=new u.Math.Vector2,Q=y.getPosition(),z=y.getAnchor(),L=y.getScaledSize(),F=f.getPosition(),s=f.getScaledSize();switch(D.set(F.x-Q.x,F.y-Q.y),D.rotateAround(null,-y.getRotation()),k){case"left":f._layoutHValue=D.x+z.x*L.width;break;case"right":f._layoutHValue=-D.x+(1-z.x)*L.width;break;case"center":f._layoutHValue=-D.x+(.5-z.x)*L.width;break;case"leftright":case"scale":"scale"===k?P=-D.x+(.5-z.x)*L.width:(E=f.getAnchor(),h=f.getRotation()-y.getRotation(),K=Math.cos(h),n=Math.sin(h),v=-Math.min(-E.x*K+E.y*n,-E.x*K-(1-E.y)*n,(1-E.x)*K+E.y*n,(1-E.x)*K-(1-E.y)*n),P=D.x-(v-z.x)*L.width),"position"===T&&"object"==typeof f._layoutHValue?(f._layoutHValue[0]=L.width,f._layoutHValue[1]=P):f._layoutHValue=[L.width,P,L.width,s.width,s.height,v]}switch(N){case"top":f._layoutVValue=D.y+z.y*L.height;break;case"bottom":f._layoutVValue=-D.y+(1-z.y)*L.height;break;case"center":f._layoutVValue=-D.y+(.5-z.y)*L.height;break;case"topbottom":case"scale":"scale"===N?P=-D.y+(.5-z.y)*L.height:(h||(E=f.getAnchor(),h=f.getRotation()-y.getRotation(),K=Math.cos(h),n=Math.sin(h)),v=-Math.min(-E.x*n-E.y*K,-E.x*n+(1-E.y)*K,(1-E.x)*n-E.y*K,(1-E.x)*n+(1-E.y)*K),P=D.y-(v-z.y)*L.height),"position"===T&&"object"==typeof f._layoutVValue?(f._layoutVValue[0]=L.height,f._layoutVValue[1]=P):f._layoutVValue=[L.height,P,L.height,s.width,s.height,v]}}}},getSerializableProperties:function(){var u=Fb.superClass.getSerializableProperties.call(this);return _p(u,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),u}});var Tf=u.Edge=function(e,_){var k=this;lr(Tf,k),k.setSource(e),k.setTarget(_)};dk("Edge",db,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return so},_22Q:function(){return lc},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(I){if(I===this)return!1;if($o(I))return!0;for(var d,a,Y,u,e,T=[this],c=-1,t=0;t>c;)if(c++,d=T[c],a=d._44I)for(a=a.getArray(),u=0,e=a.length;e>u;u++)if(Y=a[u],cr(Y)&&!(T.indexOf(Y)>=0)){if(Y===I)return!1;T.push(Y),t++}return!0},setSource:function(x){var E=this;if(E._source!==x&&E.canSetSourceTarget(x)){var D=E._source;E._source=x,D&&D._16I(E),x&&x._2I(E),E._7I(),E.fp("source",D,x)}},setTarget:function(j){var Z=this;if(Z._target!==j&&Z.canSetSourceTarget(j)){var q=Z._target;Z._target=j,q&&q._18I(Z),j&&j._4I(Z),Z._7I(),Z.fp("target",q,j)}},isLooped:function(){var E=this;return E._source===E._target&&$o(E._source)&&$o(E._target)},onPropertyChanged:function(){var c=this;c._49I&&c._49I.each(function(R){R.fp("agentChange",!0,!1)})},_7I:function(){var E,h=this,w=Tj(h);h._40I!==w&&(E=this._40I,E&&E._15I(h),h._40I=w,w&&w._1I(h),h.fp("sourceAgent",E,w),Pc(E,h._41I),Pc(w,h._41I));var s=Th(h);h._41I!==s&&(E=h._41I,E&&E._17I(h),h._41I=s,s&&s._3I(h),h.fp("targetAgent",E,s),Pc(E,h._40I),Pc(s,h._40I))},_22I:function(t){this._52I=t,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var W=this;return W._52I&&W._52I.get(0)!==W&&!W.getStyle(dq)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var X=this,c=X._52I;return c&&!X.getStyle(dq)&&c.size()>1&&X===c.get(0)},toggle:function(){var q=this._52I,P=!this.s(dq);q&&q.size()>1&&(q.each(function(t){t.s(dq,P)}),q.getSiblings().each(function(L){L!==q&&L.each(function(m){m.fp("edgeGroup",B,L)})}))},setStyle:function(u,e){(u===Dn||"edge.segments"===u)&&(e=Gp(e)),Tf.superClass.setStyle.call(this,u,e)},onStyleChanged:function(Z){Tf.superClass.onStyleChanged.apply(this,arguments),sc[Z]&&Pc(this._41I,this._40I)},getSerializableProperties:function(){var C=Tf.superClass.getSerializableProperties.call(this);return _p(C,{source:1,target:1}),C}});var Pm=u.Group=function(){lr(Pm,this)};dk("Group",Fb,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Ao},onChildAdded:function(){Pm.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Pm.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var f=this;if(!f._54I&&!Eq){var m=f.getChildrenRect();m&&(f._53I=1,f.p(hi(f.s("group.position"),m,f.getSize())),delete f._53I)}},getChildrenRect:function(){var v,L=this;return L.eachChild(function(u){$o(u)&&(v=Lh(v,L.getChildRect(u)))}),v},getChildRect:function($){var v;return $o($)&&$.s(yr)&&(oo($)&&$.isExpanded()&&$.eachChild(function(F){v=Lh(v,$.getChildRect(F))}),!v&&$.getRect&&(v=$.getRect())),v},setPosition:function(P,C){var p=this;if(!p._54I){var N;N=2===arguments.length?{x:P,y:C}:P,Eq||p._53I||(p._54I=1,xo(p._children,N.x-p._position.x,N.y-p._position.y),delete p._54I),Pm.superClass.setPosition.call(this,N)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(q){var Z=this;if(Z._57O!==q){var a=Z._57O;Z._57O=q,Z.fp("expanded",a,Z._57O),Z._fireInvalidateDeep(),Z._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(g){oo(g)?g._fireInvalidateDeep():g.iv()})},_8I:function(){Pm.superClass._8I.call(this),this.eachChild(function(p){$o(p)&&p._8I()})},onStyleChanged:function(T){Pm.superClass.onStyleChanged.apply(this,arguments),"group.position"===T&&this._81I()},getSerializableProperties:function(){var G=Pm.superClass.getSerializableProperties.call(this);return G.expanded=1,G}});var Vp=u.Block=function(){lr(Vp,this)};dk("Block",Fb,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Hi},onChildAdded:function(){Vp.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Vp.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var z=this;if(!Eq&&!z._updatingToChildren&&z._syncSize&&!z._freezeSyncFromChildren){var $,v,P,Z,D,F=[],V=z.getRotation();if(z.eachChild(function(R){$o(R)&&F.push.apply(F,R.getCorners())}),F.length){z._updatingFromChildren=1;var S=n(-V),w=q(-V),Y=1/0,y=-1/0,p=1/0,b=-1/0;for(Z=0,D=F.length;D>Z;Z++)P=F[Z],$=P.x,v=P.y,P.x=S*$-w*v,P.y=w*$+S*v,Y=s(Y,P.x),y=_(y,P.x),p=s(p,P.y),b=_(b,P.y);var m=z.getScale();z.setSize(j((y-Y)/m.x),j((b-p)/m.y));var B;m.x<0&&(B=Y,Y=y,y=B),m.y<0&&(B=p,p=b,b=B),S=n(V),w=q(V);var A=z.getAnchor();$=Y+(y-Y)*A.x,v=p+(b-p)*A.y,z.setPosition(S*$-w*v,w*$+S*v),delete z._updatingFromChildren}}},setPosition:function(_,l){var t=this;if(!t._updatingToChildren){var f;f=2===arguments.length?{x:_,y:l}:_,Eq||t._updatingFromChildren||(t._updatingToChildren=1,xo(t._children,f.x-t._position.x,f.y-t._position.y),delete t._updatingToChildren),Vp.superClass.setPosition.call(this,f)}},setWidth:function(c){return this.setSize(c,this.getHeight())},setHeight:function(W){return this.setSize(this.getWidth(),W)},setSize:function(N,T){1>N&&(N=1),1>T&&(T=1);var j=this;if(!j._updatingToChildren){2!==arguments.length&&(T=N.height,N=N.width);var P=j.getWidth(),R=j.getHeight();if(N!==P&&Vp.superClass.setWidth.call(j,N),T!==R&&Vp.superClass.setHeight.call(j,T),!Eq&&!j._updatingFromChildren){j._updatingToChildren=1;var e=N/P,l=T/R;j._adjustChildScaleOrSize(e,l,"size"),delete j._updatingToChildren,j.updateFromChildren()}}},_adjustChildScaleOrSize:function(d,c,Q){var p=this;if(p._syncSize){var j=p.getPosition(),x=p.getRotation();p.getScale(),p.eachChild(function(B){if($o(B)){var z=B.getPosition(),L=B.getRotation(),Y=B.getWidth(),P=B.getHeight(),M=B.getScale(),U=M.x*Y,E=M.y*P,i=new vl(L,z.x,z.y,U,E);i.translate(-j.x,-j.y),i.rotate(-x),L=v(i.b*Math.sign(U),i.a*Math.sign(U)),i.scale(d,c);var S,y,V,p=n(L);if(Math.abs(p)<.001?(S=q(L),y=i.b/S,V=-i.c/S):(y=i.a/p,V=i.d/p),"scale"===Q)B.setScale(y/Y,V/P);else if("size"===Q){var W=y/M.x,A=V/M.y;B.setScale(Sl(y)*Math.abs(M.x),Sl(V)*Math.abs(M.y)),B instanceof u.Shape?(B.setWidthForce(Math.max(Math.abs(W),1e-5)),B.setHeightForce(Math.max(Math.abs(A),1e-5))):B.setSize(Math.max(.01,Math.abs(W)),Math.max(.01,Math.abs(A)))}i.rotate(x),i.translate(j.x,j.y),B.setPosition(i.tx,i.ty)}})}},_calcChangeFactor:function(s,G,z,k){var i,x,H,g;return i=j(s),x=j(z),H=i>x?i/x:x/i,i=j(G),x=j(k),g=i>x?i/x:x/i,_(H,g)},setAnchor:function(){var Y=this;if(!Y._updatingToChildren){var C=Y.getAnchor();if(Vp.superClass.setAnchor.apply(Y,arguments),!Eq&&!Y._updatingFromChildren&&Y._syncSize){Y._updatingToChildren=1;var e=Y.getAnchor();Y.getPosition();var E=Y.getSize(),k=Y.getScale(),M=Y.getRotation(),D=-E.width*k.x*(C.x-e.x),y=-E.height*k.y*(C.y-e.y),v=q(M),_=n(M),A=_*D-v*y,S=v*D+_*y;Y.eachChild(function(y){if($o(y)){var I=y.getPosition();y.setPosition(I.x-A,I.y-S)}}),delete Y._updatingToChildren}}},setRotation:function(I){var Q=this;if(!Q._updatingToChildren){var z=Q.getRotation();if(Vp.superClass.setRotation.apply(Q,arguments),!Eq&&!Q._updatingFromChildren){Q._updatingToChildren=1;var x=Q.getPosition(),D=I-z;Q.eachChild(function(L){if($o(L)){var K=L.getMatrix();K.translate(-x.x,-x.y),K.rotate(D),K.translate(x.x,x.y);var m=Math.sign(L.getScale().x);L.setRotation(v(K.b*m,K.a*m)),L.setPosition(K.tx,K.ty)}}),delete Q._updatingToChildren}}},setScale:function(U,G){var R=this;if(!R._updatingToChildren){null==G&&(G=U.y,U=U.x);var P=R.getScale();if(j(U)<.01&&(U=.01*(Sl(U)||Sl(P.x))),j(G)<.01&&(G=.01*(Sl(G)||Sl(P.y))),Vp.superClass.setScale.call(R,U,G),!Eq&&!R._updatingFromChildren){R._updatingToChildren=1;var a=U/P.x,x=G/P.y;R._adjustChildScaleOrSize(a,x,"size"),delete R._updatingToChildren,R.updateFromChildren()}}},getSerializableProperties:function(){var d=Vp.superClass.getSerializableProperties.call(this);return d.clickThroughEnabled=1,d.syncSize=1,d}});var Ag=u.Grid=function(){lr(u.Grid,this)};dk("Grid",Fb,{IRotatable:!1,_icon:"grid_icon",_image:B,getUIClass:function(){return ch},setRotation:function(){},getCellRect:function($,O){var x=this,t=x.s("grid.row.count"),a=x.s("grid.column.count");if(0>=t||0>=a||0>$||$>=t||0>O||O>=a)return B;var w,D,e,L=x.getRect(),P=x.s("grid.row.percents"),q=x.s("grid.column.percents");if(jb(L,x,"grid.border",-1),P&&P._as&&(P=P._as),q&&q._as&&(q=q._as),P&&P.length===t){for(e=0,w=0;$>w;w++)e+=L.height*P[w];L.y+=e,L.height=L.height*P[$]}else L.height=L.height/t,L.y+=L.height*$;if(q&&q.length===a){for(D=0,w=0;O>w;w++)D+=L.width*q[w];L.x+=D,L.width=L.width*q[O]}else L.width=L.width/a,L.x+=L.width*O;return em(L,-x.s("grid.gap")),L}});var hq=u.Text=function(){lr(hq,this),this.setSize(100,50),this.s("text","TEXT")};dk("Text",Fb,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Pf},setWidth:function(F){F||(F=.001),hq.superClass.setWidth.call(this,F)},setHeight:function(q){q||(q=.001),hq.superClass.setHeight.call(this,q)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),mk("__text__",{width:{value:100,isSafeFunc:!0,func:function(g){return g._width}},height:{value:50,isSafeFunc:!0,func:function(r){return r._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var yg=u.Shape=function(){lr(yg,this),this._59O=new Vn};yg.__de__=Qk,dk("Shape",Fb,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Eg},_22Q:function(){return Kc
},getLength:function(Q){return Sd(ol(this._59O,this._58O,Q,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var G=this._58O;return G?new Vn(G._as.slice(0)):G},setSegments:function(c){var j=this._58O;c=c?Zh(c)?new Vn(c.slice(0)):new Vn(c._as.slice(0)):null,(j&&c&&j._as.join(",")!==c._as.join(",")||j!==c)&&(this._58O=c,this.fp("segments",j,c))},getPoints:function(){return this._59O},toPoints:function(){var d=this._59O;return new Vn(d._as.slice(0))},setPoints:function(O,z){var s=this,M=s._59O;O=O?Zh(O)?new Vn(O.slice(0)):new Vn(O._as.slice(0)):new Vn;var _,o,u,B,N,X;z&&(_=s.getPosition(),X=new vl(s.getRotation(),0,0,s.getScale().x,s.getScale().y)),(M&&O&&M._as.join(",")!==O._as.join(",")||M!==O)&&(s._59O=O,s.fs(),s.fp("points",M,O)),z&&(o=s.getPosition(),u=o.x-_.x,B=o.y-_.y,N=X.tf(u,B),s.setPosition(o.x-u+N.x,o.y-B+N.y))},addPoint:function(j,Z,r){var F=this.toPoints();F.add(j,Z),this.setPoints(F,r)},setPoint:function(q,i,U){var A=this.toPoints();A.set(q,i),this.setPoints(A,U)},removePointAt:function(W){var Z=this.toPoints();Z.removeAt(W),this.setPoints(Z)},setWidthForce:function(S){var B=this;if(!B._55I&&!Eq&&B.getWidth()){B._55I=1;var Z=B._position.x,d=S/B.getWidth(),$=B.toPoints(),j=new Vn;$.each(function(Q){j.add({x:(Q.x-Z)*d+Z,y:Q.y,e:Q.e})}),B.setPoints(j),Wr(B,[d,0,0,1,Z*(1-d),0]),B.fs(),delete B._55I}yg.superClass.setWidth.call(B,S)},setWidth:function(L){return this.setWidthForce(1>L?1:L)},setHeightForce:function(D){var s=this;if(!s._55I&&!Eq&&s.getHeight()){s._55I=1;var T=s._position.y,E=D/s.getHeight(),c=s.toPoints(),r=new Vn;c.each(function(W){r.add({x:W.x,y:(W.y-T)*E+T,e:W.e})}),s.setPoints(r),Wr(s,[1,0,0,E,0,T*(1-E)]),s.fs(),delete s._55I}yg.superClass.setHeight.call(s,D)},setHeight:function(i){return this.setHeightForce(1>i?1:i)},setAnchorElevation:function(L){var p=this;p._55I=!0;var f=p._updatingAnchor3d,J=!Eq&&!f;if(J){var o,F=L,O=p.getAnchorElevation(),V=p.getTall();o=V*(O-F),p.shiftPointsElevation(o)}var Q=yg.superClass.setAnchorElevation.apply(p,arguments);return f||delete p._55I,Q},getShapeElevation:function(){var d=this,Z=d._54O;return Z-(d.getTall()||0)*(d._anchorElevation-.5)},setAnchor3d:function($,P,V,A){var s,E=this;"number"==typeof $?s={x:$,y:P,z:V}:(s=$.length?{x:$[0],y:$[1],z:$[2]}:$,A=P),E._55I=!0,E._updatingAnchor3d=!0;var X=E.getDataModel();if(X&&X.beginTransaction(),!Eq){var p=E.getAnchor3d(),f=E.getSize(),d=E.getTall(),t=f.width*(p.x-s.x),o=f.height*(p.z-s.z),y=d*(p.y-s.y);A||E.shiftPoints(t,o,y);var M=E.p3()}var x=yg.superClass.setAnchor3d.apply(E,arguments);if(!Eq&&A){var U=E.p3();E.shiftPoints(U[0]-M[0]+t,U[2]-M[2]+o,U[1]-M[1]+y)}return X&&X.endTransaction(),delete E._updatingAnchor3d,delete E._55I,x},setAnchor:function(b,I,l){var L=this;L._55I=!0;var N=L._updatingAnchor3d,V=!Eq&&!N;if(V){var T,v,F;"number"==typeof b?F={x:b,y:I}:(F=b.length?{x:b[0],y:b[1]}:b,l=I);var B=L.getAnchor(),Y=L.getSize();T=Y.width*(B.x-F.x),v=Y.height*(B.y-F.y),l||L.shiftPoints(T,v);var f=L.getPosition()}var i=yg.superClass.setAnchor.apply(L,arguments);if(V){var n=L.getPosition();l&&L.shiftPoints(n.x-f.x+T,n.y-f.y+v)}return N||delete L._55I,i},shiftPoints:function(f,K,T){var g=this,c=g.getElevation()||0,q=g.toPoints(),W=new Vn;q.each(function(Q){var J=Q.e;T&&(J=(J==B?c:J)+T),W.add({x:Q.x+f,y:Q.y+K,e:J})}),g.setPoints(W),g.fs()},shiftPointsElevation:function(U){return this.shiftPoints(0,0,U)},setPosition:function(B,j){var z,O=this;if(!O._28Q){if(O._28Q=1,!O._55I&&!Eq){z=2===arguments.length?{x:B,y:j}:B;var T=z.x-O._position.x,E=z.y-O._position.y;if(0===T&&0===E)return delete O._28Q,void 0;O._55I=1,O.shiftPoints(T,E),Wr(O,[1,0,0,1,T,E]),delete O._55I}yg.superClass.setPosition.apply(O,arguments),delete O._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var j=this;if(2!==j._59O.size())return!1;var Q=j._58O;return Q?2===Q.size()&&1===Q.get(0)&&2===Q.get(1)?!0:!1:!0},fireShapeChange:function(){var $=this;if(!$._55I&&!Eq){var R=qh($._59O);R&&($._55I=1,$.setRect(R),delete $._55I)}$.fp(Oh,!1,!0)},getSerializableProperties:function(){var f=yg.superClass.getSerializableProperties.call(this);return f.segments=1,f.points=1,f.thickness=1,f.closePath=1,f}});var sd=u.Polyline=function(){lr(sd,this),this.s({"shape.background":null,"shape.border.width":2})};dk("Polyline",yg,{_icon:"polyline_icon",_22Q:function(){return _n},getUIClass:function(){return Fk},setClosePath:function(){},setTall:function(R){var S=this;if(!S._55I&&!S._24Q&&!Eq&&S.getTall()){S._24Q=1;var e=S._54O,f=R/S.getTall();S._59O.each(function(Q){Q.e=Q.e==B?e:(Q.e-e)*f+e}),S.fs(),delete S._24Q}sd.superClass.setTall.call(S,R)},setElevation:function(m){var r=this;if(!r._55I&&!r._24Q&&!Eq){r._24Q=1;var F=m-r._54O;r._59O.each(function(g){g.e==B?g.e=m:g.e+=F}),r.fs(),delete r._24Q}sd.superClass.setElevation.apply(r,arguments)},fireShapeChange:function(){var M=this,I=M._59O;if(!M._55I&&!M._24Q&&!Eq){var f=I.size();if(f){var a=1,P=I.get(0),O=M._54O;P.e==B&&(P.e=O);for(var q=P.e,Y=0;f>a;a++){P=I.get(a),P.e==B&&(P.e=O);var F=s(q,P.e),r=_(q+Y,P.e);q=F,Y=r-F}M._24Q=1,M.setTall(Y),M.setElevation(q+Y*M._anchorElevation),delete M._24Q}}sd.superClass.fireShapeChange.apply(M,arguments)}});var ee=u.SubGraph=function(){lr(ee,this)};dk("SubGraph",Fb,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){ee.superClass._8I.call(this),this.eachChild(function(P){$o(P)&&P._8I()})}}),w.loadingRefGraph=0;var Tb=u.RefGraph=function(){lr(Tb,this)};dk("RefGraph",Vp,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(Q){var E=this._ref;this._ref=Q,this.fp("ref",E,Q),this.updateRef()},_21I:function(){Tb.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var o=this;if(w.loadingRefGraph++,o.clearChildrenFromDataModel(),w.loadingRefGraph--,o._ref&&o._dataModel){o._xhrLoadHandler&&(o._xhrLoadHandler.cancel=!0);var H=Eq,b=o._xhrLoadHandler=function(S){if(S&&o._dataModel){w.loadingRefGraph++;var M=o._pendingUpdateInfo={needToRestore:H};H&&(M.position=o.p(),M.width=o.getWidth(),M.height=o.getHeight(),M.rotation=o.getRotation(),M.anchor=o.getAnchor(),M.scale=o.getScale()),o.p(0,0),o.setAnchor(.5,.5),o.setRotation(0),o.setScale(1,1);var t=w.parse(S),L=o._dataModel.deserialize(t,o,{justDatas:!0});L.each(function(S){S._refGraph=o}),o.checkPendingUpdateInfo(),w.loadingRefGraph--,w.handleRefGraphLoaded(o,L,t)}};b.xhrLoadCalled=!1,w.load(o._ref,function(u){b.cancel||(b.xhrLoadCalled?b(u):Wo(function(){b(u)}))}),b.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var S=this,X=S._pendingUpdateInfo;if(!X)return S.onPendingUpdated&&(w.loadingRefGraph++,S.onPendingUpdated(),w.loadingRefGraph--),void 0;var y=!0;this.eachChild(function(I){(I._pendingCheckImageJSON||I._pendingUpdateInfo)&&(y=!1)}),y&&(w.loadingRefGraph++,S._pendingUpdateInfo=null,S.updateFromChildren(),X.needToRestore&&(S.setSize(X.width,X.height),S.setAnchor(X.anchor),S.setRotation(X.rotation),S.setScale(X.scale),S.p(X.position)),this.getParent()instanceof Tb&&this.getParent().checkPendingUpdateInfo(),S.onPendingUpdated&&S.onPendingUpdated(),w.loadingRefGraph--)},getSerializableProperties:function(){var F=Tb.superClass.getSerializableProperties.call(this);return F.ref=1,F}}),u.EdgeGroup=function(G,U){this._70O=G,this._siblings=U;for(var M,D,f=0,r=G.size(),S=F[dq];r>f;f++)if(M=G.get(f).getStyle(dq,!1),M!=B){S=M;break}S==B&&(S=!0);var q=w.edgeGroupAgentFunc;for(q&&(D=q(G),D&&D!==G.get(0)&&(G.remove(D),G.add(D,0))),f=0;r>f;f++)G.get(f).s(dq,S)},dk("EdgeGroup",J,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(d){return this._70O.get(d)},indexOf:function(i){return this._70O.indexOf(i)},each:function(U,q){this._70O.each(U,q)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(u,e){this._siblings.each(function(b){b._70O.each(u,e)})}});var lk=function(h,A,J){var _=qk[h]={type:h,action:A};if(J)for(var j in J)_[j]=J[j]};_p(w,{setConnectAction:lk,getConnectAction:function(R,l){if(!l){if(!R)return null;l=R.getCurrentConnectActionType()}return qk[l]},doConnectAction:function(H,Y,j,C){C=C||H.getCurrentConnectActionType();var m=qk[C];if(!m)return!1;var B=m.action;return B?(Y instanceof Mh.Group?H.sm().getSelection().each(function(V){B.call(null,H,V,j)}):B.call(null,H,Y,j),!0):!1},doDeleteConnectionAction:function(U,Q,f){f=f||U.getCurrentConnectActionType();var k=qk[f];if(!k||!k.delete)return!1;var y=k.delete.action;return y?(Q instanceof Mh.Group?U.sm().getSelection().each(function(b){y.call(null,U,b)}):y.call(null,U,Q),!0):!1}});var Jd=u.JSONSerializer=function(E,Z){this.dm=this._dataModel=E,this._hierarchical=w.forceHierarchicalSerialization?!0:Z==B?E.isHierarchicalRendering():Z};dk("JSONSerializer",J,{ms_ac:["hierarchical"],serialize:function(O){return w.stringify(this.toJSON(),O)},toJSON:function(){var J=this,t=J.dm,j=t.getRoots(),E=J.json={v:w.getVersion(),p:{},a:{},d:[]},r=t.getSerializableAttrs();t.getInit()&&(E.init=t.getInit()),t.getName()&&(E.p.name=t.getName()),t.getBackground()&&(E.p.background=t.getBackground()),t.getLayers()&&(E.p.layers=t.getLayers()),t.getEnvmap()&&(E.p.envmap=t.getEnvmap()),E.p.autoAdjustIndex=t.isAutoAdjustIndex(),E.p.hierarchicalRendering=t.isHierarchicalRendering();for(var M in r){var $=t.a(M);$!==I&&J[Ee](M,$,E.a)}return dg(E.a)&&delete E.a,J._hierarchical?j.each(J.serializeData,this):t.each(function(u){J.serializeData(u)}),t.fireSerializeEvent({type:"serialize",json:E}),t.getPostProcessingData()&&(E.p.postProcessingData=t.getPostProcessingData()),E},isSerializable:function(){return!0},getProperties:function(V){return V.getSerializableProperties()},getStyles:function(z){return z.getSerializableStyles()},getAttrs:function(K){return K.getSerializableAttrs()},serializeData:function(c){var T=this;if(T.isSerializable(c)&&!c._refGraph){var r,W,M,h,Y=_q(c.getClassName())||c.getClass(),b=new Y,f={c:c.getClassName(),i:c.getId(),p:{},s:{},a:{}};T.json.d.push(f),r=T.getProperties(c);for(W in r)if(/^_/.test(W)){if(M=c[W],("_width"===W||"_height"===W)&&M===I){var B;((c.s("layout.h")||c.s("layout.v"))&&c.getHost()||c instanceof u.Node&&(B=c.getParent())&&B instanceof u.Block||c.s("fullscreen"))&&(M=c[W]="_width"===W?c.getWidth():c.getHeight())}M!==b[W]&&T[Ee](W.substr(1),M,f.p)}else h=mc(W),c[h]&&(M=c[h](),M!==b[h]()&&T[Ee](W,M,f.p));r=T.getStyles(c);for(W in r)M=c.s(W),M!==b.s(W)&&T[Ee](W,M,f.s);r=T.getAttrs(c);for(W in r)M=c.a(W),M!==b.a(W)&&T[Ee](W,M,f.a);dg(f.p)&&delete f.p,dg(f.s)&&delete f.s,dg(f.a)&&delete f.a}T._hierarchical&&c.getChildren().each(T.serializeData,T)},serializeValue:function(P,L,f){qf(L)?L={__a:L._as}:L instanceof db&&(L={__i:L.getId()}),f[P]=L},deserialize:function(z,B,o){var Q=this;return Ug(z)&&/.json$/.test(z)?(w.xhrLoad(z,function(i){Q.deserializeImpl(i,B,o)}),void 0):Q.deserializeImpl(z,B,o)},deserializeImpl:function(C,v,x){var y=this,c=y.dm;x=Bi(x)?{setId:x}:Im(x)?{finishFunc:x}:x||{},C=y.json=Ug(C)?w.parse(C):C,C.a&&C.a.onPreDeserialize&&!x.disableOnPreDeserialize&&C.a.onPreDeserialize(C,c,x.view),c.beginTransaction(),Eq++,y._82I={};var Y=new Vn,J=new Vn,R=0,d=C.d.length;if(x.justDatas||(Im(C.init)&&C.init(c),c.setInit(C.init)),!x.justDatas){for(var k in C.a)c.a(k,y[ib](C.a[k]));for(var H in C.p)c[dd(H)](C.p[H])}for(;d>R;R++){var p=C.d[R],t=_q(p.c),b=new t,W=p.i;x.setId&&W!=B&&(b._id=W),y._82I[W]=b,Y.add(b),J.add(p)}for(R=0;d>R;R++)y.deserializeData(Y.get(R),J.get(R));return Y.each(function(S){v&&!S.getParent()&&S.setParent(v),c.add(S)}),c.fireSerializeEvent({type:"deserialize",json:C}),Eq--,c.endTransaction(),C.a&&C.a.onPostDeserialize&&!x.disableOnPostDeserialize&&C.a.onPostDeserialize(C,c,x.view,Y),x.finishFunc&&x.finishFunc(C,c,x.view,Y),Y},deserializeData:function(b,I){for(var r in I.p)b[dd(r)](this[ib](I.p[r]));for(r in I.s)b.s(r,this[ib](I.s[r]));for(r in I.a)b.a(r,this[ib](I.a[r]))},deserializeValue:function($){if(ei($)){var f=$.__i;if(f!=B)return this._82I[f];if(f=$.__a,Zh(f))return new Vn(f)}return $}}),_p(Hc,{serialize:function(v,U){return new Jd(this,U).serialize(v)},toJSON:function(O){return new Jd(this,O).toJSON()},deserialize:function(Z,g,S){return new Jd(this).deserialize(Z,g,S)}});var Rp=u.OverlappingBox=function(k){this.gv=k,this.boxes={}};dk("OverlappingBox",J,{clear:function(){var z,u,q=this.boxes;for(z in q)u=q[z],u.length=0},isOverlapping:function(Z,s){var c,P,B=this,v=B.boxes,H=v[Z];H?(c=H.rects,P=H.length):H=v[Z]={rects:c=[],length:P=0};var m,a,s;for(m=0;P>m;m++)if(a=c[m],a.x<s.x+s.w&&a.x+a.w>s.x&&a.y<s.y+s.h&&a.h+a.y>s.y)return!0;return c.length<=P?(c.push(s),H.length++):c[H.length++]=s,!1}}),_p(w,{fetch:function(M,z){var Q="GET",G=!1,w=null,k="";z&&(Q=z.method||"GET",G=z.sync,k=z.url,w=z.data||null),M.open(Q,k,!G),z.responseType?M.responseType=z.responseType:z.overrideMimeType&&M.overrideMimeType&&M.overrideMimeType(z.overrideMimeType),M.send(w)},convertImageSrc:function(B,M){M&&"function"==typeof M||(M=function(){}),M(B)}});var $n=u.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};dk("Request",J,{_responseType:null,_overrideMimeType:"text/plain",send:function(m){var k=this._xhr,P=this.onload,p=this.onerror;this.getResponseType()?m.responseType=this.getResponseType():this.getOverrideMimeType()&&(m.overrideMimeType=this.getOverrideMimeType()),k.onload=P,k.onerror=p,w.fetch(k,m)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(Y){this._responseType=Y},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(x){this._overrideMimeType=x},getResponseText:function(){var K=this._xhr;return K.response||K.responseText}}),cq.GraphView=function(F){var g=this;g._24I={},g._34I=new Vn,g._25I={},g._56I={},g._view=wk(1,g),g._canvas=vn(g._view),g.dm(F?F:new Hc),this._coreInteractor=new bf(this),g.setEditable(!1),g.setScrollBarVisible(w.graphViewScrollBarVisible)},am("GraphView",J,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[bb,yk,Se,_b,"resettable","editInteractor",xe,"zoomable","pannable","rectSelectable","autoScrollZone",lj,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:w.graphViewZoomable,_resettable:w.graphViewResettable,_pannable:w.graphViewPannable,_rectSelectable:w.graphViewRectSelectable,_autoScrollZone:w.graphViewAutoScrollZone,_rectSelectBackground:w.graphViewRectSelectBackground,_rectSelectBorderColor:w.graphViewRectSelectBorderColor,_editPointSize:w.graphViewEditPointSize,_editPointBorderColor:w.graphViewEditPointBorderColor,_editPointBackground:w.graphViewEditPointBackground,_scrollBarColor:jg,_scrollBarSize:el,_autoHideScrollBar:km,_autoMakeVisible:dp,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(L){this._dataModel.setLayers(L)},setEditable:function(z){var v=this,y=v.__interactorMap__;if(!y){var F=cq.XEditInteractor;y=v.__interactorMap__={scrollBar:new be(v),select:new Le(v),edit:F?new F(v):new sn(v),text:new Ti(v),move:new Io(v),"default":new We(v),touch:new ff(v,{editable:!1})}}z?(v._uieditable=!0,v.setInteractors([y.scrollBar,y.select,y.edit,y.text,y.move,y.default,y.touch])):(v._uieditable=!1,v.setInteractors([y.scrollBar,y.select,y.move,y.default,y.touch]))},getCanvas:function(){return this._canvas},_33I:function(V){var t=V.getUIClass();return t?new t(this,V):B},getDataUI:function(e){var Q=this,f=Q._25I[e._id];return f===I&&(f=Q._33I(e),Q._25I[e._id]=f),f},getNodeRect:function(T){return w.getNodeRect(this,T)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(x){var A=this.getDataUI(x);return A?(A._79o(),A._78o):null},getEdgeSourcePosition:function(a){var d=this,q=d.getDataUI(a),c=q.s,i=q._data._40I;return In(d,i,c("edge.source.position"),c("edge.source.offset.x"),c("edge.source.offset.y"),c("edge.source.anchor.x"),c("edge.source.anchor.y"))},getEdgeTargetPosition:function(q){var C=this,u=C.getDataUI(q),S=u.s,n=u._data._41I;return In(C,n,S("edge.target.position"),S("edge.target.offset.x"),S("edge.target.offset.y"),S("edge.target.anchor.x"),S("edge.target.anchor.y"))},invalidateAll:function(F){var _=this;if(F){for(var B in _._25I){var l=_._25I[B];l&&l.dispose()}_._25I={},_._56I={},_._24I={},_._34I.clear(),_.redraw()}else _.dm().each(function(U){_.invalidateData(U)})},invalidateSelection:function(){var i=this;i.sm().each(function(m){i.invalidateData(m)})},invalidateData:function(V){var l=this;l._24I[V._id]=V,l._21Q(V),l.iv()},_21Q:function(F){var r=this,J=r._24I;if(cr(F)&&Oj[F.s(kr)]){var R=F.getSourceAgent();R&&R.getAgentEdges().each(function(t){J[t._id]=t}),R=F.getTargetAgent(),R&&R.getAgentEdges().each(function(R){J[R._id]=R}),r.iv()}},redraw:function(b){var h=this;h._32I||(b?h._34I.add(b):(h._32I=1,h._34I.clear()),h.iv())},each:function(S,O){var D,q,n,T=0,i=this.getLayers(),t=this._dataModel,j=t._datas._as,f=j.length;if(i){for(var R=i.length;R>T;T++)if(n=i[T],ei(n)&&(n=n.name),t.isHierarchicalRendering()){var _=function(F){return F._layer===n?O?S.call(O,F):S(F):void 0};if(this._dataModel.eachByHierarchical(_)===!1)return}else for(var U=0;f>U;U++)if(D=j[U],D._layer===n&&(q=O?S.call(O,D):S(D),q===!1))return}else if(t.isHierarchicalRendering())this._dataModel.eachByHierarchical(S,null,O);else for(;f>T;T++)if(D=j[T],q=O?S.call(O,D):S(D),q===!1)return},reverseEach:function(u,i){var r,C,l,n,T=this._dataModel,D=T._layers,s=T._datas._as,B=s.length;if(D){for(r=D.length-1;r>=0;r--)if(n=D[r],ei(n)&&(n=n.name),T.isHierarchicalRendering()){var L=function(N){return N._layer===n?i?u.call(i,N):u(N):void 0};if(T.reverseEachByHierarchical(L)===!1)return}else for(var P=B-1;P>=0;P--)if(C=s[P],C._layer===n&&(l=i?u.call(i,C):u(C),l===!1))return}else if(T.isHierarchicalRendering())T.reverseEachByHierarchical(u,null,i);else for(r=B-1;r>=0;r--)if(C=s[r],l=i?u.call(i,C):u(C),l===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var D=this,I=D._84I;if(!I){var B=this.dm().a("width"),K=this.dm().a("height");B>0&&K>0?D._84I={x:0,y:0,width:B,height:K}:(D.each(function(v){D.isVisible(v)&&(I=Lh(I,D.getDataUIBounds(v)))}),D._84I=I?I:cp)}return D._84I},getScrollRect:function(){return Lh(this.getContentRect(),this._29I)},makeCenter:function(j,O,G){var a=this;if(!a.getWidth()||!a.getHeight())return G||Wo(a.centerData,a,[j,O,!0],500),void 0;a.makeVisible(j),a.validate();var H=a.getDataUIBounds(j);if(H){var J=a.getWidth(),K=a.getHeight(),B=H.x+H.width/2,L=H.y+H.height/2,C=-B*a._zoom+J/2,M=-L*a._zoom+K/2;a.setTranslate(C,M,O)}},fitData:function(e,W,H,j,K){var P=this;if(!P.getWidth()||!P.getHeight())return K||Wo(P.fitData,P,[e,W,H,j,!0],500),void 0;var S=function(){P.makeVisible(e),P.validate();var m=P.getDataUIBounds(e);m&&(m=Sf(m),em(m,H==B?20:H),P.fitRect(m,W,j))};W?w.callWhenLoaded(S):S()},fitContent:function(Y,X,N,J){var g=this;if(!g.getWidth()||!g.getHeight())return J||Wo(g.fitContent,g,[Y,X,N,!0],500),void 0;var C=function(){g.validate();var u=Sf(g.getContentRect());em(u,X==B?20:X),g.fitRect(u,Y,N)};Y?w.callWhenLoaded(C):C()},fitRect:function(N,W,u){var V=this,O=V.getWidth(),a=V.getHeight(),w=N.x+N.width/2,M=N.y+N.height/2,B=s(O/N.width,a/N.height),f=V._zoom,r=-w*f+O/2,z=-M*f+a/2;0===B||isNaN(B)||(u&&(B=s(1,B)),W?(V._65I&&(delete V._65I.finishFunc,V._65I.stop(!0)),V._14o&&V._14o.stop(!0),V.setTranslate(r,z,{finishFunc:function(){V.setZoom(B,W)}})):(V.setTranslate(r,z),V.setZoom(B)))},toCanvas:function(Z,X){X=X||this._zoom,this.validateImpl();var x=this,K=x.getContentRect();K.width||(K.width=10),K.height||(K.height=10);var R=vn(),Y=K.x*X,c=K.y*X,o=K.width*X,H=K.height*X;Lg(R,o,H,1);var T=oj(R);return Z=Z||this._dataModel.getBackground(),Z&&Xc(T,0,0,o,H,Z),Bn(T,-Y,-c),T.scale(X,X),x._42(T),T.restore(),R},toDataURL:function(s,i,o){return this.toCanvas(s,o).toDataURL(i||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(O,x){var f=this,s=f.dm().getBackground();if(s){var H=f.dm().a("width"),d=f.dm().a("height");H>0&&d>0&&Xc(O,0,0,H,d,s)}var q=f.__htmlOrderList,b=[];if(f._93db(O,x),f.each(function(g){var U=f.getDataUI(g);if(U){var y=f._56I[g._id],R=U._htmlView;if(y){var Y=U._79o();if(R=U._htmlView,u.HtmlNode&&g instanceof u.HtmlNode)U._42(O);else{var J=f.getViewRect(),t=R&&R.layoutHTML;!x||Pn(x,Y)?(t&&(R.layoutHTML(),U.__outerLayout&&delete U.__outerLayout),U._42(O)):Pn(J,Y)||!t||U.__outerLayout||(R.layoutHTML(),U.__outerLayout=!0)}}R&&(b.push(R),R.getView&&(R=R.getView()),R.style.display=y?"block":Iq)}}),q&&b.length>0){var e=!1;if(q.length!==b.length)e=!0;else for(var z=0;z<b.length;z++)if(b[z]!==q[z]){e=!0;break}e&&(b.forEach(function(q){f.appendHTML(q,!0)}),this.__htmlOrderList=b)}else this.__htmlOrderList=b;f._92db(O,x)},validateImpl:function(){this.tryUpdateRootData();var R,Q,g,b,K,k=this,a=k.tx(),y=k.ty(),F=k._zoom,r=k._canvas,n=this.getWidth(),O=this.getHeight(),u=k._29I,Z={x:-a/F,y:-y/F,width:n/F,height:O/F},m={},e=k._34I,s=k._24I,U=k._32I,t=k._23I;k._24I={},(n!==r.clientWidth||O!==r.clientHeight)&&(Lg(r,n,O),U=1),U||un(Z,u)||(U=1),k._29I=Z,k.each(function(L){Q=L._id;var X=m[Q]=k.isVisible(L);X!==k._56I[Q]&&(s[Q]=L,g=k.getDataUI(s[Q]),g&&g._84o(X),k._84o(L,X))},k);for(Q in s)g=k.getDataUI(s[Q]),g&&(!U&&k._56I[Q]&&(K=g._79o(),K&&e.add(K)),g.invalidate()),k._83I=1;if(k._56I=m,!U)for(Q in s)m[Q]&&(g=k.getDataUI(s[Q]),g&&(K=g._79o(),K&&e.add(K)));if(U?b=Z:(e.each(function(u){Pn(Z,u)&&(b=Lh(b,u))}),b&&(em(b,_(1,1/F)),b.x=S(b.x*F)/F,b.y=S(b.y*F)/F,b.width=M(b.width*F)/F,b.height=M(b.height*F)/F,b=Kr(Z,b))),k._74O=b,b){R=oj(r);var o=b.x,W=b.y,w=b.width,I=b.height;o=Math.floor((o*F+a)*Am),W=Math.floor((W*F+y)*Am),w=Math.ceil(w*F*Am)+1,I=Math.ceil(I*F*Am)+1,R.beginPath(),R.rect(o,W,w,I),R.clip(),R.clearRect(o,W,w,I),Id(R,a,y,F),k._42(R,b),R.restore(),delete k._74O}if(e.clear(),delete k._32I,t&&n>0&&O>0){var g=k.getDataUI(t);if(g){var K=g._79o(),Y=k._29I,l=Y.x,E=Y.y,X=Y.width,i=Y.height,F=k._zoom;K&&!Pn(K,Y)&&(K.x+K.width<l&&k.tx(-K.x*F),K.x>l+X&&k.tx(-(K.x+K.width-X)*F),K.y+K.height<E&&k.ty(-K.y*F),K.y>E+i&&k.ty(-(K.y+K.height-i)*F))}delete k._23I}k._83I&&(delete k._83I,delete k._84I),k._98O(),k.countFrame(),dg(k._24I)||Wo(k.iv,k)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var q,Y=this.getFullscreenDatas();for(var $ in Y)q=Y[$],this.scaleRootData(q);this._rootDataUpdating=!1}},scaleRootData:function(Y){var Z=Y.s("fullscreen");if("uniform"===Z||"fill"===Z){Y.getRotation()&&Y.setRotation(0);var H=Y.s("fullscreen.gap")||0,l=this.getWidth(),L=this.getHeight();if(l&&L){var j,z,T,C=l-2*H,J=L-2*H,A=Y.getAnchor(),a=Y.getScaledSize(),I=a.width,M=a.height,R=Y.s("fullscreen.lock");if(R)return"uniform"===Z?C/J>I/M?(j=J/M,I=M*C/J):(j=C/I,M=I*J/C):"v"===R?(j=J/M,I=C/j,Y.getWidth()!==I&&Y.setWidth(I)):(j=C/I,M=J/j,Y.getHeight()!==M&&Y.setHeight(M)),this.setZoom(j),z=H-(Y.getX()-A.x*I)*j,T=H-(Y.getY()-A.y*M)*j,z!==this.tx()&&this.tx(z),T!==this.ty()&&this.ty(T),void 0;z=this.tx(),T=this.ty(),j=this._zoom;var b={x:(-z+H)/j,y:(-T+H)/j,width:C/j,height:J/j};if("uniform"===Z){var X=I/M,$=Math.min(b.width,b.height*X),u=$/X;b.x+=.5*(b.width-$),b.y+=.5*(b.height-u),b.width=$,b.height=u}C=b.width/Y.getScaleX(),J=b.height/Y.getScaleY(),(Y.getWidth()!=C||Y.getHeight()!==J)&&Y.setSize(C,J);var V=b.x+A.x*b.width,e=b.y+A.y*b.height,D=Y.getPosition();(V!==D.x||e!==D.y)&&Y.setPosition(V,e)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(f){var h=this;f!==h.isScrollBarVisible()&&(f?(Oi(h._view,h._79O=ms()),Oi(h._79O,h._27I=ms()),Oi(h._79O,h._28I=ms())):(ih(h._79O),delete h._79O,delete h._27I,delete h._28I),h.fp("scrollBarVisible",!f,f))},getDebugTip:function(){return""},showScrollBar:function(){var t=this;t._79O&&(t._85I||(nd(function(){t._86I()},Fl),t.iv()),t._85I=new Date)},_86I:function(){var M=this;if(M._85I){var i=new Date,n=i.getTime();n-M._85I.getTime()>=Fl?(delete M._85I,M.iv()):nd(function(){M._86I()},Fl)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var n=this,C=this._27I,k=this._28I;if(n._79O){if(n._autoHideScrollBar&&!n._85I)return C.style.visibility=Ub,k.style.visibility=Ub,void 0;var m=n.getScrollBarColor(),i=n._zoom,d=n.getScrollBarSize(),N=n.getViewRect(),F=n.getScrollRect(),I=N.height*i,O=F.height*i,Z=N.width*i-d-2,X=I*((N.y-F.y)*i/O),P=I*(I/O),B=C.style;O-.5>I?(bg>P&&(X=X+P/2-bg/2,0>X&&(X=0),X+bg>I&&(X=I-bg),P=bg),Bb(C,Z,X,d,P),B.visibility=sh,B.background=m,B.borderRadius=d/2+bi):B.visibility=Ub;var Y=N.width*i,c=F.width*i,X=N.height*i-d-2,Z=Y*((N.x-F.x)*i/c),g=Y*(Y/c),B=k.style;c-.5>Y?(bg>g&&(Z=Z+g/2-bg/2,0>Z&&(Z=0),Z+bg>Y&&(Z=Y-bg),g=bg),Bb(k,Z,X,g,d),B.visibility=sh,B.background=m,B.borderRadius=d/2+bi):B.visibility=Ub}},setDataModel:function(p){var q=this,M=q._dataModel,W=q._selectionModel;M!==p&&(M&&(M.ump(q.handleDataModelPropertyChange,q),M.umm(q.handleDataModelChange,q),M.umd(q.handleDataPropertyChange,q),M.removeIndexChangeListener(q._75O,q),M.removeHierarchyChangeListener(q.handleHierarchyChange,q),W||M.sm().ums(q.handleSelectionChange,q)),q._dataModel=p,p.mp(q.handleDataModelPropertyChange,q),p.mm(q.handleDataModelChange,q),p.md(q.handleDataPropertyChange,q),p.addIndexChangeListener(q._75O,q),p.addHierarchyChangeListener(q.handleHierarchyChange,q),W?W._21I(p):p.sm().ms(q.handleSelectionChange,q),q.invalidateAll(!0),q.fp(nh,M,p),q.updateBackground())},getLayersInfo:function(){if(this._layersInfo===I){var E=this.getLayers();E?(this._layersInfo={},E.forEach(function(F){var H=ei(F)?F.name:F;this._layersInfo[H]=F},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(v,O,g){var f,z,M=this,$=M.getDataUI(v),P=Lp($),a=_l(O,function(b){return _k(P,100*b)},100,.001),w=_k(P,100*a);if(!g){var Y=Lf($),Z=new ps(w.x,w.y),h=49/(M._zoom*M._zoom);for(f=0,z=Y.length;z>f;f++)if(Z.distanceToSquared(Y[f])<h)return{index:f,point:Y[f],distance:Math.sqrt((Y[f].x-O.x)*(Y[f].x-O.x)+(Y[f].y-O.y)*(Y[f].y-O.y))}}return{percent:a,point:w,distance:Math.sqrt((w.x-O.x)*(w.x-O.x)+(w.y-O.y)*(w.y-O.y))}},calculateAttachPoint:function(){var G=new ps,u=new ps,R=new ps;return function(I,f){var b=this.getAttachPoints(I);if(!b||!b.length)return null;R.set(f.x,f.y);for(var r,N,s,D,c=1/0,T=0,l=b.length;l>T;T++)s=b[T],u.x=s.x,u.y=s.y,G.x=s.offsetX||0,G.y=s.offsetY||0,D=In(this,I,0,G.x,G.y,u.x,u.y),N=R.distanceToSquared(D),c>N&&(r=T,c=N);c=Math.sqrt(c);var j=this.getAttachStyle(I);if("close"===j){var X=I.s("attach.close.threshold")/this._zoom;if(c>X)return null}return{index:r,distance:c,info:b[r]}}}(),getAttachPoints:function(x){var X=x.s("attach.points");if(X)return X;var e=Ve(x._image);return e?lg(e.attachPoints,x,this)||null:void 0},getAttachStyle:function(w){var y=w.s("attach.style");if(y)return y;var x=Ve(w._image);return x?lg(x.attachStyle,w,this)||"close":void 0},updateLayers:function(){this._layersInfo=I,this.invalidateSelection(),this.redraw()},updateBackground:function(){var k=this.dm().a("width"),C=this.dm().a("height");this._canvas.style.background=k>0&&C>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(R){if("background"===R.property){var q=this._canvas.style.background,y=R.newValue||"";this.updateBackground(),this.fp("canvasBackground",q,y),this.redraw()}else"a:width"===R.property||"a:height"===R.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===R.property?this.updateLayers():"hierarchicalRendering"===R.property&&this.redraw()},handleDataPropertyChange:function(g){this.dm().isHierarchicalRendering()&&"parent"===g.property&&g.data.hasChildren()&&this.redraw(),this.invalidateData(g.data)},onPropertyChanged:function(i){var c=this,X=i.property;if(c.redraw(),"zoom"===X){var l=c.sm().getSelection();l.size()&&l.each(function(E){E.invalidate()})}_c[X]?c.showScrollBar():X===xe&&c.onCurrentSubGraphChanged(i)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(r){var D=this,R=r.kind,I=r.data;if(D._83I=1,"add"===R)D.invalidateData(I),cr(I)&&I.getEdgeGroup()&&I.getEdgeGroup().eachSiblingEdge(D.invalidateData,D);else if(R===Te){D._21Q(I);var s=I._id,i=D._25I[s];if(i){if(D._56I[s]){var b=i._79o();b&&D.redraw(b)}i.dispose(),delete D._25I[s],delete D._24I[s],delete D._56I[s]}I===D._currentSubGraph&&D.setCurrentSubGraph(B)}else R===Zj&&(D.invalidateAll(!0),D.setCurrentSubGraph(B))},_75O:function(U){this.invalidateData(U.data)},handleHierarchyChange:function(K){this.dm().isHierarchicalRendering()&&K.data.hasChildren()&&this.redraw(),this.invalidateData(K.data)},adjustIndex:function(J){var T=this;if(T.isVisible(J)){T.dm().beginTransaction();for(var $=J;$._parent&&T.isVisible($._parent);)$=$._parent;$&&$!==J&&T._dataModel.adjustIndex($),T._dataModel.adjustIndex(J),T.dm().endTransaction()}},getImage:function(F){return F.getImage?F.getImage():I},getSelectWidth:function(F){var X=Ve(this.getImage(F));return X&&lg(X.disableSelectedBorder,F,this)?0:F.s("select.width")},getSelectColor:function(b){return b.s("select.color")},isSelectable:function(o,r){if(this.isSelected(o))return!0;if(!r&&o.getParent()instanceof Vp&&this.isSelectable(o.getParent(),!0)&&o.getParent().isSyncSize())return!1;var G=this.getLayersInfo();if(G){var N=G[o._layer];if(N&&N.selectable===!1)return!1}return o.s("2d.selectable")&&this.sm().isSelectable(o)},isMovable:function(A){var z=this;if(cr(A)&&A.getStyle(kr)!==tf)return!1;var r=this.getLayersInfo();if(r){var t=r[A._layer];if(t&&t.movable===!1)return!1}return A.s("2d.movable")?z._movableFunc?z._movableFunc(A):!0:!1},isEditable:function(M){var O=this;if(u._uiSerializing)return O._uieditable;if(!O._editInteractor||!O.isSelected(M))return!1;if(oo(M)){var A=O.getDataUI(M);if(!A||A._88I)return!1}if(cr(M)&&M.getStyle(kr)!==tf)return!1;var o=this.getLayersInfo();if(o){var t=o[M._layer];if(t&&t.editable===!1)return!1}return M.s("2d.editable")?O._editableFunc?O._editableFunc(M):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(H){return $o(H)&&0!==H.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(H):!0},isRectEditable:function(W){return this._rectEditableFunc?this._rectEditableFunc(W):!0},isAnchorEditable:function(R){return this._anchorEditableFunc?this._anchorEditableFunc(R):!0},isRotationEditable:function(P){return P.setRotation&&P.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(P):!0:!1},getRotationPoint:function(m){var V=m.getAnchor(),v=m.getScale(),l=this._zoom,c=gs(m.getRotation(),0,-m.getHeight()*v.y*V.y-(v.y<0?-1:1)*(xc?32:16)/l),n=m.p();return c.x+=n.x,c.y+=n.y,c},getLogicalPoint:function(q){var c=this;return xn(q,c._canvas,c.tx(),c.ty(),c._zoom,c._zoom)},getScreenPoint:function(y,x){var G,k=this;return"object"==typeof y?y.x!==I?(G=y.x,x=y.y):(G=y[0],x=y[1]):G=y,yj(G,x,k._canvas,k.tx(),k.ty(),k._zoom,k._zoom)},getSelectedDataAt:function(G){var q=this;return this.getDataAt(G,function(E){return q.isSelected(E)})},getDataInfoAt:function(W,Y,L){var d,S=this.lp(W),b=this.getDataAt(S,Y,L);if(b){var P=this.getDataUI(b);d={data:b,ui:P,point:S};var p=P._38o;if(p){var U=p.icons;for(var F in U){var C=U[F],g=p.rects[F];if(g)for(var A=lg(C.names,b,this),K=A?A.length:0,H=g.rotation,x=K-1;x>=0;x--){var o=A[x],q=g[x];if(fr(q,S,H))return d.part="icons",d.name=F,d.icon=o,d.rect=q,d.index=x,d.rotation=H,d}}}if(this.isNoteVisible(b)){if(P.note2Info&&fr(P.note2Info.clickRect,S,B,P.note2Info.scale))return d.part="note2",d;if(P.noteInfo&&fr(P.noteInfo.clickRect,S,B,P.noteInfo.scale))return d.part="note",d}if(this.isLabelVisible(b)){if(P.label2Info&&fr(P.label2Info.rect,S,P.label2Info.rotation,P.label2Info.scale))return d.part="label2",d;if(P.labelInfo&&fr(P.labelInfo.rect,S,P.labelInfo.rotation,P.labelInfo.scale))return d.part="label",d
}if(b.isInRect&&b.isInRect(S))return d.part="body",d}return d},getDataAt:function(r,A,G){r.target&&(r=this.lp(r));var Z,U=this._zoom;return this.reverseEach(function(s){return(A?A(s):this.isSelectable(s))&&this.rectIntersects(s,oq(r.x,r.y,G,U))?(Z=s,!1):void 0},this),Z},getIconInfoAt:function(Q,m){var J=this;if(Q.target&&(Q=J.lp(Q)),m||(m=J.getDataAt(Q)),m){var G=J.getDataUI(m);if(G&&G._38o){var h,O=G._38o,x=new Vn;for(h in O.icons)x.add(h);for(var y=x.size()-1;y>=0;y--){h=x.get(y);for(var C=O.rects[h],V=C.rotation,L=C.length-1;L>=0;L--){var K=C[L],s=K.width,u=K.height,X={x:Q.x-K.x-s/2,y:Q.y-K.y-u/2};V!=B&&(X=gs(-V,X.x,X.y));var K={x:-s/2,y:-u/2,width:s,height:u};if(fr(K,X))return{key:h,index:L,name:O.icons[h].names[L],rect:C[L],point:Q,rotation:V,relativeRect:K,relativePoint:X,data:m}}}}}return B},getDatasInRect:function(R,G,z){z===I&&(z=1);var L=this,M=new Vn;return L.reverseEach(function(h){z&&!L.isSelectable(h)||(G?L.rectIntersects(h,R):L.rectContains(h,R))&&M.add(h)}),M},moveSelection:function(E,p){var e=this;e.dm().beginTransaction(),xo(e.sm().toSelection(e.isMovable,e),E,p),e.dm().endTransaction()},moveDatas:function(g,v,i){var y=this;y.dm().beginTransaction(),g instanceof Vn||(g=new Vn(g)),xo(g,v,i),y.dm().endTransaction()},getDataUIBounds:function(o){var y=this.getDataUI(o);return y?y._79o():B},drawData:function(h,e,F){var z=this.getDataUI(e);if(z){var P=z._79o();(!F||Pn(F,P))&&(z._42(h),e instanceof u.Block&&e.eachChild(function(Y){this.drawData(h,Y,F)},this))}},getBoundsForGroup:function(G){return G.s(yr)?this.getDataUIBounds(G):B},isPixelPerfect:function(o){return o.s("pixelPerfect")},rectIntersects:function(b,p){this.validate();var P=B;if(this._56I[b._id]){var g=this._25I[b._id];if(g){var E=g._79o();if(Ih(p,E))P=!0;else if((p=Kr(p,E))&&(g.rectIntersects&&(P=g.rectIntersects(p)),P==B)){if(!this.isPixelPerfect(b))return!0;var e=p.x,G=p.y,c=p.width,R=p.height,k=this._zoom,y=w.hitMaxArea,V=c*R*k*k;if(V>y){var D=Math.sqrt(y/V);k*=D}c*=k,R*=k,2>c&&(c=2),2>R&&(R=2),e*=k,G*=k;var n=hn(c,R);Bn(n,-e,-G),n.scale(k,k),this._drawForChecking=!0,this.drawData(n,b,p),this._drawForChecking=!1;try{for(var a=0,S=n.getImageData(0,0,c,R).data;a<S.length;a+=4)if(0!==S[a+3]){P=!0;break}n.restore()}catch(I){Up=B,P=!1}}}}return P?!0:!1},rectContains:function(x,F){if(this._56I[x._id]){var f=this._25I[x._id];if(f)return Ih(F,f._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(z){if(!w.isInput(z.target)){var v=this,n=v._focusData,P=n&&v._25I[n._id],j=0,Q=v._dataModel._datas;if(!(n&&n._enabled&&n._editable&&P&&P.onKeyDown&&P.onKeyDown(z)===!0))if(9===z.keyCode&&(n&&(j=Q.indexOf(n),us(z)?-1===--j&&(j=0):++j===Q.size()&&(j=0)),v._focusData=n=Q.get(j),v.sm().setSelection(n)),Ui(z)?v.selectAll():Rg(z)&&v.isResettable()&&v.reset(),v.sm().isEmpty()){if(v._editing)return;var N=v.tx(),p=v.ty(),g=!1,r=us()?100:10;Bk(z)&&(N-=r,g=!0),ls(z)&&(p-=r,g=!0),Vc(z)&&(N+=r,g=!0),gm(z)&&(p+=r,g=!0),g&&v.setTranslate(N,p)}else{_e(z)&&v.handleDelete(z);var L=us()?10:1;Bk(z)&&(v.moveSelection(-L,0),v.fi({kind:"moveLeft"})),ls(z)&&(v.moveSelection(0,-L),v.fi({kind:"moveUp"})),Vc(z)&&(v.moveSelection(L,0),v.fi({kind:"moveRight"})),gm(z)&&(v.moveSelection(0,L),v.fi({kind:"moveDown"}))}}},handleScroll:function(X,D){if(xh(X),this.isZoomable()){if(!this.getEditInteractor()){var A=this.getDataAt(X);if(A){var L=Ve(this.getImage(A));if(L&&lg(L.scrollable,A,this))return}}var h=this.lp(X);D>0?this.scrollZoomIn(h):0>D&&this.scrollZoomOut(h)}},handlePinch:function(M,n,C){this.isZoomable()&&(n>C?this.pinchZoomIn(M):this.pinchZoomOut(M))},checkDoubleClickOnNote:function(u,q){var A=this,W=A.lp(u),K=A.getDataUI(q),G=K.note2Info;return G&&q.s("note2.toggleable")&&fr(G.clickRect,W)?(q.s(To,!q.s(To)),A.fi({kind:"toggleNote2",event:u,data:q}),!0):(G=K.noteInfo,G&&q.s("note.toggleable")&&fr(G.clickRect,W)?(q.s(nb,!q.s(nb)),A.fi({kind:"toggleNote",event:u,data:q}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(W,g){var N=this,Z=N.getAutoScrollZone(),z=Z/N.getZoom(),S=Z/4,I=N._29I,t=N.lp(W),O={x:N.tx(),y:N.ty()};return t&&Z>0&&I&&(t.x-I.x<z?N.translate(S,0):I.x+I.width-t.x<z&&N.translate(-S,0),t.y-I.y<z?N.translate(0,S):I.y+I.height-t.y<z&&N.translate(0,-S)),O.x=N.tx()-O.x,O.y=N.ty()-O.y,g&&(g.x+=O.x,g.y+=O.y),O},getMoveMode:function(Z,o){var U=o.s("2d.move.mode");return U?U:Hr["88"]?"x":Hr["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(U,O,Q){var J=this;return"currentSubGraph"===O?{__i:U.getId()}:Q.serializeProperty(U,O,J)},deserializeProperty:function(d,K,j){var o=this;if("currentSubGraph"===K){var P=o.dm(),g=P.__idMap;return g[d.__i]}return j.deserializeProperty(d,K,o)},setDefaultCursor:function(G,Q){this._defaultCursor=G,Q!==!1&&this.setCursor(G)},setCursor:function(G){"default"===G&&(G=this._defaultCursor||G);var X=this.getView().style;X.cursor=G,X.cursor="-webkit-"+G,X.cursor="-moz-"+G},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(U){return U===B||w.getConnectAction(null,U)?(this._currentActionType=U,this.redraw(),!0):!1},getEditStyle:function(W){var D=this.getEditInteractor();return D?D.getStyle(W):I},setEditStyle:function(x,p,H){var Q=this.getEditInteractor();return Q?(Q.setStyle(x,p,H),!0):!1},isConnectActionVisible:function(H){var z=w.getConnectAction(this);if(!z)return!1;var G=z.visible;return Im(G)&&(G=G(this,H)),G},isInteractive:function(m){var C=Ve(this.getImage(m));return C&&lg(C.interactive,m,this)?!0:m.s("interactive")},appendHTML:function(L,C){var w=this.getView();if(!(C||L&&L.parentNode!==w))return!1;var T=L.getView&&L.getView();if(!C&&T&&T.parentNode===w)return!1;(L.getView||L.isSelfViewEvent)&&(L=L.getView());var S=this.getEditInteractor();return S&&S._canvas?w.insertBefore(L,S._canvas):this.isScrollBarVisible()?w.insertBefore(L,this.getView().lastChild):Oi(w,L),!0},_layoutHTMLImpl:function(s,W,b){if(arguments.length>1){var w,$=this,X=$._zoom;if(W.getView&&(w=W,W=W.getView()),W.style.position="absolute",b){var v=s.getRect();Bb(w||W,$.tx()+v.x*X,$.ty()+v.y*X,v.width*X,v.height*X)}else{var R=new aq,v=s.getAnchorRect(),J=s.getPosition(),t=s.getScale(),p=W.style;Bb(w||W,v),R.appendTranslate($.tx(),$.ty()),R.appendScale(X,X),R.append(new aq(s.getRotation(),J.x,J.y,t.x,t.y)),ul(p,"transform","matrix("+R.a.toFixed(5)+", "+R.b.toFixed(5)+", "+R.c.toFixed(5)+",\n    "+R.d.toFixed(5)+", "+R.tx.toFixed(5)+", "+R.ty.toFixed(5)+")"),ul(p,"transformOrigin",(-v.x).toFixed(5)+"px "+(-v.y).toFixed(5)+"px"),W._matrixAppend=R.invert().translate(-v.x,-v.y)}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(P){return P instanceof hq?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(H){var h="state",C=H.s(h);if(C)return C;var J=Ve(H._image);return J?lg(J[h],H,this)||null:void 0}}),J.defineProperties(cq.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(n){this._layoutHTML=n}}});var wh=function(t,s){var R=this;R.gv=t,R.s=function(S){return s.getStyle(S)},R._data=s,R._87I=new Vn};eh(wh,J,{_6I:B,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var o=this,c=o.gv.isSelected(o._data);return!c||o.isShadowed()?0:o.gv.getSelectWidth(o._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(G){var y=this._data,R=this.gv.getBodyColor(y);return R?R:G?y.getStyle(G):B},_2Q:function(s){return this.s(s)},_1Q:function(x,s,m,I){var F=this.s,S=F("2d.gray"),P=F(s+".dash.color");if(S&&(P=w.toGrayColor(P)),x.strokeStyle=P,x.lineWidth=m,x.stroke(),F(s+".dash.3d")){var A=F(s+".dash.3d.color");Zl(x,P,S?w.toGrayColor(A):A,m,this.gv._zoom,F(s+".dash.3d.accuracy"))}Ne(x,I)},invalidate:function(){this._6I=B},_79o:function(){var m=this;if(!m._6I){var p=m._data,M=m.gv;m.labelInfo=m.label2Info=m.noteInfo=m.note2Info=m._38o=B,m._87I.clear(),m.interactiveInfo=M.isInteractive(p)?{}:B,m._3O(),m._55O=M.isEditable(p)?{_42O:M.isRectEditable(p),_43O:M.isPointEditable(p),_56O:M.isRotationEditable(p)}:B,m._6I=m._81o()}return m._6I},_3O:function(){},getPosition:function(){return cp},_68o:function(c,Z){c&&this._87I.add(pi(c,Z))},_81o:function(){var p=this,w=p.s;p._24O(Bd,"getLabel"),p._24O(Ig,"getLabel2"),p._26O(Ml,"getNote"),p._26O(an,"getNote2"),p._15O(),p._55O&&p._48O();var u;if(p._87I.each(function($){u=Lh(u,$)}),u&&p.isShadowed()){var f=Sf(u);f.x+=w("shadow.offset.x"),f.y+=w("shadow.offset.y"),em(f,w("shadow.blur")),u=Lh(u,f)}return p._87I.clear(),u},_42:function(D){var t=this,I=t._data,S=t.gv,c=t.s,M=c("opacity"),L=this.isShadowed();if(L){var T=D.shadowOffsetX,C=D.shadowOffsetY,j=D.shadowBlur,r=D.shadowColor,g=S.getZoom();D.shadowOffsetX=c("shadow.offset.x")*g,D.shadowOffsetY=c("shadow.offset.y")*g,D.shadowBlur=c("shadow.blur")*g,D.shadowColor=t.getSelectColor()}if(M!=B){var m=D.globalAlpha;D.globalAlpha=M}t._80o(D),S.isLabelVisible(I)&&((!S._drawForChecking||c("label.selectable"))&&rb(D,t.labelInfo),(!S._drawForChecking||c("label2.selectable"))&&rb(D,t.label2Info)),S.isNoteVisible(I)&&(Qd(D,t.noteInfo),Qd(D,t.note2Info)),t._99O(D),M!=B&&(D.globalAlpha=m),L&&(D.shadowOffsetX=T,D.shadowOffsetY=C,D.shadowBlur=j,D.shadowColor=r)},_80o:function(){},_47O:function(){},_24O:function(Y,N){var R=this,w=R._data,P=R.gv,y=R.s,O=P[N](w);if(O!=B){var m=y(Y+".scale"),x=y(Y+".max"),Z=y(Y+".position"),f=R[Y+"Info"]={label:O,scale:m,color:P[N+"Color"](w),font:y(Y+".font"),opacity:y(Y+".opacity"),align:y(Y+".align"),rotation:R.getRotation(y(Y+".rotation"),!1,Z),background:P[N+"Background"](w)},T=Jb(f,O);x>0&&x<T.width&&(f.labelWidth=T.width,T.width=x),1!==m&&(T.width*=m,T.height*=m);var g=R.getPosition(Z,y(Y+".offset.x"),y(Y+".offset.y"),T,y(Y+".position.fixed"));if(T.x=g.x-T.width/2,T.y=g.y-T.height/2,R._68o(f.rect=T,f.rotation),1!==m){var p=T.width/m,h=T.height/m;f.rect={x:g.x-p/2,y:g.y-h/2,width:p,height:h}}}},_26O:function(b,e){var d=this,J=d.gv,Y=d._data,Z=d.s,z=J[e](Y);if(z!=B){var A,P,k=Z(b+".scale"),N=d[b+"Info"]={note:z,scale:k,data:Y,view:J,expanded:Z(b+".expanded"),font:Z(b+".font"),color:Z(b+".color"),opacity:Z(b+".opacity"),align:Z(b+".align"),icon:Z(b+".icon"),backgroundImage:Z(b+".backgroundImage"),borderWidth:Z(b+".border.width"),borderColor:Z(b+".border.color"),background:J[e+"Background"](Y)},Q=d.getPosition(Z(b+".position"),Z(b+".offset.x"),Z(b+".offset.y")),p=Q.x,o=Q.y;if(N.expanded){var g,S=Z(b+".max"),j=Z(b+".backgroundImage");j?(j=Ve(j),g={width:Sg(j,Y),height:Xd(j,Y)}):g=Jb(N,z),g.width+=6,g.height+=2,S>0&&S<g.width&&(N.labelWidth=g.width,g.width=S),A=g.width,P=g.height+8,N.clickRect={x:p-A*k/2,y:o-P*k,width:A*k,height:P*k*g.height/P}}else{var K=Z(b+".icon");K?(K=Ve(K),A=Sg(K,Y),P=Xd(K,Y)):(A=12,P=18),N.clickRect={x:p-A*k/2,y:o-P*k,width:A*k,height:P*k}}N.rect={x:p-A/2,y:o-P*k/2-P/2,width:A,height:P};var h=M(N.borderWidth/2)*k;d._68o({x:p-A*k/2-h,y:o-P*k-h,width:A*k+2*h,height:P*k+2*h})}},_48O:function(){},_99O:function(b){var T=this,J=T._38o;if(J){var v=T.gv,q=T._data,j=J.icons,_=T.interactiveInfo;_&&(_._38o={});for(var a in j){var U=j[a],L=J.rects[a];if(L){_&&(_._38o[a]=[]);var l=lg(U.opacity,q,v),i=lg(U.names,q,v),Z=i?i.length:0,f=L.rotation;if(l!=B){var I=b.globalAlpha;b.globalAlpha*=l}for(var n=0;Z>n;n++){var Q=i[n],g=Ve(Q),O=L[n];if(f){var H=O.x+O.width/2,$=O.y+O.height/2;b.save(),Bn(b,H,$),sb(b,f),Bn(b,-H,-$)}_&&_._38o[a].push(b.interactiveInfo={compInfos:[],matrix:f?new aq(f,H,$).appendTranslate(-H,-$):new aq}),fl(b,g,lg(U.stretch,q,v),O.x,O.y,O.width,O.height,T._data,T.gv),b.interactiveInfo=B,f&&b.restore()}l!=B&&(b.globalAlpha=I)}}}}});var Kq=function(c,I){lr(Kq,this,[c,I])};eh(Kq,wh,{_checkEmptyRect:!0,_40O:function(y,u){var U=this,s=U.s,b=y.rect;(y.borderColor=U.gv.getBorderColor(U._data))&&(y.borderType=s("border.type"),y.borderWidth=s("border.width"),y.borderPadding=s("border.padding"),u=_(u,y.borderPadding+y.borderWidth/2));var p=U._data.getScale(),R=_(1,_(j(p.x),j(p.y)));if(y.selectWidth=U.getSelectWidth()){var m=U.gv._zoom;y.selectType=s("select.type"),y._97o=U.getSelectColor(),y.selectPadding=s("select.padding"),u=_(u,(y.selectPadding+y.selectWidth/2/m)/R)}u>0&&(u*=R,b=Sf(b),em(b,u)),U._68o(b)},_39O:function(S,T){var q,j=this,J=T.rect;if(T.borderWidth>0&&(q=T.borderPadding,S.strokeStyle=T.borderColor,S.lineWidth=T.borderWidth,sq(S,T.borderType,{x:J.x-q,y:J.y-q,width:J.width+2*q,height:J.height+2*q}),S.stroke()),T.selectWidth>0){var H=j.gv._zoom;if(q=T.selectPadding,S.strokeStyle=T._97o,S.lineWidth=T.selectWidth/H,T.rotation!=B){S.save(),S.translate(T.position.x,T.position.y),S.rotate(T.rotation);var d=j._data,x=d.getWidth(),p=d.getHeight(),m=T.scale,r=T.anchor;J={x:m.x*-x*r.x,y:m.y*-p*r.y,width:m.x*x,height:m.y*p}}sq(S,T.selectType,{x:J.x-q,y:J.y-q,width:J.width+2*q,height:J.height+2*q}),T.rotation!=B&&S.restore(),S.stroke()}},dispose:function(){var r=this,V=r._htmlView;Kq.superClass._3O.call(r),V&&(V.onHTMLRemoved&&V.onHTMLRemoved(),ih(V))},_3O:function(){var R=this,y=R.s,$=R._data,h=R.gv,H=$.getStyle(Oh),g=R.getBodyColor(),G=R._83o=H?{shape:H,_53o:R.getBodyColor("shape.background"),_27Q:Ve(y("shape.repeat.image"),g),shapeGradientPack:y("shape.gradient.pack"),_54o:y("shape.border.width"),_55o:y("shape.border.color"),_56o:y("shape.border.3d"),_57o:y("shape.border.3d.color"),_58o:y("shape.border.3d.accuracy"),shapeGradient:y("shape.gradient"),_59o:y("shape.gradient.color"),_60o:y("shape.border.pattern"),_61o:y("shape.border.cap"),_62o:y("shape.border.join"),shapeForeground:y("shape.foreground"),bodyColor:g,gray:y("2d.gray")}:{img:Ve(h.getImage($),g),bodyColor:g,gray:y("2d.gray"),stretch:y("image.stretch")};if(f&&!m);else{var K,r=G.img;r&&r.renderHTML?(R._htmlInfo&&R._htmlInfo.img!==r&&(R._htmlInfo=B),R._htmlInfo||(R._htmlInfo={img:r,cache:{}}),K=r.renderHTML($,h,R._htmlInfo.cache)):R._htmlInfo=B,R._htmlView&&R._htmlView!==K&&(R._htmlView.onHTMLRemoved&&R._htmlView.onHTMLRemoved(),ih(R._htmlView.getView?R._htmlView.getView():R._htmlView)),(R._htmlView=K)&&h.appendHTML(K)&&(K.onHTMLAddedSync&&K.onHTMLAddedSync(),K.onHTMLAdded&&Wo(K.onHTMLAdded)),G.rect=$.getRect(),G.position=$.p(),G.scale=$.getScale(),G.anchor=$.getAnchor(),G.rotation=$.getRotation(),H===kc&&(G._63o=y("shape.depth"));var Q=0;if(H)Q=Yd(B,G._54o/2,G._62o),R.s("shape.dash")&&(Q=_(Q,(R.s("shape.dash.width")||G._54o)/2));else if(r&&r.boundExtend)if(Q=lg(r.boundExtend,$,h),r.boundExtendAbsolute){var V=$.getScale();Q/=h._zoom*_(1,_(j(V.x),j(V.y)))}else if(!lg(r.fitSize,$,h)){var x=lg(r.width,$,h),S=lg(r.height,$,h);Q*=_($.getWidth()/x,$.getHeight()/S)}R._40O(G,Q);var b=y("clip.percentage");if(1>b&&(0>b&&(b=0),G.clipRect=hh($.getAnchorRect(),y("clip.direction"),b)),H){var E=y("shape.fill.clip.percentage");1>E&&(0>E&&(E=0),G.shapeClipRect=hh($.getAnchorRect(),y("shape.fill.clip.direction"),E));var d=y("shape.foreground.clip.percentage");1>d&&(0>d&&(d=0),G.shapeForegroundClipRect=hh($.getAnchorRect(),y("shape.foreground.clip.direction"),d))}}},getPosition:function(u,w,h,n){var m=hi(u,this._83o.rect,n);return m.x+=w,m.y+=h,m},_80o:function(C){var L=this,d=L.s,V=L.gv,m=L._data,A=L._83o,M=A.rect,f=A.position,Z=A.rotation,X=A.anchor,K=A.scale,Y=A.shape,p=A.clipRect;if(!L._checkEmptyRect||M.width>0&&M.height>0){var D=m.getSize();if(D.x=-D.width*X.x,D.y=-D.height*X.y,C.save(),Bn(C,f.x,f.y),sb(C,Z),ur(C,K.x,K.y),p&&(C.beginPath(),C.rect(p.x,p.y,p.width,p.height),C.clip()),V._drawForChecking&&A.img&&lg(A.img.pixelPerfect,m,V)===!1)Xc(C,D.x,D.y,D.width,D.height,"#888888");else if(L.freeDraw)L.freeDraw(C,D,A);else if(Y){var g,l,x,v,O=A._60o,I=es(C,O),N=A._27Q,s=A._54o,j=A.shapeGradientPack,u=A.gray,y=C.lineJoin,R=C.lineCap,z=function(E){return u?w.toGrayColor(E):E};"roundRect"===Y?g=d("shape.corner.radius"):"polygon"===Y?g=d("shape.polygon.side"):"arc"===Y&&(g=d("shape.arc.from"),l=d("shape.arc.to"),x=d("shape.arc.close"),v=d("shape.arc.oval")),C.lineJoin=A._62o,C.lineCap=A._61o;var P=z(A._53o);if(P||N||j){var G=A.shapeClipRect;G&&(C.save(),C.beginPath(),C.rect(G.x,G.y,G.width,G.height),C.clip()),sq(C,Y,D,g,l,x,v),j?Qe(C,j):N?Ed(C,N,z(A.bodyColor),null,m,V):fc(C,P,A.shapeGradient,z(A._59o),D),C.fill(),G&&C.restore(),j&&C.restore(),C!==I&&sq(I,Y,D,g,l,x,v)}else sq(I,Y,D,g,l,x,v);var i=A.shapeForeground;if(i){C.save();var n=A.shapeForegroundClipRect;n&&(C.beginPath(),C.rect(n.x,n.y,n.width,n.height),C.clip()),sq(C,Y,D,g,l,x,v),fc(C,i,d("shape.foreground.gradient"),z(d("shape.foreground.gradient.color")),D),C.fill(),C.restore()}if(s>0){var U=d("shape.border.width.absolute");U&&(C.save(),C.setTransform(1,0,0,1,0,0)),C.lineWidth=s;var q=z(A._55o);C.strokeStyle=q,C.stroke(),U&&C.restore(),A._56o&&Zl(C,q,z(A._57o),s,V._zoom,A._58o)}if(Ne(C,O),d("shape.dash")){var r=d("shape.dash.width")||s;if(r>0){O=d("shape.dash.pattern");var I=es(C,O,L._2Q("shape.dash.offset"));I!==C&&sq(I,Y,D,g,l,x,v),L._1Q(C,"shape",r,O)}}zb(C,P,A._63o,D),C.lineJoin=y,C.lineCap=R}else{var J=L.interactiveInfo;J&&(C.interactiveInfo=J.bodyInfo={compInfos:[],matrix:new aq(Z,f.x,f.y,K.x,K.y)}),A.gray&&(C.compGray=!0);var H=A.img;H&&H.cacheRule!=B&&(H=Df(C,H,A.stretch,D.width,D.height,m,V,A.bodyColor)),fl(C,H,A.stretch,D.x,D.y,D.width,D.height,m,V,A.bodyColor),C.compGray=!1,C.interactiveInfo=B}C.restore()}L._39O(C,A)},_48O:function(){},_47O:function(){}});var so=function(D,i){lr(so,this,[D,i])},Zi=function(a,D,w,n){var d=Ke(a,D);return w=n?s(w,d):Dp(w,d),d?w/=d:w=0,{x:a.x+(D.x-a.x)*w,y:a.y+(D.y-a.y)*w}};eh(so,wh,{_3O:function(){var W,o=this,t=o._data,$=o.gv,J=o.s,U=J(kr),G=t.isLooped(),T=J("edge.width"),h=J("edge.center"),n=J("edge.offset"),N=$.getBorderColor(t),D=N?J("border.width"):0,q=o.getSelectWidth(),p=t._40I,Z=t._41I,e=o._78o=p&&Z?{looped:G,type:U,width:T,center:h,color:o.getBodyColor("edge.color"),borderColor:N,borderWidth:D,_97o:q?o.getSelectColor():B,selectWidth:q,pattern:J("edge.pattern"),cap:J("edge.cap"),join:J("edge.join"),is3d:J("edge.3d"),_67o:J("edge.3d.color"),_66o:J("edge.3d.accuracy"),gray:J("2d.gray")}:B;if(e){var s=w.getEdgeType(U);if(s){var r=s(t,Xr(o,$,t,G,U),$,o._19Q);r.points&&r.points.size()>1?(e.edgeTypeInfo=r,W=qh(e.edgeTypeInfo.points)):r[Ie]&&r.rect&&(e.edgeTypeInfo=r,W=r.rect)}else{var O=J("edge.source.anchor.x"),H=J("edge.source.anchor.y"),X=J("edge.target.anchor.x"),E=J("edge.target.anchor.y"),S=Gq($,t,"source"),F=Gq($,t,"target");if(U===tf){var m=e.points=J(Dn)||Cc,g=m.size();e.segments=J("edge.segments");var Y=O!==I||H!==I||cr(p),c=X!==I||E!==I||cr(Z);if(!h)if(n)Y||(S=Zi(S,g?m.get(0):F,n,g)),c||(F=Zi(F,g?m.get(g-1):S,n,g));else{var y;Y||(y=Xm(S,g?m.get(0):F,dm($,p)),y&&(S={x:y[0],y:y[1]})),c||(y=Xm(g?m.get(g-1):S,F,dm($,Z)),y&&(F={x:y[0],y:y[1]}))}W=Lh(qh(e.points),qh(S,F))}else{var b=Xr(o,$,t,G,U);if(o._19Q||(b=-b),G)S=Sf(S),S.x=$.getNodeRect(p).x,e.radius=b,W={x:S.x-b,y:S.y-b,width:2*b,height:2*b};else{var x=Ke(S,F),Q=Dp(n,x),P={x:Q,y:b},L={x:x-Q,y:b},z=v(F.y-S.y,F.x-S.x),d=e.mat=new vl(z);if(e.orienAngle=z,e.angle=F.x<S.x?z+R:z,e.rect={x:P.x,y:P.y,width:L.x-P.x,height:0},e.origin=S,P=d.tf(P),P.x+=S.x,P.y+=S.y,L=d.tf(L),L.x+=S.x,L.y+=S.y,h){var K={x:x,y:0};K=d.tf(K),K.x+=S.x,K.y+=S.y,W=qh([S,P,L,K]),e.c1=S,e.c2=K}else W=qh(P,L);S=P,F=L}}e.sourcePoint=S,e.targetPoint=F,t._lastSourcePoint=S,t._lastTargetPoint=F}var a=0;J("edge.dash")&&(a=J("edge.dash.width")||T);var u="square"===e.cap?.71:.5;Yd(W,_(a*u,T*u+D+q),e.join),o._68o(W)}},getRotation:function(F,L,Q){F=F||0;var V=this._78o;if(V){var W,y=V.angle,k=V.points,s=V.edgeTypeInfo;if(y!=B)return L?V.orienAngle+F:y+F;if(s&&s[Ie])return s.getRotation?s.getRotation(this,F,L,Q):0;if(s&&s.points){var w=s.points;return W=w.size(),Eb[Q]?W&&0===W%2?xd(w.get(W/2-1),w.get(W/2),L,F):F:Hn[Q]?xd(w.get(0),w.get(1),L,F):xd(w.get(W-2),w.get(W-1),L,F)}if(k)return W=k.size(),Eb[Q]?W&&0===W%2?xd(k.get(W/2-1),k.get(W/2),L,F):F:Hn[Q]?xd(V.sourcePoint,W?k.get(0):V.targetPoint,L,F):xd(W?k.get(W-1):V.sourcePoint,V.targetPoint,L,F)}return F},getPosition:function(s,j,z,a,P){var $=this._78o;if($){var i,r=$.type,u=$.points,T=$.edgeTypeInfo,R=$.sourcePoint,x=$.targetPoint;if(!r)return $.looped?{x:R.x-$.radius+j,y:R.y+z}:(P&&R&&x&&(R.x>x.x||R.x===x.x&&R.y>x.y)&&(s=Nf[s],z=-z),i=hi(s,$.rect,a),i.x+=j,i.y+=z,i=$.mat.tf(i),i.x+=$.origin.x,i.y+=$.origin.y,i);if(T&&T[Ie])return T.getPosition?T.getPosition(this,s,j,z,a,P):{x:(R.x+x.x)/2,y:(R.y+x.y)/2};if(u){var i,L=u.size();if(Eb[s]){if(L){var m=L%2;if(0===m)return sm(u.get(L/2-1),u.get(L/2),s,j,z,a,P);i=u.get((L-m)/2)}else i={x:(R.x+x.x)/2,y:(R.y+x.y)/2};return i=hi(s,{x:i.x,y:i.y,width:0,height:0},a),i.x+=j,i.y+=z,i}return Hn[s]?sm(R,L?u.get(0):x,s,j,z,a,P):sm(L?u.get(L-1):R,x,s,j,z,a,P)}if(T){var O=T.points,L=O.size();if(Eb[s]){var m=L%2;return 0===m?sm(O.get(L/2-1),O.get(L/2),s,j,z,a,P):(i=O.get((L-m)/2),i=hi(s,{x:i.x,y:i.y,width:0,height:0},a),i.x+=j,i.y+=z,i)}return Hn[s]?sm(O.get(0),O.get(1),s,j,z,a,P):sm(O.get(L-2),O.get(L-1),s,j,z,a,P)}}return cp},_42:function(n){this._78o&&so.superClass._42.call(this,n)},drawPath:function(t,q){t.beginPath();var E=q.type,d=q.points,J=q.segments,D=q.edgeTypeInfo;if(!E||d){var a=q.sourcePoint,Q=a.x,W=a.y,A=q.targetPoint,r=A.x,u=A.y;if(E)if(J){var _=new Vn({x:Q,y:W});_.addAll(d),_.add({x:r,y:u}),ti(t,_,J)}else t.moveTo(Q,W),d.each(function(M){t.lineTo(M.x,M.y)}),t.lineTo(r,u);else q.looped?t.arc(Q,W,q.radius,0,z,!0):q.center?(t.moveTo(q.c1.x,q.c1.y),t.lineTo(Q,W),t.lineTo(r,u),t.lineTo(q.c2.x,q.c2.y)):(t.moveTo(Q,W),t.lineTo(r,u))}else D&&(D.points?ti(t,D.points,D.segments):D[Ie]&&D[Ie](t,D))},_80o:function(n){var V=this,r=V.s,N=V._78o,h=N.width,I=N.selectWidth,e=N.borderWidth,Y=n.lineJoin,Z=n.lineCap,q=N.gray,X=N.pattern;n.lineJoin=N.join,n.lineCap=N.cap,V.drawPath(es(n,X),N);var M=r("edge.width.absolute");M&&(n.save(),n.setTransform(1,0,0,1,0,0)),I&&(n.strokeStyle=N._97o,n.lineWidth=h+2*(e+I),n.stroke()),e&&(n.strokeStyle=q?w.toGrayColor(N.borderColor):N.borderColor,n.lineWidth=h+2*e,n.stroke());var c=q?w.toGrayColor(N.color):N.color,U=q?w.toGrayColor(N._67o):N._67o;if(n.strokeStyle=c,n.lineWidth=h,n.stroke(),N.is3d&&Zl(n,c,U,h,V.gv._zoom,N._66o),M&&n.restore(),Ne(n,X),r("edge.dash")){X=r("edge.dash.pattern");var A=es(n,X,V._2Q("edge.dash.offset"));A!==n&&V.drawPath(A,N),V._1Q(n,"edge",r("edge.dash.width")||h,X)}n.lineJoin=Y,n.lineCap=Z},_48O:function(){},_47O:function(){}});var Ao=function(O,c){lr(Ao,this,[O,c])};eh(Ao,Kq,{_3O:function(){var g,m,Z=this,R=Z.s,o=Z._data,D=Z.gv;if(Z._88I=B,o.isExpanded()&&o.eachChild(function(j){if($o(j)){var d=D.getBoundsForGroup(j);d&&(m||(m=[]),m.push(d),g=Lh(g,d))}}),g){var n=D.getLabel(o),t=R("group.type");g=Em(t,m,g),jb(g,o,"group.padding",1);var P=Z._88I={type:t,rect:g,_64o:g};if(!t&&n!=B){var d,a=Z.labelInfo={label:n,color:R("group.title.color"),font:R("group.title.font"),align:R("group.title.align")},u=Jb(a,n),s=u.width,k=u.height,i=R("group.title.align"),X=R("group.title.orientation");if((X===Xn||X===id)&&s>g.width?g.width=s:(X===ue||X===cg)&&s>g.height&&(g.height=s),a.rect={y:g.y-k,width:u.width,height:k},d=i===ue?g.x:i===cg?g.x+g.width-s:g.x+g.width/2-s/2,a.rect.x=d,X===id)P.titleRect={x:g.x,y:g.y+g.height,width:g.width,height:k},P.rect={x:g.x,y:g.y,width:g.width,height:g.height+k},a.rect={x:d,y:g.y+g.height,width:s,height:k};else if(X===ue){var Q=P.titleRect={x:g.x-k,y:g.y,width:k,height:g.height};P.rect={x:g.x-k,y:g.y,width:g.width+k,height:g.height},a.rect={x:Q.x+k/2-g.height/2,y:Q.y+g.height/2-k/2,width:g.height,height:k},a.rotation=-Math.PI/2}else if(X===cg){var Q=P.titleRect={x:g.x+g.width,y:g.y,width:k,height:g.height};P.rect={x:g.x,y:g.y,width:g.width+k,height:g.height},a.rect={x:Q.x+k/2-g.height/2,y:Q.y+g.height/2-k/2,width:g.height,height:k},a.rotation=Math.PI/2}else P.titleRect={x:g.x,y:g.y-k,width:g.width,height:k+1},P.rect={x:g.x,y:g.y-k,width:g.width,height:g.height+k}}Z._40O(P,R("group.border.width")/2)}else Ao.superClass._3O.call(Z)},getPosition:function(N,n,X,J){var C=this._88I;if(C){var O=hi(N,C.rect,J);return O.x+=n,O.y+=X,O}return Ao.superClass.getPosition.apply(this,arguments)},_24O:function(A,Q){var G=this._88I;(!G||G.type||"label2"===A)&&Ao.superClass._24O.call(this,A,Q)},_80o:function(Q){var V=this,q=V._88I;if(q){var N=V._data,G=V.s,t=V.gv,x=q.type,A=q.rect,s=q._64o,U=q.titleRect,R=V.getBodyColor(),P=Ve(G("group.image"),R),Z=G("group.image.stretch"),W=V.getBodyColor("group.background"),b=Ve(G("group.repeat.image"),R),d=G("group.gradient.pack"),l=G("group.gradient"),e=G("group.gradient.color"),y=G("group.border.width"),c=G("group.border.color"),z=G("group.border.pattern"),g=G("group.title.orientation"),v=G("group.depth");if(x){var L=Q.lineJoin,X=Q.lineCap;if(Q.lineJoin=G("group.border.join"),Q.lineCap=G("group.border.cap"),P){if(Q.save(),sq(Q,x,A),Q.clip(),fl(Q,P,Z,A.x,A.y,A.width,A.height,N,t,R),Q.restore(),y>0){var E=es(Q,z);sq(E,x,A),Q.lineWidth=y,Q.strokeStyle=c,Q.stroke(),Ne(Q,z)}}else{var E=es(Q,z);W||b||d?(sq(Q,x,A),d?Qe(Q,d):b?Ed(Q,b,R,null,N,t):fc(Q,W,l,e,A),Q.fill(),d&&Q.restore(),Q!==E&&sq(E,x,A)):sq(E,x,A),y>0&&(Q.lineWidth=y,Q.strokeStyle=G("group.border.color"),Q.stroke()),Ne(Q,z),x===kc&&zb(Q,W,v,A)}Q.lineJoin=L,Q.lineCap=X}else{var $=G("group.title.background"),a=G("group.border.radius");if(P)fl(Q,P,Z,s.x,s.y,s.width,s.height,N,t,V.getBodyColor());else if(W||b)if(b?Ed(Q,b,R,null,N,t):fc(Q,W,l,e,s),0===y)sq(Q,kc,s),Q.fill(),zb(Q,W,v,s);else{switch(Q.beginPath(),g){case id:on(Q,s.x,s.y,s.width,s.height,a,a,0,0);break;case ue:on(Q,s.x,s.y,s.width,s.height,0,a,0,a);break;case cg:on(Q,s.x,s.y,s.width,s.height,a,0,a,0);break;case Xn:on(Q,s.x,s.y,s.width,s.height,0,0,a,a)}Q.fill()}if(U&&$)if(0===y)Xc(Q,U.x,U.y,U.width,U.height,$),zb(Q,$,v,U);else{switch(Q.beginPath(),Q.fillStyle=$,g){case id:on(Q,U.x,U.y,U.width,U.height,0,0,a,a);break;case ue:on(Q,U.x,U.y,U.width,U.height,a,0,a,0);break;case cg:on(Q,U.x,U.y,U.width,U.height,0,a,0,a);break;case Xn:on(Q,U.x,U.y,U.width,U.height,a,a,0,0)}Q.fill()}if(y>0){var E=es(Q,z);if(sq(E,"roundRect",A,a),Q.lineWidth=y,Q.strokeStyle=c,U&&G("group.splitLine")){var I=U.x,p=U.y,j=U.width,C=U.height;g===id?(Q.moveTo(I,p),Q.lineTo(I+j,p)):g===ue?(Q.moveTo(I+j,p),Q.lineTo(I+j,p+C)):g===cg?(Q.moveTo(I,p),Q.lineTo(I,p+C)):(Q.moveTo(I,p+C),Q.lineTo(I+j,p+C))}Q.stroke(),Ne(Q,z)}}V._39O(Q,q)}else Ao.superClass._80o.call(V,Q)}});var Hi=function(i,s){lr(Hi,this,[i,s])};eh(Hi,Kq,{_80o:function(Y){this._39O(Y,this._83o)}});var Eg=function(M,X){lr(Eg,this,[M,X])};eh(Eg,Kq,{_3O:function(){var f=this,P=f._data,w=f.s,C=f.gv,z=P.getPoints(),G=C.getBorderColor(P),V=G?w("border.width"):0,Y=f.getSelectWidth(),W=w("shape.border.width"),Z=P.getRect(),c=P.getAnchorRect(),U=C.getBodyColor(P),x=f._99o=z.isEmpty()?B:{rect:Z,rotation:P.getRotation(),fillRule:w("shape.fill.rule"),scale:P.getScale(),position:P.p(),points:z,segments:P.getSegments(),bodyColor:U,borderColor:G,borderWidth:V,_94o:w("shape.border.3d"),_95o:w("shape.border.3d.color"),_96o:w("shape.border.3d.accuracy"),_97o:Y?f.getSelectColor():B,selectWidth:Y,_53o:w("shape.background"),_27Q:Ve(w("shape.repeat.image"),U),shapeGradientPack:w("shape.gradient.pack"),_54o:W,_55o:w("shape.border.color"),shapeGradient:w("shape.gradient"),_59o:w("shape.gradient.color"),_60o:w("shape.border.pattern"),_61o:w("shape.border.cap"),_62o:w("shape.border.join"),shapeForeground:w("shape.foreground"),gray:w("2d.gray")};if(x){c.x+=x.position.x,c.y+=x.position.y,x.gradientRect=c;var l=P.getScale(),E=_(1,_(j(l.x),j(l.y)));w("shape.dash")&&w("shape.dash.width")>W&&(W=w("shape.dash.width"));var k=W*("square"===x._61o?.71:.5)+V+Y/f.gv._zoom/E;k&&(k*=E,Z=Sf(Z),Yd(Z,k,x._62o)),f._68o(Z);var A=w("clip.percentage");1>A&&(0>A&&(A=0),x.clipRect=hh(P.getAnchorRect(),w("clip.direction"),A));var i=w("shape.fill.clip.percentage");1>i&&(0>i&&(i=0),x.shapeClipRect=hh(P.getAnchorRect(),w("shape.fill.clip.direction"),i));var F=w("shape.foreground.clip.percentage");1>F&&(0>F&&(F=0),x.shapeForegroundClipRect=hh(P.getAnchorRect(),w("shape.foreground.clip.direction"),F))}},getPosition:function(c,l,X,b){var i=this._99o;if(i){var F=hi(c,i.rect,b);return F.x+=l,F.y+=X,F}return cp},_42:function(n){this._99o&&Eg.superClass._42.call(this,n)},_80o:function(b){var r,f=this,H=f.s,Z=f._99o,U=Z.position,i=Z.scale,F=Z.rotation,g=Z.borderWidth,Q=Z.selectWidth/f.gv._zoom,W=Z._27Q,_=Z.shapeGradientPack,M=Z._54o,l=Z.clipRect,t=Z.shapeClipRect,c=Z.points,V=Z.segments,y=f._data.isClosePath(),E=Z.fillRule,n=Z.gray,k=function(F){return n?w.toGrayColor(F):F},L=k(Z._53o),S=L||W||_;b.save(),Bn(b,U.x,U.y),sb(b,F),ur(b,i.x,i.y),l&&(b.beginPath(),b.rect(l.x,l.y,l.width,l.height),b.clip()),S&&t&&(b.save(),b.beginPath(),b.rect(t.x,t.y,t.width,t.height),b.clip()),Bn(b,-U.x,-U.y);var j=Z._60o,u=es(b,j),B=b.lineJoin,O=b.lineCap;b.lineJoin=Z._62o,b.lineCap=Z._61o;var G=k(Z.bodyColor);S?(ti(b,c,V,y),_?Qe(b,_):W?Ed(b,W,G,null,f._data,f.gv):(r=G?G:L,fc(b,r,Z.shapeGradient,k(Z._59o),Z.gradientRect)),b.fill(E),t&&(b.restore(),Bn(b,-U.x,-U.y)),_&&b.restore(),u!==b&&ti(u,c,V,y)):ti(u,c,V,y);var v=Z.shapeForeground;if(v){b.save();var P=Z.shapeForegroundClipRect;P&&(Bn(b,U.x,U.y),b.beginPath(),b.rect(P.x,P.y,P.width,P.height),b.clip(),Bn(b,-U.x,-U.y)),ti(b,c,V,y),fc(b,v,H("shape.foreground.gradient"),k(H("shape.foreground.gradient.color")),Z.gradientRect),b.fill(E),b.restore()}var R=H("shape.border.width.absolute");if(R&&(b.save(),b.setTransform(1,0,0,1,0,0)),Q&&(b.strokeStyle=Z._97o,b.lineWidth=M+2*(g+Q),b.stroke()),g&&(b.strokeStyle=k(Z.borderColor),b.lineWidth=M+2*g,b.stroke()),M&&(r=k(Z._55o),!L&&G&&(r=G),b.strokeStyle=r,b.lineWidth=M,b.stroke(),Z._94o&&Zl(b,r,k(Z._95o),M,f.gv._zoom,Z._96o)),R&&b.restore(),Ne(b,j),H("shape.dash")){var K=H("shape.dash.width")||M;if(K>0){j=H("shape.dash.pattern");var u=es(b,j,f._2Q("shape.dash.offset"));u!==b&&ti(u,c,V,y),f._1Q(b,"shape",K,j)}}b.lineJoin=B,b.lineCap=O,b.restore()},_48O:function(){},_47O:function(){}});var Fk=function(C,V){lr(Fk,this,[C,V])};eh(Fk,Eg,{getRotation:function(N,A,$){N=N||0;var M=this._data.getPoints(),x=M.size();return x>1?Eb[$]?x&&0===x%2?xd(M.get(x/2-1),M.get(x/2),A,N):N:Hn[$]?xd(M.get(0),M.get(1),A,N):xd(M.get(x-2),M.get(x-1),A,N):N},getPosition:function(m,y,o,a,Y){var w=this._data.getPoints(),k=w.size();if(k>1){if(Eb[m]){var M=k%2;if(0===M)return sm(w.get(k/2-1),w.get(k/2),m,y,o,a,Y);var t=w.get((k-M)/2),S={x:t.x,y:t.y,width:0,height:0};return t=hi(m,S,a),t.x+=y,t.y+=o,t}return Hn[m]?sm(w.get(0),w.get(1),m,y,o,a,Y):sm(w.get(k-2),w.get(k-1),m,y,o,a,Y)}return cp}});var ch=function(n,Z){lr(ch,this,[n,Z])};eh(ch,Kq,{_3O:function(){var T=this;ch.superClass._3O.call(T);var O=T.s,H=T._83o;T._82o=H.img||H.shape?B:{background:T.getBodyColor("grid.background"),depth:O("grid.depth"),rect:H.rect,_88o:O("grid.cell.depth"),cellBorderColor:O("grid.cell.border.color"),_89o:O("grid.row.count"),_90o:O("grid.column.count"),block:O("grid.block"),_91o:O("grid.block.color"),_92o:O("grid.block.padding"),_93o:O("grid.block.width")}},_80o:function(I){var p=this,U=p._82o;if(!U)return ch.superClass._80o.call(p,I),void 0;var H,c,G=p._data,e=U.background,v=U.rect,N=U.block,C=U._91o,O=U._92o,L=U._93o,J=U._88o,W=U.cellBorderColor,a=U._89o,z=U._90o;if(e)if(Xc(I,v.x,v.y,v.width,v.height,e),zb(I,e,U.depth,v),J)for(H=0;a>H;H++)for(c=0;z>c;c++)v=G.getCellRect(H,c),v&&zb(I,e,J,v);else if(W){for(I.beginPath(),H=0;a>H;H++)for(c=0;z>c;c++)v=G.getCellRect(H,c),v&&I.rect(v.x,v.y,v.width,v.height);I.strokeStyle=W,I.lineWidth=1,I.stroke()}if("h"===N)for(H=0;a>H;H++)v=Lh(G.getCellRect(H,0),G.getCellRect(H,z-1)),em(v,O),Dr(I,C,v.x,v.y,v.width,v.height,L);
else if("v"===N)for(c=0;z>c;c++)v=Lh(G.getCellRect(0,c),G.getCellRect(a-1,c)),em(v,O),Dr(I,C,v.x,v.y,v.width,v.height,L);p._39O(I,p._83o)}});var Pf=function(N,l){lr(Pf,this,[N,l])};eh(Pf,Kq,{_checkEmptyRect:!1,_81o:function(){var X=this._data,j=Pf.superClass._81o.call(this),G=X.s("text");if(G!=B){var P,I,p=X.s("text.font"),v=X.s("text.align"),_=X.s("text.vAlign"),Z=ad(p,G),o=Z.width,R=Z.height,A=X.getAnchor(),L=X.getWidth(),K=X.getHeight();"left"===v?P=-L*A.x:"center"===v?P=-L*A.x+(L-o)/2:"right"===v&&(P=L*(1-A.x)-Z.width),"top"===_?I=-K*A.y:"middle"===_?I=-K*A.y+(K-R)/2:"bottom"===_&&(I=K*(1-A.y)-Z.height);var i,k=X.getMatrix();if(i=qh([k.tf(P,I),k.tf(P+o,I),k.tf(P+o,I+R),k.tf(P,I+R)]),j=Lh(j,i),j&&X.s("text.shadow")){var e=Sf(j);e.x+=X.s("text.shadow.offset.x"),e.y+=X.s("text.shadow.offset.y"),em(e,X.s("text.shadow.blur")),j=Lh(j,e)}}return j}});var Dm=cq.Interactor=function(p){this.gv=this._graphView=p};am("Interactor",J,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(j){this.gv.fi(j)},setCursor:function(g){xc||this.gv.setCursor(g)},startDragging:function(J){var S=this;S._lastClientPoint=pr(J),S._lastLogicalPoint=S.gv.lp(J),bh(S,J)},clearDragging:function(){var D=this;D._lastClientPoint=D._lastLogicalPoint=D._logicalPoint=B},autoScroll:function(N){return this.gv.autoScroll(N,this._lastClientPoint)}});var Yn=B,en=function(I){Yn.handleWindowTouchMove(I)},Un=function(v){Yn.handleWindowTouchEnd(v),Z.removeEventListener(os,en,o),Z.removeEventListener(Mn,Un,o),Yn=B},ws=function(F){Yn.handleWindowMouseMove(F)},um=function(s){Yn.handleWindowMouseUp(s),Z.removeEventListener(Wk,ws,o),Z.removeEventListener(Pl,um,o),Yn=B},jc=function(b,Q){b!==Yn&&(Yn?xc?Yn.handleWindowTouchEnd(Q):Yn.handleWindowMouseUp(Q):xc?(Z.addEventListener(os,en,o),Z.addEventListener(Mn,Un,o)):(Z.addEventListener(Wk,ws,o),Z.addEventListener(Pl,um,o)),Yn=b)},bf=function(m){var x=this;x.gv=m,x._is2d=m instanceof cq.GraphView,x._is2d&&(x.filter=function(y){return m.isSelectable(y)&&m.isInteractive(y)}),m.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",$p].forEach(function(M){x.addListener(M)}),x.initImageResource()};eh(bf,Dm,{enableVR:function(u){var W=this;if(!!W._vrEnable!==u)if(W._vrEnable=u,u)W.gv.vr.mp(W.onVRControllerChange,W);else if(W.gv.vr.ump(W.onVRControllerChange,W),W._vrRayPolyline){var a=W.gv.dm();a.remove(W._vrRayPolyline),a.remove(W._vrRayHitPoint),W._vrRayPolyline=I,W._vrRayHitPoint=I}},onVRControllerChange:function(C){var d=this,B=C.property,Y=C.newValue,F=d.gv.vr.getController(Y.id),i=F.getRay();i&&("gamepad.button.trigger"===B?"down"===Y._62O?d.handle_mousedown(i):d.handleWindowMouseUp(i):"gamepad.pose"===B&&(d.handle_mousemove(i),d.handleWindowMouseMove(i)))},drawVRRay:function(Q,k,d){var o,L=this,x=L.gv,X=L._vrRayPolyline,q=!1;if(X)o=L._vrRayHitPoint;else{var b=x.dm();L._vrRayPolyline=X=new u.Polyline,L._vrRayHitPoint=o=new u.Node,o.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),o.setAnchor3d(.5,.5,.499);var M=.2/x.vr.measureOflength;o.s3(M,M,M),X.s("intersect",!1),o.s("intersect",!1),b.add(X),b.add(o),q=!0}if(k){var C=d.world,I=d.worldNormal,W=C.x,D=C.y,S=C.z;X.s("shape.border.color","red"),X.setPoints([{x:Q.origin.x,y:Q.origin.z,e:Q.origin.y},{x:W,y:S,e:D}]),o.s("3d.visible",!0),o.p3(W,D,S),o.lookAtDirection([I.x,I.y,I.z],"front")}else{X.s("shape.border.color","blue");var N=new u.Math.Vector3;N.copy(Q.direction).setLength(1e3/L.gv.vr.measureOflength).add(Q.origin),X.setPoints([{x:Q.origin.x,y:Q.origin.z,e:Q.origin.y},{x:N.x,y:N.z,e:N.y}]),o.s("3d.visible",!1)}x.fi({kind:"vrRayIntersect",ray:Q,data:k,intersect:d,polyline:X,hitNode:o,begin:q})},addListener:function(z){var k=this;k.gv.getView().addEventListener(z,function(_){w.preventDefault(_),k.disabled||k["handle_"+z](_)},o)},handleWindowTouchMove:function(w){this.handleWindowMouseMove(w)},handleWindowMouseMove:function(X){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",X):(this.handleDownInfo("onBeginDrag",X),this.isDragging=!0))},handleWindowTouchEnd:function(H){this.handleWindowMouseUp(H)},handleWindowMouseUp:function(Y){if(this.isDragging&&(this.handleDownInfo("onEndDrag",Y),this.isDragging=!1),this.downInfo){var r=this.handle("onUp",Y);if(r&&r.data===this.downInfo.data){this.handleMissingUp(Y);var c=this,$=2===Y.button?"onContextMenu":"onClick";if(!c._dbclickTimer)return c._dbclickTimer=nd(function(){delete c._dbclickTimer,c.handleClick(Y,$,r),this.downInfo=B},w.clickDelay),void 0;Cd(c._dbclickTimer),delete c._dbclickTimer,$="onDoubleClick",c.handleClick(Y,$,r)}else this.handleDownInfo("onUp",Y);this.downInfo=B}},handle_mouseleave:function(Y){var x=this,H=x.gv,q=x.currentInfo?x.currentInfo.data:B;if(q){q.s("onLeave")&&q.s("onLeave")(Y,q,H),x.fire("data","onLeave",Y,q);var c=x.currentInfo?x.currentInfo.hits:B;if(c)for(var t in c)x.handleLeave(Y,t);x.currentInfo=B}},handle_mousewheel:function(Y){Y.scrollDelta=Y.wheelDelta/40,this.handle("onScroll",Y)},handle_DOMMouseScroll:function(E){E.scrollDelta=2===E.axis?-E.detail:0,this.handle("onScroll",E)},handle_touchstart:function(W){this.handle_mousedown(W)},handle_touchmove:function(V){this.handle("onMove",V)},handle_mousedown:function(N){this.isDragging&&(this.handleDownInfo("onEndDrag",N),this.isDragging=!1),this.downInfo=this.handle("onDown",N),this.downInfo&&jc(this,N)},handle_mousemove:function(i){var $=this,o=$.gv;$._hoverTimer&&(Cd($._hoverTimer),delete $._hoverTimer);var t,H,X,p=$.handle("onMove",i),j=this.currentInfo?this.currentInfo.data:B,l=this.currentInfo?this.currentInfo.hits:B;if(p&&(H=p.data,X=p.hits,$._hoverTimer=nd(function(){Cd($._hoverTimer),delete $._hoverTimer,$.handle("onHover",i,p)},o.getHoverDelay()||w.hoverDelay)),H!==j){if(j&&(j.s("onLeave")&&j.s("onLeave")(i,j,o),this.fire("data","onLeave",i,j)),H&&(H.s("onEnter")&&H.s("onEnter")(i,H,o),this.fire("data","onEnter",i,H)),l)for(t in l)this.handleLeave(i,t);if(X)for(t in X){var Z=X[t];Z.target.onEnter&&Z.target.onEnter(i,H,o,Z.point,Z.width,Z.height),this.fire(Z.type,"onEnter",Z.event,Z.data,Z.image,Z.comp,Z.point,Z)}}else{if(l)for(t in l)X&&X[t]||this.handleLeave(i,t);if(X)for(t in X)if(!l||!l[t]){var Z=X[t];Z.target.onEnter&&Z.target.onEnter(i,H,o,Z.point,Z.width,Z.height),this.fire(Z.type,"onEnter",Z.event,Z.data,Z.image,Z.comp,Z.point,Z)}}this.currentInfo=p},handle:function(b,y,d){var R,A=this,r=A.gv;if(A._is2d){if(d=d||r.getDataInfoAt(y,this.filter),!d)return;if(R=d.ui.interactiveInfo){var h,$=d.data;if($.s(b)&&$.s(b)(y,$,r),this.fire("data",b,y,$),"body"===d.part&&R.bodyInfo)h="body",d.hits=this.handleImage(h,r.getImage($),b,y,$,d.point,R.bodyInfo);else if("icons"===d.part&&R._38o){var o=R._38o[d.name];o&&o[d.index]&&(h="icons|"+d.name+"|"+d.index,d.hits=this.handleImage(h,d.icon,b,y,$,d.point,o[d.index]))}}return d}var $,s;if(!d)if(y&&y instanceof u.Math.Ray){var E=r.vr.intersectWorld(y);if($=E.data,s=E.intersect,A.drawVRRay(y,$,s),!$)return;var G=r.getData3dUI($);if(R=G.interactiveInfo,!R)return;d={data:$,part:s.part,ui:G}}else{if(d=r.getDataInfoAt(y),!d)return;d&&(d={data:d.data,part:d.part})}if(!s){$=d.data;var G=r.getData3dUI($);if(d.ui=G,R=G.interactiveInfo,!R)return d;if(s=r.intersectObject(y,$),!s)return}$.s(b)&&$.s(b)(y,$,r),this.fire("data",b,y,$);var N,P=s.part;return"body"!==P&&(N=$.s(P+".image")||$.s("shape3d."+P+".image")),N||(N=$.s("all.image")||$.s("shape3d.image")),R="object"==typeof N?R[N.uuid]:R[N],R&&R.bodyInfo?(d.part="body",d.interactiveInfo=R,d.point=s.uv.multiply({x:R.bodyInfo.rect.width,y:R.bodyInfo.rect.height}),d.image=N,d.hits=this.handleImage("body",N,b,y,$,d.point,R.bodyInfo),d):d},_handleLeaveOrMissing:function(e,k,Z){var I="leave"===e?this.currentInfo:this.downInfo;if(I){var o=I.interactiveInfo||I.ui.interactiveInfo;if(o){var g,f,x=I.data;if(this._is2d){if(f=this.gv.lp(k),"body"===I.part&&o.bodyInfo)g="body","leave"===e?this.handleLeaveImage(Z,g,this.gv.getImage(x),k,x,f,o.bodyInfo):this.handleMissingUpImage(g,this.gv.getImage(x),k,x,f,o.bodyInfo);else if("icons"===I.part&&o._38o){var B=o._38o[I.name];B&&B[I.index]&&(g="icons|"+I.name+"|"+I.index,"leave"===e?this.handleLeaveImage(Z,g,I.icon,k,x,f,B[I.index]):this.handleMissingUpImage(g,I.icon,k,x,f,B[I.index]))}}else{if(!o.bodyInfo)return;var h=this.gv.intersectObject(k,x);f=h?h.uv.multiply({x:o.bodyInfo.rect.width,y:o.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===e?this.handleLeaveImage(Z,"body",I.image,k,x,f,o.bodyInfo):this.handleMissingUpImage("body",I.image,k,x,f,o.bodyInfo)}}}},handleClick:function(p,h,A){var P=this,J=this.downInfo;if(J&&A){var i,r=A.interactiveInfo||A.ui.interactiveInfo,O=A.data,E=this.gv;if(O.s(h)&&O.s(h)(p,O,E),P.fire("data",h,p,O),r)if(this._is2d){if(J.part===A.part){var Q=E.lp(p);"body"===A.part&&r.bodyInfo&&(i="body",this.handleClickImage(i,E.getImage(O),h,p,O,Q,r.bodyInfo,A))}}else{if(!r.bodyInfo)return;var j=E.intersectObject(p,O);if(!j)return;Q=j.uv.multiply({x:r.bodyInfo.rect.width,y:r.bodyInfo.rect.height}),this.handleClickImage("body",J.image,h,p,O,Q,r.bodyInfo,A)}}},handleDownInfo:function(X,E){if(this.downInfo){var i=this.downInfo,x=this.gv,d=i.interactiveInfo||i.ui.interactiveInfo;if(d){var o,Q=i.data;if(Q.s(X)&&Q.s(X)(E,Q,x),this.fire("data",X,E,Q),this._is2d){var t=x.lp(E);if("body"===i.part&&d.bodyInfo)o="body",this.handleDownInfoImage(o,x.getImage(Q),X,E,Q,t,d.bodyInfo);else if("icons"===i.part&&d._38o){var _=d._38o[i.name];_&&_[i.index]&&(o="icons|"+i.name+"|"+i.index,this.handleDownInfoImage(o,i.icon,X,E,Q,t,_[i.index]))}}else{if(!d.bodyInfo)return;var q=x.intersectObject(E,Q);if(!q)return;t=q.uv.multiply({x:d.bodyInfo.rect.width,y:d.bodyInfo.rect.height}),this.handleDownInfoImage("body",i.image,X,E,Q,t,d.bodyInfo)}}}},fire:function(x,Y,K,V,v,W,S,B){this.gv.fi({kind:Y,type:x,event:K,data:V,image:v,comp:W,view:this.gv,point:S,width:B?B.width:I,height:B?B.height:I})},handleImage:function(c,t,l,P,B,C,U){var h={};if(t&&(t=Ve(t))){var M=this.gv,q=U.rect,J=this.convertPoint(C,U);J.inRect&&(t[l]&&t[l](P,B,M,J,q.width,q.height),this.fire("image",l,P,B,t,I,J,q),h[c+"|image"]={target:t,type:"image",image:t,data:B,event:P,point:J,width:q.width,height:q.height});for(var o=U.compInfos,X=t,E=o.length-1;E>=0;E--){var D=o[E],i=D.comp;J=this.convertPoint(C,D,X,i,M,B),J.inRect&&(q=D.rect,B._interactPrefix=D.prefix,i[l]&&i[l](P,B,M,J,q.width,q.height),this.fire("comp",l,P,B,t,i,J,q),(t=q.image)&&(t[l]&&t[l](P,B,M,J,q.width,q.height),this.fire("image",l,P,B,t,I,J,q)),B._interactPrefix=null,h[c+"|"+E]={target:i,type:"comp",comp:i,image:t,data:B,event:P,point:J,width:q.width,height:q.height},t&&(h[c+"|"+E+"|image"]={target:t,type:"image",image:t,data:B,event:P,point:J,width:q.width,height:q.height}))}}return h},handleLeave:function(f,L){return this._handleLeaveOrMissing("leave",f,L)},handleMissingUp:function(w){return this._handleLeaveOrMissing("missing",w)},handleLeaveImage:function(T,u,E,h,i,x,z){if(E&&(E=Ve(E))){var U=this.gv,y=z.rect,Z=this.convertPoint(x,z);T===u+"|image"&&(E.onLeave&&E.onLeave(h,i,U,Z,y.width,y.height),this.fire("image","onLeave",h,i,E,I,Z,y));for(var w=z.compInfos,p=E,O=w.length-1;O>=0;O--){var N=w[O],e=N.comp;Z=this.convertPoint(x,N,p,e,U,i),y=N.rect,i._interactPrefix=N.prefix,T===u+"|"+O&&(e.onLeave&&e.onLeave(h,i,U,Z,y.width,y.height),this.fire("comp","onLeave",h,i,E,e,Z,y)),(E=y.image)&&T===u+"|"+O+"|image"&&(E.onLeave&&E.onLeave(h,i,U,Z,y.width,y.height),this.fire("image","onLeave",h,i,E,I,Z,y)),i._interactPrefix=null}}},handleMissingUpImage:function(h,y,f,b,D,r){var W="onUp",p=this.downInfo.hits;if(p&&y&&(y=Ve(y))){var K=this.gv,v=r.rect,$=this.convertPoint(D,r);!$.inRect&&p[h+"|image"]&&(y[W]&&y[W](f,b,K,$,v.width,v.height),this.fire("image",W,f,b,y,I,$,v));for(var d=r.compInfos,o=y,s=d.length-1;s>=0;s--){var c=d[s],w=c.comp;$=this.convertPoint(D,c,o,w,K,b),$.inRect||(v=c.rect,b._interactPrefix=c.prefix,p[h+"|"+s]&&(w[W]&&w[W](f,b,K,$,v.width,v.height),this.fire("comp",W,f,b,y,w,$,v)),(y=v.image)&&p[h+"|"+s+"|image"]&&(y[W]&&y[W](f,b,K,$,v.width,v.height),this.fire("image",W,f,b,y,I,$,v)),b._interactPrefix=null)}}},handleDownInfoImage:function(V,S,F,L,s,v,h){var t=this.downInfo.hits;if(t&&S&&(S=Ve(S))){var U=this.gv,m=h.rect,P=this.convertPoint(v,h);t[V+"|image"]&&(S[F]&&S[F](L,s,U,P,m.width,m.height),this.fire("image",F,L,s,S,I,P,m));for(var b=h.compInfos,z=S,n=b.length-1;n>=0;n--){var k=b[n],H=k.comp;P=this.convertPoint(v,k,z,H,U,s),m=k.rect,s._interactPrefix=k.prefix,t[V+"|"+n]&&(H[F]&&H[F](L,s,U,P,m.width,m.height),this.fire("comp",F,L,s,S,H,P,m)),(S=m.image)&&t[V+"|"+n+"|image"]&&(S[F]&&S[F](L,s,U,P,m.width,m.height),this.fire("image",F,L,s,S,I,P,m)),s._interactPrefix=null}}},handleClickImage:function($,k,j,P,c,Z,z,i){var w=this.downInfo.hits,D=i.hits;if(w&&k&&(k=Ve(k))){var F=this.gv,x=z.rect,S=this.convertPoint(Z,z);w[$+"|image"]&&(k[j]&&k[j](P,c,F,S,x.width,x.height),this.fire("image",j,P,c,k,I,S,x));for(var A=z.compInfos,b=k,V=A.length-1;V>=0;V--){var u=A[V],y=u.comp;S=this.convertPoint(Z,u,b,y,F,c),x=u.rect,c._interactPrefix=u.prefix,w[$+"|"+V]&&D[$+"|"+V]&&(y[j]&&y[j](P,c,F,S,x.width,x.height),this.fire("comp",j,P,c,k,y,S,x)),(k=x.image)&&w[$+"|"+V+"|image"]&&(k[j]&&k[j](P,c,F,S,x.width,x.height),this.fire("image",j,P,c,k,I,S,x)),c._interactPrefix=null}}},initImageResource:function(){w.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(v,G,_,N,k,M){var E=G.rect,n=G.matrix.applyInverse(v).sub(E),u=n.x>=0&&n.y>=0&&n.x<=E.width&&n.y<=E.height;if(!u)return n;if(N&&lg(N.pixelPerfect,M,k)){var E,O=1;this._is2d?(O=k.getZoom(),E=oq(v.x,v.y,I,O)):E=oq(v.x,v.y);var H=!1,K=E.x,$=E.y,P=E.width,e=E.height,y=w.hitMaxArea,x=P*e*O*O;if(x>y){var r=Math.sqrt(y/x);O*=r}P*=O,e*=O,2>P&&(P=2),2>e&&(e=2),K*=O,$*=O;var T=hn(P,e),D=new aq(0,-K,-$,O,O);D.append(G.matrix),k._drawForChecking=!0,N.transform=D;var o=_.comps;_.comps=[N],rj(T,_,0,0,P,e,M,self),_.comps=o,delete N.transform,k._drawForChecking=!1;try{for(var R=0,F=T.getImageData(0,0,P,e).data;R<F.length;R+=4)if(0!==F[R+3]){H=!0;break}T.restore()}catch(j){Up=B,H=!1}n.inRect=H}else n.inRect=!0;return n}});var We=cq.DefaultInteractor=function(G){lr(We,this,[G])};am("DefaultInteractor",Dm,{handle_mousedown:function(E){xh(E);var d=this,w=d.gv,q=w.getDataAt(E);if(w.setFocus(E)&&!w._editing&&!w._scrolling){Sb(E)?w.handleDoubleClick(E,q):w.handleClick(E,q);var H=kf(E);!Rg()&&!H&&q&&(w.isMovable(q)||w.isInteractive(q))||!w.isPannable()||!yi(E)&&!H||Di(E)||(d._tx=w.tx(),d._ty=w.ty(),d.startDragging(E))}},handleWindowMouseUp:function(y){var I=this,Q=I.gv;Q._panning&&(delete Q._panning,Q.onPanEnded(),I.fi({kind:"endPan",event:y})),delete I._tx,delete I._ty,I.clearDragging()},handle_mousemove:function(r){var P=this,k=P.gv;P._hoverTimer&&(Cd(P._hoverTimer),delete P._hoverTimer),P._hoverTimer=nd(function(){P.fi({kind:"hover",event:r}),Cd(P._hoverTimer),delete P._hoverTimer},k.getHoverDelay()||w.hoverDelay)},handle_touchmove:function(f){this.handle_mousemove(f)},handleWindowMouseMove:function(r){var I=this,T=I.gv;I.fi({kind:T._panning?"betweenPan":"beginPan",event:r}),T._panning=1;var E=Kh(T,r,I._lastClientPoint);T.setTranslate(I._tx+E.x,I._ty+E.y)},handle_mousewheel:function(p){this.gv.handleScroll(p,p.wheelDelta)},handle_DOMMouseScroll:function(P){2===P.axis&&this.gv.handleScroll(P,-P.detail)},handle_keydown:function(u){this.gv.handleKeyDown(u)}});var Le=cq.SelectInteractor=function(H){lr(Le,this,[H])};am("SelectInteractor",Dm,{_42:function(){var N=this,Q=N.gv,x=Q.getZoom(),u=N.mark,I=N.div;I||(I=N.div=ms(),Oi(N.getView(),I));var w={};w.x=u.x*x+Q.tx(),w.y=u.y*x+Q.ty(),w.width=u.width*x,w.height=u.height*x,Bb(I,w),this.intersects()?(I.style.border="",I.style.background=Q.getRectSelectBackground()):(I.style.background="",I.style.border="1px solid "+Q.getRectSelectBorderColor())},handle_mousedown:function(W){var G=this,q=G.gv;if(G._57I=B,G.pendingClickThrough=B,!(q._editing||q._scrolling||Rg()||kf(W))){var k=q.getDataAt(W),j=q.sm();k?Di(W)?j.co(k)?j.rs(k):j.as(k):j.co(k)?k instanceof Vp&&k.isClickThroughEnabled()&&yi(W)&&(G.pendingClickThrough=pr(W)):j.ss(k):Di(W)||!q.isPannable()?yi(W)&&(Di(W)||j.cs(),q.isRectSelectable()&&(G.startDragging(W),q._77O=1)):yi(W)&&(G._57I=pr(W))}},handle_mouseup:function(K){var N=this,a=N.gv,M=N._57I;if(M&&(Ke(M,pr(K))<=1&&a.sm().cs(),N._57I=B),N.pendingClickThrough){if(Ke(N.pendingClickThrough,pr(K))<=1){var d=a.getDataAt(K);if(d instanceof Vp&&d.isClickThroughEnabled()){var C=a.getDataAt(K,function(A){var t=A.getParent()===d&&a.isSelectable(A,!0);return t});C&&(K.clickThrough=!0,a.sm().ss(C))}}N.pendingClickThrough=B}},handleWindowMouseUp:function(z){this.clear(z)},handleWindowMouseMove:function(Y){var S=this,j=S.gv;S._logicalPoint=j.lp(Y),S.mark?(S.fi({kind:"betweenRectSelect",event:Y}),j.isPannable()&&S.autoScroll(Y),S.redraw()):S.fi({kind:"beginRectSelect",event:Y}),S.mark=qh(S._lastLogicalPoint,S._logicalPoint),S.redraw()},intersects:function(){var b=this,G=b._lastLogicalPoint,T=b._logicalPoint;return G.x>T.x||G.y>T.y},clear:function(R){var k=this,W=k.gv,Z=k.mark;if(k._57I=B,k.pendingClickThrough=B,k._lastLogicalPoint){if(Z){if(0!==Z.width&&0!==Z.height){var o=W.getDatasInRect(Z,k.intersects());if(!o.isEmpty()){var f=W.sm(),u=f.toSelection();o.each(function(s){f.co(s)?u.remove(s):u.add(s)}),f.ss(u)}}ih(k.div),delete k.div,delete k.mark,k.redraw(),k.fi({kind:"endRectSelect",event:R}),W.onRectSelectEnded()}k.clearDragging(),delete W._77O}},redraw:function(){var I=this;I._draw||(I._draw=1,nd(function(){I.mark&&I._42(),delete I._draw},16))}});var Io=cq.MoveInteractor=function(k){lr(Io,this,[k])};am("MoveInteractor",Dm,{handle_mousedown:function(u){var J=this,h=J.gv;if(yi(u)&&!h._editing&&!h._scrolling&&!Rg()){var y=h.getSelectedDataAt(u);!y||h.isInteractive(y)&&!h.isMovable(y)?h._focusData=B:(J._data=y,h.handleMouseDown&&h.handleMouseDown(u,y),J.startDragging(u),h.isMovable(y)&&(h._moving=1))}},handleWindowMouseUp:function(m){var V=this,O=V.gv;O.handleMouseUp&&O.handleMouseUp(m,V._data),V.clear(m)},handleWindowMouseMove:function(C){var n=this,F=n._data,O=n.gv;if((!O._93O||!O._93O(C,F))&&O._moving){n._logicalPoint||n.fi({kind:"prepareMove",event:C});var w=n._logicalPoint?"betweenMove":"beginMove",d={kind:w,event:C},E=n._logicalPoint=O.lp(C);"beginMove"!==w||n._alreadyBeginTransaction||(n._alreadyBeginTransaction=!0,O.getDataModel().beginTransaction());var A=n._calcShift(w,C),o=A.x,s=A.y,W=n.gv.getMoveMode(C,F);W&&("x"===W?s=0:"y"===W?o=0:"xy"!==W&&(o=s=0)),O.moveSelection(o,s),n._lastLogicalPoint=E,n.autoScroll(C),n.fi(d)}},_calcShift:function(){var m=this,g=m._logicalPoint,K=m._lastLogicalPoint,E=g.x-K.x,J=g.y-K.y;return{x:E,y:J}},clear:function(O){var f=this,s=f.gv;f._lastLogicalPoint&&(f._lastLogicalPoint=f._data=s._moving=B,f._logicalPoint&&(f.fi({kind:"endMove",event:O}),s.onMoveEnded()),f.clearDragging()),f._alreadyBeginTransaction&&(f._alreadyBeginTransaction=!1,s.getDataModel().endTransaction())}});var Ti=cq.TextEditInteractor=function(Y){lr(Ti,this,[Y]),this.init()};am("TextEditInteractor",Dm,{init:function(){var J=this,$=this.input=b.createElement("input"),Q=$.style;$.text="text",Q.border="1px solid #d8d8d8",Q.position="absolute",Q.padding="2px 3px",Q.outline="none",Q.marginLeft="-90px",Q.marginTop="-16px",Q.backgroundColor="rgba(255,255,255, 0.9)",Q.fontSize="14px",Q.width="180px",Q.height="32px",Q.boxShadow="0 0 13px rgba(16,142,233, 0.5)",Q.textAlign="center",Q.boxSizing="border-box",$.addEventListener("keyup",function(G){Il(G)&&J.endTextEdit()}),$.addEventListener("focus",function(){$.select()});var k=this.textarea=b.createElement("textarea"),F=this.wrap=b.createElement("div");F.appendChild(k),Q=k.style,Q.margin=0,Q.padding="4px",Q.overflow="hidden",Q.boxSizing="border-box",Q.position="absolute",Q.outline="none",Q.backgroundColor="transparent",Q.resize="none",Q.textAlign="center",Q.fontSize="14px",Q.border="none",Q.borderWidth=0,Q.width="100%",Q.top="50%",Q=F.style,Q.boxSizing="border-box",Q.margin=0,Q.padding=0,Q.position="absolute",Q.boxShadow="0 0 13px rgba(16,142,233, 0.5)",Q.border="1px solid #d8d8d8",Q.backgroundColor="rgba(255,255,255, 0.9)",Q.width="180px",Q.marginLeft="-90px",k.addEventListener("keydown",function(b){return(us()||Di())&&Il(b)?(J.endTextEdit(),void 0):(J.calculateTextareaHeight(String.fromCharCode(b.keyCode)),void 0)}),k.addEventListener("focus",function(){k.select()});var i=function(v){v.stopPropagation()};$.addEventListener("mousedown",i),$.addEventListener("touchstart",i),k.addEventListener("mousedown",i),k.addEventListener("touchstart",i),J.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],J.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",J.handleWindowClick=function(f){var n=J._editingDOM,U=n.getBoundingClientRect(),t=pr(f);fr(U,t)||J.endTextEdit()}},handle_mousedown:function(H){var b=this,E=b.gv;if(Sb(H)&&!E._editing){var d=E.getDataAt(H);if(d){var G=E.getTextEditInfo(d);G&&(this._editInfo=G,this._editTarget=d,E._editing=!0,G.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var s=this,f=s.gv,v=s._editTarget,k=s.getTargetValue(),x=s.textarea,C=s.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===k||k===I)&&(k=""),x.value=k,s._editingDOM=x,f.getView().appendChild(C),this.layoutHTML(C,v),this.calculateTextareaHeight(),nd(function(){x.focus(),Z.addEventListener("mousedown",s.handleWindowClick),Z.addEventListener("touchstart",s.handleWindowClick)},10)},handleTextEdit:function(){var G=this,p=G.gv,F=G._editTarget,T=G.getTargetValue(),S=G.input;(null===T||T===I)&&(T=""),S.value=T,G._editingDOM=S,p.getView().appendChild(S),this.layoutHTML(S,F),nd(function(){S.focus(),Z.addEventListener("mousedown",G.handleWindowClick),Z.addEventListener("touchstart",G.handleWindowClick)},10)},layoutHTML:function(X,v){var n=this.gv,D=n.getZoom();if(v instanceof u.Node){var S=v.getRect();X.style.left=(S.x+S.width/2)*D+n.tx()+"px",X.style.top=(S.y+S.height/2)*D+n.ty()+"px"}else if(v instanceof u.Edge){var w=n.getDataUI(v),S=w._6I;X.style.left=(S.x+S.width/2)*D+n.tx()+"px",X.style.top=(S.y+S.height/2)*D+n.ty()+"px"}},endTextEdit:function(){var g=this,w=g._editInfo.isMultiline?g.wrap:g.input,x=g._editInfo.isMultiline?g.textarea:g.input;g.setTargetValue(x.value),g.gv.getView().removeChild(w),g.gv._editing=!1,delete g._editingDOM,Z.removeEventListener("mousedown",g.handleWindowClick),Z.removeEventListener("touchstart",g.handleWindowClick)},setTargetValue:function(Q){var U=this,c=U._editTarget,V=U._editInfo,o=V.accessType,Y=V.name;if(Y&&o||(o="p",Y="name"),"p"===o){var D=u.Default.setter(Y);c[D](Q)}else"a"===o?c.a(Y,Q):c.s(Y,Q)},getTargetValue:function(){var w=this,I=w._editTarget,g=w._editInfo,r=g.accessType,R=g.name;if(R&&r||(r="p",R="name"),"p"===r){var q=u.Default.getter(R);return I[q]()}return"a"===r?I.a(R):I.s(R)},createHiddenTextarea:function(){this.hiddenTextarea=b.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(K,o){if(o&&this.computedStyleCache)return this.computedStyleCache;var L=this,_=Z.getComputedStyle(K),a=_.getPropertyValue("box-sizing")||_.getPropertyValue("-moz-box-sizing")||_.getPropertyValue("-webkit-box-sizing"),i=parseFloat(_.getPropertyValue("padding-bottom"))+parseFloat(_.getPropertyValue("padding-top")),g=parseFloat(_.getPropertyValue("border-bottom-width"))+parseFloat(_.getPropertyValue("border-top-width")),U=L.SIZING_STYLE.map(function(w){return w+":"+_.getPropertyValue(w)}).join(";"),R={sizingStyle:U,paddingSize:i,borderSize:g,boxSizing:a};return o&&(this.computedStyleCache=R),R},calculateTextareaHeight:function(u){u=u||"";var j=this,U=j.textarea,q=j.hiddenTextarea,n=j.wrap,X=32,R=j.calculateHTMLStyle(U,!1),G=R.paddingSize,N=R.borderSize,C=R.boxSizing,Y=R.sizingStyle;q.setAttribute("style",Y+";"+j.HIDDEN_TEXTAREA_STYLE),q.value=U.value+u;var a=q.scrollHeight;"border-box"===C?a+=N:"content-box"===C&&(a-=G),U.style.height=a+"px",U.style.marginTop=0-.5*a+"px",n.style.height=Math.max(a,X)+"px",n.style.marginTop=a*-.5+"px"}});var be=cq.ScrollBarInteractor=function($){lr(be,this,[$])};am("ScrollBarInteractor",Dm,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(c){var C=this.gv.getViewRect();return this._41o()&&(C.x+C.width-this.gv.lp(c).x)*this.gv.getZoom()<td},isH:function(j){var K=this.gv.getViewRect();return this._40o()&&(K.y+K.height-this.gv.lp(j).y)*this.gv.getZoom()<td},handle_mousemove:function(_){this.handle_touchmove(_)},handle_touchmove:function(Z){if(!Kn&&yi(Z)&&this.gv.isScrollBarVisible()){var t=this,Q=t.isV(Z),D=t.isH(Z);(Q||D)&&t.gv.showScrollBar(),t.gv._scrolling=Q||D}},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(P){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=B,this.fi({kind:"endScroll",event:P})},handle_mousedown:function(u){this.handle_touchstart(u)},handle_touchstart:function(R){var I=this;if(I.gv.setFocus(R),xh(R),I.handle_touchmove(R),!(Kl(R)>1)&&I.gv._scrolling&&I.gv.isScrollBarVisible()){I._cp=pr(R),I._tx=I.gv.tx(),I._ty=I.gv.ty();var J=I.isV(R);I._state=J?"vScroll":"hScroll",bh(I,R),I.fi({kind:"beginScroll",event:R})}},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(S){var D=pr(S),W=this.gv.getViewRect(),E=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-D.y)*E.height/W.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-D.x)*E.width/W.width),this.fi({kind:"betweenScroll",event:S})}});var ff=cq.TouchInteractor=function(D,g){g=g||{},g.selectable===I&&(g.selectable=!0),g.movable===I&&(g.movable=!0),g.pannable===I&&(g.pannable=!0),g.pinchable===I&&(g.pinchable=!0),g.editable===I&&(g.editable=!0),this.params=g,lr(ff,this,[D])};am("TouchInteractor",Dm,{ms_edit:1,setUp:function(){var I=this;ff.superClass.setUp.call(I),xc&&I.params.editable&&I.gv.setEditInteractor(I)},tearDown:function(){var D=this;ff.superClass.tearDown.call(D),xc&&D.params.editable&&D.gv.setEditInteractor(B)},clear:function(K){var $=this,T=$.gv;T._moving&&($.fi({kind:"endMove",event:K}),delete T._moving,T.onMoveEnded(),T.dm().endTransaction()),T._panning&&($.fi({kind:"endPan",event:K}),delete T._panning,T.onPanEnded()),T._pinching&&($.fi({kind:"endPinch",event:K}),delete T._pinching,T.onPinchEnded()),T._editing&&($._46O(K),$._77I=$._node=$._edge=$._shape=$._rect=$._89I=$._index=T._editing=B),$._moving=$._panning=$._pinching=$._editing=$._57I=$._data=$._beginHistory=B,$.clearDragging()},handle_touchstart:function(p){var S=this;if(!S.gv._editing){xh(p),S._57I=B;var K=S.params,M=S.gv,R=M.sm(),k=M.getDataAt(p),o=Kl(p);if(1===o){if(Sb(p))return M.handleDoubleClick(p,k),void 0;M.handleClick(p,k),k&&(M.handleMouseDown&&M.handleMouseDown(p,k),S._data=k),K.selectable||(k=B),k&&(R.co(k)||R.ss(k),K.editable&&M.isEditable(k)&&S._79I(p,k,!0)?(S._editing=1,S.startDragging(p)):K.movable&&M.isMovable(k)&&(S._moving=1,S.startDragging(p))),k&&M.isMovable(k)||(S._57I=pr(p),K.pannable&&M.isPannable()&&(S._panning=1,S.startDragging(p),S._translate={x:M.tx(),y:M.ty()}))}else if(K.pinchable&&2===o){if(k&&M.isInteractive(k))return;S._pinching=1,S.startDragging(p);var a=M.getView(),d=M.getZoom(),g=a.getBoundingClientRect(),P=p.touches[0],Q=p.touches[1],X={x:(P.clientX+Q.clientX)/2-g.left,y:(P.clientY+Q.clientY)/2-g.top};X.x-=M.tx(),X.y-=M.ty(),X.x/=d,X.y/=d,S._p=X,S._d=yf(p)}}},handle_touchend:function(s){var A=this,q=A.gv,U=A._57I,D=A._data;U&&(Ke(U,pr(s))<=1&&!q.getDataAt(s)&&q.sm().cs(),A._57I=B),D&&q.handleMouseUp&&q.handleMouseUp(s,D)},handleWindowTouchEnd:function(k){this.clear(k)},handleWindowTouchMove:function(W){var e=this,G=e.gv,d=Kl(W);if(1===d){if(e._editing&&(e._beginHistory||(e._beginHistory=1,G.dm().beginTransaction()),G._editing=1,e._78I(W)),e._moving)e._beginHistory||(e._beginHistory=1,G.dm().beginTransaction()),e.handleMove(W);else if(e._panning){var E=pr(W),P=Kh(G,E,e._lastClientPoint);G.setTranslate(e._translate.x+P.x,e._translate.y+P.y),e.fi({kind:G._panning?"betweenPan":"beginPan",event:W}),G._panning=1}}else if(2===d&&e._pinching){var $=yf(W);G.handlePinch(e._p,$,e._d),e._d=$,e.fi({kind:G._pinching?"betweenPinch":"beginPinch",event:W}),G._pinching=1}},handleMove:function(D){var b=this,s=b.gv,m=s.lp(D);s._93O&&s._93O(D,b._data)||(s.moveSelection(m.x-b._lastLogicalPoint.x,m.y-b._lastLogicalPoint.y),b._lastLogicalPoint=m,b.autoScroll(D),b.fi({kind:s._moving?"betweenMove":"beginMove",event:D}),s._moving=1)}});var u=Z.ht,Mh=u.graph._editor={Math:u.Math,Guide:{}};Mh.getStyle=function(u){var m,R=Mh.StyleMap;return R&&(m=R[u],m!==I)?m:Mh.DefaultStyleMap[u]},Mh.setStyle=function(B,W){var J=Mh.StyleMap;J||(J=Mh.StyleMap={}),J[B]=W},Mh.inEdit=function(M){return M._inXEdit===!0},Mh.startEdit=function(S){S._inXEdit=!0,Mh.Inject.doInject(S)},Mh._46O=function(Z){Z._inXEdit=!1,Mh.Inject.undoInject(Z)},Mh.toScreenPosition=function(a,$){var _=a.tx(),w=a.ty(),V=a._zoom;return new Mh.Math.Vector2($.x*V+_,$.y*V+w)},Mh.checkHit=function(S,g,U){return S.distanceTo(g)<U?!0:!1},Mh.toWorldPosition=function(S,L){var Y=S.tx(),k=S.ty(),O=S._zoom;return{x:(L.x-Y)/O,y:(L.y-k)/O}},Mh.setAntialias=function(d,y){for(var c,Z=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],o=0,g=Z.length;g>o&&(c=Z[o],!(c in d));o++);d[c],d[c]=y},Mh.getTargetCornersOnScreen=function(s,G){if(!G)return null;var D,g=[];if(Tl(G,s)){var L=dm(s,G);D=[{x:L.x,y:L.y},{x:L.x+L.width,y:L.y},{x:L.x+L.width,y:L.y+L.height},{x:L.x,y:L.y+L.height}]}else{if(!G.getCorners)return null;D=G.getCorners()}return D.forEach(function(I){var x=Mh.toScreenPosition(s,I);g.push(x.x,x.y)}),g},Mh.log=function(){};var qj=Mh.Inject={_modules:[]};qj.registAsModule=function(m,j){var t={},C={};for(var o in m){var X=j.prototype[o];t[o]=X}m.getBackup=function(E){return t[E]},m.getBackups=function(){return t},C.doInject=function(){for(var Y in m)"getBackup"!==Y&&(j.prototype[Y]=m[Y])},C.undoInject=function(){for(var Z in m)"getBackup"!==Z&&(j.prototype[Z]=t[Z])},qj._modules.push(C)},qj.doInject=function(y){for(var L,o=qj._modules,h=0,z=o.length;z>h;h++)L=o[h],L.doInject(y)},qj.undoInject=function(q){for(var i,f=qj._modules,Y=0,E=f.length;E>Y;Y++)i=f[Y],i.undoInject(q)};var Dm=u.graph.EditInteractor=function(t){var X=this,q=b.createElement("canvas");q.className="editCanvas",q.style.position="absolute",X._styleMap={},X._canvas=q,X._context=q.getContext("2d"),Dm.superClass.constructor.call(X,t),Mh.setAntialias(X._context,!1),X._subModules=[new Mh.Anchor(X),new Mh.RotateX(X),new Mh.MoveDummy(X),new Mh.Rect(X),new Mh.Curve(X),new Mh.MoveHelper(X)],X._gridGuide=new Mh.Guide.Grid(X),X._rectGuide=new Mh.Guide.Rect(X),X._hoverGuide=new Mh.Guide.Hover(X)},sn=Dm;u.Default.def(Dm,u.graph.Interactor,{ms_edit:1,ms_fire:1}),J.defineProperties(Dm.prototype,{editDetail:{get:function(){var F=!!this._editDetail;return F},set:function(S){var X=this,c=X._editDetail;c!==S&&(X._editDetail=S,X.gv._editing=S,X.fp("editDetail",c,S),X.fp("pointsEditingMode",c,S),X.fi({kind:S?"beginEditPoints":"endEditPoints"}))
}},gvEditing:{get:function(){return this.gv._editing},set:function(l){(!this._editDetail||l)&&(this.gv._editing=l,l||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(f){this._editing=f,this.gvEditing=f}},pointsEditingMode:{get:function(){return this.editDetail},set:function(F){var W=this;W.editDetail!==F&&(F?W._tryEnterEditDetailMode():W._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var g=this._gridEnabled;if(!g)return!1;var T=this.gv;return T?!0:!0},set:function(W){W!==this._gridEnabled&&(this._gridEnabled=W,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(c){c!==this._agEnabled&&(this._agEnabled=c,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Dm.prototype.getSubModule=function(J){var K,e,C,k=this._subModules;for(e=0,C=k.length;C>e;e++)if(K=k[e],K.catalog===J)return K},Dm.prototype.invokeSubModule=function(L,V){var n=this,u=n._subModules;if(u)for(var q,K,E,c=Array.prototype.slice.call(arguments,2),l=0,s=u.length;s>l;l++)if(q=u[l],K=q[L],K&&(E=K.apply(q,c),E!=I&&V))return q},Dm.prototype.invokeSubModuleInverse=function(t,L){var x=this,E=x._subModules;if(E)for(var $,e,A,u=Array.prototype.slice.call(arguments,2),a=E.length-1;a>=0;a--)if($=E[a],e=$[t],e&&(A=e.apply($,u),A!=I&&L))return $},Dm.prototype.setUp=function(){Mh.log("setUp");var R=this,d=R.gv,W=d.getView(),c=R._canvas;Dm.superClass.setUp.call(R),d.setEditInteractor(R),d._79O?W.insertBefore(c,d._79O):W.appendChild(c),Mh.startEdit(d),R.invokeSubModule("setUp"),d.dm().mm(R._onDataModelChanged,R),d.dm().md(R._onDataPropertyChanged,R)},Dm.prototype.tearDown=function(){Mh.log("tearDown");var L=this,M=L.gv,X=M.getView();L._resetCustomCursorStyle(),Dm.superClass.tearDown.call(L),M.dm().umm(L._onDataModelChanged,L),M.dm().umd(L._onDataPropertyChanged,L),M.setEditInteractor(null),X.removeChild(L._canvas),L._drawTimer&&(Cd(L._drawTimer),L._drawTimer=null),Mh._46O(M),L.invokeSubModule("tearDown")},Dm.prototype._onDataModelChanged=function(S){var M=this;("clear"===S.kind||"remove"===S.kind&&M.editDetail&&S.data===M.getSubModule("Curve").target)&&(M.editDetail=!1,M._42())},Dm.prototype._onDataPropertyChanged=function(V){var O=this;if(O.editDetail){var P=O.getSubModule("Curve"),s=V.data;s===P.target&&(s._writing||P._handleDataChanged(V))}},Dm.prototype.clear=function(){Mh.log("clear")},Dm.prototype.redraw=function(){this._42()},Dm.prototype._42=function(){var W=this;W._drawTimer||(W._drawTimer=nd(function(){W._drawTimer=null,W.drawImpl()},0))},Dm.prototype.drawImpl=function(){var q;for(q in{_42:!0})break;return function(){var K=this,N=K._canvas,m=K.gv,n=m.getWidth(),E=m.getHeight(),t=K._context,A=u.Default.getInternal(),d=Z.devicePixelRatio;(N.width!==n||N.height!==E)&&A.setCanvas(N,n,E,d),t.clearRect(0,0,N.width,N.height);var o=K._getValidSelection();t.save(),t.scale(d,d),K._gridGuide._42(),K.invokeSubModuleInverse(q,!1,t,m,o),K._rectGuide._42(),K._hoverGuide._42(),t.restore()}}(),Dm.prototype._getValidSelection=function(){var r=this,Z=r.gv,c=Z.sm().getSelection(),E=[];return c.each(function(B){Z.isVisible(B)&&Z.isEditable(B)&&E.push(B)}),E},Dm.prototype.handle_touchmove=function(V){return this.handle_mousemove(V)},Dm.prototype.handle_mousemove=function(X){if(!u.Default.isDragging()){var D=this;if(D.editDetail||!Rg()&&!kf(X))if(D.gvEditing=!1,D._checkEdit(X))D.gvEditing=!0;else{if(!D.getStyle("hoverGuideEnabled"))return;D.hoverData=D.gv.getDataAt(X),D._42()}}},Dm.prototype.handle_touchstart=function($){return this.handle_mousedown($)},Dm.prototype.handle_mousedown=function(f){xh(f);var O=this;if(O.editDetail||!Rg()&&!kf(f)){if(Sb(f)&&!f.clickThrough){if(O.editDetail){if(O._tryQuitEditDetailMode(f))return}else if(O._tryEnterEditDetailMode())return;O.gv.dm().beginTransaction();var j=O.invokeSubModule("handleDoubleClick",!0,f);if(O.gv.dm().endTransaction(),j)return}var A=O._checkEdit(f);A&&(O._downPosition=O._getLogicalPoint(f),O.gv.dm().beginTransaction(),A.startEdit(O,f),O.editing=!0)}},Dm.prototype._checkEdit=function(u){var f=this,y=f.gv,x=f._getLogicalPoint(u),d=f.invokeSubModule("check",!0,y,u,x)||null;return f._editMod=d,d},Dm.prototype.handleWindowTouchMove=function(i){return this.handleWindowMouseMove(i)},Dm.prototype.handleWindowMouseMove=function(A){var Z=this,D=Z._downPosition;if(D){var j=Z._getLogicalPoint(A);if(j.distanceTo(D)<Z.getStyle("moveSensitivity"))return;delete Z._downPosition}var a=Z._editMod;a&&a.handleEdit(Z.gv,A)},Dm.prototype._getLogicalPoint=function(o){var n=this,J=u.Default.getLogicalPoint(o,n._canvas);return new Mh.Math.Vector2(J)},Dm.prototype.handleWindowTouchEnd=function(A){return this.handleWindowMouseUp(A)},Dm.prototype.handleWindowMouseUp=function(){var w;for(w in{_46O:!0})break;return function(s){var l=this;l.editing=!1,l.setCursor("default"),l.invokeSubModule(w,!1,s),l._42(),l.gv.dm().endTransaction()}}(),Dm.prototype.handle_mousewheel=function(t){var d=this;xh(t),d.invokeSubModule("preHandleScroll",!0)||d.gv.handleScroll(t,t.wheelDelta)},Dm.prototype.handleDelete=function(){var o=this;if(!o.editDetail){o.gv.dm().beginTransaction();var f=o.invokeSubModule("handleNormalStateDelete",!0);return o.gv.dm().endTransaction(),f||o.gv.removeSelection(),void 0}o.gv.dm().beginTransaction(),o.invokeSubModule("handleDelete",!0),o.gv.dm().endTransaction(),o._42()},Dm.prototype.handle_keydown=function(O){var o=this;if((O.metaKey||O.ctrlKey)&&o._42(),Rg(O)&&!o.editing)return o.gvEditing=!1,o.setCursor("default"),o._42(),void 0;var w=Il(O);return o.editDetail?((w||Pg(O))&&(o.editDetail=!1,o._42()),o.gv.dm().beginTransaction(),o.invokeSubModule("handle_keydown",!0,O),o.gv.dm().endTransaction(),void 0):(o.gv.dm().beginTransaction(),o.invokeSubModule("handleNormalStateKeyDown",!0,O),o.gv.dm().endTransaction(),w&&o._tryEnterEditDetailMode(),void 0)},Dm.prototype.handle_keyup=function(t){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,t),this.gv.dm().endTransaction()},Dm.prototype._tryEnterEditDetailMode=function(){var V=this;return!V.editDetail&&V.invokeSubModule("canEnterEditDetailMode",!0)&&1===V._getValidSelection().length?(V.editDetail=!0,V._42(),!0):void 0},Dm.prototype._tryQuitEditDetailMode=function(D){var u=this;return u.editDetail?!D||u.invokeSubModule("canQuitEditDetailMode",!0,D)?(u.editDetail=!1,u._42(),!0):!1:!1},Dm.prototype.setStyle=function(Y,U,q){var i=this;q?Mh.setStyle(Y,U):i._styleMap[Y]=U,"baseColor"===Y&&(Zf=U),i.fp("styleChanged",null,{key:Y,value:U,base:q}),i._42()},Dm.prototype.getStyle=function(L){var x=this,T=x._styleMap[L];return T!==I?T:Mh.getStyle(L)},Dm.prototype.setCursor=function(h){this._resetCustomCursorStyle(),u.graph.EditInteractor.superClass.setCursor.call(this,h)},Dm.prototype._resetCustomCursorStyle=function(){var p=this;if(p._customStyle){var X=this.gv.getView();X.classList&&X.classList.remove&&X.classList.remove(p._customStyle),p._customStyle=null}},Dm.prototype._setRotateCursor=function(q){var F=this,S=F._cursorFactory;S||(S=F._cursorFactory=new Mh.CursorFactory(F));var j=S.getRotateCursor(q),h=F.gv.getView();F._resetCustomCursorStyle(),F._customStyle=j,h.classList&&h.classList.add&&h.classList.add(j)};var aj=Mh.Group=function(L){var j=this;j._entities=L,j._64O=0,j._position={x:0,y:0},j._scale={x:1,y:1},j._anchor={x:.5,y:.5},j._anchor2={x:.5,y:.5}};aj.prototype={},aj.prototype.constructor=aj;var Mm=null;aj.findOrCreateGroup=function(C){if(Mm&&Mm.checkIsMe(C))return Mm;var f=new Mh.Group(C);return f.getKeyOb()?(Mm=f,f):void 0},aj.prototype.checkIsMe=function(e){var p=this._entities;if(p.length!==e.length)return!1;var J,S={},l=e.length;for(J=0;l>J;J++)S[e[J]._id]=!0;for(J=0;l>J;J++)if(!S[p[J]._id])return!1;return!0},aj.prototype.getRotation=function(){return this._64O},aj.prototype.getPosition=function(){return this._position},aj.prototype.getAnchor=function(){return this._anchor},aj.prototype.getWidth=function(){return this._width},aj.prototype.getScale=function(){return this._scale},aj.prototype.getSize=function(){return{width:this._width,height:this._height}},aj.prototype.getHeight=function(){return this._height},aj.prototype.getKeyOb=function(){for(var l=this._entities,f=l.length-1;f>=0;f--){var k=l[f];if(this.isNode(k))return k}},aj.prototype.getAnchor2=function(){var t=this,u=t.rotateCenter;if(u)return u;var g=t.getKeyOb();if(!g)return t._anchor;var A=t._anchor2,M=g.getMatrix();return M.tf({x:g.getWidth()*(A.x-g.getAnchor().x),y:g.getHeight()*(A.y-g.getAnchor().y)})},aj.prototype.setAnchor2=function(j,l){var g=this,I=g.getKeyOb();if(I){var L,t=I.getMatrix();L="number"==typeof j?{x:j,y:l}:j;var w=t.tfi(L);g._anchor2={x:I.getAnchor().x+w.x/I.getWidth(),y:I.getAnchor().y+w.y/I.getHeight()}}},aj.prototype.setRotation=function(){},aj.prototype.beginRotate=function(L){this.rotateCenter=L.pos,this.rotateMode=L.groupRotateMode},aj.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},aj.prototype.addRotation=function(L,q){return"batch"===q?this._addRotationInBatchMode(L):"block"===q?this._addRotationInBlockMode(L):void 0},aj.prototype._addRotationInBlockMode=function(r){var Y=this,i=Y.rotateCenter||Y.getPosition();Y._entities.forEach(function(F){if(Y.isNode(F)){var s=F.getMatrix();s.translate(-i.x,-i.y),s.rotate(r),s.translate(i.x,i.y);var a=Math.sign(F.getScale().x);F.setRotation(v(s.b*a,s.a*a)),F.setPosition(s.tx,s.ty)}})},aj.prototype._addRotationInBatchMode=function(b){var Y=this,L=Y._anchor2;Y._entities.forEach(function(G){if(Y.isNode(G)){var m=G.getAnchor(),o=G.getMatrix(),P=o.tf({x:G.getWidth()*(L.x-m.x),y:G.getHeight()*(L.y-m.y)}),r=new Mh.Math.Matrix2d;r.set(o.a,o.b,o.c,o.d,o.tx,o.ty),r.translate(-P.x,-P.y),r.rotate(b),r.translate(P.x,P.y);var T=Math.sign(G.getScale().x);G.setRotation(v(r.b*T,r.a*T)),G.setPosition(r.tx,r.ty)}})},aj.prototype.setPosition=function(T){var v,o,g,p,y=this,Y=y._position,D=T.x-Y.x,_=T.y-Y.y,l=y._entities;for(o=0,g=l.length;g>o;o++)v=l[o],$o(v)&&(p=v.getPosition(),v.setPosition(p.x+D,p.y+_));y._position=T},aj.prototype.setScale=function(W,c){var i=this,S=W/i._scale.x,f=c/i._scale.y;i._adjustChildScaleOrSize(S,f,"size"),i._scale={x:W,y:c}},aj.prototype.getRect=function(){var e=this,t=e._position,J=e._width,v=e._height;return{x:t.x-J/2,y:t.y-v/2,width:J,height:v}},aj.prototype.setSize=function(E,o){var r=this,E=Math.max(1,E),o=Math.max(1,o),q=E/r._width,f=o/r._height;r._adjustChildScaleOrSize(q,f,"size"),r._width=E,r._height=o},aj.prototype._adjustChildScaleOrSize=function(o,x,b){var l,z,Q,g,u,N,q,Z,W,F,T,f,A,G,_=this,D=_._position,t=_._entities,P=new Mh.Math.Matrix2d;for(z=0,Q=t.length;Q>z;z++)if(l=t[z],_.isNode(l)){if(g=l.getPosition(),u=l.getRotation(),N=l.getWidth(),q=l.getHeight(),Z=l.getScale(),T=Z.x*N,f=Z.y*q,P.identity().scale(T,f).rotate(u).translate(g.x,g.y).translate(-D.x,-D.y).rotate(-_._64O),u=v(P.b*Math.sign(T),P.a*Math.sign(T)),P.scale(o,x),W=Math.cos(u),F=Math.sin(u),Math.abs(W)<.001?(A=P.b/F,G=-P.c/F):(A=P.a/W,G=P.d/W),"scale"===b)l.setScale(A/N,G/q);else if("size"===b){var r=A/Z.x,B=G/Z.y;l.setScale(Sl(A)*Math.abs(Z.x),Sl(G)*Math.abs(Z.y)),l.setSize(Math.max(.1,Math.abs(r)),Math.max(.1,Math.abs(B)))}P.rotate(_._64O).translate(D.x,D.y),l.setPosition(P.tx,P.ty)}},aj.prototype.getMatrix=function(){var Z=this,B=Z._position,T=u.Default.getInternal(),F=Z._scale;return new T.Mat(Z._64O,B.x,B.y,F.x,F.y)},aj.prototype.toGlobal=function(f){return this.getMatrix().tf(f)},aj.prototype.getCorners=function(){var M=this,f=M._width,p=M._height,c=M._anchor,t=-f*c.x,K=-p*c.y,X=M.getMatrix();return[X.tf(t,K),X.tf(t,K+p),X.tf(t+f,K+p),X.tf(t+f,K)]},aj.prototype.calcInfo=function(){var w,P,c,A,K,Y,S=this,D=[],k=S._entities,V=S._64O;for(A=0,K=k.length;K>A;A++)Y=k[A],S.isNode(Y)&&Y.getCorners&&D.push.apply(D,Y.getCorners());if(D.length){var R=Math.cos(-V),B=Math.sin(-V),h=1/0,x=-1/0,b=1/0,Z=-1/0;for(A=0,K=D.length;K>A;A++)c=D[A],w=c.x,P=c.y,c.x=R*w-B*P,c.y=B*w+R*P,h=Math.min(h,c.x),x=Math.max(x,c.x),b=Math.min(b,c.y),Z=Math.max(Z,c.y);S._width=(x-h)/S._scale.x,S._height=(Z-b)/S._scale.y,R=Math.cos(V),B=Math.sin(V);var m=S._anchor;w=h+(x-h)*m.x,P=b+(Z-b)*m.y,S._position={x:R*w-B*P,y:B*w+R*P}}},aj.prototype.isNode=function(A){return $o(A)?Tl(A)?!1:!0:!1},aj.prototype._42=function(B,$,C){var S,L,f,n,M,F,Z,u,A=this,s=A._entities,H=A.rotateMode;for("batch"===H&&(u=A.getKeyOb()),S=0,L=s.length;L>S;S++)f=s[S],A.isNode(f)&&(F=f.getRect(),n=Mh.toScreenPosition(C,{x:F.x,y:F.y}),M=Mh.toScreenPosition(C,{x:F.x+F.width,y:F.y+F.height}),Z={min:n,max:M},f===u&&(Z.isKeyOb=!0),Mh.Icons.DrawIcon(B,$,Mh.Icons.GroupSubEntityRect,Z))};var br=Mh.CurveActiving=function(T,B){this._curve=T,this._interactor=T._interactor;for(var f in B)this[f]=B[f]};br.prototype={},br.prototype.constructor=br,J.defineProperties(br.prototype,{point:{get:function(){return this._point},set:function(Z){var h=this;h._point=Z,h.editingCtrl||h._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(o){var d=this;d._pairs=o,d.editingCtrl&&d._firePointChange()}}}),br.prototype._firePointChange=function(){var z=this,e=z.getCurrentEditingPoint(),C=z._interactor;if(!e)return C.fi({kind:"selectPoint"}),void 0;var p=this._curve.target;if(p){var J=Mh.getDataMatrix(p).invert(),o=e.e;e=J.apply(Mh.toWorldPosition(C.gv,e)),e.e=o;var s=z._lastFirePoint;s&&Math.abs(e.x-s.x)<1e-5&&Math.abs(e.y-s.y)<1e-5&&(e.e==I&&s.e==I||Math.abs(e.e-s.e)<1e-5)||(z._lastFirePoint=e,C.fi({kind:"selectPoint",x:e.x,y:e.y,e:e.e}))}},br.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},br.prototype.getCurrentEditingPoint=function(){var V=this,S=V.editingCtrl;if(S){var L=V.pairs;if(L){var q=L[S.pairId],l=q[S.type];if(l)return l}}return V._point};var Af=Mh.CursorFactory=function(A){var V=this;V._interactor=A,V._rotateCursorStyles={}};Af.prototype={},Af.prototype.constructor=Af,Af.prototype.getRotateCursor=function(G){var B=this;0>G&&(G+=2*Math.PI);var T=B._interactor,K=T.getStyle("rotateCursorSize"),C=T.getStyle("rotateCursorRound"),P=Math.round(180*(G/Math.PI)/C);P*C>=360&&(P=0);var Y=B._rotateCursorStyles,m="htCustomRotateStyle_"+K+"_"+C+"_"+P;return Y[m]||(B._produceRotateCursor(m,K,C,P),Y[m]=!0),m},Af.prototype._produceRotateCursor=function(j,t,H,X){var l=this;l._interactor;var E=l._canvas;E||(E=l._canvas=b.createElement("canvas")),E.width=E.height=t*devicePixelRatio,E.style.width=E.style.height=t+" px";var p=E.getContext("2d");Mh.setAntialias(p,!1),p.scale(devicePixelRatio,devicePixelRatio);var m,k,c,r,I,S=Math.round(t/2),s=""+S+" "+S+",auto !important;";m=Math.PI/180*X*H,p.clearRect(0,0,t,t),p.save(),p.scale(t/32,t/32),p.translate(16,16),p.rotate(m+Math.PI/2),p.beginPath(),p.moveTo(-8,0),p.lineTo(-8,3),p.lineTo(-5,3),p.moveTo(8,0),p.lineTo(8,3),p.lineTo(5,3),p.moveTo(-8,3),p.quadraticCurveTo(0,-6,8,3),p.restore(),p.strokeStyle="white",p.lineWidth=4,p.stroke(),p.strokeStyle="black",p.lineWidth=2,p.stroke(),k=JSON.stringify(E.toDataURL()),r="cursor:url("+k+")"+s,1!==devicePixelRatio&&(c='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+t+'px" height="'+t+'px"><image xlink:href='+k+' width="'+t+'" height="'+t+'"/></svg>',r+="cursor:url(data:image/svg+xml;base64,"+btoa(c)+")"+s,r+="cursor:-webkit-image-set(url("+k+")"+devicePixelRatio+"x,url("+k+")1x)"+s),I=b.createElement("style"),I.textContent="body."+j+" *, ."+j+"{"+r+"}",b.head.appendChild(I)};var Ag=Mh.Guide.Grid=function(o){var Y=this;Y._interactor=o,Y._alignmentGuideId=0,Y._xAlignmentGuide=[],Y._yAlignmentGuide=[]};Ag.prototype={},Ag.prototype.constructor=Ag,J.defineProperties(Ag.prototype,{gridBlockSize:{get:function(){var u=this;return u._gridBlockSize||u._interactor.getStyle("gridBlockSize")},set:function(s){this._gridBlockSize=s,this._interactor._42()}},gridThickLinesEvery:{get:function(){var k=this;return k._gridThickLinesEvery||k._interactor.getStyle("gridThickLinesEvery")},set:function(k){this._gridThickLinesEvery=k,this._interactor._42()}},gridEnabled:{get:function(){var l=this,m=l._interactor;return m.gridEnabled&&l.isValidGrid()}}}),Ag.prototype._42=function(){var e=this,o=e._interactor;e.gridEnabled&&e.drawGrid(),o.alignmentGuideEnabled&&e.drawAlignmentGuide()},Ag.prototype.makeMatrix=function(){var N=this,u=N._interactor.getStyle("gridAngle"),g=N._interactor.getStyle("gridRotation"),Q=new Mh.Math.Matrix2d,F=Math.sin(u),e=Math.cos(u);return Q.set(1,0,e,F,0,0),Q.rotate(g),Q},Ag.prototype.isValidGrid=function(){var L=this,l=Math.PI,f=L._interactor,k=f.gv;if(k._zoom<f.getStyle("gridZoomThreshold"))return!1;var I=f.getStyle("gridAngle"),y=Math.abs(180*(I%l/l)),Q=1-1e-8;return Q>y||y>180-Q?!1:!0},Ag.prototype.drawAlignmentGuide=function(){var g=this,w=g._interactor,X=w.gv,Z=w._canvas,f=w._context,d=Z.width,q=Z.height,z=X.tx(),A=X.ty(),$=X._zoom;f.beginPath(),f.strokeStyle=w.getStyle("gridAlignmentGuideColor"),f.lineWidth=1,g._xAlignmentGuide.forEach(function(p){var V=p.p*$+z;f.moveTo(V,0),f.lineTo(V,q)}),g._yAlignmentGuide.forEach(function(g){var L=g.p*$+A;f.moveTo(0,L),f.lineTo(d,L)}),f.stroke()},Ag.prototype.drawGrid=function(){function o(l,J,W,F){var e=Mh.toScreenPosition(N,U.apply({x:l,y:J})),t=Mh.toScreenPosition(N,U.apply({x:W,y:F}));K.moveTo(e.x,e.y),K.lineTo(t.x,t.y)}var M=this,$=M._interactor,G=M.gridBlockSize,R=M.gridThickLinesEvery,j=$.getStyle("gridThickColor"),c=$.getStyle("gridLightColor"),N=$.gv,Q=$._canvas,K=$._context,k=Q.width,B=Q.height,U=M.makeMatrix(),n=U.applyInverse(Mh.toWorldPosition(N,{x:0,y:0})),V=U.applyInverse(Mh.toWorldPosition(N,{x:k,y:0})),I=U.applyInverse(Mh.toWorldPosition(N,{x:0,y:B})),L=U.applyInverse(Mh.toWorldPosition(N,{x:k,y:B})),P=Math.min(n.x,V.x,I.x,L.x),W=Math.max(n.x,V.x,I.x,L.x),x=Math.min(n.y,V.y,I.y,L.y),h=Math.max(n.y,V.y,I.y,L.y);k=W-P,B=h-x;var r=Math.ceil(P/G),s=Math.floor(W/G),q=Math.ceil(x/G),A=Math.floor(h/G);N.tx(),N.ty(),N._zoom;var d,e,z;for(K.save(),K.lineWidth=1,K.beginPath(),K.strokeStyle=j,z=Math.ceil(r/R)*R;s>=z;z+=R)d=z*G,o(d,x,d,h);for(z=Math.ceil(q/R)*R;A>=z;z+=R)e=z*G,o(P,e,W,e);for(K.stroke(),K.beginPath(),K.strokeStyle=c,z=r;s>=z;z++)0!==z%R&&(d=z*G,o(d,x,d,h));for(z=q;A>=z;z++)0!==z%R&&(e=z*G,o(P,e,W,e));K.stroke(),K.restore()},Ag.prototype.getAlignmentGuides=function(){var J=this;return{x:J._xAlignmentGuide,y:J._yAlignmentGuide}},Ag.prototype.addAlignmentGuide=function(m,v,Z){var R=this,X="x"===m?R._xAlignmentGuide:R._yAlignmentGuide,Z=Z?Z:++R._alignmentGuideId,W={p:v,id:Z};if(X.length){var K=R._findClosestAlignmentGuide(W.p,X);K.dis<0?X.splice(K.index+1,0,W):X.splice(K.index,0,W)}else X.push(W);return R._interactor._42(),Z},Ag.prototype.findClosest=function(I,R,n){var V=this,L=V._interactor,P=L.gv;n&&(I=Mh.toWorldPosition(P,I));var $,o,K,s=1/0,N=1/0,z=I.x,l=I.y;if(V.gridEnabled){var Q=V.gridBlockSize,r=V.makeMatrix(),m=r.applyInverse(I);m=r.apply({x:Math.round(m.x/Q)*Q,y:Math.round(m.y/Q)*Q}),s=m.x-z,N=m.y-l,K=!0}if(L.alignmentGuideEnabled&&($=V._findClosestAlignmentGuide(z,V._xAlignmentGuide).dis,o=V._findClosestAlignmentGuide(l,V._yAlignmentGuide).dis,Math.abs($)<Math.abs(s)&&(s=$,K=!0),Math.abs(o)<Math.abs(N)&&(N=o,K=!0)),K){K=!1;var G=P._zoom,d=L.getStyle("smartGuideSensitivity")/G,c={};if(Math.abs(s)<d&&"y"!==R&&(c.x=n?s*G:s,K=!0),Math.abs(N)<d&&"x"!==R&&(c.y=n?N*G:N,K=!0),K)return c}},Ag.prototype._findClosestAlignmentGuide=function(x,K){if(!K.length)return{dis:1/0};for(var C,b=0,A=K.length-1;A-b>1;)C=Math.floor((b+A)/2),K[C].p<x?b=C:A=C;var s=K[b].p-x,R=K[A].p-x;return Math.abs(s)<=Math.abs(R)?{line:K[b],dis:s,index:b}:{line:K[A],dis:R,index:A}},Ag.prototype.removeAllAlignmentGuide=function(m){var u=this;"y"!==m&&(u._xAlignmentGuide=[]),"x"!==m&&(u._yAlignmentGuide=[]),u._interactor._42()},Ag.prototype.removeAlignmentGuide=function(H){for(var R,Z,g,N=this,p=N._xAlignmentGuide,s=0;2>s;s++)for(p=0===s?N._xAlignmentGuide:N._yAlignmentGuide,R=0,Z=p.length;Z>R;R++)if(g=p[R],g.id===H)return p.splice(R,1),N._interactor._42(),{axis:0===s?"x":"y",position:g.p};return!1},Ag.prototype.adjustAlignmentGuide=function($,Z){var R=this,I=R.removeAlignmentGuide($);return I?(R.addAlignmentGuide(I.axis,Z,$),!0):!1};var Vo=Mh.Guide.Rect=function(I){var s=this;s._interactor=I};Vo.prototype={},Vo.prototype.constructor=Vo,Vo.prototype.gatherRects=function(){var w,V,s,F,d=this,C=d._interactor.gv,n=[],m=[],A={x:n,y:m},J={},Y=C.getDataModel(),Q=Y.a("width"),B=Y.a("height");Q&&B&&(w=0,V=0,s=Q,F=B,n.push({node:Y,type:0,p:w},{node:Y,type:1,p:w+s/2},{node:Y,type:2,p:w+s}),m.push({node:Y,type:0,p:V},{node:Y,type:1,p:V+F/2},{node:Y,type:2,p:V+F}),J[Y._id||0]={x:w,y:V,width:s,height:F}),Y.each(function(h){if($o(h)&&!C.isSelected(h)&&C.isVisible(h)&&C.isValidGuideLineSource(h)){var d=!1;if(C.sm().getSelection().each(function(Q){d||(h.isHostOn(Q)?d=!0:h.isDescendantOf(Q)&&(d=!0))}),!d){var v=h.getRect();w=v.x,V=v.y,s=v.width,F=v.height,n.push({node:h,type:0,p:w},{node:h,type:1,p:w+s/2},{node:h,type:2,p:w+s}),m.push({node:h,type:0,p:V},{node:h,type:1,p:V+F/2},{node:h,type:2,p:V+F}),J[h._id]=v}}}),n.sort(function(t,X){return t.p-X.p}),m.sort(function(c,I){return c.p-I.p}),d._grid=A,d._87I=J},Vo.prototype.gatherLines=function(e,Y,m){var T,l,i,$,k,O,x,Q,J,E,q,d,a=this,g=[a.findClosest({x:e.x,y:e.y},Y),a.findClosest({x:e.x+e.w/2,y:e.y+e.h/2},Y),a.findClosest({x:e.x+e.w,y:e.y+e.h},Y)],t={},M=a._87I;m=m||255;var R,L;for(a._guideLine=[],T=0;2>T;T++)for(t={},0===T?($="y",Q=e.x,J=Q+e.w):($="x",Q=e.y,J=Q+e.h),l=0;3>l;l++)k=g[l],k&&isFinite(k[$])&&(R=1<<3*T+l,m&R&&(O=k[$+"Line"],x=O.node,L=x._id||0,t[L]||(t[L]=!0,d=M[L],"y"===$?(E=d.x,q=d.x+d.width):(E=d.y,q=d.y+d.height),i=O.p,a._guideLine.push({type:$,a:Q,b:J,c:E,d:q,p:i,center:1===O.type}))))},Vo.prototype._binarySearchClosest=function(g,t){if(!t.length)return{dis:1/0};for(var S,s=0,T=t.length-1;T-s>1;)S=Math.floor((s+T)/2),t[S].p<g?s=S:T=S;var W=t[s].p-g,e=t[T].p-g;return Math.abs(W)<=Math.abs(e)?{line:t[s],dis:W}:{line:t[T],dis:e}},Vo.prototype.findClosest=function(n,E,D){var K=this,e=K._interactor,h=e.gv,B=K._grid;D&&(n=Mh.toWorldPosition(h,n));var F,O=K._binarySearchClosest(n.x,B.x),m=K._binarySearchClosest(n.y,B.y),p=O.dis,G=m.dis,$=h._zoom,i=e.getStyle("smartGuideSensitivity")/$,C={};return Math.abs(p)<i&&"y"!==E&&(C.x=D?p*$:p,C.xLine=O.line,F=!0),Math.abs(G)<i&&"x"!==E&&(C.y=D?G*$:G,C.yLine=m.line,F=!0),F?C:void 0},Vo.prototype._42=function(){var I=this,j=I._guideLine;if(j&&!u.Default.isCtrlDown()){var R,Y,A,s,D,M,K,v,C,Z,b,p,d,J,E,U,w,c=I._interactor,X=c.gv,g=c._context,S=X.tx(),x=X.ty(),o=X._zoom,Q=c.getStyle("guideLineTextSpacing");for(R=0,Y=j.length;Y>R;R++)A=j[R],v=A.type,C=A.p,Z=A.a,b=A.b,p=A.c,d=A.d,J=Math.min(Z,p),E=Math.max(b,d),"x"===v?(s=C*o+S,D=J*o+x,M=s,K=E*o+x):(s=J*o+S,D=C*o+x,M=E*o+S,K=D),Mh.Icons.DrawIcon(c,g,Mh.Icons.MoveLineGuide,{rect:[s,D,M,K],center:A.center}),d>=Z&&b>=p||(J=Z>d?d:b,E=Z>d?Z:p,w=E-J,"x"===v?(A.center2center||(s-=Q,M=s),D=J*o+x,K=E*o+x,U=Mh.Icons.MoveLineGuideDistanceV):"y"===v&&(A.center2center||(D-=Q,K=D),s=J*o+S,M=E*o+S,U=Mh.Icons.MoveLineGuideDistanceH),Mh.Icons.DrawIcon(c,g,U,{x0:s,y0:D,x1:M,y1:K,dis:w}))}},Vo.prototype.clear=function(){this._guideLine=null};var Ac=Mh.Guide.Hover=function(I){var U=this;U._interactor=I};Ac.prototype={},Ac.prototype.constructor=Ac,J.defineProperties(Ac.prototype,{}),Ac.prototype._42=function(){var p=this._interactor;if(p.getStyle("hoverGuideEnabled")&&!p.gvEditing){var K=p.hoverData,h=p.gv;if(!$o(K)||h.isSelected(K))return p.hoverData=null,void 0;var $=dm(h,K),b=Mh.toScreenPosition(h,{x:$.x,y:$.y}),x=Mh.toScreenPosition(h,{x:$.x+$.width,y:$.y+$.height});Mh.Icons.DrawIcon(p,p._context,Mh.Icons.HoverDataRect,{min:b,max:x,color:p.getStyle("hoverGuideColor")||p.getStyle("baseColor")})}},Mh.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyVisible:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,guideLineTextSpacing:0,hoverGuideEnabled:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var ip=Mh.Icons={},jh=1e4,$l=null,Zf=Mh.DefaultStyleMap.baseColor,vq="rgb(183,232,135)",pn="rgb(255,204,153)",zg=6;u.Default.setImage("Icons.RectPoint",{width:zg,height:zg,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Zf}},rect:[0,0,zg,zg]}]}),ip.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var p=ip.GroupSubEntityRect.data;if(!p)return[];var U=p.min,H=p.max;return[U.x,U.y,U.x,H.y,H.x,H.y,H.x,U.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return ip.GroupSubEntityRect.data.isKeyOb?Zf:Zf}}}]};var Ad=4;ip.HoverDataRect={comps:[{type:"shape",points:{func:function(){var M=ip.HoverDataRect.data;if(!M)return[];var A=M.min,H=M.max,B=Ad;return A.x-=B,A.y-=B,H.x+=B,H.y+=B,[A.x,A.y,A.x,H.y,H.x,H.y,H.x,A.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return ip.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},ip.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[ip.Line.data.P1.x,ip.Line.data.P1.y],zg,zg]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[ip.Line.data.P2.x,ip.Line.data.P2.y],zg,zg]}}}]},ip.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return ip.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},ip.Rect={comps:[{type:"shape",points:{func:function(){var e=ip.Rect.data;if(!e)return[];var C=e.LT,r=e.LB,i=e.RB,m=e.RT;return[C.x,C.y,r.x,r.y,i.x,i.y,m.x,m.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Zf}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ip.Rect.data.rotation}},rect:{func:function(){return[[ip.Rect.data.LT.x,ip.Rect.data.LT.y],zg,zg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ip.Rect.data.rotation}},rect:{func:function(){return[[ip.Rect.data.LB.x,ip.Rect.data.LB.y],zg,zg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ip.Rect.data.rotation}},rect:{func:function(){return[[ip.Rect.data.RB.x,ip.Rect.data.RB.y],zg,zg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ip.Rect.data.rotation}},rect:{func:function(){return[[ip.Rect.data.RT.x,ip.Rect.data.RT.y],zg,zg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ip.Rect.data.rotation}},visible:{func:function(){return ip.Rect.data.L?!0:!1}},rect:{func:function(){return[[ip.Rect.data.L.x,ip.Rect.data.L.y],zg,zg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ip.Rect.data.rotation}},visible:{func:function(){return ip.Rect.data.R?!0:!1}},rect:{func:function(){return[[ip.Rect.data.R.x,ip.Rect.data.R.y],zg,zg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ip.Rect.data.rotation}},visible:{func:function(){return ip.Rect.data.T?!0:!1}},rect:{func:function(){return[[ip.Rect.data.T.x,ip.Rect.data.T.y],zg,zg]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ip.Rect.data.rotation}},visible:{func:function(){return ip.Rect.data.B?!0:!1}},rect:{func:function(){return[[ip.Rect.data.B.x,ip.Rect.data.B.y],zg,zg]}}}]};var Qc=16;u.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Zf}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Zf}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),ip.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[ip.Anchor.data.POS.x,ip.Anchor.data.POS.y],Qc,Qc]}}}]},ip.TipShiftX=12,ip.TipShiftY=12;var mf=[8,28];ip.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[ip.TipHelper.data.helperPos.x,ip.TipHelper.data.helperPos.y,mf[0]*ip.TipHelper.data.size,mf[1]]}},background:{func:function(){return $l.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return ip.TipHelper.data.text}},rect:{func:function(){return[ip.TipHelper.data.helperPos.x,ip.TipHelper.data.helperPos.y,mf[0]*ip.TipHelper.data.size,mf[1]]}},color:{func:function(){return $l.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var qr=7;ip.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!ip.ShapePoint.data.dynamicVisible}},rect:{func:function(){var A=ip.ShapePoint.data.point,Y=ip.ShapePoint.data.size||qr;return[A,Y+10,Y+10]}},background:{func:function(){var B=Date.now(),H=ip.ShapePoint.data.dynamicPeriod||1500,U=Math.sin(B%H/H*Math.PI);return"rgba(27,124,22,"+.5*U+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var o=ip.ShapePoint.data.point,Z=ip.ShapePoint.data.size||qr;return[o,Z,Z]}},background:{func:function(){var y=ip.ShapePoint.data.isEnd;return y?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return ip.ShapePoint.data.color||Zf}}},{type:"rect",visible:{func:function(){return!!ip.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Zf}},rect:{func:function(){var Y=5;return[ip.ShapePoint.data.point,Y,Y]}}}]},ip.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!ip.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return ip.ShapeBgCurve.data.P}},segments:{func:function(){return ip.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var b=Date.now(),X=ip.ShapeBgCurve.data.dynamicPeriod||1500,m=Math.sin(b%X/X*Math.PI);return"rgba(27,124,22,"+.3*m+")"}}},{type:"shape",points:{func:function(){return ip.ShapeBgCurve.data.P}},segments:{func:function(){return ip.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return ip.ShapeBgCurve.data.color||Zf}}}]};var tc=8;ip.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var Q=ip.ShapeHighlighPoint.data;return[[Q.x,Q.y],tc,tc]}},background:{func:function(){return $l.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var nf=10;ip.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var l=ip.ShapeHighlighRealPoint.data;return[[l.x,l.y],nf,nf]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Zf}}}]};var Er=8;ip.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var _=ip.ShapeHighlighCtrlPoint.data,H=_.x,p=_.y,D=Er/2;return[H-D,p-D,H-D,p+D,H+D,p+D,H+D,p-D]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return $l.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return $l.getStyle("shapeCtrlPointBorderColor")||Zf}}}]};var Oq=3;
ip.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return ip.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Oq,borderColor:{func:function(){return $l.getStyle("curveHighlightColor")}}}]},ip.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return ip.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},ip.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return ip.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return ip.MoveLineGuide.data.center?vq:pn}}}]};var ri=5;ip.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var l=ip.MoveLineGuideDistanceH.data,E=l.x0,r=l.y0;return[E,r-ri,E,r+ri]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:pn},{type:"shape",points:{func:function(){var B=ip.MoveLineGuideDistanceH.data,q=B.x1,P=B.y1;return[q,P-ri,q,P+ri]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:pn},{type:"text",text:{func:function(){return Math.round(ip.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var i=ip.MoveLineGuideDistanceH.data;return[[(i.x0+i.x1)/2,i.y0-10],20,20]}},color:pn,font:"12px Arial",align:"center"}]},ip.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var R=ip.MoveLineGuideDistanceV.data,k=R.x0,B=R.y0;return[k-ri,B,k+ri,B]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:pn},{type:"shape",points:{func:function(){var j=ip.MoveLineGuideDistanceV.data,q=j.x1,D=j.y1;return[q-ri,D,q+ri,D]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:pn},{type:"text",text:{func:function(){return Math.round(ip.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var b=ip.MoveLineGuideDistanceV.data;return[[b.x0-10,(b.y0+b.y1)/2],20,20]}},color:pn,font:"12px Arial",align:"center"}]},u.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),ip.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var I=ip.EdgeElevationGuide.data,T=I.x,G=I.y,M=$l.getStyle("curveElevationIntersectSize"),A=$l.getStyle("curveElevationGuideShift");return T+=A[0],G+=A[1],[T-M,G-M,2*M,2*M]}}}]},u.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),u.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),ip.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return ip.ConnectGuide.data.rotation}},rect:{func:function(){var k=ip.ConnectGuide.data.connect;k.x,k.y;var M=$l.getStyle("connectGuideIntersectSize");return[[k.x,k.y],2*M,2*M]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var Y=ip.ConnectGuide.data.cursorPos||ip.ConnectGuide.data.connect,y=$l.getStyle("connectGuideIntersectSize");return[[Y.x,Y.y],2*y-2,2*y-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var c=ip.ConnectGuide.data.connect,z=ip.ConnectGuide.data.cursorPos||c;return[c.x,c.y,c.x+.5*(z.x-c.x),c.y,z.x+.5*(c.x-z.x),z.y,z.x,z.y]}}}]},u.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),u.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),ip.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var x=ip.ConnectGuideGarbage.data.hover;return x?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var p=ip.ConnectGuideGarbage.data,Q=$l.getStyle("connectGuideGarbageIntersectsize");return p.hover&&(Q+=5),[[p.x,p.y],2*Q,2*Q]}}}]};var is=6;ip.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return ip.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var e=ip.ShapeActivingCtrl.data;return[e.point.x,e.point.y,e.c1.x,e.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Zf}}},{type:"shape",visible:{func:function(){return ip.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var J=ip.ShapeActivingCtrl.data;return[J.point.x,J.point.y,J.c2.x,J.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Zf}}},{type:"shape",visible:{func:function(){return ip.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var f=ip.ShapeActivingCtrl.data.c1,j=f.x,q=f.y,z=is/2;return"c1"===ip.ShapeActivingCtrl.data.hl&&(z+=.5),[j-z,q-z,j-z,q+z,j+z,q+z,j+z,q-z]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return $l.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===ip.ShapeActivingCtrl.data.hl?$l.getStyle("shapeCtrlPointHighlightBorder")||Zf:$l.getStyle("shapeCtrlPointBorderColor")||Zf}}},{type:"shape",visible:{func:function(){return ip.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var T=ip.ShapeActivingCtrl.data.c2,x=T.x,Z=T.y,O=is/2;return"c2"===ip.ShapeActivingCtrl.data.hl&&(O+=.5),[x-O,Z-O,x-O,Z+O,x+O,Z+O,x+O,Z-O]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return $l.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===ip.ShapeActivingCtrl.data.hl?$l.getStyle("shapeCtrlPointHighlightBorder")||Zf:$l.getStyle("shapeCtrlPointBorderColor")||Zf}}}]},ip.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Zf}},rect:{func:function(){return[[ip.RoundPoint.data.x,ip.RoundPoint.data.y],zg,zg]}}}]},ip.AttachPoint={comps:[{type:"rect",background:{func:function(){return ip.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Zf}},rect:{func:function(){var S=ip.AttachPoint.data.isAttach?zg+4:zg;return[[ip.AttachPoint.data.x,ip.AttachPoint.data.y],S,S]}}}]},ip.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return ip.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return ip.SimpleRect.data.color||Zf}},rect:{func:function(){var o=ip.SimpleRect.data;return[o.x,o.y,o.width,o.height]}}}]},u.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),ip.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var b=ip.MoveDummy.data;return[[b.pos.x,b.pos.y],2*b.size,2*b.size]}}}]},Mh.Icons.DrawIcon=function(o,H,w,r){w.width=w.height=jh,w.data=r,$l=o,u.Default.drawImage(H,w,0,0,jh,jh)},Mh.Icons.MapPoints=function(V,b){for(var e=0,p=V.length;p>e;e++)V[e]/=b},Mh.roundTo=function(a,v,n){var L=Math.abs(a%v);return n>L||n>v-L?v*Math.round(a/v):a},Mh.toFixed=function(c){return Math.round(100*c)/100},Mh.getDataMatrix=function(k){if(k instanceof u.Shape){var X=new u.Math.Matrix2d,n=k.getPosition();return X.translate(-n.x,-n.y).scale(k.getScale().x,k.getScale().y).rotate(k.getRotation()).translate(n.x,n.y),X}return k.getMatrix?k.getMatrix():new u.Math.Matrix2d};var Xp=Mh.Math.Curve=function(){this._curves=[]};Xp.prototype={},Xp.prototype.constructor=Xp,Xp.prototype.createFromHtShape=function(e,P,K){P instanceof u.List&&(P=P.toArray());var i,X,w,n,s,C,Z,J=this,o=null,t=null,k=0,a=Mh.Math.Vector2,q=Mh.Math.CubicBezier,l=function(z){return new a(e[z],e[z+1],K?K[z/2]:I)};for(X=0,w=P.length;w>X;X++){switch(n=P[X],s=null,n){case 1:t=l(k),o=t,k+=2;break;case 2:i=l(k),k+=2,s=new q(t,t.clone(),i.clone(),i),t=i;break;case 3:C=l(k),i=l(k+2),k+=4,s=new q(t,C.clone().sub(t).multiplyScalar(2/3).add(t),C.clone().sub(i).multiplyScalar(2/3).add(i),i),t=i;break;case 4:C=l(k),Z=l(k+2),i=l(k+4),k+=6,s=new q(t,C,Z,i),t=i;break;case 5:if(!o)break;s=new q(t,t.clone(),o.clone(),o),t=null,o=null}s&&(s._index=J._curves.length,J._curves.push(s))}},Xp.prototype.checkPoint=function(H,y){var W,j,z,o,r,e=this,q=e._curves;for(W=0,j=q.length;j>W;W++)if(o=q[W],r=o.intersectRect(H,y,y),r.length)return z=0,r.forEach(function(N){z+=N.t}),z/=r.length,H=o.getPointAt(z),H.t=z,{bezier:o,intersection:H}},Xp.prototype.insertKnot=function(i,l){var z=i.insertKnot(l),Z=this,U=Z._curves;U.splice(i._index,1,z[0],z[1])},Xp.prototype._isCloseEnough=function(A,G){return Math.abs(A.x-G.x)<1e-6&&Math.abs(A.y-G.y)<1e-6},Xp.prototype._isSamePoint=function(u,z){return u===z},Xp.prototype.moveRealPoint=function(D,A){var $=this,F=$._curves,W=A.clone().sub(D);F.forEach(function(g){var o=g._p1;g._p2,g._p3;var l=g._p4;$._isSamePoint(o,D)&&(g._p2.add(W),g._p1=A),$._isSamePoint(l,D)&&(g._p3.add(W),g._p4=A)})},Xp.prototype.moveCtrlDueToRealPointMovement=function(F,i){var d=this,N=d._curves,j=function(Q){Q.add(i),Q.e&&i.e&&(Q.e+=i.e)};N.forEach(function(c){var S=c._p1;c._p2,c._p3;var $=c._p4;d._isSamePoint(S,F)&&j(c._p2),d._isSamePoint($,F)&&j(c._p3)})},Xp.prototype.moveCtrlPoint=function(W,X,j){var r=W[j];if(r){r.e!==I&&(X.e=r.e);var B=this,T=B._curves;X.clone().sub(r),T.forEach(function(i){var v;"c2"===j?v="_p2":"c1"===j&&(v="_p3"),B._isSamePoint(i[v],r)&&(i[v]=X)}),W[j]=X}},Xp.prototype.deleteRealPoint=function(u,$){var p,h,H,g,B,S,F,K=this,U=K._curves,f={},r=[],O=Mh.Math.CubicBezier;for(h=0,H=U.length;H>h;h++)p=U[h],g=p._p1,B=p._p2,S=p._p3,F=p._p4,(f[h]||!K._isSamePoint(g,u))&&(K._isSamePoint(F,u)?H>h+1&&K._isSamePoint(U[h+1]._p1,u)&&($||r.push(new O(g,B,U[h+1]._p3,U[h+1]._p4))):r.push(p));K._curves=r},Xp.prototype.findPairs=function(S,q){var h,H,$,n,f,v,X,G,u=this,B=u._curves,z={},w=[];for(H=0,$=B.length;$>H;H++)h=B[H],n=h._p1,f=h._p2,v=h._p3,X=h._p4,!z[H]&&u._isSamePoint(n,S)&&(q?w.push({point:n,r2:X}):w.push({point:n,c2:f})),u._isSamePoint(X,S)&&(G=q?{point:X,r1:n}:{point:X,c1:v},$>H+1&&u._isSamePoint(B[H+1]._p1,S)&&(q?G.r2=B[H+1]._p4:G.c2=B[H+1]._p2,z[H+1]=!0),w.push(G));return w},Xp.prototype.toHtShape=function(){var m=this,w=m._curves,C=[],l=[],E={x:1/0,y:1/0};return w.forEach(function(S){var t=S._p1,U=S._p2,o=S._p3,q=S._p4;return m._isCloseEnough(t,E)||(C.push(1),l.push(t.clone())),E=q,m._isCloseEnough(t,U)&&m._isCloseEnough(o,q)?(C.push(2),l.push(q.clone()),void 0):(C.push(4),l.push(U.clone(),o.clone(),q.clone()),void 0)}),{segments:C,points:l}};var Ok=Mh.Math.CubicBezier=function(I,L,T,O){var M=this;M._id=Mh.Math.CubicBezier._globalId++,M._p1=I,M._p2=L,M._p3=T,M._p4=O};Ok._globalId=1,Ok.prototype={},Ok.prototype.constructor=Ok,Ok.prototype.toString=function(){return this._id},Ok.prototype.intersectRect=function(d,h,M){var A=h/2,X=M/2,H=d.x,Z=d.y,v=Mh.Math.Vector2,R=new v(-A+H,-X+Z),E=new v(A+H,X+Z),e=new v(E.x,R.y),U=new v(R.x,E.y),P=this,$=P.intersectLine(R,e),Y=P.intersectLine(e,E),c=P.intersectLine(E,U),f=P.intersectLine(U,R),u=$.concat(Y).concat(c).concat(f);return u},Ok.prototype.intersectLine=function(T,I){var D,j,q,m,r,W,x,Z,b,L,N,O,K,i=this,h=T.clone().min(I),Y=T.clone().max(I);m=i._p1,r=i._p2,W=i._p3,x=i._p4,D=m.clone().multiplyScalar(-1),j=r.clone().multiplyScalar(3),q=W.clone().multiplyScalar(-3),N=D.add(j).add(q).add(x),D=m.clone().multiplyScalar(3),j=r.clone().multiplyScalar(-6),q=W.clone().multiplyScalar(3),L=D.add(j).add(q),D=m.clone().multiplyScalar(-3),j=r.clone().multiplyScalar(3),b=D.add(j),Z=m.clone(),K=new Mh.Math.Vector2(T.y-I.y,I.x-T.x),O=T.x*I.y-I.x*T.y;for(var P=i.getRoots(K.dot(N),K.dot(L),K.dot(b),K.dot(Z)+O),F=new Array,E=0,A=P.length;A>E;E++){var H=P[E];if(!(0>H||H>1)){var v=m.clone().lerp(r,H),p=r.clone().lerp(W,H),z=W.clone().lerp(x,H),B=v.lerp(p,H),R=p.lerp(z,H),c=B.lerp(R,H);c.t=H,T.x==I.x?h.y<=c.y&&c.y<=Y.y&&F.push(c):T.y==I.y?h.x<=c.x&&c.x<=Y.x&&F.push(c):c.x>=h.x&&c.y>=h.y&&c.x<=Y.x&&c.y<=Y.y&&F.push(c)}}return F},Ok.prototype.solveTForPoint=function(x){var M,j,r,P,R=this;M=R._p1.x-x.x,j=R._p2.x-x.x,r=R._p3.x-x.x,P=R._p4.x-x.x;for(var D=R.getRoots(P-3*r+3*j-M,3*r-6*j+3*M,3*j-3*M,M),t=I,c=1/0,O=0,U=D.length;U>O;O++){var g=D[O];if(!(0>g||g>1)){var p=R._p1.clone().lerp(R._p2,g),B=R._p2.clone().lerp(R._p3,g),y=R._p3.clone().lerp(R._p4,g),V=p.lerp(B,g),b=B.lerp(y,g),J=V.lerp(b,g);J.t=g;var X=Math.abs(J.y-x.y);c>X&&(c=X,t=J)}}return t},Ok.prototype.getPointAt=function(q){var B=this,_=B._p1,u=B._p2,V=B._p3,F=B._p4,G=_.clone().lerp(u,q),v=u.clone().lerp(V,q),d=V.clone().lerp(F,q),n=G.lerp(v,q),l=v.lerp(d,q);return n.lerp(l,q)},Ok.prototype.getRoots=function(X,w,G,E){var f,A,s,g,o,V=new Array;if(Math.abs(X)<1e-6){var f=w,A=G/f,s=E/f,g=A*A-4*s;if(g>0){var o=Math.sqrt(g);V.push(.5*(-A+o)),V.push(.5*(-A-o))}else 0==g&&V.push(.5*-A)}w/=X,G/=X,E/=X,f=(3*G-w*w)/3,A=(2*w*w*w-9*G*w+27*E)/27;var k=w/3,d=A*A/4+f*f*f/27,e=A/2;if(Math.abs(d)<=1e-6&&(d=0),d>0){var M,l,o=Math.sqrt(d);M=-e+o,l=M>=0?Math.pow(M,1/3):-Math.pow(-M,1/3),M=-e-o,M>=0?l+=Math.pow(M,1/3):l-=Math.pow(-M,1/3),V.push(l-k)}else if(0>d){var z=Math.sqrt(-f/3),F=Math.atan2(Math.sqrt(-d),-e)/3,J=Math.cos(F),N=Math.sin(F),K=Math.sqrt(3);V.push(2*z*J-k),V.push(-z*(J+K*N)-k),V.push(-z*(J-K*N)-k)}else{var M;M=e>=0?-Math.pow(e,1/3):Math.pow(-e,1/3),V.push(2*M-k),V.push(-M-k)}return V},Ok.prototype._70I=function(){var l=this;return l._p1.distanceToSquared(l._p2)<1e-10&&l._p3.distanceToSquared(l._p4)<1e-10},Ok.prototype.insertKnot=function(T){var B=this,W=B._p1,w=B._p2,b=B._p3,U=B._p4,y=W.clone().lerp(w,T),Y=w.clone().lerp(b,T),m=b.clone().lerp(U,T),k=y.clone().lerp(Y,T),H=Y.clone().lerp(m,T),R=k.clone().lerp(H,T);return B._70I()?(W.clone().lerp(U,T),[new Mh.Math.CubicBezier(W,W.clone(),R.clone(),R),new Mh.Math.CubicBezier(R,R.clone(),U.clone(),U)]):[new Mh.Math.CubicBezier(W,y,k,R),new Mh.Math.CubicBezier(R,H,m,U)]};var so=u.Default.getInternal().ui().EdgeUI,Gj={_47O:function(j){var u=this,I=Gj.getBackups()._47O;Mh.inEdit(u.gv)||I.call(u,j)}};Mh.Inject.registAsModule(Gj,so);var Kq=u.Default.getInternal().ui().NodeUI,xj={_47O:function(B){var e=this,R=xj.getBackups()._47O;Mh.inEdit(e.gv)||R.call(e,B)},getSelectWidth:function(){var E=this,c=E.gv,J=E._data;if(c.isEditable(J)&&Mh.inEdit(c))return 0;var g=xj.getBackup("getSelectWidth");return g.call(E)}};Mh.Inject.registAsModule(xj,Kq);var Mi=u.graph.GraphView,wg={_editPointSize:function(){var M=u.Default.isTouchable,B=Mh.getStyle("pointSize");return B[M?0:1]}(),isPointEditable:function(u){var y=this;if(Mh.inEdit(y))return y._pointEditableFunc?y._pointEditableFunc(u):!0;var M=wg.getBackup("isPointEditable");M.call(y,u)},isEditable:function(g){var w,v=this,e=wg.getBackup("isEditable");if(w=g instanceof Mh.Group?!0:e.call(v,g),!Mh.inEdit(v))return w;if(!(g instanceof u.Edge))return w;if(!g.s("2d.editable"))return!1;var Q=v.getEditableFunc();return Q?Q(g):!0},_42:function(I,L){var c=this,n=wg.getBackups()._42;if(n.call(c,I,L),Mh.inEdit(c)){var S=c.getEditInteractor();S.drawImpl()}}};Mh.Inject.registAsModule(wg,Mi);var Eg=u.Default.getInternal().ui().ShapeUI,og={_47O:function(K){var D=this,r=og.getBackups()._47O;Mh.inEdit(D.gv)||r.call(D,K)}};Mh.Inject.registAsModule(og,Eg);var We=u.graph.DefaultInteractor,Ko={handle_mousewheel:function(k){var v=this,B=Ko.getBackup("handle_mousewheel");Mh.inEdit(v.gv)||B.call(v,k)}};Mh.Inject.registAsModule(Ko,We);var Io=u.graph.MoveInteractor,Tp={_calcShift:function(U,M){var i=this,w=Tp.getBackup("_calcShift"),G=i.gv;if(!Mh.inEdit(G))return w.call(i,U,M);var q=G.getEditInteractor(),v=q.getSubModule("Move").calcShift(U,M,i);return v||w.call(i,U,M)},clear:function(Y){var w=this,q=Tp.getBackup("clear");q.call(w,Y);var c=w.gv;if(Mh.inEdit(c)){var E=c.getEditInteractor();E.getSubModule("Move").clear(Y)}}};Mh.Inject.registAsModule(Tp,Io);var Vo=Mh.Rect=function(R){this.catalog="Rect",this._interactor=R};Vo.prototype={},Vo.prototype.constructor=Vo,Vo.prototype.gatherInfo=function(t,M){var q=this;if(1===M.length){var y=M[0];return y instanceof u.Shape&&y._70I()?q.gatherLine(t,y):Tl(y,t)?!1:q.gatherSingleTarget(t,y)}return M.length>1?q.gatherMultiTargets(t,M):!1},Vo.prototype.gatherSingleTarget=function(W,k){if(k.getCorners){var h,u=this,B=u.info;u.target=k,h=u.screenInfo={};var g=k.getCorners();B.LT=new Mh.Math.Vector2(g[0]),B.LB=new Mh.Math.Vector2(g[1]),B.RB=new Mh.Math.Vector2(g[2]),B.RT=new Mh.Math.Vector2(g[3]),B.T=B.LT.clone().add(B.RT).divideScalar(2),B.B=B.LB.clone().add(B.RB).divideScalar(2),B.L=B.LT.clone().add(B.LB).divideScalar(2),B.R=B.RT.clone().add(B.RB).divideScalar(2);for(var d in B)h[d]=Mh.toScreenPosition(W,B[d]);var q=u._interactor,y=q.getStyle("checkSize"),f=function(L,c,X){var x=c.clone().sub(L).setLength(-y),f=X.clone().sub(L).setLength(-y),W=x.add(f).add(L);return W};return h.rotLT=f(h.LT,h.RT,h.LB),h.rotLB=f(h.LB,h.LT,h.RB),h.rotRB=f(h.RB,h.LB,h.RT),h.rotRT=f(h.RT,h.LT,h.RB),h.rotT=h.rotLT.clone().add(h.rotRT).divideScalar(2),h.rotB=h.rotLB.clone().add(h.rotRB).divideScalar(2),h.rotL=h.rotLT.clone().add(h.rotLB).divideScalar(2),h.rotR=h.rotRT.clone().add(h.rotRB).divideScalar(2),h.rotation=k.getRotation(),u.gatherConnectInfo(),!0}},Vo.prototype.gatherConnectInfo=function(){var v=this,C=v.target,s=v._interactor,q=v.screenInfo,Y=s.gv;if(Y.isConnectActionVisible(C)&&s.getStyle("connectGuideVisible")){var m;C.s&&(m=C.s("connectGuideShift")),m||(m=s.getStyle("connectGuideShift"));var I=C.getAnchor(),o=C.getSize(),x=C.toGlobal({x:o.width*(m[0]-I.x),y:o.height*(m[1]-I.y)});x=Mh.toScreenPosition(Y,x),q.P1?x.add(q.P2.clone().sub(q.P1).setLength(m[2])):(x.add(q.RT.clone().sub(q.LT).setLength(m[2])),x.add(q.LB.clone().sub(q.LT).setLength(m[3]))),q.connect=x}},Vo.prototype.gatherMultiTargets=function(z,O){var H=Mh.Group.findOrCreateGroup(O);if(!H)return!1;var t=this;return t.editing&&"rotate"!==t.editing.mode||H.calcInfo(),t.gatherSingleTarget(z,H)},Vo.prototype.gatherLine=function(a,T){this.target=T;var K=this.screenInfo={},v=T.getPoints(),M=Mh.getDataMatrix(T);return K.P1=Mh.toScreenPosition(a,M.apply(v.get(0))),K.P2=Mh.toScreenPosition(a,M.apply(v.get(1))),this.gatherConnectInfo(),!0},Vo.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Vo.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Vo.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Vo.prototype.check=function(E,$,M){if(u.Default.isLeftButton($)){var K=this;if(K.editing=null,K.tipInfo=null,K.screenInfo){var q=K.target,R=E.isEditable(q),Y=K.screenInfo;if(R&&Y.connect){var N=K._checkConnect(M);if(N)return N}if(Y.P1)return K._checkLine(M);var i,W,L,j=null,G=K._interactor,S=G.getStyle("checkSize");if(R&&E.isRectEditable(q))for(W=0;W<Mh.Rect.ResizeKeys.length;W++)if(L=Mh.Rect.ResizeKeys[W],Mh.checkHit(M,Y[L],S)){j=L,i="resize";break}if(!j&&R&&E.isRotationEditable(q)&&!G.getStyle("rotateAsClock")){var t=G.getStyle("rotateCheckSize");for(W=0;W<Mh.Rect.RotateKeys.length;W++)if(L=Mh.Rect.RotateKeys[W],Mh.checkHit(M,Y[L],t)){j=L,i="rotate";break}}if(!j)return G.setCursor("default"),void 0;if("rotate"===i){var T,D=E.lp($);if(q instanceof Mh.Group){var Q=G.getStyle("groupRotateModeKey");"string"==typeof Q&&(Q=[Q]);for(var s=!1,p=0,l=Q.length;l>p;p++)if($[Q[p]]){s=!0;break}var v=G.getStyle("groupRotateModeDefault");T=s?"batch"===v?"block":"batch":v}var A="batch"===T?q.getAnchor2():q.getPosition(),y=Math.atan2(D.y-A.y,D.x-A.x);G._setRotateCursor(y),K.editing={mode:i,key:j,pos:A,flipY:q.getScale().y<0,rotation:q.getRotation(),hitRot:y},T&&(K.editing.groupRotateMode=T)}else{var h=Mh.Rect.ResizeKeys.indexOf(j),O=Mh.Rect.ResizeDirection[h],U=Math.cos(q.getRotation()),g=Math.sin(q.getRotation()),I=O.x*Math.sign(q.getScale().x),o=O.y*Math.sign(q.getScale().y),n=Math.atan2(-g*I-U*o,U*I-g*o),J=(Math.round(n/(Math.PI/4))+8)%8,z=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][J];this._interactor.setCursor(z);var H=q.getWidth(),f=q.getHeight(),k=q.getAnchor();K.editing={mode:i,key:j,rect:{x:-H*k.x,y:-f*k.y,width:H,height:f},anchor:k,matrix:q.getMatrix()}}return j}}},Vo.prototype._checkLine=function(u){var j=this;j.screenInfo;var X,l=j._interactor.getStyle("checkSize");if(Mh.checkHit(u,j.screenInfo.P1,l))X="P1";else{if(!Mh.checkHit(u,j.screenInfo.P2,l))return this._interactor.setCursor("default"),void 0;X="P2"}return j.editing={mode:"line",key:X},X},Vo.prototype._checkConnect=function(l){var U=this,V=U.screenInfo,q=U._interactor,s=q.getStyle("connectGuideIntersectSize"),I=V.connect,v=l.x,M=I.x;if(M>v&&s>M-v&&Math.abs(I.y-l.y)<s||v>=M&&Mh.checkHit(l,I,s)){var j="connect",N=w.getConnectAction(q.gv);if(U.editing={mode:j},N&&N.delete)if(U.target instanceof Mh.Group){var e=!0;q.gv.sm().getSelection().each(function(b){N.delete.visible.call(null,q.gv,b)||(e=!1)}),U.editing.hasDeleteAction=e}else N.delete.visible.call(null,q.gv,U.target)&&(U.editing.hasDeleteAction=!0);return q.setCursor("default"),j}},Vo.prototype._fireEditEvent=function(t,T){var g=this._interactor,P=this.editing;if(P){var E=P.mode;E="rotate"===E?"Rotation":"connect"===E?"Connection":E[0].toUpperCase()+E.slice(1),g.fi({kind:t+"Edit"+E,event:T})}},Vo.prototype.startEdit=function(B,R){B.startDragging(R);var $=this;$._interactor.fi({kind:"prepareEdit",event:R});var L=$.editing,w=$.target;if(L){if($._fireEditEvent("begin",R),"rotate"===L.mode)return L.groupRotateMode&&w.beginRotate(L),void 0;if("connect"!==L.mode)("line"===L.mode||w&&0===w.getRotation())&&($._inSmartGuide=!0,$._interactor.rectGuide.gatherRects());else if(L.hasDeleteAction){var N=B.gv,p=$._interactor.getStyle("connectGuideGarbageShift");L.garbageInfo={x:N.getWidth()*p[0]+p[2],y:N.getHeight()*p[1]+p[3],size:$._interactor.getStyle("connectGuideGarbageIntersectsize")},B._42()}}},Vo.prototype._46O=function(J){var G,p,y=this,b=y.editing,g=y.target;if(b){if("connect"===b.mode&&!b.canceled&&!b.deleted)try{b.garbageInfo&&b.garbageInfo.hover?w.doDeleteConnectionAction(y._interactor.gv,g):w.doConnectAction(y._interactor.gv,g,b.target)}catch(c){console.error(c)}p=b.freezeFlag,G=y.editing.groupRotateMode,y._fireEditEvent("end",J),y.editing=null}y.tipInfo=null,y._inSmartGuide&&(y._interactor.rectGuide.clear(),y._inSmartGuide=!1),G&&g&&g.endRotate(),g instanceof u.Block&&(p===I?delete g._freezeSyncFromChildren:g._freezeSyncFromChildren=p,g.updateFromChildren())},Vo.prototype.handleNormalStateDelete=function(){var p=this,z=p.editing;if(z&&"connect"===z.mode&&!z.canceled&&!z.deleted){if(z.garbageInfo){try{w.doDeleteConnectionAction(p._interactor.gv,p.target)}catch(N){console.error(N)}z.garbageInfo=null}return z.cursorPos=null,z.targetCorners=null,z.deleted=!0,p._interactor._42(),!0}},Vo.prototype.handleNormalStateKeyDown=function(J){var U=this,a=U.editing;return!a||"connect"!==a.mode||a.canceled||a.deleted?void 0:u.Default.isEsc(J)?(a.cursorPos=null,a.targetCorners=null,a.canceled=!0,U._interactor._42(),!0):void 0},Vo.prototype.handleEdit=function(e,w){var v=this,x=v.editing;if(x){var R,E,y,P,c,f=v.target,a=x.key,Q=x.mode,b=e.lp(w),L=v._interactor;if("connect"===Q){if(x.canceled)return;if(x.deleted)return;x.cursorPos=L._getLogicalPoint(w);var C=x.garbageInfo;return C&&Mh.checkHit(x.cursorPos,C,C.size)?(C.hover=!0,x.target=null,x.targetCorners=null):(C&&(C.hover=!1),x.target=e.getDataAt(b,function(q){return e.isSelectable(q)?$o(q)?!0:!1:!1})||null,x.targetCorners=Mh.getTargetCornersOnScreen(e,x.target)),L._42(),void 0}if("rotate"===Q){var t,K,N=x.pos,O=Math.atan2(b.y-N.y,b.x-N.x);if(x.groupRotateMode?K=O-x.hitRot:(t=O-x.hitRot,K=x.rotation+t),K%=2*Math.PI,0>K&&(K+=2*Math.PI),!u.Default.isCtrlDown(w)){var z,h;us(w)?(z=L.getStyle("shiftRotateRound"),h=z/2):(z=L.getStyle("rotateRound"),h=L.getStyle("rotateSensitivity")),K=Mh.roundTo(K,z,h)}x.groupRotateMode?(t=K-(x.lastRotation||0),0!==t&&(f.addRotation(t,x.groupRotateMode),x.lastRotation=K)):f.setRotation(K),L._setRotateCursor(O),K>Math.PI&&(K-=2*Math.PI);var X=180*(K/Math.PI);X=X.toFixed(2),R=""+X+"°"}else if("resize"===Q){var T=x.rect;y=T.x,P=T.y;var U,k=T.width,$=T.height,s=x.anchor,I=x.matrix,M=f.s&&f.s("keepAspectRatio")||L.getStyle("keepAspectRatio");us(w)&&(M=!M);var o=v._unionPointMode1,D=v._unionPointMode2;if(v._inSmartGuide&&!u.Default.isCtrlDown(w)&&!M){var B;"L"===a||"R"===a?B="x":("T"===a||"B"===a)&&(B="y"),v._adsorbedToClosest(b,B),c=!0}U=I.tfi(b);var d;"LT"===a?(T=o(U,{x:y+k,y:P+$},k,$,M),d=9):"T"===a?(T=D({x:y,y:U.y},{x:y+k,y:P+$},k,$,M,"v"),d=1):"RT"===a?(T=o(U,{x:y,y:P+$},k,$,M),d=33):"L"===a?(T=D({x:U.x,y:P},{x:y+k,y:P+$},k,$,M,"h"),d=8):"R"===a?(T=D({x:y,y:P},{x:U.x,y:P+$},k,$,M,"h"),d=32):"LB"===a?(T=o(U,{x:y+k,y:P},k,$,M),d=12):"B"===a?(T=D({x:y,y:P},{x:y+k,y:U.y},k,$,M,"v"),d=4):"RB"===a&&(T=o(U,{x:y,y:P},k,$,M),d=36);var _=I.tf(T.x+T.width*s.x,T.y+T.height*s.y);f instanceof u.Block&&(x.hasOwnProperty("freezeFlag")||(x.freezeFlag=f._freezeSyncFromChildren,f._freezeSyncFromChildren=!0)),f.setPosition(_),f.setSize(T.width,T.height),c&&(E=f.getRect(),L.rectGuide.gatherLines({node:f,x:E.x,y:E.y,w:E.width,h:E.height},B,d)),R=""+Math.round(T.width)+" * "+Math.round(T.height)}else if("line"===Q){if(us(w)){var V=f.getPoints(),g="P1"===a?V.get(1):V.get(0),j={x:b.x-g.x,y:b.y-g.y},S=L.getStyle("shiftLineRotateRound"),m=v._shiftDirList;if(!m||v._shiftRotateRound!==S){v._shiftRotateRound=S,v._shiftDirList=m=[];for(var F=0;F<Math.PI;F+=S)m.push({x:q(F),y:n(F)})}for(var W,A=0,G=0,Z=m.length;Z>G;G++){var r=m[G],H=r.x*j.x+r.y*j.y;Math.abs(H)>Math.abs(A)&&(A=H,W=r)}b={x:g.x+W.x*A,y:g.y+W.y*A},L.rectGuide.clear()}else v._inSmartGuide&&!u.Default.isCtrlDown(w)&&(v._adsorbedToClosest(b),c=!0);var Y=Mh.getDataMatrix(f).applyInverse(b);f.setPoint("P1"===a?0:1,Y,!0);var l=f.getPoints(),p=l.get(0),i=l.get(1);y=p.x-i.x,P=p.y-i.y,R=" "+Math.round(Math.sqrt(y*y+P*P))+" ",c&&(E=f.getRect(),L.rectGuide.gatherLines({node:f,x:E.x,y:E.y,w:E.width,h:E.height}))}if(R){var J=u.Default.getLogicalPoint(w,L._canvas);J.x+=Mh.Icons.TipShiftX,J.y+=Mh.Icons.TipShiftY,v.tipInfo={helperPos:J,text:R,size:R.length}}v._fireEditEvent("between",w)}},Vo.prototype._unionPointMode1=function(v,c,K,t,Z){if(Z&&K&&t){var h=v.x-c.x,$=v.y-c.y;Math.abs(h*t)<Math.abs($*K)?($=Math.sign($)*Math.abs(h*t/K),v.y=c.y+$):(h=Math.sign(h)*Math.abs($*K/t),v.x=c.x+h)}return u.Default.unionPoint(v,c)},Vo.prototype._unionPointMode2=function(T,S,k,g,N,q){var m=u.Default.unionPoint(T,S);if(N&&k&&g){var L;"v"===q?(L=m.x+m.width/2,m.width=k*m.height/g,m.x=L-m.width/2):(L=m.y+m.height/2,m.height=g*m.width/k,m.y=L-m.height/2)}return m},Vo.prototype._adsorbedToClosest=function(J,p){var y=this,o=y._interactor,n=o.rectGuide.findClosest(J,p),h=o.gridGuide.findClosest(J,p),s=1/0,D=1/0;n&&(isFinite(n.x)&&(s=n.x),isFinite(n.y)&&(D=n.y)),h&&(isFinite(h.x)&&Math.abs(h.x)<Math.abs(s)&&(s=h.x),isFinite(h.y)&&Math.abs(h.y)<Math.abs(D)&&(D=h.y)),isFinite(s)&&(J.x+=s),isFinite(D)&&(J.y+=D)},Vo.prototype._42=function(h,T,j){var b=this;b.info={},b.screenInfo=null;var g=b._interactor;if(!g.editDetail&&b.gatherInfo(T,j)){var J=b.editing,m=J?J.groupRotateMode:null,N=b.screenInfo;if("block"!==m){if(N.P1?Mh.Icons.DrawIcon(g,h,Mh.Icons.Line,N):Mh.Icons.DrawIcon(g,h,Mh.Icons.Rect,N),N.connect&&(Mh.Icons.DrawIcon(g,h,Mh.Icons.ConnectGuide,{rotation:N.rotation,connect:N.connect,cursorPos:J?J.cursorPos:null}),J)){if(J.targetCorners){for(var Z={x:1/0,y:1/0},u={x:-1/0,y:-1/0},z=0,R=J.targetCorners.length;R>z;z+=2)Z.x=Math.min(Z.x,J.targetCorners[z]),u.x=Math.max(u.x,J.targetCorners[z]),Z.y=Math.min(Z.y,J.targetCorners[z+1]),u.y=Math.max(u.y,J.targetCorners[z+1]);
Mh.Icons.DrawIcon(g,h,Mh.Icons.HoverDataRect,{min:Z,max:u,color:g.getStyle("hoverGuideColor")||g.getStyle("baseColor")})}J.garbageInfo&&Mh.Icons.DrawIcon(g,h,Mh.Icons.ConnectGuideGarbage,J.garbageInfo)}b.tipInfo&&Mh.Icons.DrawIcon(g,h,Mh.Icons.TipHelper,b.tipInfo)}b.target instanceof Mh.Group&&b.target._42(g,h,T)}};var cl=Mh.Anchor=function(_){this.catalog="Anchor",this._interactor=_};cl.prototype={},cl.prototype.constructor=cl,cl.prototype.gatherInfo=function(M,d){var f=this;if(1===d.length){var $=d[0];if(!$.getAnchor)return;if($ instanceof u.Shape&&$._70I())return;if(Tl($,M))return;return f.gatherSingleTarget(M,d[0])}return d.length>1?f.gatherMultiTargets(M,d):!1},cl.prototype.gatherSingleTarget=function(B,V){var H=this;return H.info.POS=V.getPosition(),H.screenInfo.POS=Mh.toScreenPosition(B,H.info.POS),H.target=V,!0},cl.prototype.gatherMultiTargets=function(F,j){var S=this,h=Mh.Group.findOrCreateGroup(j);return h?(S.screenInfo.POS=Mh.toScreenPosition(F,h.getAnchor2()),S.target=h,!0):!1},cl.prototype.isVisible=function(){var p=this,h=p._interactor;if(h.getStyle("anchorVisible")===!1)return!1;var F=p.target;if(F){if(this.editing)return!0;var G=F.getAnchor(),H=h.getStyle("anchorOutsideVisibleThreshold");if(G.x<-H||G.x>1+H||G.y<-H||G.y>1+H)return!0;var N=F.getSize(),J=F.getScale(),S=Math.min(Math.abs(N.width*J.x),Math.abs(N.height*J.y));if(S*h.gv._zoom<h.getStyle("anchorHideThreshold"))return!1}return!0},cl.prototype.check=function(_,n,S){if(u.Default.isLeftButton(n)){var k=this,j=k._interactor;if(k.isVisible()&&j.getStyle("anchorMovable")!==!1){k.editing=null,k.tipInfo=null;var d=k.target;if(d&&_.isAnchorEditable(d)&&_.isEditable(d)){var V;if(k.screenInfo&&(V=k.screenInfo.POS)&&Mh.checkHit(S,new Mh.Math.Vector2(V),j.getStyle("checkSize"))){if(d instanceof Mh.Group)return k.editing={},!0;var O=d.getWidth(),M=d.getHeight(),Z=d.getAnchor();return k.editing={rect:{x:-O*Z.x,y:-M*Z.y,width:O,height:M},anchor:Z,matrix:d.getMatrix()},!0}}}}},cl.prototype.startEdit=function(F,H){F.startDragging(H),F.fi({kind:"beginEditAnchor",event:H})},cl.prototype._46O=function(G){var B=this;B.editing&&(B.editing=null,B._interactor.fi({kind:"endEditAnchor",event:G})),B.tipInfo=null},cl.prototype.handleEdit=function($,w){var P=this,a=P.target;if(a){var e=P.editing;if(e){var h=$.lp(w),A=P._interactor;if(a instanceof Mh.Group)return a.setAnchor2(h),A._42(),void 0;var I=e.matrix,b=I.tfi(h),k=e.rect,F=(b.x-k.x)/k.width,_=(b.y-k.y)/k.height;if(!u.Default.isCtrlDown(w)){var Y=A.getStyle("anchorRound"),Q=A.getStyle("anchorSensitivity");F=Mh.roundTo(F,Y,Q),_=Mh.roundTo(_,Y,Q)}a.setAnchor(F,_,!0);var X=u.Default.getLogicalPoint(w,A._canvas);X.x+=Mh.Icons.TipShiftX,X.y+=Mh.Icons.TipShiftY;var D=""+F.toFixed(2)+", "+_.toFixed(2);P.tipInfo={helperPos:X,text:D,size:D.length},A.fi({kind:"betweenEditAnchor",event:w})}}},cl.prototype._42=function(n,r,q){var X=this;X.info={},X.screenInfo={};var g=X._interactor;g.editDetail||X.gatherInfo(r,q)&&X.isVisible()&&(Mh.Icons.DrawIcon(g,n,Mh.Icons.Anchor,X.screenInfo),X.tipInfo&&Mh.Icons.DrawIcon(g,n,Mh.Icons.TipHelper,X.tipInfo))};var Ib=Mh.MoveDummy=function(x){this.catalog="MoveDummy",this._interactor=x};Ib.prototype={},Ib.prototype.constructor=Ib,Ib.prototype.gatherInfo=function(){var g=this,G=this._interactor.getSubModule("Rect");if(G){var B=G.screenInfo;if(B){var r=g._interactor,D=g.getMovableTarget(G.target);if(D){var J=r.getStyle("moveDummyVisible"),m=B.LT||B.P1,d=B.RT||B.P2,v=B.LB||m;if(m){var H=B.P1,M=Math.min(m.distanceTo(v),m.distanceTo(d));if(!(M>J)){var V=r.getStyle("moveDummyPosition"),o=d.clone().sub(m),s=v.clone().sub(m),w=V[2],b=V[3];if(H){var A=r.getStyle("moveDummyLineExtraShift");A&&(w+=A[0],b+=A[1])}var j=m.clone().add(o.clone().multiplyScalar(V[0])).add(o.setLength(w)).add(s.clone().multiplyScalar(V[1])).add(s.setLength(b));return g.screenInfo.pos=j,g.screenInfo.size=r.getStyle("moveDummySensitivity"),!0}}}}}},Ib.prototype.getMovableTarget=function(K){var w=this._interactor.gv;if($o(K)){if(w.isMovable(K))return K}else if(K instanceof Mh.Group)for(var S=K._entities,E=S.length-1;E>=0;E--){var y=S[E];if($o(y)&&w.isMovable(y))return y}return null},Ib.prototype.getMoveInteractor=function(){for(var $,h,b,V=this._interactor.gv,K=V.getInteractors(),$=0,h=K.length;h>$;$++)if(b=K.get($),b instanceof Io)return b},Ib.prototype.startEdit=function(L,F){L.startDragging(F);var P=this.getMoveInteractor();if(P){var j=this.selectedTarget,v=L.gv;v._moving=1,P._data=j,v.handleMouseDown&&v.handleMouseDown(F,j)}},Ib.prototype._46O=function(K){var u=this,q=u.getMoveInteractor();q&&(q.handleWindowMouseUp(K),u.selectedTarget=null)},Ib.prototype.handleEdit=function(C,N){var f=this.getMoveInteractor();f&&f.handleWindowMouseMove(N)},Ib.prototype.check=function(U,e,M){if(this.selectedTarget=null,u.Default.isLeftButton(e)&&!U._scrolling&&!Rg()){var m=this;if(m.screenInfo){var V=m.screenInfo.pos;if(V&&!(M.distanceTo(V)>m.screenInfo.size)){var t=m._interactor;return m.selectedTarget=m.getMovableTarget(t.getSubModule("Rect").target),t.setCursor("default"),!0}}}},Ib.prototype._42=function(p,D,q){var S=this;S.screenInfo={};var z=S._interactor;z.editDetail||S.gatherInfo(D,q)&&(!z.editing||S.selectedTarget)&&Mh.Icons.DrawIcon(z,p,Mh.Icons.MoveDummy,S.screenInfo)};var Ab=Mh.RotateX=function(O){this.catalog="RotateX",this._interactor=O};Ab.prototype={},Ab.prototype.constructor=Ab,Ab.prototype.gatherInfo=function(Y,H){var A=this;if(1===H.length){var E=H[0];return E instanceof u.Shape&&E._70I()||Tl(E,Y)?!1:A.gatherSingleTarget(Y,E)}return H.length>1?A.gatherMultiTargets(Y,H):!1},Ab.prototype.gatherSingleTarget=function(){var I=new u.Math.Vector2,x=new u.Math.Vector2,s=new u.Math.Vector2,t=new u.Math.Vector2,b=function(u,K){var j=u.x-K.x,q=u.y-K.y;return j*j+q*q};return function(w,u){if(u.getCorners){var R=this,T=u.getCorners(),P=15,v=u.getPosition();I.copy(T[0]),s.copy(T[1]),t.copy(T[3]),x.copy(I).add(t).divideScalar(2).add(I.sub(s).setLength(P/w.getZoom()));var m=Math.max(b(v,T[0]),b(v,T[1]),b(v,T[2]),b(v,T[3]));return R.info.POS=x.clone(),R.screenInfo.POS=Mh.toScreenPosition(w,R.info.POS),R.screenInfo.LEN=Math.sqrt(m)*w.getZoom()+P,R.screenInfo.CENTER=Mh.toScreenPosition(w,v),R.target=u,!0}}}(),Ab.prototype.gatherMultiTargets=function(I,Q){var g=this,x=Mh.Group.findOrCreateGroup(Q);if(!x)return!1;var g=this;return g.gatherSingleTarget(I,x)},Ab.prototype.isVisible=function(){var e=this._interactor;if(!e.getStyle("rotateAsClock"))return!1;var w=this.target;if(!w)return!0;var E=e.gv;return E.isEditable(w)&&E.isRotationEditable(w)?!0:!1},Ab.prototype.check=function(A,S,s){var m=this,i=m._checkImpl(A,S,s);return(i||m._clockPainted)&&m._interactor._42(),i},Ab.prototype._checkImpl=function(I,M,X){if(u.Default.isLeftButton(M)){var V=this;V.editing=null,V.tipInfo=null;var J;if(V.screenInfo&&(J=V.screenInfo.POS)&&V.isVisible()){var i=V._interactor;if(Mh.checkHit(X,J,i.getStyle("checkSize"))){var f=V.target,l=I.lp(M),r=f.getPosition(),A=Math.atan2(l.y-r.y,l.x-r.x);return i._setRotateCursor(A),V.editing={pos:r,rotation:f.getRotation(),hitRot:A,groupRotateMode:"block",screenInfo:{CENTER:V.screenInfo.CENTER,LEN:V.screenInfo.LEN}},!0}}}},Ab.prototype.startEdit=function(o,y){o.startDragging(y),o.fi({kind:"beginEditRotation",event:y}),this.target instanceof Mh.Group&&this.target.beginRotate(this.editing)},Ab.prototype._46O=function(c){var m=this;m.editing&&(m.editing=null,m._interactor.fi({kind:"endEditRotation",event:c})),m.target instanceof Mh.Group&&m.target.endRotate(),m.tipInfo=null},Ab.prototype.handleEdit=function(E,c){var y=this,M=y.editing;if(M){var H,L,R=y.target,i=E.lp(c),A=y._interactor,G=M.pos,I=Math.atan2(i.y-G.y,i.x-G.x),F=R instanceof Mh.Group;if(F?L=I-M.hitRot:(H=I-M.hitRot,L=M.rotation+H),L%=2*Math.PI,0>L&&(L+=2*Math.PI),!u.Default.isCtrlDown(c)){var N,z;us(c)?(N=A.getStyle("shiftRotateRound"),z=N/2):(N=A.getStyle("rotateRound"),z=A.getStyle("rotateSensitivity")),L=Mh.roundTo(L,N,z)}F?(H=L-(M.lastRotation||0),0!==H&&(R.addRotation(H,M.groupRotateMode),M.lastRotation=L)):R.setRotation(L),A._setRotateCursor(I),L>Math.PI&&(L-=2*Math.PI);var j=180*(L/Math.PI),Q=""+j.toFixed(2)+"°",O=u.Default.getLogicalPoint(c,A._canvas);O.x+=Mh.Icons.TipShiftX,O.y+=Mh.Icons.TipShiftY,y.tipInfo={helperPos:O,text:Q,size:Q.length},A.fi({kind:"betweenEditRotation",event:c})}},Ab.prototype._42=function(u,c,S){var k=this;k._clockPainted=!1,k.info={},k.screenInfo={};var p=k._interactor;p.editDetail||k.gatherInfo(c,S)&&k.isVisible()&&(Mh.Icons.DrawIcon(p,u,Mh.Icons.RoundPoint,k.screenInfo.POS),k.tipInfo&&Mh.Icons.DrawIcon(p,u,Mh.Icons.TipHelper,k.tipInfo),k.editing&&k.drawClock(u))},Ab.prototype.drawClock=function(r){r.save();var j=this;j._clockPainted=!0;var Q=j.editing||{},b=Q.screenInfo||j.screenInfo,J=b.LEN,W=J+8,v=J+18;r.save(),r.translate(b.CENTER.x,b.CENTER.y),r.beginPath(),r.strokeStyle="rgb(150, 150, 150)";for(var D,p,o,f,M,O=0;360>O;O++)D=O*Math.PI/180,0===O%5&&(p=n(D)*J,o=q(D)*J,f=n(D)*W,M=q(D)*W,r.moveTo(p,o),r.lineTo(f,M)),0===O%45&&(p=n(D)*J,o=q(D)*J,f=n(D)*v,M=q(D)*v,r.moveTo(p,o),r.lineTo(f,M));r.stroke(),r.rotate(-L);var h=Q.lastRotation||j.target.getRotation();r.beginPath(),r.fillStyle="rgba(255, 0, 0, 0.1)",r.strokeStyle="rgb(157, 157, 157)",r.moveTo(0,0),r.arc(0,0,v,0,h,!1),r.fill(),r.beginPath(),r.moveTo(0+v,0),r.arc(0,0,v,0,h,!1),r.stroke(),r.restore()};var Xp=Mh.Curve=function(v){this.catalog="Curve",this._interactor=v};Xp.prototype={},Xp.prototype.constructor=Xp,J.defineProperties(Xp.prototype,{activing:{get:function(){return this._activing},set:function(P){var j=this;if(P)j._activing=new Mh.CurveActiving(this,P);else{var W=j._activing;W&&W.dispose(),j._activing=null}}}}),Xp.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Xp.prototype.setUp=function(){var U=this,C=U._interactor;C&&C.gv.mp(U._onGraphviewPropertyChanged,U)},Xp.prototype._onGraphviewPropertyChanged=function(P){("zoom"===P.property||"translateX"===P.property||"translateY"===P.property)&&this._handleDataChanged()},Xp.prototype.tearDown=function(){var R=this,a=R._interactor;a&&a.gv.ump(R._onGraphviewPropertyChanged,R)},Xp.prototype.canEnterEditDetailMode=function(){var J=this,v=J._interactor,$=v._getValidSelection();if(1===$.length){var w=$[0],U=w instanceof u.Edge;if(w instanceof u.Shape||U){if(U){var s=w.s("edge.type");if(s&&"points"!==s)return}var F=v.gv;if(F.isPointEditable(w)&&F.isEditable(w))return J.target=w,!0}}},Xp.prototype.canQuitEditDetailMode=function(f){var t=this,T=t._interactor._getLogicalPoint(f);return t._checkEditRealPoint(T)?void 0:t._interactor.gv.getDataAt(f)!==t.target?!0:void 0},Xp.prototype.preHandleScroll=function(){var Q=this.editing;return Q&&Q.inEdit?!0:void 0},Xp.prototype.getCurrentSelectintStatus=function(){var e=this;if(e.activing&&!e.activing.selections){if(e.activing.status!=I)return e.activing.status;var c=function(_){var M=e.activing.status;e.activing.status=_,e._interactor.fp("shapePointStatus",M,_)},R=Mh.Curve.PointType,u=e.activing.point,V=e.activing.pairs;if(!V||1!==V.length)return c(R.Mirrored);var D=V[0],X=D.c1&&D.c1.isNearEnough(u),N=D.c2&&D.c2.isNearEnough(u);if(!D.c1||!D.c2)return X||N?c(R.Straight):c(R.Disconnected);if(X&&N)return c(R.Straight);if(X||N)return c(R.Asymmetric);var Z=D.c1.clone().sub(u),M=D.c2.clone().sub(u);return Math.abs(Z.x*M.y-Z.y*M.x)>1e-5||Z.x*M.x>0?c(R.Disconnected):Math.abs(Z.length()-M.length())>1e-5?c(R.Asymmetric):c(R.Mirrored)}},Xp.prototype.handle_keydown=function(W){var t=this;if(t._interactor.editDetail){var A=Mh.Curve.PointType;"1"===W.key?t._setCurrentSelectionStatus(A.Straight):"2"===W.key?t._setCurrentSelectionStatus(A.Mirrored):"3"===W.key?t._setCurrentSelectionStatus(A.Disconnected):"4"===W.key&&t._setCurrentSelectionStatus(A.Asymmetric)}},Xp.prototype.setCurrentSelectionStatus=function(Q){var D=this,n=D._interactor;if(n){var t=n.gv;t.dm().beginTransaction(),this._setCurrentSelectionStatus(Q),t.dm().endTransaction()}},Xp.prototype._setCurrentSelectionStatus=function(V){var p=this,R=p.activing;if(R){var m=p.getCurrentSelectintStatus();if(null!==m&&m!==V){R.status=V;var n=p.activing.point,F=p.activing.pairs;if(F&&1===F.length){var S=F[0],f=p.screenInfo.curve,X=Mh.Curve.PointType,J=function(){p._writeToHt(),p._interactor.fp("shapePointStatus",m,V)};if(V===X.Straight)return f.moveCtrlPoint(S,n,"c1"),f.moveCtrlPoint(S,n,"c2"),J(),void 0;if(m===X.Straight){var e=f.findPairs(n,!0),z=e[0],O=z.r1||n,q=z.r2||n,v=q.clone().sub(O).multiplyScalar(.25);return f.moveCtrlPoint(S,n.clone().sub(v),"c1"),f.moveCtrlPoint(S,n.clone().add(v),"c2"),J(),void 0}var i=S.c1,A=S.c2;if(i&&A){if(V===X.Mirrored)return f.moveCtrlPoint(S,n.clone().multiplyScalar(2).sub(A),"c1"),J(),void 0;if(V===X.Asymmetric&&m===X.Disconnected){var H=i.clone().sub(n).length(),v=n.clone().sub(A).setLength(H).add(n);return f.moveCtrlPoint(S,v,"c1"),J(),void 0}}R._firePointChange(),p._interactor.fp("shapePointStatus",m,V)}}}},Xp.prototype._handleDataChanged=function(){var P="points,segments,shape,position,rotation,scale".split(",");return function(S){var x=this;if(x.screenInfo&&x.target){if(S&&P.indexOf(S.property)<0)return;var e=x._interactor;x.gatherSingleTarget(e.gv,x.target,!0),x.check(e.gv,null,new Mh.Math.Vector2(e._lastClientPoint)),e._42()}}}(),Xp.prototype.gatherSingleTarget=function(k,q,Y){var y,c,w=this;w.screenInfo&&w.screenInfo.curve&&(c=w.screenInfo.curve._curves);var m=w.editing;y=m?w.screenInfo:w.screenInfo={};var _,s,n=q instanceof u.Edge;n?(_=q.s("edge.segments"),s=q.s("edge.points")||new u.List):(_=q._58O,s=q._59O),y.S=_;var Z,V=y.P=[],j=Mh.getDataMatrix(q);if(q instanceof u.Polyline&&(Z=q.getElevation()||0,y.E=[]),s.each(function(l){y.E&&y.E.push(l.e||Z),l=j.apply(l);var z=Mh.toScreenPosition(k,l);V.push(z.x,z.y)}),n){var N=Mh.toScreenPosition(k,q._lastSourcePoint),h=Mh.toScreenPosition(k,q._lastTargetPoint);V.splice(0,0,N.x,N.y),V.push(h.x,h.y)}if(!y.S||!y.S.size()){y.S=new u.List,y.S.add(1);for(var U=0;U<V.length/2-1;U++)y.S.add(2)}if((!m||Y)&&w.convertToCubicBezier(c),w.activing&&(Y||!w.editing||"realPoint"===w.editing.type)){var v=y.curve.findPairs(w.activing.point);w.activing.pairs=v}n&&"points"!==q.s("edge.type")&&w._writeToHt()},Xp.prototype._convertToNewPoint=function(F,h,e,Q){var X,R,m;for(X=0,R=h.length;R>X;X++){if(m=h[X],m._p1.isNearEnough(F)&&(!Q||Q.indexOf(m._p1)<0))return m._p1;if(m._p4.isNearEnough(F)&&(!Q||Q.indexOf(m._p4)<0))return m._p4}if(e)for(X=0,R=Math.min(e.length,R);R>X;X++){if(m=e[X],m._p1===F&&(!Q||Q.indexOf(h[X]._p1)<0))return h[X]._p1;if(m._p4===F&&(!Q||Q.indexOf(h[X]._p4)<0))return h[X]._p4}},Xp.prototype.convertToCubicBezier=function(L){var Q,j,H=this,e=new Mh.Math.Curve,f=H.screenInfo;if(e.createFromHtShape(f.P,f.S,f.E),f.curve=e,H.activing){var O=e._curves;Q=H.activing.point,j=H._convertToNewPoint(Q,O,L);var N=[];if(j&&(H.activing.point=j,N.push(j)),H.activing.selections){var $=-1,z=H.activing.selections;z.forEach(function(Y){$++,j=H._convertToNewPoint(Y,O,L,N),j&&(z[$]=j,N.push(j))})}}},Xp.prototype.check=function(u,O,w){if(!O||yi(O)||kf(O)){var i=this;if(i._interactor.setCursor("default"),i.editing=null,i.highlight=null,i.tipInfo=null,i.edgeEditResult=null,i.screenInfo){if(Rg()||kf(O))return i._interactor._42(),!0;if(i._checkEditCtrlPoint(w))return i._interactor._42(),!0;if(i._checkEditRealPoint(w))return i._interactor._42(),!0;if(i._checkEditElevation(w))return i._interactor._42(),!0;var M=i.screenInfo.curve,P=M.checkPoint(w,i._interactor.getStyle("curveIntersectSize"));if(P){var E=i.highlight={};E.type="insertKnot",E.bezier=P.bezier,E.point=P.intersection}return i._interactor._42(),!0}}},Xp.prototype._checkEditRealPoint=function(Y){var d,g,b,I,h,k,o=this,D=o.screenInfo.curve._curves,l=o._interactor.getStyle("curvePointIntersectSize"),T=1/0;for(l*=l,b=0,I=D.length;I>b;b++)d=D[b],h=d._p1,k=Y.distanceToSquared(h),T>k&&(T=k,g=h),h=d._p4,k=Y.distanceToSquared(h),T>k&&(T=k,g=h);if(T>l)return!1;var B=o.highlight={};return B.type="changeRealPoint",B.point=g,o.editing={type:"realPoint",point:g,shiftGuide:{point:g.clone(),dir:"x",limit:0}},o._interactor.setCursor("crosshair"),!0},Xp.prototype._checkEditElevation=function(M){var z=this;if(!z._interactor.getStyle("curveElevationVisible"))return!1;var l=z.activing;if(!l)return!1;var s=l.getCurrentEditingPoint();if(!s)return!1;var t=z._interactor,X=t.getStyle("curveElevationGuideShift"),A=t.getStyle("curveElevationIntersectSize"),o=M.distanceToSquared({x:s.x+X[0],y:s.y+X[1]});if(!(o>A*A)){var p=z.highlight={};p.type="elevation";var G=new Mh.Math.Vector2(M.x,M.y,s.e);return z.editing={type:"elevation",startPoint:G},z._interactor.setCursor("crosshair"),!0}},Xp.prototype._checkEditCtrlPoint=function(y){var e=this;if(e.activing&&!e.activing.selections){var c=e.getCurrentSelectintStatus();if(c!==Mh.Curve.PointType.Straight){var k=e.activing.pairs;if(k){var Y=e._interactor.getStyle("curvePointIntersectSize");Y*=Y;var w,P,V,h,L,Q,n,D,g,Z=1/0;for(n=0,g=k.length;g>n;n++)for(h=k[n],D=0;2>D;D++)L=0===D?"c1":"c2",h[L]&&(Q=y.distanceToSquared(h[L]),Z>Q&&(Z=Q,w=h,P=n,V=L));if(Z>Y)return!1;e.activing.hlpair=w,e.activing.hltype=V;var J=e.highlight={};return J.type="changeCtrlPoint",J.point=w[V],e.editing={type:"ctrlPoint",pair:w,pairId:P,ctrlType:V,direction:w[V].clone().sub(e.activing.point).normalize()},e._interactor.setCursor("crosshair"),!0}}}},Xp.prototype.startEdit=function(O,v){O.startDragging(v);var D=this;D.highlight&&"insertKnot"===D.highlight.type&&(D.insertKnot(),D.gatherSingleTarget(D._interactor.gv,D.target),D.activing=null,D._checkEditRealPoint(D._interactor._getLogicalPoint(v)));var w=D._activing;if(w){var Z=D.editing?D.editing.type:null;"ctrlPoint"===Z?w.editingCtrl={pairId:D.editing.pairId,type:w.hltype}:"realPoint"===Z&&(w.editingCtrl=!1)}var s=D.highlight,c=u.Default.isCtrlDown(v);if(!s||Rg()||kf(v)){var g=D._interactor.gv;if(!g.setFocus(v)||g._scrolling)return;return c?D._multiSelect={startPoint:g.lp(v)}:g.isPannable()&&(yi(v)||kf(v))&&(D._pan={tx:g.tx(),ty:g.ty()},O.fi({kind:"beginPan",event:v})),void 0}if("changeRealPoint"===s.type){var T,E=D.activing?D.activing.point:null,x=D.activing?D.activing.selections:null;if(c&&D.activing)E===s.point?(x?(D.activing={point:x[0]},x.length>1&&(x.splice(0,1),D.activing.selections=x)):D.activing=null,D.editing=null):x&&(T=x.indexOf(s.point))>=0?(x.length>1?x.splice(T,1):delete D.activing.selections,D.editing=null):x?(x.push(E),D.activing={point:s.point,selections:x}):D.activing={point:s.point,selections:[E]};else if(x)E===s.point||((T=x.indexOf(s.point))>=0?(x.splice(T,1,E),D.activing={point:s.point,selections:x}):D.activing={point:s.point});else{var Y;E===s.point&&(Y=D.activing.status),D.activing={point:s.point},Y&&(D.activing.status=Y)}O.fi({kind:"beginEditPoint",event:v})}},Xp.prototype.insertKnot=function(){var q=this,B=q.highlight,k=q.screenInfo.curve;k.insertKnot(B.bezier,B.point.t),q._writeToHt()},Xp.prototype._writeToHt=function(){var h,r,g,y,X=this,Q=X.screenInfo.curve,o=Q.toHtShape(),R=o.points,_=[],Y=o.segments,H=X._interactor.gv,J=X.target,W=J instanceof u.Edge,q=Mh.getDataMatrix(J).invert();y=J instanceof u.Polyline,y&&(g=J.getElevation());for(var j=0,f=R.length;f>j;j++)h=R[j],r=Mh.toWorldPosition(H,h),r=q.apply(r),h.e!=I&&h.e!==g&&(r.e=h.e),_.push(r);if(J._writing=!0,W){J.s("edge.type","points"),J.setStyle("edge.segments",Y),J.setStyle("edge.points",_.slice(1,_.length-1)),J.setStyle("edge.source.offset.x",0),J.setStyle("edge.source.offset.y",0),J.setStyle("edge.target.offset.x",0),J.setStyle("edge.target.offset.y",0);var i=X._nextChangeEdgeHost;delete X._nextChangeEdgeHost,i&&("source"===i.type?J.setSource(i.host):J.setTarget(i.host)),X._writeEdgeHostAnchor("source",_[0]),X._writeEdgeHostAnchor("target",_[_.length-1])}else _.length?(J.setSegments(Y),J.setPoints(_,!0)):J.removeFromDataModel();delete J._writing},Xp.prototype._writeEdgeHostAnchor=function(K,m){var D=this,s=D.target,B=D._calcHostAnchor(s,K,m);B.index!==I?(s.setStyle("edge."+K+".index",B.index),s.setStyle("edge."+K+".percent",I),s.setStyle("edge."+K+".anchor.x",I),s.setStyle("edge."+K+".anchor.y",I)):B.percent!==I?(s.setStyle("edge."+K+".percent",B.percent),s.setStyle("edge."+K+".index",I),s.setStyle("edge."+K+".anchor.x",I),s.setStyle("edge."+K+".anchor.y",I)):(s.s("edge."+K+".anchor.x",B.x),s.s("edge."+K+".anchor.y",B.y),B.offsetX||B.offsetY?(s.s("edge."+K+".offset.x",B.offsetX),s.s("edge."+K+".offset.y",B.offsetY)):(s.s("edge."+K+".offset.x",0),s.s("edge."+K+".offset.y",0)))},Xp.prototype._calcHostAnchor=function(S,O,w,r){r||(r="source"===O?S.getSource():S.getTarget());var D=this._interactor.gv,W=D.calculateAttachPoint(r,w);if(W)return W.info;if(cr(r)){var Q=D.calculateEdgePosition(r,w);return Q}var g=r.getRotation(),o=r.getAnchor();if(Tl(r,D)&&(g=0),g){var A=r.getMatrix(),_=A.tfi(w),J=r.getSize();return{x:_.x/J.width+o.x,y:_.y/J.height+o.y}}var E=dm(D,r),H={x:(w.x-E.x)/E.width,y:(w.y-E.y)/E.height};return H},Xp.prototype._handlePanning=function(H){var B=this,E=B._pan;if(E){E.started=!0;var K=B._interactor,f=K.gv,k=K._lastClientPoint,y=pr(H),W=Kh(f,y,k);f.setTranslate(E.tx+W.x,E.ty+W.y),B.gatherSingleTarget(K.gv,B.target),K._42(),K.fi({kind:"betweenPan",event:H})}},Xp.prototype.handleEdit=function(s,F){var X=this,R=X.editing;if(X._pan)return X._handlePanning(F),void 0;if(X._multiSelect)return X._multiSelect.endPoint=s.lp(F),X._interactor.redraw(),void 0;if(R){R.inEdit=!0;var v,E,d,U=X._interactor._getLogicalPoint(F),S=u.Default.isCtrlDown(F),n=u.Default.isShiftDown(F),C=R.type,D=X.activing;if(X._guideInfo=null,"ctrlPoint"===C&&n){var N=X.editing.direction.clone();v=D.point;var w=N.dot(U.clone().sub(v));U=N.setLength(w).add(v)}else if("ctrlPoint"===C||"realPoint"===C){var N;if("realPoint"===C&&n){var P=X.editing.shiftGuide;E=P.point;var i=Math.abs(U.x-E.x),V=Math.abs(U.y-E.y);i>V&&i>P.limit&&"y"===P.dir&&(P.dir="x"),V>i&&V>P.limit&&"x"===P.dir&&(P.dir="y"),N=P.dir,"x"===N?(U.y=E.y,P.limit=Math.max(P.limit,i)):"y"===N&&(U.x=E.x,P.limit=Math.max(P.limit,V))}var p=X._isEditEdgeSourceTarget();if(p){var e=X._editEdgeSourceTarget(p,U,S);e&&(X.edgeEditResult=e,d=e.tipText)}else if(!S){var A=X._guidingToEdit(U,N),l="realPoint"===C?X._interactor.gridGuide.findClosest(U,N,!0):null,f=1/0,Y=1/0;l&&(l.x&&(f=l.x),l.y&&(Y=l.y));var g=!1;A&&(A.xList&&(Math.abs(A.x)<=Math.abs(f)?(g=!0,f=A.x):delete A.xList),A.yList&&(Math.abs(A.y)<=Math.abs(Y)?(g=!0,Y=A.y):delete A.yList),g&&(X._guideInfo=A)),isFinite(f)&&(U.x+=f),isFinite(Y)&&(U.y+=Y),g&&(A.v=U)}}var t=X.screenInfo.curve;if("realPoint"===R.type){v=R.point,v.e!==I&&(U.e=v.e),t.moveRealPoint(v,U),R.point=U,X.highlight.point=U;var T=D.status,L=D.selections;if(X.activing={point:U,status:T},L){var $=U.clone().sub(v),r=0;L.forEach(function(I){var Y=I.clone().add($);t.moveRealPoint(I,Y),L[r++]=Y}),X.activing.selections=L}}else if("ctrlPoint"===R.type){var k=D.pairs,j=k[R.pairId];t.moveCtrlPoint(j,U,R.ctrlType);var o=D.status,z=Mh.Curve.PointType;if((o===z.Mirrored||o===z.Asymmetric)&&j.c1&&j.c2){var v=new Mh.Math.Vector2(D.point),h="c1"===R.ctrlType?"c2":"c1";if(o===Mh.Curve.PointType.Mirrored)t.moveCtrlPoint(j,v.clone().multiplyScalar(2).sub(U),h);else if(o===z.Asymmetric){var w=j[h].clone().sub(v).length(),K=v.clone().sub(j[R.ctrlType]).setLength(w).add(v);isNaN(K.x)||t.moveCtrlPoint(j,K,h)}}D._firePointChange()}else if("elevation"===R.type){E=R.startPoint;var O=E.e+(E.y-U.y)/s._zoom;X._setCurrentPointImpl("e",O),D._firePointChange(),d="E: "+Mh.toFixed(O)}var m=u.Default.getLogicalPoint(F,X._interactor._canvas);if(m.x+=Mh.Icons.TipShiftX,m.y+=Mh.Icons.TipShiftY,!d){var y=Mh.toWorldPosition(s,U);d=""+Mh.toFixed(y.x)+", "+Mh.toFixed(y.y)}X.tipInfo={helperPos:m,text:d,size:d.length},X._writeToHt(),X._interactor.fi({kind:"betweenEditPoint",event:F})}},Xp.prototype._setCurrentPointImpl=function(o,O){var d=this,s=d._activing;if(!s)return!1;var M=d.target;if(!M)return!1;var B=s.getCurrentEditingPoint();if(!B)return!1;var Y=s.editingCtrl;if(!Y)var c=B.clone();if("e"===o)B.e=O;else{var A;if("x"===o||"y"===o){var S=s._lastFirePoint;A="x"===o?{x:O,y:S?S.y:0}:{x:S?S.x:0,y:O}}else"object"==typeof o?(A=o,o.e!==I&&(B.e=o.e)):(A={x:arguments[0],y:arguments[1]},arguments[2]!==I&&(B.e=arguments[2]));var n=Mh.getDataMatrix(M);A=Mh.toScreenPosition(d._interactor.gv,n.apply(A)),B.x=A.x,B.y=A.y}if(!Y){var J=c.multiplyScalar(-1).add(B);B.e&&c.e&&(J.e=B.e-c.e),d.screenInfo.curve.moveCtrlDueToRealPointMovement(B,J)}return!0},Xp.prototype.setCurrentPoint=function(v,C){return this._setCurrentPointImpl(v,C)?(this._writeToHt(),!0):!1},Xp.prototype._isEditEdgeSourceTarget=function(){var X=this,Z=X.target;if(!(Z instanceof u.Edge))return!1;var I=X.editing.point,p=X.screenInfo.curve._curves;return I===p[0]._p1?"source":I===p[p.length-1]._p4?"target":!1},Xp.prototype._editEdgeSourceTarget=function(y,w,W){var R,r=this,b=r.target;if(R="source"===y?b.getSource():b.getTarget()){var u,M=r._interactor.gv,k=Mh.toWorldPosition(M,w),P=r._calcHostAnchor(b,y,k,R);if(u=P.index!==I||P.percent!==I?P.distance*M.getZoom()>r._interactor.getStyle("edgeHostEdgeMaxDistance"):r._interactor.getStyle("edgeHostDetectPerFrame")?!0:P.x<0||P.x>1||P.y<0||P.y>1?!0:!1){var O=M.getDataAt(k,function(C){return M.isSelectable(C)?C===R?!1:b.canSetSourceTarget(C,y)?!0:!1:!1});if(O){var Q=r._calcHostAnchor(b,y,k,O);R=O,r._nextChangeEdgeHost={type:y,host:O},P=Q}}var V,p,v;if(W||P.x===I)(P.percent!==I||P.index!==I)&&(p=P.point);else{var J=r._interactor.getStyle("anchorRound"),j=r._interactor.getStyle("anchorSensitivity");V=M.calculateAttachPoint(R,k),V?P=V.info:(P.x=Mh.roundTo(P.x,J,j),P.y=Mh.roundTo(P.y,J,j)),p=R.getAttachPosition(P.x,P.y,P.offsetX,P.offsetY)}p&&(v=Mh.toScreenPosition(M,p),w.x=v.x,w.y=v.y),r._edgeHostGuideInfo={corners:Mh.getTargetCornersOnScreen(M,R),attach:V?V.index:-1,host:R};var c;return P.percent!==I?c="percent: "+P.percent.toFixed(2):P.index!==I?c="index: "+P.index:(c=""+P.x.toFixed(2)+", "+P.y.toFixed(2),(P.offsetX||P.offsetY)&&(c+=" offset: "+P.offsetX.toFixed(2)+", "+P.offsetY.toFixed(2))),{host:R,anchor:P,tipText:c}}},Xp.prototype._guidingToEdit=function(X,r){var u,I,w=this;if(u=w.screenInfo.curve){I=u._curves;var S,Z,R,Q,l,z,i,n,y=1/0,b=1/0,E=[];for(w.editing&&"realPoint"===w.editing.type&&(n=w.editing.point),l=0,z=2*I.length;z>l;l++)i=I[Math.floor(l/2)][l%2?"_p4":"_p1"],E.indexOf(i)>=0||(E.push(i),n&&n===i||(R=i.x-X.x,Q=i.y-X.y,Math.abs(R)<Math.abs(y)?(y=R,S=[i]):R===y&&S.push(i),Math.abs(Q)<Math.abs(b)?(b=Q,Z=[i]):Q===b&&Z.push(i)));var N=w._interactor.getStyle("smartGuideSensitivity");if((Math.abs(y)>N||"y"===r)&&(S=null),(Math.abs(b)>N||"x"===r)&&(Z=null),S||Z){var J=!1,W={};if(S&&(J=!0,W.xList=S,W.x=y),Z&&(J=!0,W.yList=Z,W.y=b),J)return W}}},Xp.prototype._46O=function(X){var L=this;L.editing&&(L.editing=null,L._interactor.fi({kind:"endEditPoint",event:X})),L._guideInfo=null,L._edgeHostGuideInfo=null,L._pan&&(L._pan=null,L._interactor.fi({kind:"endPan",event:X})),L._multiSelect&&(L._handleMultiSelect(L._multiSelect),L._multiSelect=null),L.tipInfo=null,L.edgeEditResult=null},Xp.prototype._handleMultiSelect=function(X){if(X.startPoint&&X.endPoint){var i,r,W,J,U,R=this,n=R._interactor,b=n.gv,V=Mh.toScreenPosition(b,X.startPoint),B=Mh.toScreenPosition(b,X.endPoint),T=u.Default.unionPoint(V,B),c=R.screenInfo.curve._curves,x=[],$=function(J){J.x>=T.x&&J.y>=T.y&&J.x<=T.x+T.width&&J.y<=T.y+T.height&&x.indexOf(J)<0&&x.push(J)};for(i=0,r=c.length;r>i;i++)U=c[i],$(U._p1),$(U._p4);if(x.length){var S=R.activing||{},g=S.selections||[];for(S.point&&g.push(S.point),i=0,r=g.length;r>i;i++)W=g[i],J=x.indexOf(W),J>=0?x[J]=I:x.push(W);var K=x;for(x=[],i=0,r=K.length;r>i;i++)K[i]&&x.push(K[i]);r=x.length,0===r?R.activing=null:1===r?R.activing={point:x[0]}:(W=x[r-1],R.activing={point:W,selections:x.splice(0,r-1)}),n.redraw()}}},Xp.prototype._canDeletePoint=function(Q,R){var B=this.target;if(!(B instanceof u.Edge))return!0;var b=Q._curves[0],T=Q._curves[Q._curves.length-1];return b._p1===R||T._p4===R?!1:!0},Xp.prototype.handleDelete=function(){var x=this;if(x.activing&&x.screenInfo){var g=u.Default.isShiftDown(),O=x.screenInfo.curve;x._canDeletePoint(O,x.activing.point)&&O.deleteRealPoint(x.activing.point,g),x.activing.selections&&x.activing.selections.forEach(function(b){x._canDeletePoint(O,b)&&O.deleteRealPoint(b,g)}),x.activing=null,delete x.editing,delete x.tipInfo,delete x.edgeEditResult,delete x._pan,delete x._multiSelect,x._writeToHt(),x._interactor.fp("deleteShapePoint",!1,!0)}},Xp.prototype.handleDoubleClick=function(U){var t=this,e=t._interactor._getLogicalPoint(U);if(t.screenInfo&&t._checkEditRealPoint(e)){var C=t.getCurrentSelectintStatus(),w=Mh.Curve.PointType;return C=C===w.Mirrored?w.Straight:w.Mirrored,t._setCurrentSelectionStatus(C),t._interactor._42(),!0}},Xp.prototype._drawHighlight=function(o){var w=this,l=w.highlight;if(l){var h=l.bezier,q=w._interactor;h&&Mh.Icons.DrawIcon(q,o,Mh.Icons.ShapeHighlightCurve,[h._p1.x,h._p1.y,h._p2.x,h._p2.y,h._p3.x,h._p3.y,h._p4.x,h._p4.y]);var Q=l.point;Q&&"insertKnot"===l.type&&Mh.Icons.DrawIcon(q,o,Mh.Icons.ShapeHighlighPoint,Q)}},Xp.prototype._drawGuide=function(v){var h=this,Y=h._guideInfo;if(Y){var S,d,o,c,y=Y.v;for(S=0;2>S;S++)if(c=0===S?Y.xList:Y.yList)for(d=0,o=c.length;o>d;d++)Mh.Icons.DrawIcon(h._interactor,v,Mh.Icons.ShapeGuideLine,[y.x,y.y,c[d].x,c[d].y])}},Xp.prototype._drawCurrentPoint=function(x){var I=this;if(I.activing){var U=I.activing,v=I.getCurrentSelectintStatus(),c=I._interactor;if(v!==Mh.Curve.PointType.Straight){var g=U.pairs;U.hlpair,U.hltype;var f=U.selections,p=U.editingCtrl;if(g&&!f){var m,A,n;for(A=0,n=g.length;n>A;A++)m=g[A],p&&A===p.pairId&&m[p.type]?Mh.Icons.DrawIcon(c,x,Mh.Icons.ShapeActivingCtrl,{point:m.point,c1:m.c1,c2:m.c2,hl:p.type}):Mh.Icons.DrawIcon(c,x,Mh.Icons.ShapeActivingCtrl,m)}}Mh.Icons.DrawIcon(c,x,Mh.Icons.ShapeHighlighRealPoint,I.activing.point),f&&f.forEach(function(a){Mh.Icons.DrawIcon(c,x,Mh.Icons.ShapeHighlighRealPoint,a)})}},Xp.prototype.clear=function(){var Y=this;Y.editing=null,Y._guideInfo=null,Y.activing=null,Y.highlight=null},Xp.prototype._42=function(v){var t=this;t.info={},t.editing||(t.screenInfo=null);var L=t._interactor;if(!L.editDetail)return t.clear(),void 0;var z=L.gv;if(!t.target||!z.isSelected(t.target)||!z.isVisible(t.target))return L.editDetail=!1,t.clear(),void 0;if(t.gatherSingleTarget(z,t.target),Mh.Icons.DrawIcon(L,v,Mh.Icons.ShapeBgCurve,t.screenInfo),t._drawHighlight(v),t._drawCurrentPoint(v),t._getRealPoint().forEach(function(S){Mh.Icons.DrawIcon(L,v,Mh.Icons.ShapePoint,S)}),t._drawGuide(v),t.tipInfo&&Mh.Icons.DrawIcon(L,v,Mh.Icons.TipHelper,t.tipInfo),t._edgeHostGuideInfo){Mh.Icons.DrawIcon(L,v,Mh.Icons.NodeHoverGuide,t._edgeHostGuideInfo.corners);var $=t._edgeHostGuideInfo.host;if($){var C=z.getAttachPoints($);if(C&&C.length)for(var A=0,H=C.length;H>A;A++){var R=C[A],_=$.getAttachPosition(R.x,R.y,R.offsetX,R.offsetY);_=Mh.toScreenPosition(z,_),_.isAttach=t._edgeHostGuideInfo.attach===A,Mh.Icons.DrawIcon(L,v,Mh.Icons.AttachPoint,_)}}}if(t._interactor.getStyle("curveElevationVisible")&&t.target instanceof u.Polyline&&t.activing){var e=t.activing.getCurrentEditingPoint();e&&Mh.Icons.DrawIcon(L,v,Mh.Icons.EdgeElevationGuide,e)}if(t.edgeEditResult&&t._drawEdgeHostHighlight(v,t.edgeEditResult.host,t.edgeEditResult.anchor),t._multiSelect&&t._multiSelect.endPoint){var c=u.Default.unionPoint(Mh.toScreenPosition(z,t._multiSelect.startPoint),Mh.toScreenPosition(z,t._multiSelect.endPoint));c.color=z.getRectSelectBorderColor(),v.save(),v.setTransform(1,0,0,1,0,0);var V=Z.devicePixelRatio,y=c.borderWidth=Math.round(V);y/=2,c.x=Math.round(c.x*V)+y,c.y=Math.round(c.y*V)+y,c.width=Math.round(c.width*V),c.height=Math.round(c.height*V),Mh.Icons.DrawIcon(L,v,Mh.Icons.SimpleRect,c),v.restore()}},Xp.prototype._drawEdgeHostHighlight=function(b,v,f){this.drawEdgeHostHighlight(b,v,f),this._interactor.redraw()},Xp.prototype.drawEdgeHostHighlight=function(R,u,z){if(cr(u)){var k,_,V,E,g=this,D=g._interactor,Y=D.gv,T=Y.getDataUI(u),n=cb(T),y=[];for(V=0,E=n.points.length;E>V;V++)_=Mh.toScreenPosition(Y,n.points.get(V)),y.push(_.x,_.y);n.segments&&(k=n.segments.toArray());var b=D.getStyle("edgeHostHighlighPeriod"),Z=D.getStyle("edgeHostEdgeHighlighColor");
Mh.Icons.DrawIcon(D,R,Mh.Icons.ShapeBgCurve,{P:y,S:k,color:Z,dynamicVisible:z.index===I,dynamicPeriod:b}),Z=D.getStyle("edgeHostPointHighlighColor");var U=Lf(T);for(V=0,E=U.length;E>V;V++){var S=U[V],x=Mh.toScreenPosition(Y,S);Mh.Icons.DrawIcon(D,R,Mh.Icons.ShapePoint,{point:{x:x.x,y:x.y},color:Z,size:12,dynamicVisible:V===z.index,dynamicPeriod:b})}}},Xp.prototype._getRealPoint=function(){var q,H=this.screenInfo,Z=H.P,l=H.S,e=-1,m=[],s=-1,w=l.length;return l.each(function(k){s++;var P=1;if(3===k)P=2;else if(4===k)P=3;else if(5===k)return;e+=P,q=s+1>=w?!0:1===l.get(s+1)?!0:!1,m.push({point:{x:Z[2*e],y:Z[2*e+1]},segmentIndex:s,pointIndex:e,isEnd:q})}),m},Xp.prototype.getEditingPointsInfo=function(G){var H=this,T=H.activing;if(!T)return!1;var g=T.point;if(!g)return!1;var M=this._getRealPoint(),s=[{screen:g}];T.selections&&T.selections.forEach(function(G){s.push({screen:G})});var Q,E,O=M.length;return s.forEach(function(v){for(Q=0;O>Q;Q++)if(E=M[Q],v.screen.isNearEnough(E.point)){v.segmentIndex=E.segmentIndex,v.pointIndex=E.pointIndex,v.point=H.target.getPoints().get(E.pointIndex);break}}),G&&s.sort(function(t,I){return t.segmentIndex-I.segmentIndex}),s};var Ld=Mh.MoveHelper=function(J){var W=this;W.catalog="Move",W._interactor=J};Ld.prototype={},Ld.prototype.constructor=Ld,Ld.prototype.calcShift=function(L,E,T){var n,$,c=this,j=c._interactor.gv,y=j.lp(E);if("beginMove"===L&&c._gatherGridInfo(T._lastLogicalPoint||y),n=c._target){var X=n.downPosition;if(X){var A=c._interactor.getStyle("moveSensitivity")/j._zoom;if(X.distanceTo(y)<A)return{x:0,y:0};delete n.downPosition}var O;$=u.Default.isShiftDown(E),$&&(y=c._dealShiftDown(y),O=n.shiftGuide.dir);var F,P=n.rawPos={x:n.pos.x+y.x-n.lp.x,y:n.pos.y+y.y-n.lp.y};if(u.Default.isCtrlDown(E)){if(F=c._calcShiftByAddon(),c._target.node instanceof Mh.Group){var C=c._target.node;C._position.x+=F.x,C._position.y+=F.y}return F}for(var v,o=n.x+P.x,z=n.y+P.y,a={x:o,y:z},I={x:o+n.w/2,y:z+n.h/2},k={x:o+n.w,y:z+n.h},w=c._interactor.rectGuide,t=c._interactor.gridGuide,R=[w.findClosest(a,O),w.findClosest(I,O),w.findClosest(k,O),t.findClosest(a,O),t.findClosest(I,O),t.findClosest(k,O)],B=1/0,U=1/0,J=0,D=R.length;D>J;J++)v=R[J],v&&(o=v.x,z=v.y,isFinite(o)&&Math.abs(o)<Math.abs(B)&&(B=o),isFinite(z)&&Math.abs(z)<Math.abs(U)&&(U=z));if(isFinite(B)||(B=0),isFinite(U)||(U=0),F=c._calcShiftByAddon(B,U),c._target.node instanceof Mh.Group){var C=c._target.node;C._position.x+=F.x,C._position.y+=F.y}var r=n.node;if(!Tl(r,j)){var l=P.x+B,_=P.y+U;c._interactor.rectGuide.gatherLines({node:r,x:n.x+l,y:n.y+_,w:n.w,h:n.h},O)}return F}},Ld.prototype._calcShiftByAddon=function(Z,Y){var h=this._target,H=h.rawPos,o=h.node.getPosition();return Z=Z||0,Y=Y||0,{x:H.x-o.x+Z,y:H.y-o.y+Y}},Ld.prototype._dealShiftDown=function(w){var Z=this,D=Z._target.shiftGuide,k=Z._target.lp,L=Math.abs(w.x-k.x),M=Math.abs(w.y-k.y);L>M&&L>D.limit&&"y"===D.dir&&(D.dir="x"),M>L&&M>D.limit&&"x"===D.dir&&(D.dir="y");var y=D.dir;return"x"===y?(w.y=k.y,D.limit=Math.max(D.limit,L)):"y"===y&&(w.x=k.x,D.limit=Math.max(D.limit,M)),w},Ld.prototype._gatherGridInfo=function(d){var D,c=this,z=c._interactor,b=z._getValidSelection();if(b.length){if(1===b.length){if(D=b[0],!D.getRect)return c._target=null,void 0}else if(D=Mh.Group.findOrCreateGroup(b),!D)return c._target=null,void 0}else{var b=z.gv.sm().getSelection();if(b.length&&(D=b.get(0),!D.getRect))return c._target=null,void 0}var u=D.getPosition(),r=D.getRect();c._target={node:D,x:r.x-u.x,y:r.y-u.y,w:r.width,h:r.height,lp:{x:d.x,y:d.y},pos:{x:u.x,y:u.y},shiftGuide:{dir:"x",limit:0},downPosition:new Mh.Math.Vector2(d)},z.rectGuide.gatherRects()},Ld.prototype.clear=function(){var e=this;e._interactor.rectGuide.clear(),e._interactor._42()};var fb=J.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),kj=function(){function Y(H,j){var l=I;return function(){return l||(l=H.getExtension(j)),l}}function L(N,b){b==I&&(b={}),b.version=Q&&(N instanceof WebGL2RenderingContext||J.prototype.toString.call(N)===r)?2:1,b.extensions=function(){for(var l={},X=N.getSupportedExtensions(),k=X.length;k--;)l[name]=Y(N,X[k]);return l}();for(var q=J.keys(x),$=0,g=q.length;g>$;++$){var P=q[$];b[P]=N.getParameter(x[P])}if(b.version>1){q=J.keys(F);for(var $=0,g=q.length;g>$;++$){var P=q[$];b[P]=N.getParameter(F[P])}}return b}var Q="undefined"!=typeof WebGL2RenderingContext,r="[object WebGL2RenderingContext]",x={aliasedLineWidthRange:fb.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:fb.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:fb.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:fb.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:fb.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:fb.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:fb.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:fb.MAX_TEXTURE_SIZE,maxVaryingVectors:fb.MAX_VARYING_VECTORS,maxVertexAttribs:fb.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:fb.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:fb.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:fb.MAX_VIEWPORT_DIMS},F={max3DTextureSize:fb.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:fb.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:fb.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:fb.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:fb.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:fb.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:fb.MAX_DRAW_BUFFERS,maxElementIndex:fb.MAX_ELEMENT_INDEX,maxElementsIndices:fb.MAX_ELEMENTS_INDICES,maxElementsVertices:fb.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:fb.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:fb.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:fb.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:fb.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:fb.MAX_SAMPLES,maxTextureLODBias:fb.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:fb.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:fb.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:fb.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:fb.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:fb.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:fb.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:fb.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:fb.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:fb.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:fb.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(f){var K=f._info;return K||(f._info=K=L(f,K)),K}}}(),gq=function(){function x(r,u,i){return{def:r,getter:i?function(x){var U=kj.for(x);return U.version>1?x.getParameter(u):r}:function(B){return B.getParameter(u)},setter:i?function(b,H){var m=kj.for(b);m.version>1&&b.pixelStorei(u,H)}:function(V,o){V.pixelStorei(u,o)}}}function z(t){return"string"==typeof t?Dk(t):t.r!==I?(w[0]=t.r,w[1]=t.g,w[2]=t.b,w[3]=t.a,w):t.red!==I?(w[0]=t.red,w[1]=t.green,w[2]=t.blue,w[3]=t.alpha,w):t}function m(P){return E(P)?Array.prototype.slice.call(P,0):P}function n(R,p,U){this.gl=p,this._record=U||{},this._branches={},this._leafSync={},this._struct=R;for(var M=R.children,a=M.length;a--;){var C=M[a],i=C.name;C.isLeaf?(this._leafSync[i]=!1,this._record[i]=m(C.desc.def)):this._record[i]={}}}function H(g){function S(k,B){n.call(this,g,k,B);for(var P=C.length;P--;){var e=C[P];this._branches[e._name]=new e._type(k,this._record[e._name])}}function s(o,p){function c(R,U){for(var z=r,f=!1;z--;)R[z]!==U[z]&&(R[z]=U[z],f=!0);return f}var i=o.name,W=E(o.desc.def),r=W&&o.desc.def.length;if(o.isLeaf){var B=o.desc.setter,S=o.desc.parse;J.defineProperty(p,i,{configurable:!1,enumerable:!0,get:function(){return this._record[i]},set:W?function(F){S&&(F=S(F)),(c(this._record[i],F)||!this._leafSync[i])&&(B(this.gl,this._record[i]),this._leafSync[i]=!0)}:function(W){this._record[i]===W&&this._leafSync[i]||(B(this.gl,W),this._record[i]=W,this._leafSync[i]=!0)}})}else C.push({_name:i,_type:H(o)}),J.defineProperty(p,i,{configurable:!1,enumerable:!0,get:function(){return this._branches[i]},set:function(N){this._branches[i].apply(N)}})}var C=[];return K(S,n),g.forEach(s,S.prototype),S}var w="undefined"!=typeof Float32Array&&new Float32Array(4),p={viewport:{def:[0,0,0/0,0/0],getter:function(x){return x.getParameter(x.VIEWPORT)},setter:function(e,y){var m=y[2]!==y[2]?e.drawingBufferWidth-y[0]:y[2],b=y[3]!==y[3]?e.drawingBufferHeight-y[1]:y[3];e.viewport(y[0],y[1],m,b)}},dither:{def:!1,getter:function(P){return P.isEnabled(P.DITHER)},setter:function(e,T){T?e.enable(e.DITHER):e.disable(e.DITHER)}},rasterizerDiscard:{def:!1,getter:function(V){var b=kj.for(V);return b.version>1&&V.isEnabled(V.RASTERIZER_DISCARD)},setter:function(o,i){var L=kj.for(o);1!==L.version&&(i?o.enable(o.RASTERIZER_DISCARD):o.disable(o.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(p){return p.lineWidth?p.getParameter(p.LINE_WIDTH):1},setter:function(Q,u){Q.lineWidth&&Q.lineWidth(u)}},color:{clear:{def:[0,0,0,0],getter:function(W){return W.getParameter(W.COLOR_CLEAR_VALUE)},setter:function(o,l){o.clearColor(l[0],l[1],l[2],l[3])},parse:z},mask:{def:[!0,!0,!0,!0],getter:function(Q){return Q.getParameter(Q.COLOR_WRITEMASK)},setter:function(z,X){z.colorMask(X[0],X[1],X[2],X[3])}}},blend:{enabled:{def:!1,getter:function(h){return h.isEnabled(h.BLEND)},setter:function(S,L){L?S.enable(S.BLEND):S.disable(S.BLEND)}},color:{def:[0,0,0,0],getter:function(k){return k.getParameter(k.BLEND_COLOR)},setter:function(E,D){E.blendColor(D[0],D[1],D[2],D[3])},parse:z},equation:{def:[fb.FUNC_ADD,fb.FUNC_ADD],getter:function(G){return[G.getParameter(G.BLEND_EQUATION_RGB),G.getParameter(G.BLEND_EQUATION_ALPHA)]},setter:function(E,u){E.blendEquationSeparate(u[0],u[1])},parse:function(t){var d=t.length;return d>1?t:1===d?(w[1]=w[0]=t[0],w):(w[1]=w[0]=t,w)}},func:{def:[fb.ONE,fb.ZERO,fb.ONE,fb.ZERO],getter:function(q){return[q.getParameter(q.BLEND_SRC_RGB),q.getParameter(q.BLEND_DST_RGB),q.getParameter(q.BLEND_SRC_ALPHA),q.getParameter(q.BLEND_DST_ALPHA)]},setter:function(s,I){s.blendFuncSeparate(I[0],I[1],I[2],I[3])},parse:function(N){var u=N.length;return u>3?N:(w[2]=w[0]=N[0],w[3]=w[1]=N[1],w)}}},cullFace:{enabled:{def:!1,getter:function(p){return p.isEnabled(p.CULL_FACE)},setter:function($,Y){Y?$.enable($.CULL_FACE):$.disable($.CULL_FACE)}},mode:{def:fb.BACK,getter:function(U){return U.getParameter(U.CULL_FACE_MODE)},setter:function(D,b){D.cullFace(b)}},frontFace:{def:fb.CCW,getter:function(M){return M.getParameter(M.FRONT_FACE)},setter:function(B,G){B.frontFace(G)}}},scissor:{enabled:{def:!1,getter:function(X){return X.isEnabled(X.SCISSOR_TEST)},setter:function(H,u){u?H.enable(H.SCISSOR_TEST):H.disable(H.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(J){return J.getParameter(J.SCISSOR_BOX)},setter:function(e,h){var T=h[2]!==h[2]?e.drawingBufferWidth-h[0]:h[2],n=h[3]!==h[3]?e.drawingBufferHeight-h[1]:h[3];e.scissor(h[0],h[1],T,n)}}},depth:{enabled:{def:!1,getter:function(y){return y.isEnabled(y.DEPTH_TEST)},setter:function(y,b){b?y.enable(y.DEPTH_TEST):y.disable(y.DEPTH_TEST)}},clear:{def:1,getter:function(l){return l.getParameter(l.DEPTH_CLEAR_VALUE)},setter:function(W,y){W.clearDepth(y)}},mask:{def:!0,getter:function(J){return J.getParameter(J.DEPTH_WRITEMASK)},setter:function(C,D){C.depthMask(D)}},range:{def:[-1,1],getter:function(l){return l.getParameter(l.DEPTH_RANGE)},setter:function(u,r){u.depthRange(r[0],r[1])}},func:{def:fb.LESS,getter:function(p){return p.getParameter(p.DEPTH_FUNC)},setter:function(D,X){D.depthFunc(X)}}},stencil:{enabled:{def:!1,getter:function(k){return k.isEnabled(k.STENCIL_TEST)},setter:function(z,t){t?z.enable(z.STENCIL_TEST):z.disable(z.STENCIL_TEST)}},clear:{def:0,getter:function(v){return v.getParameter(v.STENCIL_CLEAR_VALUE)},setter:function(H,Q){H.clearStencil(Q)}},frontMask:{def:255,getter:function(k){return k.getParameter(k.STENCIL_WRITEMASK)},setter:function(g,u){g.stencilMaskSeparate(g.FRONT,u)}},frontOp:{def:[fb.KEEP,fb.KEEP,fb.KEEP],getter:function(D){return[D.getParameter(D.STENCIL_FAIL),D.getParameter(D.STENCIL_PASS_DEPTH_FAIL),D.getParameter(D.STENCIL_PASS_DEPTH_PASS)]},setter:function(X,M){X.stencilOpSeparate(X.FRONT,M[0],M[1],M[2])}},frontFunc:{def:[fb.ALWAYS,0,255],getter:function(v){return[v.getParameter(v.STENCIL_FUNC),v.getParameter(v.STENCIL_REF),v.getParameter(v.STENCIL_VALUE_MASK)]},setter:function(u,X){u.stencilFuncSeparate(u.FRONT,X[0],X[1],X[2])}},backMask:{def:255,getter:function(p){return p.getParameter(p.STENCIL_BACK_WRITEMASK)},setter:function(m,v){m.stencilMaskSeparate(m.BACK,v)}},backOp:{def:[fb.KEEP,fb.KEEP,fb.KEEP],getter:function(X){return[X.getParameter(X.STENCIL_BACK_FAIL),X.getParameter(X.STENCIL_BACK_PASS_DEPTH_FAIL),X.getParameter(X.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(g,B){g.stencilOpSeparate(g.BACK,B[0],B[1],B[2])}},backFunc:{def:[fb.ALWAYS,0,255],getter:function(R){return[R.getParameter(R.STENCIL_BACK_FUNC),R.getParameter(R.STENCIL_BACK_REF),R.getParameter(R.STENCIL_BACK_VALUE_MASK)]},setter:function(y,V){y.stencilFuncSeparate(y.BACK,V[0],V[1],V[2])}}},hint:{generateMipmap:{def:fb.DONT_CARE,getter:function(p){return p.getParameter(p.GENERATE_MIPMAP_HINT)},setter:function(s,D){s.hint(s.GENERATE_MIPMAP_HINT,D)}},fragmentShaderDerivative:{def:fb.DONT_CARE,getter:function(j){var d=kj.for(j);return 1!==d.version||d.extensions.OES_standard_derivatives?j.getParameter(fb.FRAGMENT_SHADER_DERIVATIVE_HINT):fb.DONT_CARE},setter:function(e,k){var c=kj.for(e);return c.version>1||c.extensions.OES_standard_derivatives?(e.hint(fb.FRAGMENT_SHADER_DERIVATIVE_HINT,k),void 0):void 0}}},pixelStore:{packAlignment:x(4,fb.PACK_ALIGNMENT,!1),unpackAlignment:x(4,fb.UNPACK_ALIGNMENT,!1),unpackFlipY:x(!1,fb.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:x(!1,fb.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:x(fb.BROWSER_DEFAULT_WEBGL,fb.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:x(0,fb.PACK_ROW_LENGTH,!0),packSkipPixels:x(0,fb.PACK_SKIP_PIXELS,!0),packSkipRows:x(0,fb.PACK_SKIP_ROWS,!0),unpackRowLength:x(0,fb.UNPACK_ROW_LENGTH,!0),unpackImageHeight:x(0,fb.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:x(0,fb.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:x(0,fb.UNPACK_SKIP_ROWS,!0),unpackSkipImages:x(0,fb.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(G){return G.isEnabled(G.POLYGON_OFFSET_FILL)},setter:function(z,G){G?z.enable(z.POLYGON_OFFSET_FILL):z.disable(z.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function($){return[$.getParameter($.POLYGON_OFFSET_FACTOR),$.getParameter($.POLYGON_OFFSET_UNITS)]},setter:function(E,J){E.polygonOffset(J[0],J[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(B){return B.isEnabled(B.SAMPLE_COVERAGE)},setter:function(r,R){R?r.enable(r.SAMPLE_COVERAGE):r.disable(r.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(h){return h.isEnabled(h.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(v,j){j?v.enable(v.SAMPLE_ALPHA_TO_COVERAGE):v.disable(v.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(B){return[B.getParameter(B.SAMPLE_COVERAGE_VALUE),B.getParameter(B.SAMPLE_COVERAGE_INVERT)]},setter:function(A,L){A.sampleCoverage(L[0],L[1])}}}},d=Bc.create(p,function(S){return"def"in S});n.prototype.reset=function(){for(var g=this._struct.children,m=g.length;m--;){var y=g[m],j=y.name;y.isLeaf?this[j]=y.desc.def:this._branches[j].reset()}},n.prototype.save=function(h){h==I&&(h={});for(var O=this._struct.children,_=O.length;_--;){var D=O[_],o=D.name;if(D.isLeaf)h[o]=m(this._record[o]);else{var a=h[o];a==I&&(h[o]=a={}),this._branches[o].save(a)}}return h},n.prototype.sync=function(A,E){for(var e=this._struct.children,b=e.length;b--;){var l=e[b],S=l.name;l.isLeaf?(E||!this._leafSync[S])&&(A?(this._record[S]=l.desc.getter(this.gl),this._leafSync[S]=!0):(l.desc.setter(this.gl,this._record[S]),this._leafSync[S]=!0)):this._branches[S].sync(A,E)}},n.prototype.syncLoss=function(){for(var q=this._struct.children,U=q.length;U--;){var l=q[U];l.isLeaf?this._leafSync[l.name]=!1:this._branches[l.name].syncLoss()}},n.prototype.apply=function(E){for(var i=this._struct.children,n=i.length;n--;){var Q=i[n],A=Q.name;A in E&&(Q.isLeaf?this[A]=E[A]:this._branches[A].apply(E[A]))}},n.prototype.append=function(S){var U=this._struct.childMap;for(var l in S){var P=U[l];P&&(P.isLeaf?this[l]=S[l]:this._branches[l].append(S[l]))}};var u=H(d);return function(k){var X=k._state;return X||(k._state=X=new u(k)),X}}(),Pe=function(){function t(C,z,t,Y){if(C){var Q=C.length;if(Q!=I)for(var G=0;Y>G;++G)z[t+G]=C[G];else C.toArray&&C.toArray(z,t)}else for(var G=0;Y>G;++G)z[t+G]=0}function v(E,X,Z){var V=E[0];if(0>=V||V>0)return E;var q=X*Z,z=a[q];if(z==I&&(a[q]=new Float32Array(q)),0!==X){t(V,z,0,Z);for(var N=1,C=0;N!==X;++N)C+=Z,t(E[N],z,C,Z)}return z}function D(F,w){F.uniform1f(this.addr,w)}function X(m,V){m.uniform1fv(this.addr,V)}function O(Z,u){if(u.x!=I)Z.uniform2f(this.addr,u.x,u.y);else{var j=a[2];j.set(u,0),Z.uniform2fv(this.addr,j)}}function S(b,F){b.uniform2fv(this.addr,v(F,this.size,2))}function z(d,P){if(P.x!=I)d.uniform3f(this.addr,P.x,P.y,P.z);else if(P.r!=I)d.uniform3f(this.addr,P.r,P.g,P.b);else if(P.red!=I)d.uniform3f(this.addr,P.red,P.green,P.blue);else{var A=a[3];A.set(P,0),d.uniform3fv(this.addr,A)}}function m(o,j){o.uniform3fv(this.addr,v(j,this.size,3))}function u(w,j){if("string"==typeof j&&(j=Dk(j)),j.x!=I)w.uniform4f(this.addr,j.x,j.y,j.z,j.w);else if(j.r!=I)w.uniform4f(this.addr,j.r,j.g,j.b,j.a);else if(j.red!=I)w.uniform4f(this.addr,j.red,j.green,j.blue,j.alpha);else{var L=a[4];L.set(j,0),w.uniform4fv(this.addr,L)}}function o(X,C){X.uniform4fv(this.addr,v(C,this.size,4))}function r(d,w){d.uniform1i(this.addr,w)}function G(B,Y){B.uniform1iv(this.addr,Y)}function H(g,R){g.uniform2iv(this.addr,R)}function L(M,D){M.uniform3iv(this.addr,D)}function C($,n){$.uniform4iv(this.addr,n)}function B(F,y){F.uniform1i(this.addr,c[y?1:0])}function Z(W,v){var c=a[4];c.set(v,0),W.uniformMatrix2fv(this.addr,!1,c)}function s(O,s){O.uniformMatrix2fv(this.addr,!1,v(s,this.size,4))}function d(c,t){var x=a[9];x.set(t,0),c.uniformMatrix3fv(this.addr,!1,x)}function x(U,z){U.uniformMatrix3fv(this.addr,!1,v(z,this.size,9))}function w(H,c){var f=a[16];f.set(c,0),H.uniformMatrix4fv(this.addr,!1,f)}function Q(l,K){l.uniformMatrix4fv(this.addr,!1,v(K,this.size,16))}function n(J,q){J.uniform1i(this.addr,this.slots[0]),J.activeTexture(J.TEXTURE0+this.slots[0]),J.bindTexture(J.TEXTURE_2D,q||J._emptyTexture)}function f(X,C){X.uniform1iv(this.addr,this.slots);for(var w=this.slots.length;w--;)X.activeTexture(X.TEXTURE0+this.slots[w]),X.bindTexture(X.TEXTURE_2D,C[w]||X._emptyTexture)}function q(B,T){B.uniform1i(this.addr,this.slots[0]),B.activeTexture(B.TEXTURE0+this.slots[0]),B.bindTexture(B.TEXTURE_CUBE_MAP,T||B._emptyCubeTexture)}function V(g,y){g.uniform1iv(this.addr,this.slots);
for(var O=this.slots.length;O--;)g.activeTexture(g.TEXTURE0+this.slots[O]),g.bindTexture(g.TEXTURE_CUBE_MAP,y[O]||g._emptyCubeTexture)}function j(j,Q,I){i[j]=[Q,I]}function N(f,U,F){switch(f.type){case 35678:case 35680:if("uSampler"===F)return[0];if("uBlendSampler"===F)return[1];for(var S=f.size,l=new Int32Array(S),k=0;S>k;++k)l[k]=U.usedTextureSlot++;return l}return I}function g(E,O,K,c,e){this.name=E,this.addr=O,this.size=c?K.size:0,this.activeInfo=K,this.setter=i[K.type][c?1:0],this.slots=N(K,e,E),Fg(this)}function T(V,v,z,H){var R=V.name,f=R.length;for(k.lastIndex=0;;){var P=k.exec(R),a=k.lastIndex,F=P[1],r="]"===P[2],c=P[3];if(r&&(F=0|F),c===I||"["===c&&a+2===f){z[F]=new g(F,v,V,c!==I,H);break}var _=z[F];_==I&&(z[F]=_={}),z=_}}function Y(o,D,M){this.gl=D,this._program=M,this._leaves={},this._branches={},this._struct=o}function A(i){function d(O,t){Y.call(this,i,O,t);for(var l=L.length;l--;){var B=L[l];this._branches[B._name]=new B._type(O,t)}}function I(P,V){var h=P.name;if(P.isLeaf){var G=$("d.setter(this.gl, v);",["v"],["d"],[P.desc]);J.defineProperty(V,h,{configurable:!1,enumerable:!0,get:function(){return G},set:G})}else L.push({_name:h,_type:A(P)}),J.defineProperty(V,h,{configurable:!1,enumerable:!0,get:function(){return this._branches[h]},set:function(C){this._branches[h].apply(C)}})}var L=[];return K(d,Y),i.forEach(I,d.prototype),d}function l(u,s){for(var M=u.getProgramParameter(s,u.ACTIVE_UNIFORMS),g={},S={usedTextureSlot:2};M--;){var b=u.getActiveUniform(s,M),W=b.name,t=u.getUniformLocation(s,W);T(b,t,g,S)}var a=Bc.create(g,function(S){return"addr"in S}),N=A(a);return J.defineProperty(N.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:S.usedTextureSlot}),new N(u,s)}var a=[];if("function"==typeof Float32Array)for(var p=1;17>p;++p)a[p]=new Float32Array(p);var c=new Int32Array([0,1]),i=[];j(fb.FLOAT,D,X),j(fb.FLOAT_VEC2,O,S),j(fb.FLOAT_VEC3,z,m),j(fb.FLOAT_VEC4,u,o),j(fb.INT,r,G),j(fb.INT_VEC2,H,H),j(fb.INT_VEC3,L,L),j(fb.INT_VEC4,C,C),j(fb.BOOL,B,G),j(fb.BOOL_VEC2,H,H),j(fb.BOOL_VEC3,L,L),j(fb.BOOL_VEC4,C,C),j(fb.FLOAT_MAT2,Z,s),j(fb.FLOAT_MAT3,d,x),j(fb.FLOAT_MAT4,w,Q),j(fb.SAMPLER_2D,n,f),j(fb.SAMPLER_CUBE,q,V);var k=/([\w\d_]+)(\])?(\[|\.)?/g;return Y.prototype.apply=function(S){for(var L=this._struct.children,J=L.length;J--;){var r=L[J],w=r.name;w in S&&(r.isLeaf?this[w]=S[w]:this._branches[w].apply(S[w]))}},Y.prototype.append=function(D){var $=this._struct.childMap;for(var n in D){var J=$[n];J&&(J.isLeaf?this[n]=D[n]:this._branches[n].append(D[n]))}},function(v,I){var H=I._uniforms;return H||(I._uniforms=H=l(v,I)),H}}(),ce=function(){function G(z,u,H){u.vertexAttrib1f(z.addr,H)}function W(l,O,X){if(X.x!=I)O.vertexAttrib2f(l.addr,X.x,X.y);else{var C=e[2];C.set(X,0),O.vertexAttrib2fv(l.addr,C)}}function m(q,m,x){if(x.x!=I)m.vertexAttrib3f(q.addr,x.x,x.y,x.z);else if(x.r!=I)m.vertexAttrib3f(q.addr,x.r,x.g,x.b);else if(x.red!=I)m.vertexAttrib3f(q.addr,x.red,x.green,x.blue);else{var L=e[3];L.set(x,0),m.vertexAttrib3fv(q.addr,L)}}function X(z,S,G){if("string"==typeof G&&(G=Dk(G)),G.x!=I)S.vertexAttrib4f(z.addr,G.x,G.y,G.z,G.w);else if(G.r!=I)S.vertexAttrib4f(z.addr,G.r,G.g,G.b,G.a);else if(G.red!=I)S.vertexAttrib4f(z.addr,G.red,G.green,G.blue,G.alpha);else{var H=e[4];H.set(G,0),S.vertexAttrib4fv(z.addr,H)}}function E(x,a,v){v=v.el||v;for(var z=0,g=0;2>z;++z)a.vertexAttrib2f(x.addr,v[g++],v[g++])}function U(M,G,b){b=b.el||b;for(var E=0,q=0;3>E;++E)G.vertexAttrib3f(M.addr,b[q++],b[q++],b[q++])}function d(l,A,e){e=e.el||e;for(var W=0,S=0;4>W;++W)A.vertexAttrib4f(l.addr,e[S++],e[S++],e[S++],e[S++])}function u(z,o,s,h,C,I,l){o.bindBuffer(o.ARRAY_BUFFER,s),o.vertexAttribPointer(z.addr,1,h||o.FLOAT,!!C,I||0,l||0),o.bindBuffer(o.ARRAY_BUFFER,null)}function B(e,$,U,l,L,h,f){$.bindBuffer($.ARRAY_BUFFER,U),$.vertexAttribPointer(e.addr,2,l||$.FLOAT,!!L,h||0,f||0),$.bindBuffer($.ARRAY_BUFFER,null)}function P(G,A,h,U,d,D,H){A.bindBuffer(A.ARRAY_BUFFER,h),A.vertexAttribPointer(G.addr,3,U||A.FLOAT,!!d,D||0,H||0),A.bindBuffer(A.ARRAY_BUFFER,null)}function S(I,l,A,X,$,T,j){l.bindBuffer(l.ARRAY_BUFFER,A),l.vertexAttribPointer(I.addr,4,X||l.FLOAT,!!$,T||0,j||0),l.bindBuffer(l.ARRAY_BUFFER,null)}function j(M,h,Z,J,c,i,_){var i=i||4,_=_||0;h.bindBuffer(h.ARRAY_BUFFER,Z),h.vertexAttribPointer(M.addr,2,J||h.FLOAT,!!c,i,_),h.vertexAttribPointer(M.addr+1,2,J||h.FLOAT,!!c,i,_+2),h.bindBuffer(h.ARRAY_BUFFER,null)}function _(V,g,o,v,j,a,K){var a=a||9,K=K||0;g.bindBuffer(g.ARRAY_BUFFER,o),g.vertexAttribPointer(V.addr,3,v||g.FLOAT,!!j,a,K),g.vertexAttribPointer(V.addr+1,3,v||g.FLOAT,!!j,a,K+3),g.vertexAttribPointer(V.addr+2,3,v||g.FLOAT,!!j,a,K+6),g.bindBuffer(g.ARRAY_BUFFER,null)}function M(I,m,c,P,u,T,a){var T=T||16,a=a||0;m.bindBuffer(m.ARRAY_BUFFER,c),m.vertexAttribPointer(I.addr,4,P||m.FLOAT,!!u,T,a),m.vertexAttribPointer(I.addr+1,4,P||m.FLOAT,!!u,T,a+4),m.vertexAttribPointer(I.addr+2,4,P||m.FLOAT,!!u,T,a+8),m.vertexAttribPointer(I.addr+3,4,P||m.FLOAT,!!u,T,a+12),m.bindBuffer(m.ARRAY_BUFFER,null)}function p(F,b,f){s[F]=function(q,B,h,o,$,d){this.addr==I||this.addr<0||(B==I||B===!1?q.disableVertexAttribArray(this.addr):Ur(B)===g?(q.enableVertexAttribArray(this.addr),f(this,q,B,h,o,$,d)):(q.disableVertexAttribArray(this.addr),b(this,q,B)))}}function V(N,i,K){this.name=N,this.addr=i,this.activeInfo=K,this.setter=s[K.type],Fg(this)}function b(x,g,E){this.gl=g,this.program=E,this._branches={},this._struct=x}function N(M){function z(P,C){b.call(this,M,P,C);for(var g=I.length;g--;){var n=I[g];this._branches[n._name]=new n._type(P,C)}}function T(W,V){var Y=W.name;if(W.isLeaf){var n=$("d.setter(this.gl, v);",["v"],["d"],[W.desc]);J.defineProperty(V,Y,{configurable:!1,enumerable:!0,get:function(){return n},set:n})}else I.push({_name:Y,_type:N(W)}),J.defineProperty(V,Y,{configurable:!1,enumerable:!0,get:function(){return this._branches[Y]},set:function(N){this._branches[Y].apply(N)}})}var I=[];return K(z,b),M.forEach(T,z.prototype),z}function t(c,y){for(var I=c.getProgramParameter(y,c.ACTIVE_ATTRIBUTES),T={};I--;){var x=c.getActiveAttrib(y,I),w=x.name,G=c.getAttribLocation(y,w);T[w]=new V(w,G,x)}var t=Bc.create(T,function(o){return"addr"in o}),n=N(t);return new n(c,y)}var e=[];if(Float32Array)for(var H=1;17>H;++H)e[H]=new Float32Array(H);var s=[],g="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return p(fb.FLOAT,G,u),p(fb.FLOAT_VEC2,W,B),p(fb.FLOAT_VEC3,m,P),p(fb.FLOAT_VEC4,X,S),p(fb.FLOAT_MAT2,E,j),p(fb.FLOAT_MAT3,U,_),p(fb.FLOAT_MAT4,d,M),b.prototype.disable=function(){for(var a=this._struct.children,E=a.length;E--;){var $=a[E],L=$.name;$.isLeaf?this.gl.disableVertexAttribArray($.desc.addr):this._branches[L].disable()}},b.prototype.apply=function(X){for(var w=this._struct.children,Q=w.length;Q--;){var e=w[Q],D=e.name;D in X&&(e.isLeaf?this[D]=X[D]:this._branches[D].apply(X[D]))}},b.prototype.append=function(Z){var a=this._struct.childMap;for(var F in Z){var I=a[F];I&&(I.isLeaf?this[F]=Z[F]:this._branches[F].append(Z[F]))}},function(F,W){var C=W._attribs;return C||(W._attribs=C=t(F,W)),C}}(),cn=function(k){var W=this;J.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:k,writable:!1},glState:{configurable:!1,enumerable:!1,value:gq(k),writable:!1}}),W._currProgram=I,W._currUniforms=I,W._currAttribs=I,W._sync=!0};J.defineProperties(cn.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(q){var S=this;S._sync&&q===S._currProgram||(S.gl.useProgram(q),S._currProgram=q,S._currUniforms=Pe(S.gl,q),S._currAttribs=ce(S.gl,q),S._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var i=this;return i._currProgram&&!i._sync&&(i.gl.useProgram(i._currProgram),i._sync=!0),i._currUniforms},set:function(V){var i=this;i._currUniforms&&(i._currProgram&&!i._sync&&(i.gl.useProgram(i._currProgram),this._sync=!0),i._currUniforms.apply(V))}},attribs:{configurable:!1,enumerable:!1,get:function(){var F=this;return F._currProgram&&!F._sync&&(F.gl.useProgram(F._currProgram),F._sync=!0),F._currAttribs},set:function(p){var R=this;R._currUniforms&&(R._currProgram&&!R._sync&&(R.gl.useProgram(R._currProgram),this._sync=!0),R._currAttribs.apply(p))}}}),cn.prototype.useProgram=function(d){var T=this;T._sync&&d===T._currProgram||(T.gl.useProgram(d),T._currProgram=d,T._currUniforms=Pe(T.gl,d),T._currAttribs=ce(T.gl,d),T._sync=!0)},cn.prototype.directState=function(){return this.glState},cn.prototype.directUniforms=function(){return this._currUniforms},cn.prototype.directAttribs=function(){return this._currAttribs},cn.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},cn.for=function($){var h=$._renderState;return h||($._renderState=h=new cn($)),h};var io="directional",il="point",mi="spot",Ye="light.color",mo={},_f=function(N,k){Ug(k)&&co.test(k)?ho(N,k):ei(k)&&k.modelType?Yf(N,k):ik[N]=k},rd=function(C){if(ei(C))return C.modelType?C.uuid?ik[C.uuid]:(C.uuid=u.Math.generateUUID(),Yf(C.uuid,C),I):C;var j=ik[C];return C&&j===I&&co.test(C)&&(ok&&ok[C]||ho(C,C)),j},$b=function(R,_){R.frameStack?R.frameStack.push(_):R.frameStack=[_],R.bindFramebuffer(R.FRAMEBUFFER,_)},_j=function(v){var j=v.frameStack;if(j){if(j.pop(),j.length)return v.bindFramebuffer(v.FRAMEBUFFER,j[j.length-1]),void 0;v.frameStack=null}v.bindFramebuffer(v.FRAMEBUFFER,null)};_p(w,{graph3dViewAttributes:B,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:R/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:ao,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:R/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:_f,getShape3dModel:rd,createMatrix:function(s,S){Zh(s)||(s=[s]);for(var B=s.length-1;B>=0;B--){var q=s[B];S=se(q.mat,q.s3,q.r3,q.rotationMode,q.t3,S)}return S},transformVec:function(b,o){return wd(b,o)},glBindFrame:$b,glUnbindFrame:_j,createBoxModel:function(){return{vs:ic,ns:vf,uv:xp,is:Ar}},createRoundRectModel:function(E,x){return hk.roundRect(E,x)},createStarModel:function(V,D){return hk.star(V,D)},createRectModel:function(w,P){return hk.rect(w,P)},createTriangleModel:function(N,k){return hk.triangle(N,k)},createRightTriangleModel:function(O,X){return hk.rightTriangle(O,X)},createParallelogramModel:function(X,j){return hk.parallelogram(X,j)},createTrapezoidModel:function(t,X){return hk.trapezoid(t,X)},createSmoothSphereModel:function(t,l,g,U,Q,y,S){return me(new Sr(t,l,g,U,Q,y,S))},createSphereModel:function(h,F,o,g,S,_){return h?Hm(h,F,o,g,S,_):w.createSmoothSphereModel()},createSmoothConeModel:function(o,R,C,h,V){return kn(o,R,C,h,V)},createConeModel:function(I,r,O,q,x,v){return I?Nd(I,r,O,q,x,v):kn(v)},createSmoothCylinderModel:function(D,k,R,$,P,t,x,z){return me(new Ai(D,k,R,$,P,t,x,z))},createCylinderModel:function(k,Y,K,z,c,P,f){return k?ni(k,Y,K,z,c,P,f):Kj(P,f)},createSmoothTorusModel:function(X,O,v,u,T,d){return me(new kk(X,O,v,u,T,d))},createTorusModel:function(A,H,C,G,u,j,P){return A?Db(A,H,C,G,u,j,P):oe(j,P)},createExtrusionModel:function(x,C,Q,z,Z,_,a,l){return Nq(x,C,Q,z,Z,_,a,l)},createSmoothRingModel:function($,F,v,A,g,I){for(var d=[],c=0;c<$.length-1;c+=2)d.push({x:$[c],y:$[c+1]});for($=ol(d,F,v)[0],d=[],c=0;c<$.length;c++){var l=$[c];d.push(new Bh(l.x,0,l.y))}return me(new qp(d,I,A,g))},createTextGeometry:function(j,u){return me(new Pd(j,u))},loadFontFace:function(z,l){w.xhrLoad(z,function(p){if(!p)return l();var O;try{O=JSON.parse(p)}catch(K){O=JSON.parse(p.substring(65,p.length-2))}Ap.loadFace(O),l&&l(O.familyName.toLowerCase())},l?null:{sync:!0})},createRingModel:function(r,W,b,g,u,M,j,s,Z,K){for(var v=[],F=0;F<r.length-1;F+=2)v.push({x:r[F],y:r[F+1]});M=M||w.shapeSide,j=j||0,s=s||M;var o,h,t,m,O,p,H,a,A,Y,F,f,E,l,D,e,x,y,U=[],i=[],R=Z?[]:B,X=Z?[]:B,T=K?[]:B,z=K?[]:B,J=g?[]:B,N=g?[]:B,Q=u?[]:B,I=u?[]:B,r=ol(v,W,b),G=Sd(r),C=0,$=2*Math.PI/M;return r.forEach(function(k){if(t=k.length,t>1){if(m=k[0],g)for(p=m.x,a=m.y,F=j;s>F;F++)f=F+1,E=F*$,l=f*$,D=n(E),e=q(E),x=n(l),y=q(l),J.push(D*p,a,-e*p,x*p,a,-y*p,0,a,0),N.push(.5-.5*D,.5-.5*e,.5-.5*x,.5-.5*y,.5,.5);for(Y=0;t>Y;Y++){for(O=k[Y],p=m.x,H=O.x,a=m.y,A=O.y,o=C/G,C+=Ke(m,O),h=C/G,F=j;s>F;F++)f=F+1,E=F*$,l=f*$,D=n(E),e=q(E),x=n(l),y=q(l),U.push(D*H,A,-e*H,x*H,A,-y*H,D*p,a,-e*p,x*H,A,-y*H,x*p,a,-y*p,D*p,a,-e*p),i.push(F/M,h,f/M,h,F/M,o,f/M,h,f/M,o,F/M,o),Z&&F===j&&(R.push(0,a,0,0,A,0,D*H,A,-e*H,D*H,A,-e*H,D*p,a,-e*p,0,a,0),X.push(0,.5-a,0,.5-A,2*H,.5-A,2*H,.5-A,2*p,.5-a,0,.5-a)),K&&f===s&&(T.push(0,a,0,x*H,A,-y*H,0,A,0,x*H,A,-y*H,0,a,0,x*p,a,-y*p),z.push(1,.5-a,1-2*H,.5-A,1,.5-A,1-2*H,.5-A,1,.5-a,1-2*p,.5-a));m=O}if(u)for(p=m.x,a=m.y,F=j;s>F;F++)f=F+1,E=F*$,l=f*$,D=n(E),e=q(E),x=n(l),y=q(l),Q.push(x*p,a,-y*p,D*p,a,-e*p,0,a,0),I.push(.5-.5*x,.5+.5*y,.5-.5*D,.5+.5*e,.5,.5)}}),{vs:U,uv:i,bottom_vs:Q,bottom_uv:I,top_vs:J,top_uv:N,from_vs:R,from_uv:X,to_vs:T,to_uv:z}}},!0),_p(F,{"3d.move.mode":I,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":I,"edge.gradient.color":I,"edge.source.t3":I,"edge.target.t3":I,"light.type":il,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":R/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Lb,"wf.short":!1,"wf.mat":I,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:I,"transparent.mask":!1,brightness:I,"select.brightness":.7,"repeat.uv.length":I,alphaTest:.4,"shadow.cast":!0,"shadow.receive":!0,"shadow.quality":"high","shadow.intensity":.3,"shadow.bias":-.005,"shadow.radius":.1,"shadow.type":"pcf","shadow.degree.x":30,"shadow.degree.z":-10,renderTextureSamples:4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":yn,"label.t3":I,"label.r3":I,"label.texture.scale":2,"label.rotationMode":Vi,"label.light":!1,"label.blend":I,"label.reverse.flip":!1,"label.reverse.color":op,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":yn,"label2.t3":I,"label2.r3":I,"label2.texture.scale":2,"label2.rotationMode":Vi,"label2.light":!1,"label2.blend":I,"label2.reverse.flip":!1,"label2.reverse.color":op,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":yn,"note.t3":I,"note.r3":I,"note.texture.scale":2,"note.rotationMode":Vi,"note.light":!1,"note.blend":I,"note.reverse.flip":!1,"note.reverse.color":op,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":yn,"note2.t3":I,"note2.r3":I,"note2.texture.scale":2,"note2.rotationMode":Vi,"note2.light":!1,"note2.blend":I,"note2.reverse.flip":!1,"note2.reverse.color":op,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:I,"shape3d.color":Ue,"shape3d.top.color":I,"shape3d.bottom.color":I,"shape3d.from.color":I,"shape3d.to.color":I,"shape3d.image":I,"shape3d.top.image":I,"shape3d.bottom.image":I,"shape3d.from.image":I,"shape3d.to.image":I,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":I,"shape3d.side.to":I,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":I,"shape3d.opacity":I,"shape3d.reverse.flip":!1,"shape3d.reverse.color":op,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":I,"shape3d.uv.scale":I,"shape3d.top.uv.offset":I,"shape3d.top.uv.scale":I,"shape3d.bottom.uv.offset":I,"shape3d.bottom.uv.scale":I,"shape3d.from.uv.offset":I,"shape3d.from.uv.scale":I,"shape3d.to.uv.offset":I,"shape3d.to.uv.scale":I,"shape3d.top.cap":I,"shape3d.bottom.cap":I,"shape3d.start.angle":0,"shape3d.sweep.angle":z,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":I,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Ue,"all.image":I,"all.blend":I,"all.opacity":I,"all.reverse.flip":!1,"all.reverse.color":op,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":I,"all.uv.offset":I,"all.uv.scale":I,"all.discard.selectable":!0,mat:I,"left.mat":I,"right.mat":I,"top.mat":I,"bottom.mat":I,"front.mat":I,"back.mat":I},!0);var bs,Or=!1,pf=[0,0,0,0],lh=function(C){return C instanceof ji},Ob=function(c){return[c.x,c.e||0,c.y]},Fp=function(x,V,s){for(var V=Dk(V),h=V[0],g=V[1],r=V[2];s--;)x.push(h,g,r)},ro=function(y,A,p){for(var A=Dk(A),Y=A[0],P=A[1],b=A[2],S=A[3];p--;)y.push(Y,P,b,S)},vr=function(n,Y,p){if(Y)for(var s,V,U,f=Y[0],I=Y[1],B=Y[2],H=Y[4],X=Y[5],C=Y[6],N=Y[8],L=Y[9],j=Y[10],d=Y[12],q=Y[13],y=Y[14],M=p.length,P=0,P=0;M>P;P+=3)s=p[P],V=p[P+1],U=p[P+2],n.push(f*s+H*V+N*U+d,I*s+X*V+L*U+q,B*s+C*V+j*U+y);else Md(n,p)},dc=function($,K){var Z=K.s("light.intensity"),b=Dk(K.s(Ye)),x=b[0],Y=b[1],Q=b[2];1!==Z&&(x*=Z,Y*=Z,Q*=Z),$.push(x,Y,Q,K.s("light.disabled")?1:0)},_r=function(Q,S){var y=cn.for(S),T=y.directUniforms();T.uHeadlightRange=Q._headlightRange;var C=Q._headlightIntensity,A=Dk(Q._headlightColor);1!==C&&(A=[A[0]*C,A[1]*C,A[2]*C]),T.uHeadlightColor=[A[0],A[1],A[2],Q._headlightDisabled?1:0];var K=Q._59O,$=Q._spots,k=Q._dirs;if(K.length){var G=[],W=[],e=[];K.forEach(function(T){dc(G,T),Md(W,Q._transformPointToViewSpace(T.p3())),e.push(T.s("light.range"))}),T.uPointColor=G,T.uPointRange=e,T.uPointPosition=W}if($.length){var E=[],f=[],J=[],B=[],V=[],H=[];$.forEach(function(w){dc(E,w),Md(f,Q._transformPointToViewSpace(w.p3())),Md(V,Q._transformDirectionToViewSpace(w.p3(),w.s("light.center"))),J.push(w.s("light.range")),B.push(n(w.s("light.angle")/2)),H.push(w.s("light.exponent"))}),T.uSpotColor=E,T.uSpotRange=J,T.uSpotAngle=B,T.uSpotExponent=H,T.uSpotPosition=f,T.uSpotDirection=V}if(k.length){var _=[],m=[];k.forEach(function(H){dc(_,H),Md(m,Q._transformDirectionToViewSpace(H.p3()))}),T.uDirColor=_,T.uDirDirection=m}},yl=function(i){return i>0&&0===(i-1&i)},ud=function(F){return F=_(0,s(R,F)),F=_(Rm,s(R-Rm,F))},er=function(){return.05+l()/2},Nh=function(W,u,t,r){var v,d=W.getEye();return W.isOrtho()?(v=Gc(W.getCenter(),d),v[0]+=r[0],v[1]+=r[1],v[2]+=r[2]):v=d,Om(u,t,r,v)},Om=function(y,U,P,c){var C=qg(y,U),h=Gc(c,P,!0),a=qg(h,U);if(j(a)<Rm)return B;var L=(C-qg(P,U))/a;return[P[0]+h[0]*L,P[1]+h[1]*L,P[2]+h[2]*L]},af=function(I,w){return{x:2*I.x-w.x,y:2*I.y-w.y}},_g=function(m,V,P,l){var w,L;if(!m)return w=v(V.y-P.y,P.x-V.x),{x:V.x+l*q(w),y:V.y+l*n(w)};if(!P)return w=v(m.y-V.y,V.x-m.x),{x:V.x+l*q(w),y:V.y+l*n(w)};var y=Gc([m.x,m.y,0],[V.x,V.y,0],!0),e=Gc([P.x,P.y,0],[V.x,V.y,0],!0),T=-(y[0]+e[0])/2,k=-(y[1]+e[1])/2,R=h(T*T+k*k);if(Rm>R)return w=v(m.y-V.y,V.x-m.x),{x:V.x+l*q(w),y:V.y+l*n(w)};var t=m.x-V.x,p=m.y-V.y,H=P.x-V.x,Y=P.y-V.y,z=h(t*t+p*p),J=h(H*H+Y*Y);w=a(qg(y,e))/2,L=y[1]*e[0]-y[0]*e[1]>0?-1:1,T/=R,k/=R;var D=l/q(w),j=_(z,J)/n(w);R=Math.min(D,j);var U={x:V.x+L*R*T,y:V.y+L*R*k};return P.b&&D>J/n(w)&&(U.adjust=!0),U},yh=function(P){var A=P[1],N=P[2],T=P[3],f=P[6],I=P[7],c=P[11];P[1]=P[4],P[2]=P[8],P[3]=P[12],P[4]=A,P[6]=P[9],P[7]=P[13],P[8]=N,P[9]=f,P[11]=P[14],P[12]=T,P[13]=I,P[14]=c},Cq=function($){var i=$[0],h=$[1],Y=$[2],M=$[3],D=$[4],k=$[5],v=$[6],o=$[7],y=$[8],r=$[9],I=$[10],e=$[11],j=$[12],P=$[13],T=$[14],N=$[15],H=i*k-h*D,t=i*v-Y*D,L=i*o-M*D,w=h*v-Y*k,G=h*o-M*k,R=Y*o-M*v,S=y*P-r*j,n=y*T-I*j,O=y*N-e*j,X=r*T-I*P,l=r*N-e*P,Z=I*N-e*T,q=H*Z-t*l+L*X+w*O-G*n+R*S;return q?(q=1/q,$[0]=(k*Z-v*l+o*X)*q,$[1]=(Y*l-h*Z-M*X)*q,$[2]=(P*R-T*G+N*w)*q,$[3]=(I*G-r*R-e*w)*q,$[4]=(v*O-D*Z-o*n)*q,$[5]=(i*Z-Y*O+M*n)*q,$[6]=(T*L-j*R-N*t)*q,$[7]=(y*R-I*L+e*t)*q,$[8]=(D*l-k*O+o*S)*q,$[9]=(h*O-i*l-M*S)*q,$[10]=(j*G-P*L+N*H)*q,$[11]=(r*L-y*G-e*H)*q,$[12]=(k*n-D*X-v*S)*q,$[13]=(i*X-h*n+Y*S)*q,$[14]=(P*t-j*w-T*H)*q,$[15]=(y*w-r*t+I*H)*q,void 0):B},tg=function(n,p){if(p){var f=p[0],j=p[1],d=p[2];n[12]=n[0]*f+n[4]*j+n[8]*d+n[12],n[13]=n[1]*f+n[5]*j+n[9]*d+n[13],n[14]=n[2]*f+n[6]*j+n[10]*d+n[14],n[15]=n[3]*f+n[7]*j+n[11]*d+n[15]}},Kg=function(c,A){if(A){var D=A[0],m=A[1],s=A[2];c[0]=c[0]*D,c[1]=c[1]*D,c[2]=c[2]*D,c[3]=c[3]*D,c[4]=c[4]*m,c[5]=c[5]*m,c[6]=c[6]*m,c[7]=c[7]*m,c[8]=c[8]*s,c[9]=c[9]*s,c[10]=c[10]*s,c[11]=c[11]*s}},Yb=function(P,$,b){var t=$[0],d=$[1],W=$[2],x=$[3],B=$[4],v=$[5],n=$[6],k=$[7],g=$[8],c=$[9],S=$[10],e=$[11],V=$[12],F=$[13],f=$[14],Z=$[15],R=b[0],I=b[1],G=b[2],j=b[3];return P[0]=R*t+I*B+G*g+j*V,P[1]=R*d+I*v+G*c+j*F,P[2]=R*W+I*n+G*S+j*f,P[3]=R*x+I*k+G*e+j*Z,R=b[4],I=b[5],G=b[6],j=b[7],P[4]=R*t+I*B+G*g+j*V,P[5]=R*d+I*v+G*c+j*F,P[6]=R*W+I*n+G*S+j*f,P[7]=R*x+I*k+G*e+j*Z,R=b[8],I=b[9],G=b[10],j=b[11],P[8]=R*t+I*B+G*g+j*V,P[9]=R*d+I*v+G*c+j*F,P[10]=R*W+I*n+G*S+j*f,P[11]=R*x+I*k+G*e+j*Z,R=b[12],I=b[13],G=b[14],j=b[15],P[12]=R*t+I*B+G*g+j*V,P[13]=R*d+I*v+G*c+j*F,P[14]=R*W+I*n+G*S+j*f,P[15]=R*x+I*k+G*e+j*Z,P},Lj=function(X,p,U,L){var o,b,$,A,v,g,N,f,G,l,O=p[0],q=p[1],c=p[2],e=L[0],J=L[1],Y=L[2],H=U[0],I=U[1],E=U[2];return j(O-H)<Rm&&j(q-I)<Rm&&j(c-E)<Rm?Dc(X):(N=O-H,f=q-I,G=c-E,l=1/h(N*N+f*f+G*G),N*=l,f*=l,G*=l,o=J*G-Y*f,b=Y*N-e*G,$=e*f-J*N,l=h(o*o+b*b+$*$),l?(l=1/l,o*=l,b*=l,$*=l):(o=0,b=0,$=0),A=f*$-G*b,v=G*o-N*$,g=N*b-f*o,l=h(A*A+v*v+g*g),l?(l=1/l,A*=l,v*=l,g*=l):(A=0,v=0,g=0),X[0]=o,X[1]=A,X[2]=N,X[3]=0,X[4]=b,X[5]=v,X[6]=f,X[7]=0,X[8]=$,X[9]=g,X[10]=G,X[11]=0,X[12]=-(o*O+b*q+$*c),X[13]=-(A*O+v*q+g*c),X[14]=-(N*O+f*q+G*c),X[15]=1,X)},If=function(Z,p,s,I,H){var V=1/N(p/2),W=1/(I-H);return Z[0]=V/s,Z[1]=0,Z[2]=0,Z[3]=0,Z[4]=0,Z[5]=V,Z[6]=0,Z[7]=0,Z[8]=0,Z[9]=0,Z[10]=(H+I)*W,Z[11]=-1,Z[12]=0,Z[13]=0,Z[14]=2*H*I*W,Z[15]=0,Z},fn=function(e,_,d,z,T,F,r){var M=1/(_-d),c=1/(z-T),v=1/(F-r);return e[0]=-2*M,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*v,e[11]=0,e[12]=(_+d)*M,e[13]=(T+z)*c,e[14]=(r+F)*v,e[15]=1,e},Qq=function($,D){var c=D[0],F=D[1],o=D[2],g=D[3],h=c*c+F*F+o*o+g*g,b=h?1/h:0;return $[0]=-c*b,$[1]=-F*b,$[2]=-o*b,$[3]=g*b,$},zn=function(B,A){var U=A[0]+A[5]+A[10],L=0;return U>0?(L=2*Math.sqrt(U+1),B[3]=.25*L,B[0]=(A[6]-A[9])/L,B[1]=(A[8]-A[2])/L,B[2]=(A[1]-A[4])/L):A[0]>A[5]&A[0]>A[10]?(L=2*Math.sqrt(1+A[0]-A[5]-A[10]),B[3]=(A[6]-A[9])/L,B[0]=.25*L,B[1]=(A[1]+A[4])/L,B[2]=(A[8]+A[2])/L):A[5]>A[10]?(L=2*Math.sqrt(1+A[5]-A[0]-A[10]),B[3]=(A[8]-A[2])/L,B[0]=(A[1]+A[4])/L,B[1]=.25*L,B[2]=(A[6]+A[9])/L):(L=2*Math.sqrt(1+A[10]-A[0]-A[5]),B[3]=(A[1]-A[4])/L,B[0]=(A[8]+A[2])/L,B[1]=(A[6]+A[9])/L,B[2]=.25*L),B},uk=function(Z,U,N){var G=U[0],o=U[1],L=U[2],y=U[3],F=G+G,w=o+o,r=L+L,C=G*F,Y=G*w,E=G*r,g=o*w,c=o*r,K=L*r,t=y*F,A=y*w,R=y*r;return Z[0]=1-(g+K),Z[1]=Y+R,Z[2]=E-A,Z[3]=0,Z[4]=Y-R,Z[5]=1-(C+K),Z[6]=c+t,Z[7]=0,Z[8]=E+A,Z[9]=c-t,Z[10]=1-(C+g),Z[11]=0,Z[12]=N[0],Z[13]=N[1],Z[14]=N[2],Z[15]=1,Z},Yg=function(t,G){if(t.vr.enable){var s=t.vr.getViewMatrix(G);if(s)return s}return Lj(G?G:Gf(),t._eye,t._center,t._up)},tl=function(i,d){if(i.vr.enable){var e=i.vr.getProjectMatrix();if(e)return e}if(!d&&i._computedProjectMatrix)return rs(i._computedProjectMatrix);var V=i.getAspect(),y=i._near,_=i._far,x=Gf();if(i._ortho){var q=i._orthoWidth/2,$=q/V;fn(x,-q,q,-$,$,y,_)}else If(x,i._fovy,V,y,_);return x},gj=function(j,$){if(!j)return B;var X=0,t=1,i=2,U=[],J=0,O=j.length,I=O/3;if($){for(;O>J;J++)U[J]=0;for(J=0;J<$.length;J+=3){var r=[],Z=[],a=[];r[X]=j[3*$[J+1]+X]-j[3*$[J]+X],r[t]=j[3*$[J+1]+t]-j[3*$[J]+t],r[i]=j[3*$[J+1]+i]-j[3*$[J]+i],Z[X]=j[3*$[J+2]+X]-j[3*$[J+1]+X],Z[t]=j[3*$[J+2]+t]-j[3*$[J+1]+t],Z[i]=j[3*$[J+2]+i]-j[3*$[J+1]+i],a[X]=r[t]*Z[i]-r[i]*Z[t],a[t]=r[i]*Z[X]-r[X]*Z[i],a[i]=r[X]*Z[t]-r[t]*Z[X];for(var C=0;3>C;C++)U[3*$[J+C]+X]+=a[X],U[3*$[J+C]+t]+=a[t],U[3*$[J+C]+i]+=a[i]}}else for(J=0;I>J;J+=3){var r=[],Z=[],a=[];r[X]=j[3*(J+1)+X]-j[3*J+X],r[t]=j[3*(J+1)+t]-j[3*J+t],r[i]=j[3*(J+1)+i]-j[3*J+i],Z[X]=j[3*(J+2)+X]-j[3*(J+1)+X],Z[t]=j[3*(J+2)+t]-j[3*(J+1)+t],Z[i]=j[3*(J+2)+i]-j[3*(J+1)+i],a[X]=r[t]*Z[i]-r[i]*Z[t],a[t]=r[i]*Z[X]-r[X]*Z[i],a[i]=r[X]*Z[t]-r[t]*Z[X];for(var C=0;3>C;C++)U[3*(J+C)+X]=a[X],U[3*(J+C)+t]=a[t],U[3*(J+C)+i]=a[i]}for(J=0;O>J;J+=3){var d=[];d[X]=U[J+X],d[t]=U[J+t],d[i]=U[J+i];var g=h(d[X]*d[X]+d[t]*d[t]+d[i]*d[i]);0===g&&(g=Rm),d[X]=d[X]/g,d[t]=d[t]/g,d[i]=d[i]/g,U[J+X]=d[X],U[J+t]=d[t],U[J+i]=d[i]}return new Hf(U)},vc=function(x,h,p,K){if(p||(p=x.createTexture()),h){var L=x.TEXTURE_2D,c=x.REPEAT,Y=x.CLAMP_TO_EDGE,y=x.TEXTURE_MIN_FILTER;K!==x.NEAREST&&(K=x.LINEAR),x.activeTexture(x.TEXTURE0),eb(x,p),x.texImage2D(L,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,h),ph(x,x.TEXTURE_MAG_FILTER,K);var V=h.naturalWidth||h.width,g=h.naturalHeight||h.height;yl(V)&&yl(g)&&!h.clampToEdge?(ph(x,x.TEXTURE_WRAP_S,c),ph(x,x.TEXTURE_WRAP_T,c),ph(x,y,x.LINEAR_MIPMAP_LINEAR),x.generateMipmap(L)):(ph(x,x.TEXTURE_WRAP_S,Y),ph(x,x.TEXTURE_WRAP_T,Y),ph(x,y,K)),eb(x,B)}return p},Yh=function(M,s){var U=new Uint8Array(4);return s=s||M.createTexture(),M.activeTexture(M.TEXTURE0),eb(M,s),ph(M,M.TEXTURE_MIN_FILTER,M.LINEAR),M.texImage2D(M.TEXTURE_2D,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,U),s},ts=function(y,b){var C=new Uint8Array(4);return b=b||y.createTexture(),y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_CUBE_MAP,b),y.texParameteri(y.TEXTURE_CUBE_MAP,y.TEXTURE_MAG_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_CUBE_MAP,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,C),y.texImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,C),y.texImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,C),y.texImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,C),y.texImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,C),y.texImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,C),b},Rj=function(s){s._26I&&s._prg&&(s._26I.deleteProgram(s._prg),s._prg=B)},rp=function(d,B,m,w){var P=d.createShader(m);return d.shaderSource(P,w),d.compileShader(P),d.attachShader(B,P),P},Og=function(G){return G.createBuffer()},eb=function(w,R){w.bindTexture(w.TEXTURE_2D,R)},ph=function(Z,L,z){Z.texParameteri(Z.TEXTURE_2D,L,z)},$m=function(x,s){var c=cn.for(x).directState();c.polygonOffset.enable=!0,c.polygonOffset.value=s},Ro=function(c){var J=cn.for(c).directState();J.polygonOffset.enable=!1},go=function(L,M){if(M){var h=cn.for(L).directState();h.color.clear=Dk(M)}},de=function(k){var s=cn.for(k),F=s.directUniforms(),T=s.directAttribs();F.uFix=!0,T.aNormal=!1},kp=function(A){var J=cn.for(A),G=J.directUniforms();J.directAttribs(),G.uFix=!1},pc=function(i,t,g,q,p,$,d,h){var C=cn.for(i),H=C.directState(),W=C.directUniforms();C.directAttribs(),i._picking||(g?(W.uBlend=!0,W.uBlendColor=g):W.uBlend=!1,W.uLight=q==B?!0:q,Yp(p)&&1!==p&&(W.uPartOpacity=p),W.uReverseFlip=$==B?!1:$,W.uFixPickReverseColor=d||op),H.cullFace.enabled=h?!0:!1},Vf=function(O){if(!O._picking){var F=cn.for(O),w=F.directUniforms();F.directAttribs(),w.uPartOpacity=1}},Fn=function(){var X=[0,0,1,1];return function(L,m,a,F,r,u,M,h,T){var o=cn.for(L),S=o.directUniforms(),f=o.directAttribs();return a?(S.uTexture=!0,S.uDiscardSelectable=Bi(F)?F:!0,f.aUv=Wf(L,r,u,B,2),T?(S.uBlendTexture=!0,S.uBlendSampler=T):(S.uBlendTexture=!1,S.uBlendSampler=L._emptyBlendTexture),S.uSampler=a,M?(X[0]=M[0],X[1]=M[1]):(X[0]=0,X[1]=0),h?(X[2]=h[0],X[3]=h[1]):(X[2]=1,X[3]=1),S.uOffsetScale=X,void 0):(S.uSampler=L._emptyTexture,S.uBlendSampler=L._emptyBlendTexture,void 0)}}(),Hd=function(S,p,A){var w=cn.for(S),y=w.directUniforms(),O=w.directAttribs();S.activeTexture(S.TEXTURE0),eb(S,B),S.activeTexture(S.TEXTURE1),eb(S,B),A&&(O.aUv=!1,y.uTexture=!1,y.uSampler=S._emptyTexture,y.uBlendTexture=!1,y.uBlendSampler=S._emptyBlendTexture)},Wc=function(w,A,s,o,g,k){var G=cn.for(w),x=G.directUniforms(),R=G.directAttribs();!s||Tg||Bm||w.lineWidth(s),o&&!w._picking&&(x.uFixPickReverseColor=o),g&&(R.aPosition=Wf(w,g,k,B))},gn=function(w,b,u,R){bs&&(R=w[bs]),w.drawArrays(R==B?w.TRIANGLES:R,b,u);var z=w._renderInfo;z&&(z.calls++,z.vertices+=u,(R==B||R===w.TRIANGLES)&&(z.faces+=u/3),R===w.LINES&&(z.lines+=u/2))},uj=function(R,A,D,c){bs&&(c=R[bs]),R.drawElements(c==B?R.TRIANGLES:c,D,R.UNSIGNED_SHORT,A==B?0:2*A);var v=R._renderInfo;v&&(v.calls++,v.vertices+=D,(c==B||c===R.TRIANGLES)&&(v.faces+=D/3),c===R.LINES&&(v.lines+=D/2))},Jj=function(b,Q,x){var r=b.ARRAY_BUFFER;return b.bindBuffer(r,Q),x&&b.bufferData(r,x,b.STATIC_DRAW),Q},Wf=function(B,Q,O,V,F){return O?fj(B,B.ARRAY_BUFFER,Q,O):Jj(B,Q,O,V,F)},Re=function(R,E,D){var l=R.ELEMENT_ARRAY_BUFFER;R.bindBuffer(l,E),D&&R.bufferData(l,D,R.STATIC_DRAW)},vh=function(S,F,Z){fj(S,S.ELEMENT_ARRAY_BUFFER,F,Z)},fj=function(I,p,a,R){var n=R._bufId;n||(n=R._bufId=u.Math.generateIncreasingID());var a,Y=I._bufPool;return(a=Y[n])&&a._buf?I.bindBuffer(p,a._buf):(a=Y[n]={_buf:Og(I)},I.bindBuffer(p,a._buf),I.bufferData(p,R,I.STATIC_DRAW)),a._fid=I._renderInfo.frame,a._buf},Gd=function(D,x){var i=D.getGL();D._prg;var I=cn.for(i),a=I.directUniforms();I.directAttribs(),D._7O=D._8O.pop(),x&&(a.uMVMatrix=D._7O,D._6O=x,a.uNMatrix=x)},Hp=function(f,I){return I||(I=Gf()),qb(I,f),Cq(I),yh(I),I},rm=function(T,g){var w=T.getGL(),y=(T._prg,T._7O),$=cn.for(w),l=$.directUniforms();$.directAttribs(),g&&(T._8O.push(rs(y)),l.uMMatrix=g,Yb(y,y,g),T._7O=y),l.uMVMatrix=y,l.uNMatrix=Hp(y,T._6O)},xf={body:0,label:1,label2:2,note:3,note2:4},tm=10,uc=function(P,k,I,$,h,n){var L;if(I){var u=$._pickId;u||(u=$._pickId=k._pickIdUsed=k._pickIdUsed+tm);var t=u+xf[h];k[t]||(k[t]={data:$,part:h}),L=Fo(t)}else L=pf;if(!n){var Y=cn.for(P),C=Y.directUniforms();C.uFixPickReverseColor=L}return L},fs=function(){var y={center:function(o,k,q,L,O){var D=-k[1]/2,S={x:-k[0]/2,y:D,width:k[0],height:k[1]},f=hi(o,S,q);return[f.x+L,-f.y-O,er()]},front:function(O,M,v,H,T){var p=-M[1]/2,V={x:-M[0]/2,y:p,width:M[0],height:M[1]},j=hi(O,V,v);return[j.x+H,-j.y-T,M[2]/2+er()]},back:function(u,M,L,n,o){var l=-M[0]/2,V=-M[1]/2,_={x:l,y:V,width:M[0],height:M[1]},w=hi(u,_,L);return[-w.x-n,-w.y-o,-M[2]/2-er()]},left:function(i,W,m,u,f){var d=-W[1]/2,a={x:-W[2]/2,y:d,width:W[2],height:W[1]},T=hi(i,a,m);return[-W[0]/2-er(),-T.y-f,T.x+u]},right:function(R,z,m,F,J){var G=-z[2]/2,M=-z[1]/2,o={x:G,y:M,width:z[2],height:z[1]},h=hi(R,o,m);return[z[0]/2+er(),-h.y-J,-h.x-F]},top:function(X,o,b,N,n){var I={x:-o[0]/2,y:-o[2]/2,width:o[0],height:o[2]},z=hi(X,I,b);return[z.x+N,o[1]/2+er(),z.y+n]},bottom:function(y,n,d,L,R){var U=-n[2]/2,B={x:-n[0]/2,y:U,width:n[0],height:n[2]},M=hi(y,B,d);return[M.x+L,-n[1]/2-er(),-M.y-R]}};return function(n,s,z,r,v,Q){return y[r](n,s,z,v||0,Q||0)}}(),jd=function(F,w,c,b,M,v,P,x,W,e){if(M&&(w[0]+=M[0],w[1]+=M[1],w[2]+=M[2]),tg(F,c),x){var K=Gf();if(Xh(K,W,e),wd(w,K),tg(F,w),F.auto=x,F.pos=wd([0,0,0],F),v){var I=F.mat2=Gf();Xh(I,v,P)}}else Xh(F,W,e),tg(F,w),b===ue?Ze(F,-L):b===cg?Ze(F,L):b===Xn?lp(F,-L):b===id?lp(F,L):b===wl&&Ze(F,R),Xh(F,v,P);return F},as=function(x,W){var Z=W.auto,f=W.mat2,q=x.gv;if(Z){var J,e=Gf(),a=[0,0,0,0];J="string"==typeof Z?[Z.indexOf("x")<0?q._eye[0]:q._center[0],Z.indexOf("y")<0?q._eye[1]:q._center[1],Z.indexOf("z")<0?q._eye[2]:q._center[2]]:q._eye,zn(a,Lj(Gf(),J,q._center,q._up)),uk(e,Qq(a,a),W.pos),f&&Yb(e,e,f),rm(q,e)}else rm(q,W)},xi=function(M,E,N,L,F){var e=M.s,u=M.gv,G=u.getGL(),P=u._prg,c=u._buffer,H=u._1O,r=cn.for(G),w=r.directAttribs();
vc(G,Up,H),as(M,N),pc(G,P,e(E+".blend"),e(E+".light"),e(E+".opacity"),e(E+".reverse.flip"),e(E+".reverse.color"),e(E+".reverse.cull")),Fn(G,P,H,F,c.uv,fm),w.aPosition=Wf(G,c.vs,L,B),w.aNormal=Wf(G,c.ns,nr,B),vh(G,c.is,Mq),uj(G,0,Mq.length),Hd(G,P,H),Vf(G,P),Gd(u)},vj=function(i,o,M){var U=i.gv,f=i.data,b=i[o]={blend:U.getBodyColor(f)||U.getFaceBlend(f,o),light:U.getFaceLight(f,o),color:U.getFaceColor(f,o),opacity:U.getFaceOpacity(f,o),transparent:U.getFaceTransparent(f,o),reverseFlip:U.getFaceReverseFlip(f,o),reverseColor:U.getFaceReverseColor(f,o),reverseCull:U.getFaceReverseCull(f,o),texture:U.getFaceImage(f,o),blendTexture:U.getFaceBlendImage(f,o),discardSelectable:U.getFaceDiscardSelectable(f,o)};if("csg"!==o){b.uv=U.getFaceUv(f,o)||M&&M[o+"Uv"],b.uvScale=U.getFaceUvScale(f,o)||M&&M[o+"UvScale"],b.uvOffset=U.getFaceUvOffset(f,o)||M&&M[o+"UvOffset"];var v=U.getFaceMat(f,o);v&&(b.mat=Lm(f,v))}return b},Rl=function(K,C,N,m,T){if(m){if(!T(m.transparent))return;var U=K.data,D=K.gv,v=D._buffer,r=D.getTexture(m.texture,U),t=D.getTexture(m.blendTexture,U),Z=cn.for(C),o=Z.directUniforms(),q=Z.directAttribs();Fn(C,N,r,m.discardSelectable,v.uv,m.tuv,m.uvOffset,m.uvScale,t),pc(C,N,m.blend,m.light,m.opacity,m.reverseFlip,m.reverseColor,m.reverseCull),o.uDiffuse=m.color||F["color.empty"],q.aPosition=Wf(C,v.vs,m.vs,B),q.aNormal=Wf(C,v.ns,m.ns,B),gn(C,0,m.vs.length/3),Vf(C,N),Hd(C,N,r)}},Qm=function(m,u,F,f,q,X){var o,N,s,l,g,t,p,O,k,J,Z,$=[f-u,q-F],A=m?m.length:0;for(s=0;A>s;s++){for(l=2,o=m[s],g=o[0],t=o[1];l+1<o.length;){if(p=o[l],O=o[l+1],N=Qb(u,F,f,q,g,t,p,O,!0)){k=[p-g,O-t],J=Ke(k),k[0]/=J,k[1]/=J,J=qg($,k),J=J>0?X:-X,Z=[k[0]*J,k[1]*J];break}g=p,t=O,l+=2}if(Z)break}if(Z)for(f=u+Z[0],q=F+Z[1],s=0;A>s;s++)for(l=2,o=m[s],g=o[0],t=o[1];l+1<o.length;){if(p=o[l],O=o[l+1],N=Qb(u,F,f,q,g,t,p,O,!0))return[0,0];g=p,t=O,l+=2}return Z?Z:[f-u,q-F]},Uh=u.graph3d={},ys=function(v,K,c){eh(A+".graph3d."+v,K,c)},ci="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",ed="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<*1/2!;!*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit!)xpebiTufh!@!fwjfdfSxpebit)!+!zujtofuoJxpebit!,!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!qe!-*!z/f{jTmfyfu!-yyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*!2!-2!.!)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!}}!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!<*!opjujtpQpUuihjm!)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*!sbfObsfnbDxpebit!.!sbGbsfnbDxpebit!)!0!*!sbfObsfnbDxpebit!.!*!opjujtpQpUuihjm!)iuhofm!)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<*!*!1/3!-1/5!)3dfw!+!f{jTqbNxpebit!)!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*!sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*!68/1!-684/1!)3dfw!,!sbobmq!+!*!63/1!-632/1!)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!z/w!)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!z/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!y/w!)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!y/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*!1/1!?!{/w!)!gj!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!{/Wtcb!)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*!Zf{jTmfyfu!+!1/3!.!1/2!)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<*!*!{/Wtcb!-z/Wtcb!)ybn!-y/Wtcb!)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*!w!)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*!Zf{jTmfyfu!ubpmg!-w!4dfw!)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!gjmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!|!*!utfUnvutvsg!)!gj!!!!!!!!!!!!<*!dfWutfUnvutvsg!)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*!1/2!>=!{/esppDxpebit!-nvutvsGoj!)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*!dfWnvutvsGoj!)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*!1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit!)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*!esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*!y/g!-c!-b!)yjn!>!d!ubpmg!!!!!!!!!!!!<*!z/g!-us!-cs!)yjn!>!c!ubpmg!!!!!!!!!!!!<*!z/g!-um!-cm!)yjn!>!b!ubpmg!!!!!!!!!!!!<*!6/1!,!f{jt!+!wv!)udbsg!>!g!3dfw!!!!!!!!!!!!<*!fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*!6/1!,!f{jt!+!wv!)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*!1/2!-1/1!)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt!)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!*!*!wv!-tiuqfe!)E3fsvuyfu!)iuqfEpUBCHSldbqov!-fsbqnpd!)qfut!osvufs!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt!)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!tspudbGldbqoV!-w!)upe!osvufs|!*!w!5dfw!oj!utopd!)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*!/2!-tspudbGldbQ!)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*!/763!!-/763!+!/763!-/763!+!/763!+!/763!)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";_p(w,{setBatchInfo:function(V,q){Qn[V]=q},getBatchInfo:function(j){return Qn[j]}},!0);var re=[1,1,1],Td=[1,0,0,0,0,1,0,1,1,1,1,0],fo=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],iq=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],wj=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],hb=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],ej=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Fc=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],ab=function(y,l){var u=y._renderLists;if(l){var o=l.getRenderLayer(),p=u.get(o);p&&p.ivBatch(l)}else u.each(function(f){f.ivBatch()})},cd=function(r,F,j){var D=j._id,Q=F[D];if(Q){var C=Q.batch,R=r[C],G=R.ds,A=Q.index;if(R.invalidate=!0,delete F[D],G.splice(A,1),$c(G))return delete r[C],void 0;for(var M=Q.begin,K=Q.size,e=3*M,u=3*K,N=4*M,o=4*K,W=R.vs,n=R.ps,i=R.uv,Z=R.cs,E=R.bs,b=R.rs,J=R.ns,S=R.ls;A<G.length;A++)Q=F[G[A]._id],Q.index--,Q.begin-=K;W.splice(e,u),n.splice(N,o),i&&i.splice(2*M,2*K),Z&&Z.splice(N,o),E&&E.splice(e,u),b&&b.splice(M,K),J&&J.splice(e,u),S&&S.splice(M,K)}},fi=function(l,v,m,M){if(!M)return B;var S=v[M];if(!S){var r=Qn[M]||Vr,e=r.image?[]:B;S=v[M]={vs:[],ns:[],uv:e,cs:e?B:r.color?B:[],bs:r.blend?[]:B,ps:[],rs:r.brightness?[]:B,ds:[]}}return S.invalidate=!0,l[m._id]={index:S.ds.length,begin:S.vs.length/3,batch:M},S.ds.push(m),S},Qp=function(S,P){return P!=B&&1!==P?[S[0]*P,S[1]*P,S[2]*P,S[3]]:S},Ae=function(){var r;return function(x,g,F){var S=x.getData3dUI(g),t=S.shapeModel;t||(t=ds(S));var N,P=g.s("wf.combineTriangle");if(F.geometry){if(!t&&(g instanceof u.Node&&!(g instanceof u.Shape)?(r||(r={vs:ic,is:Ar,uv:xp}),t=r):t=[S.left,S.front,S.right,S.back,S.top,S.bottom],!t))return I;if(N=P!==!1?Ah(t):vm(t),!N)return}else N=F.short?Xj:vp;var $=x.getBrightness(g),Q=Dk(F.color||"white"),H=Q[3]<1,C=Math.ceil(F.width)||1,s=(H?"T":"O")+C,W=g.getRenderLayer(),D=x._renderLists.get(W),_=D.wireframeIndexMap,c=D.wireframeModelMap,o=c[s];o||(o=c[s]={vs:[],cs:[],ps:[],ds:[],T:H,W:C}),o.invalidate=!0;var f=o.vs,X=o.cs,y=o.ds,B=_[g._id]={index:y.length,begin:f.length/3,batch:s};y.push(g);var j=S.mat;if(!j){j=Lm(g,F.mat);var v=S._calcAnchorMat(g);v&&Yb(j,j,v)}vr(f,j,N);var w=B.size=f.length/3-B.begin;ro(X,Qp(Q,$),w)}}(),hf=function(z,j,s,k,F,Z,$,v,m){var J=z.getBrightness(j);J==B&&(J=1);var u=Qp(Dk(k),J),Q=u[3]<1;Z=Math.ceil(Z)||1;var t=(Q?"T":"O")+Z;if($){var O=$[0],n=($[1]||O)+O;t+="-"+O+"-"+n,m&&(t+="-"+Lk(m)+"-"+J,m=Qp(Dk(m),J))}var x=j.getRenderLayer(),S=z._renderLists.get(x),Y=S.polylineIndexMap,M=S.polylineModelMap,U=M[t];U||(U=M[t]={vs:[],cs:[],ps:[],ds:[],ls:$?[]:B,T:Q,W:Z},$&&(U.D=O,U.G=n,U.A=m)),U.invalidate=!0;var L,q=U.vs,l=U.cs,X=U.ds,V=U.ls,R=Y[j._id]={index:X.length,begin:q.length/3,batch:t};X.push(j),Md(q,s);var C,r=R.size=q.length/3-R.begin,E=s.length,_=0,A=[];if($||F)for(L=0;E>L;L+=6)C=Ke([s[L],s[L+1],s[L+2]],[s[L+3],s[L+4],s[L+5]]),A.push(C),_+=C;if(_&&F){var I,w=Qp(Dk(F),J),p=[w[0]-u[0],w[1]-u[1],w[2]-u[2],w[3]-u[3]],K=0;for(L=0;E>L;L+=6)I=K/_,ro(l,[u[0]+p[0]*I,u[1]+p[1]*I,u[2]+p[2]*I,u[3]+p[3]*I],1),K+=A[L/6],I=K/_,ro(l,[u[0]+p[0]*I,u[1]+p[1]*I,u[2]+p[2]*I,u[3]+p[3]*I],1)}else ro(l,u,r);if($)for(K=v||0,L=0;E>L;L+=6)V.push(K),K+=A[L/6],V.push(K)},al=function(S,s,Q){if(s){var V=4*s.begin,D=Q[s.batch].ps;if(D[V]!==S[0]||D[V+1]!==S[1]||D[V+2]!==S[2]||D[V+3]!==S[3]){for(var e=0;e<s.size;e++)D[V++]=S[0],D[V++]=S[1],D[V++]=S[2],D[V++]=S[3];D._invalidateThisFrame=!0}}},Je=function(s,t){var m=t+["32"],N=s[t],C=s[m];N?C&&C.length===N.length?(C.set(N),C._bufId=null):s[m]=new Hf(N):delete s[m]},ml=function(R,b,Z,O,U,P,V,F,a){if(Zh(Z))Z.forEach(function(p){ml(R,b,p,O,U,P,V,F,a)});else if(Ug(Z))ml(R,b,ds(O,Z),O,U,P,V,F,a);else if(ei(Z)){var A,s=lg(Z.mat,b,R),g=lg(Z.s3,b,R),k=lg(Z.t3,b,R),C=lg(Z.r3,b,R);if((g||C||k||s)&&(A=se(s,g,C,lg(Z.rotationMode,b,R),k),P.push(A)),Z.shape3d)ml(R,b,Z.shape3d,O,U,P,V,F,Z);else{var _=O.s;a=a||Vr;var o=P[0],m=P.length,w=_("shape3d.color",Z.color,a.color);if(U||(U=_("shape3d.blend",Z.blend,a.blend)),m>1){o=rs(o);for(var J=1;m>J;J++)Yb(o,o,P[J])}Z.vs&&_(Yj,Z.visible,a.visible)&&Dg(o,V,F,Z.vs,Z.uv,Z.is,U,w),Z.top_vs&&_(sg,Z.topVisible,a.topVisible)&&Dg(o,V,F,Z.top_vs,Z.top_uv,Z.top_is,U,_("shape3d.top.color",Z.topColor,a.topColor)||w),Z.bottom_vs&&_(Of,Z.bottomVisible,a.bottomVisible)&&Dg(o,V,F,Z.bottom_vs,Z.bottom_uv,Z.bottom_is,U,_("shape3d.bottom.color",Z.bottomColor,a.bottomColor)||w),Z.from_vs&&_(ui,Z.fromVisible,a.fromVisible)&&Dg(o,V,F,Z.from_vs,Z.from_uv,Z.from_is,U,_("shape3d.from.color",Z.fromColor,a.fromColor)||w),Z.to_vs&&_(Co,Z.toVisible,a.toVisible)&&Dg(o,V,F,Z.to_vs,Z.to_uv,Z.to_is,U,_("shape3d.to.color",Z.toColor,a.toColor)||w)}A&&P.pop()}},Dg=function(D,a,Y,x,g,N,u,h){var e,G=a.cs,j=a.uv,H=a.bs;if(N){e=N.length;for(var X=0;e>X;X++){var R=N[X];vr(Y,D,[x[3*R],x[3*R+1],x[3*R+2]]),j&&Md(j,[g[2*R],g[2*R+1]])}}else e=x.length/3,vr(Y,D,x),j&&Md(j,g);G&&ro(G,h,e),H&&(u?Fp(H,u,e):Md(H,re,e))},ob=function(Y,Z,i,h){var J=[];h?ml(Y.gv,Y.data,h,Y,Y.getBodyColor(),[Z],i,J):(Bs(Y,ue,Z,i,J),Bs(Y,cg,Z,i,J),Bs(Y,yn,Z,i,J),Bs(Y,wl,Z,i,J),Bs(Y,Xn,Z,i,J),Bs(Y,id,Z,i,J),Bs(Y,"csg",Z,i,J)),J.length&&(Md(i.vs,J),Md(i.ns,gj(J)))},Bs=function(C,y,V,r,W){var g=C[y];if(g){var Y=g.tuv;if(Y){var N,$,G,O,I=g.uvScale,f=g.uvOffset;if(I)for(N=Y.length,$=I[0],G=I[1],O=0;N>O;O+=2)Y[O]*=$,Y[O+1]*=G;if(f)for(N=Y.length,$=f[0],G=f[1],O=0;N>O;O+=2)Y[O]+=$,Y[O+1]+=G}Dg(V,r,W,g.vs,Y,B,g.blend,g.color)}},mg=function(o,b,_,R,X,G,U,M){var t,s=_.cs,W=_.uv,d=_.bs;if(o.getFaceVisible(b,G)){var y=o.getFaceMat(b,G);if(y&&(X=Lm(b,y)),vr(U,X,M),s&&ro(s,o.getFaceColor(b,G),6),W){var E=o.getFaceUv(b,G)||R[G+"Uv"],i=o.getFaceUvScale(b,G)||R[G+"UvScale"],Z=o.getFaceUvOffset(b,G)||R[G+"UvOffset"];E=E?[E[6],E[7],E[0],E[1],E[2],E[3],E[2],E[3],E[4],E[5],E[6],E[7]]:Td;var v=E[0],A=E[1],C=E[2],u=E[3],J=E[4],n=E[5],F=E[6],L=E[7],O=E[8],P=E[9],I=E[10],q=E[11];if(i){var r=i[0],h=i[1];v*=r,A*=h,C*=r,u*=h,J*=r,n*=h,F*=r,L*=h,O*=r,P*=h,I*=r,q*=h}if(Z){var H=Z[0],f=Z[1];v+=H,A+=f,C+=H,u+=f,J+=H,n+=f,F+=H,L+=f,O+=H,P+=f,I+=H,q+=f}W.push(v,A,C,u,J,n,F,L,O,P,I,q)}d&&(t=o.getBodyColor(b)||o.getFaceBlend(b,G),t?Fp(d,t,6):Md(d,re,6))}},Wl=function(V,R,U,S){var U=V._picking?V.pickColorMap:null,l=V.getGL(),n=V._prg,t=V._buffer;if(!dg(R)){rm(V),de(l,n);for(var s in R){var O=R[s];if(!(S&&!O.T||!S&&O.T)){O.invalidate?(O.invalidate=!1,Je(O,"vs"),Je(O,"cs"),Je(O,"ls"),Je(O,"ps")):U&&O.ps&&O.ps._invalidateThisFrame&&(O.ps._invalidateThisFrame=!1,Je(O,"ps"));var P=O.vs32,Y=U?O.ps32:O.cs32;Wc(l,n,O.W,B,t.vs,P);var K=cn.for(l),H=K.directUniforms(),f=K.directAttribs(),L=O.D,i=!V._dashDisabled&&L;H.uAlphaTest=F.alphaTest,i&&(H.uDash=!0,H.uDashDistance=L,H.uDashGapDistance=O.G,H.uDiffuse=O.A||F["color.empty"],f.aLineDistance=Wf(l,t.lineDistance,O.ls32,B,1));var o=!V._batchColorDisabled;o&&(H.uBatchColor=!0,f.aBatchColor=Wf(l,t.batchColor,Y,B,4)),Fn(l),gn(l,0,P.length/3,l.LINES),Hd(l),o&&(H.uBatchColor=!1,f.aBatchColor=!1),i&&(H.uDash=!1,f.aLineDistance=!1)}}kp(l,n)}},$f=function(S,m,N,$,j){var n,O,b,i,c,R,e,H,Z,k,L,N=S._picking?S.pickColorMap:null,D=S.getGL(),Y=S._prg,w=cn.for(D),f=w.directUniforms(),u=w.directAttribs(),v=S._buffer;if(!dg(m)){rm(S);for(n in m)if(O=Qn[n]||Vr,!($&&!O.transparent||!$&&O.transparent)){var g=O.renderLayerMask;if(g==B&&(g=xs),j==B&&(j=xs),ub(j,g)&&(b=m[n],N||!O.transparentMask)){var G=$&&O.autoSort!==!1&&(S._33Q||b.invalidate);if(b.invalidate?(b.invalidate=!1,Je(b,"vs"),Je(b,"ns"),Je(b,"cs"),Je(b,"rs"),Je(b,"ps"),Je(b,"bs"),Je(b,"uv")):N&&b.ps&&b.ps._invalidateThisFrame&&(b.ps._invalidateThisFrame=!1,Je(b,"ps")),c=b.vs32,R=N?b.ps32:b.cs32,Z=b.uv32,e=b.bs32,H=b.rs32,L=c.length/3,G&&(b.is=Gk(c,S.getEye())),L){i=O.light,k=S.getTexture(O.image),pc(D,Y,B,O.light,O.opacity,O.reverseFlip,O.reverseColor,O.reverseCull),R?S._batchColorDisabled||(f.uBatchColor=!0,u.aBatchColor=Wf(D,v.batchColor,R,B,4)):f.uDiffuse=O.color||F["color.empty"];var p=O.alphaTest;f.uAlphaTest=p===I?F.alphaTest:p;var o=e&&!S._batchBlendDisabled;o&&(f.uBatchBlend=!0,u.aBatchBlend=Wf(D,v.batchBlend,e,B));var W=H&&!S._batchBrightnessDisabled;W&&(f.uBatchBrightness=!0,u.aBatchBrightness=Wf(D,v.batchBrightness,H,B,1)),Z?Fn(D,Y,k,O.discardSelectable,v.uv,Z,O.uvOffset,O.uvScale):Fn(D),u.aPosition=Wf(D,v.vs,c,B),u.aNormal=Wf(D,v.ns,b.ns32,B),b.is?(Re(D,v.is,b.is),uj(D,0,L)):gn(D,0,L),Z?Hd(D,Y,k):Hd(D),R&&!S._batchColorDisabled&&(f.uBatchColor=!1,u.aBatchColor=!1),o&&(f.uBatchBlend=!1,u.aBatchBlend=!1),W&&(f.uBatchBrightness=!1,u.aBatchBrightness=!1),Vf(D,Y)}}}}},Gk=function(e,T){for(var q=e.length/3,$=new Array(q),p=q/3,U=new Array(p),Q=0;p>Q;Q++)U[Q]=Q;U.sort(function(i,J){var x=9*i,I=[(e[x]+e[x+3]+2*e[x+6])/4,(e[x+1]+e[x+4]+2*e[x+7])/4,(e[x+2]+e[x+5]+2*e[x+8])/4];x=9*J;var m=[(e[x]+e[x+3]+2*e[x+6])/4,(e[x+1]+e[x+4]+2*e[x+7])/4,(e[x+2]+e[x+5]+2*e[x+8])/4],E=Ke(T,I)-Ke(T,m);return E>0?-1:0>E?1:0});for(var Q=0;p>Q;Q++){var I=3*Q,L=3*U[Q];$[I]=L,$[I+1]=L+1,$[I+2]=L+2}return new rg($)},Vh={obj:function(Q,T){var F={mat:Q.mat,s3:Q.s3,r3:Q.r3,rotationMode:Q.rotationMode,t3:Q.t3,cube:Q.cube==B?!0:Q.cube,center:Q.center==B?!0:Q.center,ignoreMtls:Q.ignoreMtls,ignoreTransparent:Q.ignoreTransparent,ignoreColor:Q.ignoreColor,ignoreImage:Q.ignoreImage,ignoreNormal:Q.ignoreNormal,prefix:Q.prefix,flipY:Q.flipY,flipFace:Q.flipFace,reverseFlipMtls:Q.reverseFlipMtls,finishFunc:function(d,l){if(d){var l=[];for(var p in d){var E=d[p];l.rawS3=E.rawS3,l.push(E),Q.eachModel&&Q.eachModel(p,E)}l.json=Q,T(l)}else T()}};w.loadObj(Q.obj,Q.mtl,F)}};w.getModelTypeHandlers=function(){return Vh},w.setModelTypeHandler=function(c,n){Vh[c]=n},w.getModelTypeHandler=function(T){return Vh[T]},w.handleModelLoaded=function(){},w.handleUnfoundModel=function(){};var ok=B,vb=B,fk=function(l){ok&&!l._loadingModelView_&&(vb||(vb={}),vb[l._loadingModelView_=No()]=l)},ho=function(F,h){ok||(ok={});var T=ok[F];if(T){if(T.url===h)return;T.request.onload=Zr,T.request.onerror=Zr}var V=new $n;if(ok[F]={request:V,url:h},h=w.beforeLoadURL(h),h.data){var x=w.parse(h.data);Yf(F,x,h)}else{V.onload=function(){if(200===this.status||0===this.status){delete ok[F];var $=w.parse(V.getResponseText());Yf(F,$,h)}else mp(F,w.handleUnfoundModel(F,h)||B)},V.onerror=function(){mp(F,w.handleUnfoundModel(F,h)||B)};var _={};_.url=encodeURI(h),_.sync=!1,V.send(_)}},Yf=function(M,C,d){var x=C.modelType;if(!x)return mp(M,C),w.handleModelLoaded(M,C),void 0;var V=w.getModelTypeHandler(x);if(V){if(ok||(ok={}),ok[M])return;ok[M]=!0;var k=function(_){_?(mp(M,_),w.handleModelLoaded(M,_)):mp(M,w.handleUnfoundModel(M,d)||B)};V(C,k)}else mp(M,w.handleUnfoundModel(M,d)||B)},mp=function(M,k){if(ik[M]=k,delete ok[M],dg(ok)&&(ok=B,vb)){for(var S in vb){var N=vb[S];N.invalidateAll&&N.invalidateAll(I,"modelLoaded",M),N.redraw&&N.redraw(),N.iv(),delete N._loadingModelView_}vb=B}if(k&&vb)for(var S in vb){var N=vb[S];N.invalidateAll&&N.invalidateAll(I,"modelLoading",M),N.redraw&&N.redraw(),N.iv()}},fm=new Hf([0,0,0,1,1,1,1,0]),nr=new Hf([0,0,1,0,0,1,0,0,1,0,0,1]),Mq=new rg([0,1,2,2,3,0]),ic=new Hf([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Ar=new rg([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),xp=new Hf([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),vf=gj(ic,Ar),zl=(new Hf([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new rg([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[ue,yn,cg,wl,Xn,id]),vp=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Xj=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Hm=function(h,b,D,J,H,j){j=j||16,h=h||16,b=b||0,D=D||h;var c,k,C,A,i,Y,E,N,a=.5,o=[],I=[],G=z/h,y=R/j;for(c=0;j>c;c++)for(i=c+1,A=c*y,N=i*y,k=b;D>k;k++)Y=k+1,C=k*G,E=Y*G,o.push(a*q(A)*n(C),a*n(A),-a*q(A)*q(C),a*q(N)*n(E),a*n(N),-a*q(N)*q(E),a*q(A)*n(E),a*n(A),-a*q(A)*q(E),a*q(A)*n(C),a*n(A),-a*q(A)*q(C),a*q(N)*n(C),a*n(N),-a*q(N)*q(C),a*q(N)*n(E),a*n(N),-a*q(N)*q(E)),I.push(k/h,c/j,Y/h,i/j,Y/h,c/j,k/h,c/j,k/h,i/j,Y/h,i/j);if(J){var Q=[],u=[];for(C=b*G,c=0;j>c;c++)i=c+1,A=c*y,N=i*y,Q.push(0,0,0,a*q(N)*n(C),a*n(N),-a*q(N)*q(C),a*q(A)*n(C),a*n(A),-a*q(A)*q(C)),u.push(0,.5,b/h,i/j,b/h,c/j)}if(H){var P=[],w=[];for(C=D*G,c=0;j>c;c++)i=c+1,A=c*y,N=i*y,P.push(0,0,0,a*q(A)*n(C),a*n(A),-a*q(A)*q(C),a*q(N)*n(C),a*n(N),-a*q(N)*q(C)),w.push(1,.5,D/h,c/j,D/h,i/j)}return{vs:o,uv:I,from_vs:Q,from_uv:u,to_vs:P,to_uv:w}},oe=function(A,U,Y){A=A||.17,U=U||12,Y=Y||18,0>A?A=0:A>.25&&(A=.25);var i,M,F,O,u,X,I,T=.5,K=[],G=[],C=[],V=z/Y,J=z/U,h=T-A;for(M=0;U>=M;M++)for(O=-R+M*J,X=n(O),u=q(O),i=0;Y>=i;i++)F=i*V,I=h+A*X,K.push(n(F)*I,u*A,-q(F)*I),G.push(i/Y,1-M/U);for(M=0;U>M;M++){var s=M*(Y+1),c=(M+1)*(Y+1);for(i=0;Y>i;i++)C.push(s+i,c+i+1,c+i,s+i,s+i+1,c+i+1)}return{vs:K,uv:G,is:C}},Db=function(H,O,L,p,N,o,D){D=D||12,H=H||18,O=O||0,L=L||H,o=o||.17,0>o?o=0:o>.25&&(o=.25);var b,Y,m,l,g,w,E,h,e,V,v=.5,f=[],B=[],W=z/H,y=z/D,P=v-o;for(m=0;D>m;m++)for(l=m+1,E=-R+m*y,h=-R+l*y,b=O;L>b;b++)Y=b+1,g=b*W,w=Y*W,e=P+o*n(E),V=P+o*n(h),f.push(n(g)*e,q(E)*o,-q(g)*e,n(w)*e,q(E)*o,-q(w)*e,n(w)*V,q(h)*o,-q(w)*V,n(g)*e,q(E)*o,-q(g)*e,n(w)*V,q(h)*o,-q(w)*V,n(g)*V,q(h)*o,-q(g)*V),B.push(b/H,1-m/D,Y/H,1-m/D,Y/H,1-l/D,b/H,1-m/D,Y/H,1-l/D,b/H,1-l/D);if(p){var u=[],x=[];for(m=0;D>m;m++)l=m+1,E=-R+m*y,h=-R+l*y,g=O*W,e=P+o*n(E),V=P+o*n(h),u.push(n(g)*e,q(E)*o,-q(g)*e,n(g)*V,q(h)*o,-q(g)*V,n(g)*P,0,-q(g)*P),x.push(.5+.5*n(E),.5-.5*q(E),.5+.5*n(h),.5-.5*q(h),.5,.5)
}if(N){var j=[],_=[];for(m=0;D>m;m++)l=m+1,E=-R+m*y,h=-R+l*y,g=L*W,e=P+o*n(E),V=P+o*n(h),j.push(n(g)*e,q(E)*o,-q(g)*e,n(g)*P,0,-q(g)*P,n(g)*V,q(h)*o,-q(g)*V),_.push(.5-.5*n(E),.5-.5*q(E),.5,.5,.5-.5*n(h),.5-.5*q(h))}return{vs:f,uv:B,from_vs:u,from_uv:x,to_vs:j,to_uv:_}},Kj=function(Y,F){for(var N,O,c,l=.5,b=16,U=[],E=[],V=[],v=z/b,k=0;b>=k;k++)N=k*v,O=n(N)*l,c=q(N)*l,U.push(O,-l,c,O,l,c),E.push(1-k/b,1,1-k/b,0);for(k=0;b>k;k++)V.push(2*k,2*k+1,2*k+3,2*k,2*k+3,2*k+2);if(F){var y=[],K=[],L=[];for(y.push(0,-l,0),K.push(.5,.5),k=0;b>=k;k++)N=k*v,O=n(N),c=q(N),y.push(O*l,-l,-c*l),K.push(.5+.5*O,.5+.5*c);for(k=0;b>k;k++)L.push(0,k+2,k+1)}if(Y){var X=[],t=[],e=[];for(X.push(0,l,0),t.push(.5,.5),k=0;b>=k;k++)N=k*v,O=n(N),c=q(N),X.push(O*l,l,-c*l),t.push(.5+.5*O,.5-.5*c);for(k=0;b>k;k++)e.push(0,k+1,k+2)}return{vs:U,uv:E,is:V,bottom_vs:y,bottom_uv:K,bottom_is:L,top_vs:X,top_uv:t,top_is:e}},ni=function(A,y,F,W,Z,N,Q){A=A||12,y=y||0,F=F||A;for(var e,s,C,d,v,g,r,b,f=.5,x=[],$=[],_=z/A,H=y;F>H;H++)e=H+1,s=H*_,C=e*_,d=n(s)*f,v=q(s)*f,g=n(C)*f,r=q(C)*f,x.push(d,-f,-v,g,-f,-r,d,f,-v,g,-f,-r,g,f,-r,d,f,-v),$.push(H/A,1,e/A,1,H/A,0,e/A,1,e/A,0,H/A,0);if(Q){var m=[],L=[];for(H=y;F>H;H++)s=_*H,C=_*(H+1),d=n(s),v=q(s),g=n(C),r=q(C),m.push(d*f,-f,-v*f,0,-f,0,g*f,-f,-r*f),L.push(.5+.5*d,.5+.5*v,.5,.5,.5+.5*g,.5+.5*r)}if(N){var I=[],h=[];for(H=y;F>H;H++)s=_*H,C=_*(H+1),d=n(s),v=q(s),g=n(C),r=q(C),I.push(d*f,f,-v*f,g*f,f,-r*f,0,f,0),h.push(.5+.5*d,.5-.5*v,.5+.5*g,.5-.5*r,.5,.5)}if(W){var M=[],P=[];s=_*y,d=n(s)*f,v=q(s)*f,b=y/A,M.push(0,f,0,0,-f,0,d,-f,-v,d,-f,-v,d,f,-v,0,f,0),P.push(0,0,0,1,b,1,b,1,b,0,0,0)}if(Z){var R=[],E=[];s=_*F,d=n(s)*f,v=q(s)*f,b=F/A,R.push(0,-f,0,0,f,0,d,f,-v,d,f,-v,d,-f,-v,0,-f,0),E.push(1,1,1,0,b,0,b,0,b,1,1,1)}return{vs:x,uv:$,bottom_vs:m,bottom_uv:L,top_vs:I,top_uv:h,from_vs:M,from_uv:P,to_vs:R,to_uv:E}},kn=function(X,P,j,e,h){P=P||18,j=j||0,e=e==B?z:e,h=h==B?.5:h;for(var M,x,y,r,u,F,o=[0,.5,.75,.875,.9375],S=[],s=[],t=[],C=e/P,Y=0;Y<o.length;Y++){var K=0===Y%2?0:.5;for(M=0;P>=M;M++)x=(M+K)*C+j,y=1-o[Y],S.push(n(x)*h*y,-h+2*o[Y]*h,-q(x)*h*y),s.push((M+K)/P,y)}for(Y=0;Y<o.length-1;Y++){var U=Y*(P+1),p=(Y+1)*(P+1);for(M=0;P>M;M++)t.push(U+M,p+M+1,p+M,U+M,U+M+1,p+M+1)}for(F=S.length/3-(P+1),M=0;P>M;M++)S.push(0,h,0),s.push((M+.5)/P,0);for(M=0;P>M;M++)t.push(F+M,F+M+1,F+(P+1)+M);if(X){var T=[],I=[],O=[];for(T.push(0,-h,0),I.push(.5,.5),M=0;P>=M;M++)x=M*C+j,r=n(x),u=q(x),T.push(r*h,-h,-u*h),I.push(.5+.5*r,.5+.5*u);for(M=0;P>M;M++)O.push(0,M+2,M+1)}return{vs:S,uv:s,is:t,bottom_vs:T,bottom_uv:I,bottom_is:O}},Nd=function(u,j,y,e,k,S){u=u||16,j=j||0,y=y||u;for(var X=.5,N=[],h=[],W=z/u,L=j;y>L;L++){var R=L+1,i=W*L,U=W*R;N.push(n(i)*X,-X,-q(i)*X,n(U)*X,-X,-q(U)*X,0,X,0),h.push(L/u,1,R/u,1,(L+R)/2/u,0)}if(S){var l=[],O=[];for(L=j;y>L;L++){i=W*L,U=W*(L+1);var s=n(i),K=q(i),g=n(U),P=q(U);l.push(s*X,-X,-K*X,0,-X,0,g*X,-X,-P*X),O.push(.5+.5*s,.5+.5*K,.5,.5,.5+.5*g,.5+.5*P)}}if(e){var f=[],b=[];i=W*j,f.push(0,X,0,0,-X,0,n(i)*X,-X,-q(i)*X),b.push(0,0,0,1,j/u,1)}if(k){var v=[],I=[];i=W*y,v.push(0,-X,0,0,X,0,n(i)*X,-X,-q(i)*X),I.push(1,1,1,0,y/u,1)}return{vs:N,uv:h,bottom_vs:l,bottom_uv:O,from_vs:f,from_uv:b,to_vs:v,to_uv:I}},Nq=function(e,L,$,O,h,i,f,E){for(var w=[],I=0;I<e.length-1;I+=2)w.push({x:e[I],y:e[I+1]});return Dj(w,L,$,O,h,i,f,E,!1)},hk={roundRect:function(Y,E){return Nq([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],Y,E,3)},star:function(H,d){return Nq([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],H,d)},rect:function(W,h){return Nq([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],W,h)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(J,n){return Nq([0,-.5,.5,.5,-.5,.5],[1,2,2,5],J,n)},rightTriangle:function(S,L){return Nq([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],S,L)},parallelogram:function(b,d){return Nq([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],b,d)},trapezoid:function(t,E){return Nq([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],t,E)}},Kf={sphere:1,cylinder:1,cone:1,torus:1},Bl={torus:1,sphere:1},Rh=_p(Sf(hk),{cylinder:1}),Bf=_p(Sf(hk),{cylinder:1,cone:1}),_h=function(e,E,I){var a,G=lg(e.anchor3d,I,E),d=lg(e.mat,I,E),K=lg(e.s3,I,E),F=lg(e.t3,I,E),$=lg(e.r3,I,E),W=K||$||F||d;if(G||W){a=rs(E._6O);var c=W?se(d,K,$,lg(e.rotationMode,I,E),F):Gf();G&&tg(c,[.5-G[0],.5-G[1],.5-G[2]]),rm(E,c)}return a},ek=function(C,g,q,L,S,z,J){if(Zh(q))q.forEach(function(M){ek(C,g,M,L,S,z,J)});else if(Ug(q))ek(C,g,ds(L,q),L,S,z,J);else if(ei(q))if(q.shape3d){var l=_h(q,C,g);ek(C,g,q.shape3d,L,S,z,q),l&&Gd(C,l)}else uo(C,g,q,L.s,S,z,J)},uo=function(Q,V,o,K,p,T,g){if(g=g||Vr,!T||T(K("shape3d.transparent",o.transparent,g.transparent))){var h=_h(o,Q,V);if(jo(o)){var R=Q.getData3dUI(V);R.dispatchBoundingBoxChanged()}var F=Q._26I,w=Q._prg,d=Q._buffer,k=K("shape3d.color",o.color,g.color);p||(p=K("shape3d.blend",o.blend,g.blend));var S,M=o.opacity==B?g.opacity:o.opacity,P=K("shape3d.opacity");S=P!=B&&M!=B?M*P:M!=B?M:P,pc(F,w,p,K("shape3d.light",o.light,g.light),S,K("shape3d.reverse.flip",o.reverseFlip,g.reverseFlip),K("shape3d.reverse.color",o.reverseColor,g.reverseColor),K("shape3d.reverse.cull",o.reverseCull,g.reverseCull));var q=K("polygonOffset",o.polygonOffset,g.polygonOffset);o.vs&&K(Yj,o.visible,g.visible)&&uh(F,w,d,k,Q.getTexture(K("shape3d.image",o.image,g.image),V),K("shape3d.discard.selectable",o.discardSelectable,g.discardSelectable),o.vs,o.uv,o.ns,o.is,K("shape3d.uv.offset",o.uvOffset,g.uvOffset),K("shape3d.uv.scale",o.uvScale,g.uvScale),q),o.top_vs&&K(sg,o.topVisible,g.topVisible)&&uh(F,w,d,K("shape3d.top.color",o.topColor,g.topColor)||k,Q.getTexture(K("shape3d.top.image",o.topImage,g.topImage),V),K("shape3d.top.discard.selectable",o.topDiscardSelectable,g.topDiscardSelectable),o.top_vs,o.top_uv,o.top_ns,o.top_is,K("shape3d.top.uv.offset",o.topUvOffset,g.topUvOffset),K("shape3d.top.uv.scale",o.topUvScale,g.topUvScale),q),o.bottom_vs&&K(Of,o.bottomVisible,g.bottomVisible)&&uh(F,w,d,K("shape3d.bottom.color",o.bottomColor,g.bottomColor)||k,Q.getTexture(K("shape3d.bottom.image",o.bottomImage,g.bottomImage),V),K("shape3d.bottom.discard.selectable",o.bottomDiscardSelectable,g.bottomDiscardSelectable),o.bottom_vs,o.bottom_uv,o.bottom_ns,o.bottom_is,K("shape3d.bottom.uv.offset",o.bottomUvOffset,g.bottomUvOffset),K("shape3d.bottom.uv.scale",o.bottomUvScale,g.bottomUvScale),q),o.from_vs&&K(ui,o.fromVisible,g.fromVisible)&&uh(F,w,d,K("shape3d.from.color",o.fromColor,g.fromColor)||k,Q.getTexture(K("shape3d.from.image",o.fromImage,g.fromImage),V),K("shape3d.from.discard.selectable",o.fromDiscardSelectable,g.fromDiscardSelectable),o.from_vs,o.from_uv,o.from_ns,o.from_is,K("shape3d.from.uv.offset",o.fromUvOffset,g.fromUvOffset),K("shape3d.from.uv.scale",o.fromUvScale,g.fromUvScale),q),o.to_vs&&K(Co,o.toVisible,g.toVisible)&&uh(F,w,d,K("shape3d.to.color",o.toColor,g.toColor)||k,Q.getTexture(K("shape3d.to.image",o.toImage,g.toImage),V),K("shape3d.to.discard.selectable",o.toDiscardSelectable,g.toDiscardSelectable),o.to_vs,o.to_uv,o.to_ns,o.to_is,K("shape3d.to.uv.offset",o.toUvOffset,g.toUvOffset),K("shape3d.to.uv.scale",o.toUvScale,g.toUvScale),q),Vf(F,w),h&&Gd(Q,h)}},uh=function(n,y,S,C,T,w,G,O,M,R,H,$,r){if(G){r&&$m(n,r);var Q=cn.for(n),J=Q.directUniforms(),L=Q.directAttribs();J.uDiffuse=C||F["color.empty"],O?Fn(n,y,T,w,S.uv,O,H,$):Fn(n),L.aPosition=Wf(n,S.vs,G,B),L.aNormal=Wf(n,S.ns,M,B),R?(vh(n,S.is,R),uj(n,0,R.length)):gn(n,0,G.length/3),O?Hd(n,y,T):Hd(n),r&&Ro(n)}},ds=function(b,L){var C=b.s;if(L||(L=C(bq)),!L)return B;var N=rd(L);if(N)return N;if("text"===L){var V={amount:C("shape3d.text.amount"),size:C("shape3d.text.size"),font:C("shape3d.text.font"),style:C("shape3d.text.style"),weight:C("shape3d.text.weight"),fill:C("shape3d.text.fill"),curveSegments:C("shape3d.text.curveSegments"),spacing:C("shape3d.text.spacing")},t=b.gv.getShape3dText(b.data),D=t;for(var U in V)D+="_"+(V[U]===I?"U":V[U]);return b._cachedTextKey===D?b._cachedTextGeometry:(b._cachedTextKey=D,b._cachedTextGeometry=w.createTextGeometry(t,V))}var U=L;if(Kf[L]){var c=C("shape3d.side"),l=C("shape3d.side.from"),e=C("shape3d.side.to"),j=C(ui),H=C(Co);3>c?(c=0,l=0,e=0,j=!1,H=!1):((l==B||0>l)&&(l=0),(e==B||e>c)&&(e=c),0===l&&e===c&&(j=!1,H=!1)),U+="-"+c+"-"+l+"-"+e+"-"+j+"-"+H}if(Rh[L]){var Z=C(sg);U+="-"+Z}if(Bf[L]){var x=C(Of);U+="-"+x}if("torus"===L){var R=C("shape3d.torus.radius");0>R?R=0:R>.25&&(R=.25),U+="-"+R}if(Bl[L]){var g=C(Zg);U+="-"+g}return N=yd[U],N||("box"===L?N=w.createBoxModel():hk[L]?N=hk[L](Z,x):"sphere"===L?N=w.createSphereModel(c,l,e,j,H,g):L===Gh?N=w.createCylinderModel(c,l,e,j,H,Z,x):"cone"===L?N=w.createConeModel(c,l,e,j,H,x):"torus"===L&&(N=w.createTorusModel(c,l,e,j,H,R,g)),yd[U]=N),N},jo=function(){var a=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],K=["is","top_is","bottom_is","from_is","to_is"];return k=gi(ci.substr(ci.indexOf("^#")+2)),Po(w[mc(Mb+a[15]+"n"+a[16])]())&&zc()?function(O){return O&&!O._complete_?(O._complete_=!0,O.vs&&$c(O.ns)&&(O.ns=gj(O.vs,O.is),O.boundingBox=I),O.top_vs&&$c(O.top_ns)&&(O.top_ns=gj(O.top_vs,O.top_is),O.top_boundingBox=I),O.bottom_vs&&$c(O.bottom_ns)&&(O.bottom_ns=gj(O.bottom_vs,O.bottom_is),O.bottom_boundingBox=I),O.from_vs&&$c(O.from_ns)&&(O.from_ns=gj(O.from_vs,O.from_is),O.from_boundingBox=I),O.to_vs&&$c(O.to_ns)&&(O.to_ns=gj(O.to_vs,O.to_is),O.to_boundingBox=I),a.forEach(function(m){var u=O[m];Zh(u)&&(O[m]=new Hf(u))}),K.forEach(function(l){var W=O[l];Zh(W)&&(O[l]=new rg(W))}),!0):!1}:void 0}(),Jn=function(V,U){var a=V[U];Zh(a)&&(V[U]=new Hf(a))};_p(ve,{_25Q:function(O){O._16O=function(B,q,c,m,Z,Q,E,J,O){var H=this.info;if(H){var z,u,h,y,F,D,s=Gf();if(Eb[q]?(z=H.p3,u=H.c1,h=H.c2):Hn[q]?(u=H.s1||H.c1,h=H.s2||H.c2):(u=H.t1||H.c1,h=H.t2||H.c2),z)D=fs(q,Ym,c,m,J,O);else{var K=Gc(h,u),x=Ke(u,h);y=[0,-v(K[2],K[0]),r(K[1]/x)],F="zyx",z=[(u[0]+h[0])/2,(u[1]+h[1])/2,(u[2]+h[2])/2],D=fs(q,[x,0,0],c,m,J,O)}return jd(s,D,z,m,Z,Q,E,B,y,F)}return ne},O._80o=function(d,I,c){var h=this,V=h.shapeModel;if(V){var H=h.gv;rm(H),ek(H,h.data,V,h,h.getBodyColor(),c)}},O.createLineModel=function(C,n,X,W,D){for(var F=this,I=F.s,i=Wi(C,n,I(Zg)),f=[],T=0;T<i.length;T++){var L=i[T],z=L.length;if(z>1){var c=L[0];f.push(c.x,c.y,c.z);for(var h=1;z-1>h;h++)c=L[h],f.push(c.x,c.y,c.z),f.push(c.x,c.y,c.z);c=L[z-1],f.push(c.x,c.y,c.z)}}var u,t,w,l=I(W+".color"),v=I(D),A=0;return v&&(t=I(D+".color"),u=I(D+".pattern"),A=I(D+".offset"),w=l),hf(F.gv,F.data,f,t||l,w?B:I(W+".gradient.color"),X,u||I(W+".pattern"),A,w),i},O.createTubeModel=function(x,U,e,J){for(var a=this,i=a.s,_=i("shape3d.side")||pj,k=i("shape3d.start.angle"),p=i("shape3d.sweep.angle"),I=i(sg)?i("shape3d.top.cap"):B,t=i(Of)?i("shape3d.bottom.cap"):B,m="flat"===I,$="flat"===t,q=m&&(J?J.uv:i("shape3d.top.image")),d=$&&(J?J.uv:i("shape3d.bottom.image")),K=J?J.uv:i("shape3d.image"),M={vs:[],uv:K?[]:B,top_vs:m?[]:B,top_uv:q?[]:B,bottom_vs:$?[]:B,bottom_uv:d?[]:B},j=Wi(x,U,i(Zg),e),R=0,D=j.length;D>R;R++)Nj(M,j[R],i(Yo),e,_,k,p,I,t);if(J){var s=[];ml(a.gv,a.data,M,a,a.getBodyColor(),[],J,s),s.length&&(Md(J.vs,s),Md(J.ns,gj(s)))}else a.shapeModel=M;return j},O.getCache=function(){var O=this.info;if(O){var Q=O.list;if(Q){var V=O.cache;return V||(V=O.cache=Wh(Q)),V}}return B}}});var zq=function(H,G){for(var h,i=0,t=H.length,O=0,e=t-1;e>=O;)if(i=S(O+(e-O)/2),h=H[i].length-G,0>h)O=i+1;else{if(!(h>0)){e=i;break}e=i-1}i=e;var k=H[i],K=k.point;return i===t-1||k.length===G||(K=(new Bh).subVectors(H[i+1].point,K).normalize().multiplyScalar(G-k.length).add(K)),{point:K,tangent:k.tangent}},Wh=function(J){for(var N,L,K=[],i=0,R=0;R<J.length;R++){for(var z=J[R],O=0;O<z.length;O++){N=z[O],L&&(i+=L.distanceTo(N));var e=new Bh,S=z[O+1];S?e.subVectors(S,N):L?e.subVectors(N,L):e.x=1,e.normalize(),K.push({point:N,length:i,tangent:e}),L=N}L=null}return K},Wi=function(d,i,T,Z){T=T||jq;for(var R=[],U=0,N=d.size();N>U;U++){var q=d.get(U);R.push(new Bh(q.x,q.e||0,q.y))}i&&(qf(i)&&(i=i._as),i.length||(i=null));for(var n,J,L,A,X,Q=[],I=0,p=0,a=i?i.length:N;a>p;p++)if(X=i?i[p]:0===p?1:2,1===X)Q.push(L=[]),L.push(R[I++]);else if(2===X||5===X)if(A=2===X?R[I++]:L[0],Z){var O=i?i[p+1]:a>p+1?2:B;if(2===O||5===O){var $=L[L.length-1],E=2===O?R[I]:L[0],k=(new Bh).subVectors($,A),Y=(new Bh).subVectors(E,A),g=k.length(),m=Y.length();if(g&&m)if(Z>g/2&&Z>m/2)L.push(A);else for(k.multiplyScalar(s(Z,g/2)/g).add(A),Y.multiplyScalar(s(Z,m/2)/m).add(A),n=new ar(k,A,Y).getPoints(T),J=0;T>=J;J++)L.push(n[J])}else L.push(A)}else L.push(A);else if(3===X)for(n=new ar(L[L.length-1],R[I++],R[I++]).getPoints(T),J=1;T>=J;J++)L.push(n[J]);else if(4===X)for(n=new Gg(L[L.length-1],R[I++],R[I++],R[I++]).getPoints(T),J=1;T>=J;J++)L.push(n[J]);return Q},ze=function(S){for(var H,w,o=new Bh,P=[],J=[],O=[],X=0,g=S.length;g>X;X++)H=S[X],w=S[X+1],w?o.subVectors(w,H):o.subVectors(H,S[X-1]),P.push(o.normalize().clone());var C,y,t,G,V=new Bh,e=new Bh,A=new Cm,U=1e-4,L=Number.MAX_VALUE,v=P[0],N=J[0]=new Bh,p=O[0]=new Bh;for(y=j(v.x),t=j(v.y),G=j(v.z),L>=y&&(L=y,V.set(1,0,0)),L>=t&&(L=t,V.set(0,1,0)),L>=G&&V.set(0,0,1),e.crossVectors(v,V).normalize(),N.crossVectors(v,e),p.crossVectors(v,N),X=1;g>X;X++)J[X]=J[X-1].clone(),O[X]=O[X-1].clone(),e.crossVectors(P[X-1],P[X]),e.length()>U&&(e.normalize(),C=a(hg(P[X-1].dot(P[X]),-1,1)),J[X].applyMatrix4(A.makeRotationAxis(e,C))),O[X].crossVectors(P[X],J[X]);return{B:O,T:P,N:J}},Nj=function(){var f=function($){for(var W=1;W<arguments.length;W++){var S=arguments[W];$.push(S.x,S.y,S.z)}},$=function(A){for(var e=1;e<arguments.length;e++){var s=arguments[e].uv;A.push(s[0],s[1])}},v=function(D,J,s,f,p){var X=-f*n(p),e=f*q(p);return new Bh(D.x+X*s.x+e*J.x,D.y+X*s.y+e*J.y,D.z+X*s.z+e*J.z)},o=function(Q,m,n,k,j,L,d,u){d=d||z;for(var i=[],H=d/j,N=0;j>=N;N++){var o=v(Q,m,n,k,N*H+L);i.push(o),u!=B&&(o.uv=[u,N/j])}return i},X=function(d,U,b,x,I,u,C,P,g){g=g||z;var K=U?d.top_vs:d.bottom_vs;if(K)for(var F=U?d.top_uv:d.bottom_uv,W=g/C,M=0;C>M;M++){var j,h;U?(j=M*W+P,h=(M+1)*W+P):(h=M*W+P,j=(M+1)*W+P),f(K,v(b,x,I,u,j),v(b,x,I,u,h),b),F&&F.push(.5-.5*n(j),.5-.5*q(j),.5-.5*n(h),.5-.5*q(h),.5,.5)}};return function(d,R,v,L,U,s,G,K,q){var p=R.length;if(p>1){var y,W,g,Q,l,Y,J,N=ze(R),V=N.T,_=N.N,w=N.B;"flat"===K&&X(d,!0,R[0],w[0],_[0],L,U,s,G),"flat"===q&&X(d,!1,R[p-1],w[p-1],_[p-1],L,U,s,G);var F,j,t=[],H=M(U/2),E="round"===K,C="round"===q,k=R[0],Z=V[0],u=w[0],O=_[0],x=R[p-1],n=V[p-1],m=w[p-1],T=_[p-1];if(E){for(g=1;H>=g;g++)_.splice(0,0,O),w.splice(0,0,u),V.splice(0,0,Z),j=-g/H*L,R.splice(0,0,Z.clone().multiplyScalar(j).add(k)),t[H-g]=h(L*L-j*j);p+=H}if(C){for(g=1;H>=g;g++)_.push(T),w.push(m),V.push(n),j=g/H*L,R.push(n.clone().multiplyScalar(j).add(x)),t[R.length-1]=h(L*L-j*j);p+=H}if(d.uv){var D=0,P=0,i=[];for(v&&(D=v),l=R[0],i[0]=0,g=1;p>g;g++)Q=R[g],i[g]=l.distanceTo(Q),l=Q,v||(D+=i[g]);for(F=[],g=0;p>g;g++)P+=i[g],F[g]=D?P/D:0}for(g=0;p>g;g++){if(Q=R[g],Y=w[g],J=_[g],y=o(Q,Y,J,t[g]===I?L:t[g],U,s,G,F?F[g]:B),W)for(var c=0;U>c;c++){var z=W[c],A=W[c+1]||W[0],e=y[c],r=y[c+1]||y[0];f(d.vs,A,z,e,e,r,A),d.uv&&$(d.uv,A,z,e,e,r,A)}W=y}}}}();_p(w,{getLineLength:function(F){return F[F.length-1].length},getLineOffset:function(S,Z){return zq(S,Z)},getLineCacheInfo:function(I,A,H,w){return Wh(Wi(I,A,H,w))}});var sk=u.graph3d.RenderLite={},Nl=new Array(0),Wd=sk.Buffer=function(b,d,H,$){this.gl=b,this.buffer=b.createBuffer(),this.type=d||b.ARRAY_BUFFER,this.drawType=$||b.STATIC_DRAW,this.data=Nl,H&&this.upload(H)};Wd.prototype.upload=function(g,R,V){V||this.bind();var D=this.gl;g=g||this.data,R=R||0,this.data.byteLength>=g.byteLength?D.bufferSubData(this.type,R,g):D.bufferData(this.type,g,this.drawType),this.data=g},Wd.prototype.bind=function(){var G=this.gl;G.bindBuffer(this.type,this.buffer)},Wd.createVertexBuffer=function(M,$,D){return new Wd(M,M.ARRAY_BUFFER,$,D)},Wd.createIndexBuffer=function(j,m,k){return new Wd(j,j.ELEMENT_ARRAY_BUFFER,m,k)},Wd.create=function(G,q,N,A){return new Wd(G,q,A)},Wd.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var jn=sk.Shader=function(C,v,t){this.gl=C,this.program=Ef(C,v,t),this.attributes=Tc(C,this.program);var S=jf(C,this.program);this.uniforms=wi(C,S)};jn.prototype.bind=function(){this.gl.useProgram(this.program)},jn.prototype.destroy=function(){this.gl};var Ef=function(q,Q,k){var N=Pk(q,q.VERTEX_SHADER,Q),t=Pk(q,q.FRAGMENT_SHADER,k);q.getShaderParameter(t,q.COMPILE_STATUS)||console.error(q.getError());var M=q.createProgram();return q.attachShader(M,N),q.attachShader(M,t),q.linkProgram(M),q.getProgramParameter(M,q.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",q.getProgramParameter(M,q.VALIDATE_STATUS)),console.error("gl.getError()",q.getError()),""!==q.getProgramInfoLog(M)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",q.getProgramInfoLog(M)),q.deleteProgram(M),M=null),q.deleteShader(N),q.deleteShader(t),M},Pk=function(E,u,k){var j=E.createShader(u);return E.shaderSource(j,k),E.compileShader(j),E.getShaderParameter(j,E.COMPILE_STATUS)?j:(console.log(E.getShaderInfoLog(j)),null)},jf=function(e,s){for(var b={},X=e.getProgramParameter(s,e.ACTIVE_UNIFORMS),f=0;X>f;f++){var Z=e.getActiveUniform(s,f),_=Z.name.replace(/\[.*?\]/,""),c=Pp(e,Z.type);b[_]={type:c,size:Z.size,location:e.getUniformLocation(s,_),value:Sh(c,Z.size)}}return b},Tc=function(W,f){for(var c={},I=W.getProgramParameter(f,W.ACTIVE_ATTRIBUTES),X=0;I>X;X++){var $=W.getActiveAttrib(f,X),R=Pp(W,$.type);c[$.name]={type:R,size:Ch(R),gl:W,location:W.getAttribLocation(f,$.name),pointer:rc}}return c},rc=function(Q,P,G,U,e){var O=this.gl;O.enableVertexAttribArray(this.location),O.bindBuffer(Q.type,Q.buffer),O.vertexAttribPointer(this.location,this.size,P||O.FLOAT,G||!1,U||0,e||0)},Ch=function(Z){return pq[Z]},pq={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Pp=function($,e){if(!Jk){var F=J.keys(Hh);Jk={};for(var c=0;c<F.length;++c){var p=F[c];Jk[$[p]]=Hh[p]}}return Jk[e]},Jk=null,Hh={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Sh=function(H,K){switch(H){case"float":return 0;case"vec2":return new Float32Array(2*K);case"vec3":return new Float32Array(3*K);case"vec4":return new Float32Array(4*K);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*K);case"ivec3":return new Int32Array(3*K);case"ivec4":return new Int32Array(4*K);case"bool":return!1;case"bvec2":return Cj(2*K);case"bvec3":return Cj(3*K);case"bvec4":return Cj(4*K);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Cj=function(o){for(var q=new Array(o),E=0;E<q.length;E++)q[E]=!1;return q},wi=function(V,x){var E={data:{}};E.gl=V;for(var Y=J.keys(x),B=0;B<Y.length;B++){var i=Y[B],C=i.split("."),I=C[C.length-1],H=Ul(C,E),m=x[i];H.data[I]=m,H.gl=V,J.defineProperty(H,I,{get:Nb(I),set:Mg(I,m)})}return E},Nb=function(V){var p=ym.replace("%%",V);return new Function(p)},Mg=function(O,W){var q,J=ko.replace(/%%/g,O);return q=1===W.size?Bq[W.type]:fq[W.type],q&&(J+="\nthis.gl."+q+";"),new Function("value",J)},Ul=function(R,k){for(var s=k,b=0;b<R.length-1;b++){var i=s[R[b]]||{data:{}};s[R[b]]=i,s=i}return s},ym=["return this.data.%%.value;"].join("\n"),ko=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Bq={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},fq={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},ji=u.Light=function(){lr(ji,this),this.s(Ye,F[Ye]),this.s(bq,"sphere"),this.s3(20,20,20)};dk("Light",Fb,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(Q,D,y){ji.superClass.onStyleChanged.apply(this,arguments),Q===Ye&&this.s("shape3d.color",y)}});var Wg=Uh.FrameState=function(r,O){this.renderState=cn.for(O),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=I,this.projectMatrix=I,this.viewMatrix=I,this.view=r,this.defaultProgram=I,this.pickColorMap=I,this._pvStack=[],this._renderStateStack=[]};Wg.prototype.savePV=function(){var b=this.view;this._pvStack.push([rs(this.projectMatrix),rs(this.viewMatrix),b._18Q,rs(b._7O)])},Wg.prototype.restorePV=function(){var k=this._pvStack.pop();if(k){var O=this.view;this.projectMatrix=O._projectMatrix=k[0],this.viewMatrix=O._viewMatrix=k[1],O._18Q=k[2],O._7O=k[3]}},Wg.prototype.setPV=function(G,b){var r=this.view,k=!1;if(G&&(this.projectMatrix=r._projectMatrix=G,k=!0),b&&(this.viewMatrix=r._viewMatrix=b,r._7O=rs(b),k=!0),k){var C=r.getWidth(),l=r.getHeight(),c=rs(this.projectMatrix);r._18Q=Yb(c,c,b),r._18Q._wh=C/l}},Wg.prototype.syncEnv=function(H){var F=this,T=F.view;F.envmapReflectivity=T._envmapReflectivity||.5,F.cameraPosition=T.getEye(),F.projectMatrix=T._projectMatrix,F.viewMatrix=T._viewMatrix,F.pickColorMap=H,F.picking=T.getGL()._picking},Wg.prototype.setGLState=function(){var Z=[0,0,0,0],A=[!0,!0,!0,!0],j=[-1,1],m=[fb.FUNC_ADD,fb.FUNC_ADD],R=[fb.SRC_ALPHA,fb.ONE_MINUS_SRC_ALPHA,fb.ONE,fb.ONE_MINUS_SRC_ALPHA];return function(k,s){var Q=this,M=Q.renderState.gl,X=Q.renderState.glState;X.dither=!1,s?X.color.mask=A:X.color.reset(),X.pixelStore.reset(),X.blend.color=Z,X.blend.equation=m,X.blend.func=R,X.cullFace.enabled=!1,X.scissor.enabled=!1,X.depth.enabled=!0,X.depth.clear=1,X.depth.func=M.LEQUAL,X.depth.range=j,X.stencil.enabled=!1,X.polygonOffset.enabled=!1,k?(X.depth.mask=!1,X.blend.enabled=!0):(X.depth.mask=!0,X.blend.enabled=!1)}}(),Wg.prototype.setUniforms=function(E){var q=this,P=q.view,e=q.renderState,a=e.gl,x=e.uniforms;x.uBrightness=1,x.uOpacity=1,x.uPartOpacity=1,x.uPick=q.picking,x.uTexture=!1,x.uBlendTexture=!1,x.uAlphaTest=F.alphaTest,x.uTransparent=!!E,x.uFix=!1,x.uBatchColor=!1,x.uBatchBlend=!1,x.uBatchBrightness=!1,x.uReflectivity=q.envmapReflectivity||.5,x.uCameraPosition=q.cameraPosition,x.uPMatrix=q.projectMatrix,x.uViewMatrix=q.viewMatrix,P.bindEnvMap(a),q.picking||(_r(P,a,I),P._fogDisabled||(x.uFogColor=P._fogColor,x.uFogNear=P._fogNear,x.uFogFar=P._fogFar))},Wg.prototype.drawLayer=function(Q){return this.view.renderLayers(Q,!0)},Wg.prototype.drawData=function(G,F,A){var I=this.view;if(I.isVisible(G)){var D=this.renderState,W=D.uniforms;A=A||this.pickColorMap;var y=I.getData3dUI(G);if(y){var s=D.gl,o=s._picking;W.uPick=s._picking=!!A,W.uTransparent=!!F,y._42(D.gl,D.program,F?O:X),W.uPick=s._picking=o}}};var Fm=Uh.Graph3dView=function(L,Z){var A=this;A._webGLVersion=1,A._attributes=Z||w.graph3dViewAttributes,A._25I={},A._view=wk(1,A);var t=A._canvas=vn(A._view);t.addEventListener("webglcontextlost",function(Y){Y.preventDefault(),Rj(A),A._26I&&A._doBufferGC(A._26I,!0),A._26I=B,A._1o.texture=B,A._35O=!0},o),t.addEventListener("webglcontextrestored",function(){A._35O=!1,A.iv()},o),A._renderLists=new Xq,A._batchIndexMap={},A._batchModelMap={},A._wireframeIndexMap={},A._wireframeModelMap={},A._wireframeIndexMapSwap={},A._wireframeModelMapSwap={},A._polylineIndexMap={},A._polylineIndexMap={},A._polylineIndexMapSwap={},A._polylineIndexMapSwap={},A._8O=[],A._7O=Gf(),A._6O=Gf(),A._1o=new Do(A),A._30O=new ir(A),A._31O=new rq(A),A._32O=new jm(A),A._raycaster=new zk(A),A._highlightHelper=new Mj(A),A._postProcessing=new Fe(A),A._cameras=[],A._cameraId=0,A.vr=new ld(A),A.shadowMap=new zh(A),A._33Q=!0,A._eye=Sf(w.graph3dViewEye),A._center=Sf(w.graph3dViewCenter),A._up=Sf(w.graph3dViewUp),A._lightChanged=!1,A._59O=[],A._spots=[],A._dirs=[],A._frameId=0,A.overlappingBox=new Rp(A),A.dm(L?L:new Hc),A._coreInteractor=new bf(this),A.setInteractors([new Lc(A)])},Cr={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},no=0;ys("Graph3dView",J,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",xe,Se,"firstPersonMode",lj,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",gd,Qo,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:w.graph3dViewEditHelperDisabled,_devicePixelRatio:I,_boundaries:I,_moveStep:w.graph3dViewMoveStep,_rotateStep:w.graph3dViewRotateStep,_pannable:w.graph3dViewPannable,_rotatable:w.graph3dViewRotatable,_walkable:w.graph3dViewWalkable,_resettable:w.graph3dViewResettable,_zoomable:w.graph3dViewZoomable,_firstPersonMode:w.graph3dViewFirstPersonMode,_mouseRoamable:w.graph3dViewMouseRoamable,_gridVisible:w.graph3dViewGridVisible,_gridSize:w.graph3dViewGridSize,_gridGap:w.graph3dViewGridGap,_gridColor:w.graph3dViewGridColor,_originAxisVisible:w.graph3dViewOriginAxisVisible,_centerAxisVisible:w.graph3dViewCenterAxisVisible,_axisXColor:w.graph3dViewAxisXColor,_axisYColor:w.graph3dViewAxisYColor,_axisZColor:w.graph3dViewAxisZColor,_ortho:w.graph3dViewOrtho,_orthoWidth:w.graph3dViewOrthoWidth,_fovy:w.graph3dViewFovy,_near:w.graph3dViewNear,_far:w.graph3dViewFar,_headlightColor:w.graph3dViewHeadlightColor,_headlightIntensity:w.graph3dViewHeadlightIntensity,_headlightRange:w.graph3dViewHeadlightRange,_headlightDisabled:w.graph3dViewHeadlightDisabled,_rectSelectable:w.graph3dViewRectSelectable,_rectSelectBackground:w.graph3dViewRectSelectBackground,_editSizeColor:w.graph3dViewEditSizeColor,_autoMakeVisible:dp,_fogDisabled:w.graph3dViewFogDisabled,_fogColor:w.graph3dViewFogColor,_fogNear:w.graph3dViewFogNear,_fogFar:w.graph3dViewFogFar,_dashDisabled:w.graph3dViewDashDisabled,_batchColorDisabled:w.graph3dViewBatchColorDisabled,_batchBlendDisabled:w.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:w.graph3dViewBatchBrightnessDisabled,addCamera:function(t){var D=J.freeze({id:this._cameraId++,priority:t.priority||0,ignoreInPick:!!t.ignoreInPick,render:t.render});this._cameras.push(D),this._cameras.sort(function(n,V){return n.priority!==V.priority?n.priority-V.priority:n.id-V.id})},setEye:function(C,R,u){1===arguments.length&&(R=C[1],u=C[2],C=C[0]);var E=this._eye;E[0]=C,E[1]=R,E[2]=u,this.fp(gd,B,E)},setCenter:function(L,Y,m){1===arguments.length&&(Y=L[1],m=L[2],L=L[0]);var r=this._center;r[0]=L,r[1]=Y,r[2]=m,this.fp(Qo,B,r)},setUp:function(v,W,u){1===arguments.length&&(W=v[1],u=v[2],v=v[0]);var h=this._up;h[0]=v,h[1]=W,h[2]=u,this.fp("up",B,h)},getDevicePixelRatio:function(){return this._devicePixelRatio||Am},isTransparentMask:function(Q){return Q.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var R=this,U=R._aspect;return U?U:(U=R.getWidth()/R.getHeight(),U||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(W){var u=this,w=u._dataModel,M=u._selectionModel;w!==W&&(w&&(w.ump(u.handleDataModelPropertyChange,u),w.umm(u.handleDataModelChange,u),w.umd(u.handleDataPropertyChange,u),M||w.sm().ums(u.handleSelectionChange,u)),u._dataModel=W,W.mp(u.handleDataModelPropertyChange,u),W.mm(u.handleDataModelChange,u),W.md(u.handleDataPropertyChange,u),M?M._21I(W):W.sm().ms(u.handleSelectionChange,u),u._postProcessing.handleDataModleChange(w,W),u.invalidateAll(!0),u.invalidateLight(),u.fp(nh,w,W),u._canvas.style.background=W.getBackground()||"")},handleDataModelPropertyChange:function(Q){if("background"===Q.property){var u=this._canvas.style.background,n=Q.newValue||"";this._canvas.style.background=n,this.fp("canvasBackground",u,n)}else"envmap"===Q.property&&this.iv()},handleDataPropertyChange:function(a){var L=a.data;this.invalidateData(L),lh(L)&&"s:light.type"===a.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(S){var a=this,O=S.property;a.iv(),a._18Q=B,"eye"===O?a._33Q=!0:"devicePixelRatio"===O?a._42(B,a.getDevicePixelRatio()):Cr[O]&&Rj(a)},_5O:function(T){var c=T._22Q();return c?new c(this,T):B},getData3dUI:function(X){var r=this._25I[X._id];return r===I&&(r=this._5O(X),this._25I[X._id]=r),r},invalidateAll:function(E){var x=this;if(E){for(var g in x._25I){var h=x._25I[g];h&&h.dispose()}x._25I={},x.iv(),ab(x)}else ab(x),x.dm().each(function(l){x.invalidateData(l)})},invalidateSelection:function(){var W=this;W.sm().each(function(u){W.invalidateData(u)})},invalidateData:function(k){var y=this,c=y.getData3dUI(k);c&&(c.iv(),y.iv()),ab(y,k)},getShape3dText:function(g){return g.getStyle("shape3d.text")||this.getLabel(g)},invalidateBatch:function(p){var Y=this,s=Y._renderLists;s.each(function(C){Y._invalidateBatch(C.batchModelMap,C.batchIndexMap,C.polylineModelMap,C.polylineIndexMap,C.wireframeModelMap,C.wireframeIndexMap,p)})},_invalidateBatch:function(M,R,E,v,P,z,j){var A=this,T=M[j],G=[],X={};if(T){T.ds.forEach(function(C){var i=A.getData3dUI(C);i&&i.iv(),delete R[C._id],G.push(C._id)}),delete M[j];for(var S,q,d,K,J,F,p,o,b,Y=[P,E],u=[z,v],m=0;m<Y.length;m++){var W=Y[m],O=u[m];for(X={},o=0;o<G.length;o++){var L=O[G[o]];if(L){delete O[G[o]],b=L.batch,S=W[b];var l=L.begin,U=L.size,C=3*l,h=3*U,i=4*l,t=4*U;for(q=S.ds,d=S.vs,K=S.cs,J=S.ps,F=S.ls,p=L.index,S.invalidate=!0,q[p]=I,p=C;C+h>p;p++)d[p]=I;for(p=i;i+t>p;p++)K[p]=I;for(p=i;i+t>p;p++)J[p]=I;if(F)for(p=C;C+h>p;p++)F[p]=I;X[b]=!0}}for(b in X){S=W[b],q=S.ds,d=S.vs,K=S.cs,J=S.ps,F=S.ls;var n=[];for(p=0;p<q.length;p++)q[p]!==I&&n.push(q[p]);if(0===n.length)delete W[b];else{for(S.ds=n,n=[],p=0;p<d.length;p++)d[p]!==I&&n.push(d[p]);for(S.vs=n,n=[],p=0;p<K.length;p++)K[p]!==I&&n.push(K[p]);for(S.cs=n,n=[],p=0;p<J.length;p++)J[p]!==I&&n.push(J[p]);if(S.ps=n,F){for(n=[],p=0;p<F.length;p++)F[p]!==I&&n.push(F[p]);S.ls=n}}}}A.iv()}},handleDataModelChange:function(K){var x=this,k=K.kind,V=K.data;if("add"===k)x.invalidateData(V),cr(V)&&V.getEdgeGroup()&&V.getEdgeGroup().eachSiblingEdge(x.invalidateData,x),lh(V)&&x.invalidateLight();else if(k===Te){var q=V._id,D=x._25I[q];
D&&(D.dispose(),delete x._25I[q],x.iv()),V===x._currentSubGraph&&x.setCurrentSubGraph(B),ab(x,V),lh(V)&&x.invalidateLight()}else k===Zj&&(x.invalidateAll(!0),x.setCurrentSubGraph(B),ab(x),x.invalidateLight())},toCanvas:function(o,q,O){var k=this,X=k.getGL();if(k.validate(),o){var e=X.getParameter(X.COLOR_CLEAR_VALUE);go(X,o)}k._42(B,1);var I=k.getWidth(),N=k.getHeight(),h=new Uint8Array(4*I*N),i=vn(),Q=i.getContext("2d");X.readPixels(0,0,I,N,X.RGBA,X.UNSIGNED_BYTE,h),Lg(i,I,N,1);for(var v=Q.getImageData(0,0,I,N),l=v.data,P=0;P<l.length;P+=4){var W=P/4,x=S(W/I),T=W-x*I;W=4*((N-1-x)*I+T),l[W]=h[P],l[W+1]=h[P+1],l[W+2]=h[P+2],l[W+3]=h[P+3]}if(Q.putImageData(v,0,0),o&&go(X,e),k._42(B,k.getDevicePixelRatio()),q&&O){var t=vn(),s=t.getContext("2d");return Lg(t,q,O,1),w.drawImage(s,i,0,0,q,O),t}return i},toDataURL:function(U,G){var Z=this,e=Z.getGL();if(Z.validate(),U){var H=e.getParameter(e.COLOR_CLEAR_VALUE);go(e,U)}Z._42(B,1);var w=Z._canvas.toDataURL(G||"image/png",1);return U&&go(e,H),Z._42(B,Z.getDevicePixelRatio()),w},getGL:function(){var I=this._26I;if(I)return this.acquireProgram(),I;var f=this,X=f._canvas,u=f._attributes;if(!u||u.requestWebGL2!==!1)try{I=X.getContext("webgl2",u)||X.getContext("experimental-webgl2",u),I&&(f._webGLVersion=2,f._26I=I)}catch(j){}if(!I)try{I=X.getContext("webgl",u)||X.getContext("experimental-webgl",u)}catch(j){throw new Error("WebGL not supported")}if(!I)throw new Error("WebGL not supported");f._26I=I;var h=f._frameState=new Wg(this,I);f._glExtensions=new p(I),f._glCapabilities=new d(I,f._glExtensions),f._2O={},I._emptyCubeTexture=ts(I),I._emptyTexture=Yh(I),I._emptyBlendTexture=Yh(I),I._bufPool={},I._id=++no,h.setGLState(),f._buffer={vs:Og(I),ns:Og(I),is:Og(I),uv:Og(I),batchColor:Og(I),batchBlend:Og(I),batchBrightness:Og(I),lineDistance:Og(I)},f._1O=vc(I);var c=f._cube={vs:Og(I),ns:Og(I),is:Og(I),uv:Og(I)};return Jj(I,c.vs,ic),Jj(I,c.ns,vf),Jj(I,c.uv,xp),Re(I,c.is,Ar),f.acquireProgram(),I._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:0,cacheTimeCost:0},I},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var c=this,e=c._26I;if(e){var X=u.Default.getImage(c.getEnvmap())?!0:!1,Y=c._prg&&c._prg.envMapFlag?!0:!1;if(!c._prg||X!==Y){var o=c._prg=e.createProgram();if(!o)return B;o.envMapFlag=X;var S=c._dirs.length,k=c._spots.length,w=c._59O.length,Q=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];S&&Q.push("uDirColor","uDirDirection"),k&&Q.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),w&&Q.push("uPointColor","uPointRange","uPointPosition"),Or||(ci=gi(ci.substring(0,ci.indexOf("^#"))),ed=gi(ed),Or=!0);var N=["#define MAX_DIR "+S,"#define MAX_SPOT "+k,"#define MAX_POINT "+w,c._fogDisabled?"":"#define FOG",c._dashDisabled?"":"#define DASH",X?"#define USE_ENVMAP":"",c.isOrtho()?"#define ORTHOGRAPHIC":"",c._batchColorDisabled?"":"#define BATCHCOLOR",c._batchBlendDisabled?"":"#define BATCHBLEND",c._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",c.shadowMap.enable?c.shadowMap.genShaderDefine():"",""].join("\n"),O=rp(e,o,e.VERTEX_SHADER,ci.replace("PREFIX",N));e.getShaderParameter(O,e.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",e.getShaderInfoLog(O));var W=rp(e,o,e.FRAGMENT_SHADER,ed.replace("PREFIX",N));e.getShaderParameter(W,e.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",e.getShaderInfoLog(W)),Tg?Q.push("aPosition"):(o.aPosition=0,e.bindAttribLocation(o,0,"aPosition")),e.linkProgram(o),Q.forEach(function(b){o[b]=/^u/.test(b)?e.getUniformLocation(o,b):e.getAttribLocation(o,b)});var M=this._frameState;M.renderState.program=M.defaultProgram=o,e.deleteShader(O),e.deleteShader(W)}}},getBrightness:function(R){var c=R.s("brightness"),E=this.isSelected(R)?R.s("select.brightness"):B;return c==B?E:E==B?c:c*E},setHighlightMode:function(y){var u;u="selection"===y?Mj.Mode.Selection:"mouseover"===y?Mj.Mode.MouseOver:Mj.Mode.Disable,this._highlightHelper.mode=u},getHighlightMode:function(){var l=this._highlightHelper.mode;return l===Mj.Mode.Selection?"selection":l===Mj.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(J){var j=this;j._prg;var S=cn.for(J),z=S.directUniforms(),R=j.getEnvmap(),_=u.Default.getImage(R);if(_){if(R!==j._lastEnvMap){j._envMapTexture&&J.deleteTexture(j._envMapTexture);var q=j._envMapTexture=J.createTexture();J.activeTexture(J.TEXTURE0),J.bindTexture(J.TEXTURE_CUBE_MAP,q),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MAG_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,_),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,_),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,_),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,_),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,_),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,_),J.bindTexture(J.TEXTURE_CUBE_MAP,null),j._lastEnvMap=R}z.uEnvMap=j._envMapTexture}},getWireframe:function(q){var U=q.s("wf.visible"),M=q.s("wf.width");return U===!0||M>0&&"selected"===U&&this.isSelected(q)?{color:q.s("wf.color"),width:M,"short":q.s("wf.short"),mat:q.s("wf.mat")}:void 0},_transformPointToViewSpace:function(_){var M=[_[0],_[1],_[2]];return wd(M,this._viewMatrix),M},_transformDirectionToViewSpace:function(b,t){var h=[b[0],b[1],b[2]];wd(h,this._viewMatrix);var V=t?[t[0],t[1],t[2]]:[0,0,0];wd(V,this._viewMatrix);var G=V[0]-h[0],F=V[1]-h[1],c=V[2]-h[2],$=Math.sqrt(G*G+F*F+c*c);return $?[G/$,F/$,c/$]:[G,F,c]},getWireframeGeometry:function(g){return g.s("wf.geometry")?{color:g.s("wf.color"),width:g.s("wf.width"),mat:g.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(k){return k.s("body.color")},getMat:function(F){return F.getMat?F.getMat():F.s("mat")},getFaceMat:function(w,N){return w.getFaceMat?w.getFaceMat(N):w.s(N+".mat")},getFaceBlend:function(R,e){return R.s(e+".blend")||R.s("all.blend")},getFaceColor:function(N,J){return N.s(J+".color")||N.s("all.color")},getFaceImage:function(Y,t){return Y.s(t+".image")||Y.s("all.image")},getFaceBlendImage:function(c,f){return c.s(f+".blend.image")||c.s("all.blend.image")},getFaceDiscardSelectable:function(E,k){var Z=E.s(k+".discard.selectable");return Z==B?E.s("all.discard.selectable"):Z},getFaceUv:function(n,e){return n.s(e+".uv")||n.s("all.uv")},getFaceUvOffset:function(B,M){return B.s(M+".uv.offset")||B.s("all.uv.offset")},getFaceUvScale:function(R,a){return R.s(a+".uv.scale")||R.s("all.uv.scale")},getFaceLight:function(q,G){var o=q.s(G+".light");return o==B?q.s("all.light"):o},getFaceVisible:function(J,F){var I=J.s(F+".visible");return I==B?J.s("all.visible"):I},getFaceOpacity:function(q,O){var G=q.s(O+".opacity");return G==B?q.s("all.opacity"):G},getFaceTransparent:function(t,Z){var c=t.s(Z+".transparent");return c==B?t.s("all.transparent"):c},getFaceReverseColor:function(K,u){return K.s(u+".reverse.color")||K.s("all.reverse.color")},getFaceReverseFlip:function(d,s){var X=d.s(s+".reverse.flip");return X==B?d.s("all.reverse.flip"):X},getFaceReverseCull:function(N,b){var D=N.s(b+".reverse.cull");return D==B?N.s("all.reverse.cull"):D},getTextureMap:function(){return this._2O},deleteTexture:function(N){var K=this,B=K._2O[N];B&&(delete K._2O[N],K.getGL().deleteTexture(B))},invalidateShape3dCachedImage:function(N){var D=this.getData3dUI(N);D.invalidateCachedTexture(this.getGL())},isInteractive:function(t){return t.s("interactive")},getTexture:function(U,C){if(!U)return B;var y=this,$=y.getGL(),r=y._2O[U];if(!r){var Z=Ve(U);if(!Z)return $._emptyTexture;if(Z.uuid||(Z.uuid=u.Math.generateUUID()),Z.tagName){if(Z.dynamic)return vc($,Z,y._1O);r=y._2O[U]=vc($,Z)}else{var K,f=C&&C.s("shape3d.image.cache")&&!y.isInteractive(C),k=y.vr.isPresenting();if(k&&(C._textureUpdateFrame===$._renderInfo.frame?f=!0:C._textureUpdateFrame=$._renderInfo.frame),f&&(K=y.getData3dUI(C),r=K.getCachedTexture()),!r){if(f){if($._renderInfo.cacheTimeCost>w.graph3dMaxVectorCacheTime)return y.redraw(),$._emptyTexture;if(!zi(Z,C))return $._emptyTexture}var A,b=C&&C.s("shape3d.fixSizeOnScreen"),M=b?$.NEAREST:$.LINEAR;b||C&&C.s("shape3d.vector.dynamic")&&(K||(K=y.getData3dUI(C)),b=K.getVectorDynamicSize(),b&&(A=y.getDevicePixelRatio(),b[0]*=A,b[1]*=A));var d,Y,g=C&&C.s("shape3d.texture.scale")||1;if(b?(A||(A=y.getDevicePixelRatio()),d=b[0]>0?b[0]:g*Sg(Z,C)*A,Y=b[1]>0?b[1]:g*Xd(Z,C)*A):(d=g*Sg(Z,C),Y=g*Xd(Z,C)),d>=1&&Y>=1){var D=0;f&&(D=Date.now());var T=hn(d,Y);if(!K&&C&&(K=y.getData3dUI(C)),K&&K.interactiveInfo){var o=U;"object"==typeof o&&(o=o.uuid||(o.uuid=u.Math.generateUUID()));var N=K.interactiveInfo[o]={};T.interactiveInfo=N.bodyInfo={compInfos:[],matrix:new aq,rect:{x:0,y:0,width:d,height:Y}}}rj(T,Z,0,0,d,Y,C,y),T.interactiveInfo&&(T.interactiveInfo=null),T.restore(),f||k?(r=vc($,Up,null,M),K.setCachedTexture(r),$._renderInfo.cacheTimeCost+=Date.now()-D,Up=null):r=vc($,Up,y._1O,M)}}}}return r},redraw:function(){this.iv()},validateImpl:function(){var Z=this;if(Z._lightChanged){Z._lightChanged=!1;var q=[],T=[],v=[];Z.dm().each(function(k){if(lh(k)){var O=k.s("light.type");O===il?q.push(k):O===mi?T.push(k):O===io&&v.push(k)}}),(q.length!==Z._59O.length||T.length!==Z._spots.length||v.length!==Z._dirs.length)&&Rj(Z),Z._59O=q,Z._spots=T,Z._dirs=v}Z._42(),Z._1o.iv()},getRenderInfo:function(){var h=this.getGL();return h?h._renderInfo:void 0},getDebugTip:function(){var Y=this,K=Y.getRenderInfo();if(K){var E=Y.getGL()._validBufCount||0,P="Draw Calls: "+K.calls+"<br/>"+"Vertices: "+K.vertices+"<br/>"+"Faces: "+K.faces+"<br/>"+"Lines: "+K.lines+"<br/>"+"Buffer Count: "+E;return Y.vr.isPresenting()&&(P+="<br/>VR fps: "+Y.vr.getFps()),P}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var f=new u.Math.Box3,J=new u.Math.Matrix4;return function(_){var Y=_;if(Y instanceof u.Data&&(Y=this.getData3dUI(Y)),!Y.mat)return!0;var p=Y.getBoundingBox();f.copy(p).applyMatrix4(J.fromArray(Y.mat));var d=this.getFrustum();return d.intersectsBox(f)}}(),updateScene:function(){this._renderLists.init();var h,O,b,Q=this.dm().getDatas().getArray(),R=Q.length,s=this.getGL(),e=this._renderLists;for(h=0;R>h;h++)O=Q[h],b=this.getData3dUI(O),b&&b.update(this,s,e)},enableShadow:function(l,w){return this.shadowMap.setShadow(l,w)},renderScene:function(){function L(l,C){f.setGLState(l,C),f.setUniforms(l),f.renderState.attribs.disable(),T=$.directUniforms(),y=$.directAttribs(),y.disable()}function G(_){for(;q>o;o++){var P=R[o];if(!c||!P.ignoreInPick){if(P.priority>=_)break;P.render(s,d,f),L()}}}var d=this;d.shadowMap.render();var y,f=d._frameState,$=f.renderState,m=$.glState,T=$.directUniforms(),s=d.getGL(),Z=d._prg;$.syncLoss(),d._projectMatrix=tl(d),Yg(d,d._7O),d._viewMatrix=rs(d._7O),f.syncEnv(this._picking?this.pickColorMap:I),$.useProgram(Z),L(!1,!0);var c=d._picking,R=this._cameras,o=0,q=R.length;if(G(w.cameraPriority.skybox),c){var C=m.color.clear.slice(0);go(s,[0,0,0,0])}else go(s,[0,0,0,0]),m.blend.enabled=!1,m.depth.enabled=!1,m.depth.mask=!1,d.drawSky(s,Z),d.drawReflectors(s)&&(d._projectMatrix=tl(d),Yg(d,d._7O),d._viewMatrix=rs(d._7O),f.syncEnv(),L()),m.blend.enabled=!1,m.depth.enabled=!0,m.depth.mask=!0,T.uTransparent=!1,d._31O._42(s,Z),d.shadowMap.enable&&d.shadowMap.createShadow(T);for(var e=0,X=nl.length;X>e;e++){var A=nl[e],n=Rb[A];if(!n.ignore){var O=n.priority;G(O),this.renderLayer(A)}}m.depth.enabled=!1,T.uTransparent=!1,c?d._30O._42(s,Z):(m.blend.enabled=!1,m.depth.mask=!0,d._32O._42(s,Z),d._30O._42(s,Z),d._highlightHelper._42(s,Z)),m.depth.enabled=!0,G(w.cameraPriority.infinity),c&&go(s,C),Jj(s,B),Re(s,B)},renderLayers:function(n,Q){Q&&(n=yb(n));for(var C=0,f=n.length;f>C;C++)this.renderLayer(n[C])},renderLayer:function(n){var $=this,J=$._picking,y=$._renderLists.get(n);if(y){var P,V,p,g=$.getGL(),E=$._frameState,c=E.renderState,L=c.glState,e=c.directUniforms(),u=y.opaque,K=y.transparent,o=y.batchModelMap,x=y.polylineModelMap,r=y.wireframeModelMap,g=$.getGL(),D=$._prg;J||(L.blend.enabled=!1,L.depth.enabled=!0,L.depth.mask=!0),e.uTransparent=!1,g.clear(g.DEPTH_BUFFER_BIT);var a=this.drawFilter;if(a)for(p=u,P=0,V=p.length;V>P;P++)a(p[P].data)!==!0&&p[P].ui._42(g,D,X);else{for(p=u,P=0,V=p.length;V>P;P++)p[P].ui._42(g,D,X);$f($,o),Wl($,x),Wl($,r)}if(J||(L.blend.enabled=!0,L.depth.mask=!1),e.uTransparent=!0,a)for(p=K,P=0,V=p.length;V>P;P++)a(p[P].data)!==!0&&p[P].ui._42(g,D,O);else{for(p=K,P=0,V=p.length;V>P;P++)p[P].ui._42(g,D,O);$f($,o,null,!0),Wl($,x,null,!0),Wl($,r,null,!0)}}},drawV2:function(X){var u=this;if(!u._35O&&(!Zk||$k(Zk))){var f=u.getWidth(),v=u.getHeight();if(f&&v){var N=u.getGL();if(N){var S=u._canvas;X||(X=u.getDevicePixelRatio()),(f!==S.clientWidth||v!==S.clientHeight)&&(Lg(S,f,v,X),f&&N.drawingBufferWidth!==f*X&&(u.setDevicePixelRatio(X=N.drawingBufferWidth/f),Lg(S,f,v,X)),u._18Q=null),N.clear(N.COLOR_BUFFER_BIT);var K=N._renderInfo;K.calls=0,K.vertices=0,K.faces=0,K.lines=0,K.frame=++u._frameId,K.cacheTimeCost=0,u._81O=B,u.overlappingBox.clear(),u.updateScene(),u._prg,f*=X,v*=X,u._postProcessing._42(N,f,v)||(u.setViewport(N,0,0,f,v),u.renderScene()),u._33Q=!1,u.countFrame(),u._doBufferGC(N)}}}},_42:function(t,K){return this.drawV2(K)},drawReflectors:function(M){var R,$,B,T=this,z=T._dataModel.getReflectors(),I=!1;for(R in z)$=z[R],T.isVisible($)&&(B=T.getData3dUI($),B&&B.drawReflector(M)&&(I=!0));return I},enablePostProcessing:function(s,Z){return this._postProcessing.enableModule(s,Z)},getPostProcessingModule:function(T){return this._postProcessing.getModule(T)},setViewport:function(b,i,j,l,Z){this._viewport=[i,j,l,Z],cn.for(b).directState().viewport=this._viewport},getViewport:function(){return this._viewport},setBufferGCInterval:function(y){this._bufferGCInterval=y},_doBufferGC:function(p,W){var u,N,q=p._bufPool,S=0,e=0,K=p._renderInfo.frame,n=this._bufferGCInterval||10;for(u in q)S++,N=q[u],N&&(W||K-N._fid>n?(p.deleteBuffer(N._buf),N._buf=null,q[u]=null):e++);if(S/2>e&&S>128){var t={};for(u in q)q[u]&&(t[u]=q[u]);p._bufPool=t}p._validBufCount=e},_swapLineMap:function(){var p=this;jj=p._polylineModelMap,p._polylineModelMap=p._polylineModelMapSwap,p._polylineModelMapSwap=jj,jj=p._wireframeModelMap,p._wireframeModelMap=p._wireframeModelMapSwap,p._wireframeModelMapSwap=jj,jj=p._polylineIndexMap,p._polylineIndexMap=p._polylineIndexMapSwap,p._polylineIndexMapSwap=jj,jj=p._wireframeIndexMap,p._wireframeIndexMap=p._wireframeIndexMapSwap,p._wireframeIndexMapSwap=jj},_updateSkyBox:function(O){if(this._skyBox&&O){var H=O.property,t=!1,B=this._skyBox;if("eye"===H||"forceUpdate"===H){var X=this._eye;B.p3(X[0],X[1],X[2]),t=!0}if("near"===H||"far"===H||"forceUpdate"===H){var W=this._near,e=this._far,i=B.getFinalScale3d();if(i[0]/=2,i[1]/=2,i[2]/=2,i[0]<=W||i[0]>=e||i[1]<=W||i[1]>=e||i[2]<=W||i[2]>=e){var P=2*W*e/(W+e),R=Math.min(i[0],i[1],i[2]),f=P/R,p=B.getScale3d();B.setScale3d(p[0]*f,p[1]*f,p[2]*f),t=!0}}t&&this.invalidateData(B)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(L){var t=this._skyBox;t&&(this._skyBoxStyleMap&&t.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&t.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&t.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=L,this.ump(this._updateSkyBox,this),L&&(L.dm()&&L.dm().remove(L),this._skyBoxStyleMap=u.Default.clone(L.getStyleMap()),this._skyBoxAnchor3d=L.getAnchor3d(),L.setAnchor3d(.5,.5,.5),this._skyBoxP3=L.p3().slice(0),L.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",t,L)},drawSky:function(F,L){var O=this,u=O._skyBox;if(u){var q=cn.for(F).directUniforms(),n=O._headlightIntensity,z=Dk(O._headlightColor),L=O._prg;1!==n&&(z=[z[0]*n,z[1]*n,z[2]*n]),q.uHeadlightColor=[z[0],z[1],z[2],1];var t=O.getData3dUI(u);if(t){var P=O.isOrtho(),g=P||this._computedProjectMatrix;if(g){var k=O._projectMatrix;P&&(O._ortho=!1),q.uPMatrix=O._projectMatrix=tl(O,!0)}t.validate(),t._42(F,L,V),g&&(P&&(O._ortho=!0),q.uPMatrix=O._projectMatrix=k)}F.clear(F.DEPTH_BUFFER_BIT),q.uHeadlightColor=[z[0],z[1],z[2],O._headlightDisabled?1:0]}},getLogicalPoint:function(p){return xn(p,this._canvas)},isRectOverlapping:function(L){var Q=this.getData3dUI(L);return Q._rectOverlapping},getHitFaceInfo:function(x){x.target&&(x=this.lp(x));var Q=this.getDataInfoAt(x);if(Q){var F=this.intersectObject(x,Q.data);if(F)return{data:Q.data,face:F.part}}return B},unproject:function(X,E){var $=this,J=$.getWidth(),P=$.getHeight(),A=X.target?$.lp(X):X,S=A.x-J/2,M=A.y-P/2,C=2*(S/J),W=2*(-1*M/P);E=E||0;var F=Gf(),e=tl($),O=Yg($);Yb(F,e,O),Cq(F);var d=He([C,W,E,1],F);return[d[0]/d[3],d[1]/d[3],d[2]/d[3]]},getDataAt:function(u){var k=this.getDataInfoAt(u);return k?k.data:B},getDataInfoAt:function(i,u){return i.target&&(i=this.lp(i)),this._1o.get(oq(i.x,i.y,u),!0)},getDatasInRect:function(y){return this._1o.get(y)},setEditable:function(I){var w=this,L=w._editable;w._editable=I,this.fp(wn,L,I)},isEditable:function(f){var j=this;return j._editable?$o(f)?f.s("3d.editable")?j._editableFunc?j._editableFunc(f):!0:!1:!1:!1},isSelectable:function(w){return w.s("3d.selectable")&&this.sm().isSelectable(w)},isMovable:function(l){var g=this;return cr(l)&&l.getStyle(kr)!==tf?!1:l.s("3d.movable")?g._movableFunc?g._movableFunc(l):!0:!1},isSizeEditable:function(b){return $o(b)?this._sizeEditableFunc?this._sizeEditableFunc(b):!0:!1},isRotationEditable:function(Q){return $o(Q)&&Q.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(Q):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(H){this.setZoom(Vm,H)},zoomOut:function(f){this.setZoom(1/Vm,f)},setZoom:function(h,H){if(1!==h){var C=this;if(C._ortho)return C.setOrthoZoom(h,H),void 0;C._14o&&C._14o.stop(!0);var Y=1/h,i=C._eye,s=C._center,O=s[0]+(i[0]-s[0])*Y-i[0],k=s[1]+(i[1]-s[1])*Y-i[1],T=s[2]+(i[2]-s[2])*Y-i[2];if(!(Ke(i,s)<C._moveStep&&1>Y)){if(H=Aq(H)){var j=Sf(i);return H.action=function(b){C.fi({kind:C._zooming?"betweenZoom":"beginZoom"}),C._zooming=1,i[0]=j[0]+O*b,i[1]=j[1]+k*b,i[2]=j[2]+T*b,C.fp(gd,B,i)},H._37o=function(){delete C._14o,delete C._zooming,C.fi({kind:"endZoom"}),C.onZoomEnded()},C._14o=Qh(H)}i[0]+=O,i[1]+=k,i[2]+=T,C.fp(gd,B,i)}}},setOrthoZoom:function(e,A){if(1!==e){var y=this;y._14o&&y._14o.stop(!0);var $=y._orthoWidth,Z=$/e-$;if(!($<y._moveStep&&e>1))return(A=Aq(A))?(A.action=function(h){y.fi({kind:y._zooming?"betweenZoom":"beginZoom"}),y._zooming=1,y.setOrthoWidth($+Z*h)},A._37o=function(){delete y._14o,delete y._zooming,y.fi({kind:"endZoom"}),y.onZoomEnded()},y._14o=Qh(A)):(y.setOrthoWidth($/e),void 0)}},getPositionInfo:function(u){var q=this,k=q._eye,X=q._center,g=q.getAspect(),t=u?qg(Gc(X,k,!0),Gc(u,k)):Ke(k,X);if(q._ortho){var D=q._orthoWidth;return{length:t,height:D/g,width:D}}var F=2*N(q._fovy/2)*t;return{length:t,height:F,width:F*g}},getCenterInfo:function(){var N=this;return N._81O||(N._81O=N.getPositionInfo()),Sf(N._81O)},rotate:function(r,x,H,u){var k=this;if(r||x){u==B&&(u=k._firstPersonMode),k._88O&&k._88O.stop(!0);var Q=k._center,C=k._eye,F=k.getCenterInfo().length,A=u?Q:C,b=u?C:Q,Y=Gc(A,b),c=v(Y[0],Y[2]),_=v(h(Y[0]*Y[0]+Y[2]*Y[2]),Y[1]),f=u?Qo:gd;return u&&(x=-x),(H=Aq(H))?(H.action=function(I){k.fi({kind:k._rotating?"betweenRotate":"beginRotate"}),k._rotating=1;var y=c+r*I,L=_+x*I;L=ud(L),Y[0]=F*q(L)*q(y),Y[1]=F*n(L),Y[2]=F*q(L)*n(y),A[0]=b[0]+Y[0],A[1]=b[1]+Y[1],A[2]=b[2]+Y[2],k.fp(f,B,A)},H._37o=function(){delete k._88O,delete k._rotating,k.fi({kind:"endRotate"}),k.onRotateEnded()},k._88O=Qh(H)):(c+=r,_+=x,_=ud(_),Y[0]=F*q(_)*q(c),Y[1]=F*n(_),Y[2]=F*q(_)*n(c),A[0]=b[0]+Y[0],A[1]=b[1]+Y[1],A[2]=b[2]+Y[2],k.fp(f,B,A),void 0)}},pan:function(W,f,k,v){if(W||f){var n=this;v==B&&(v=n._firstPersonMode),n._89O&&n._89O.stop(!0);var Q=Yg(n),r=[Q[0]*W,Q[4]*W,Q[8]*W],P=[Q[1]*f,Q[5]*f,Q[9]*f],b=r[0]+P[0],o=r[1]+P[1],D=r[2]+P[2],j=n._center,S=n._eye;if(v){var p=Qm(n.getBoundaries(),S[0],S[2],S[0]+b,S[2]+D,h(b*b+D*D));b=p[0],D=p[1]}if(k=Aq(k)){var x=Sf(S),F=Sf(j);return k.action=function(t){n.fi({kind:n._panning?"betweenPan":"beginPan"}),n._panning=1,j[0]=F[0]+b*t,j[1]=F[1]+o*t,j[2]=F[2]+D*t,S[0]=x[0]+b*t,S[1]=x[1]+o*t,S[2]=x[2]+D*t,n.fp(gd,B,S),n.fp(Qo,B,j)},k._37o=function(){delete n._89O,delete n._panning,n.fi({kind:"endPan"}),n.onPanEnded()},n._89O=Qh(k)}j[0]+=b,j[1]+=o,j[2]+=D,S[0]+=b,S[1]+=o,S[2]+=D,n.fp(gd,B,S),n.fp(Qo,B,j)}},walk:function(P,v,l){if(P){var T=this;l==B&&(l=T._firstPersonMode),T._90O&&T._90O.stop(!0);var O=T._center,W=T._eye,R=Gc(O,W,!0);if(l){var D=Qm(T.getBoundaries(),W[0],W[2],W[0]+R[0]*P,W[2]+R[2]*P,j(P));if(P=Ke(D),!P)return;R=[D[0]/P,0,D[1]/P]}if(v=Aq(v)){var p=Sf(W),h=Sf(O);return v.action=function(J){T.fi({kind:T._walking?"betweenWalk":"beginWalk"}),T._walking=1;var S=P*J;W[0]=p[0]+R[0]*S,W[1]=p[1]+R[1]*S,W[2]=p[2]+R[2]*S,O[0]=h[0]+R[0]*S,O[1]=h[1]+R[1]*S,O[2]=h[2]+R[2]*S,T.fp(gd,B,W),T.fp(Qo,B,O)},v._37o=function(){delete T._90O,delete T._walking,T.fi({kind:"endWalk"}),T.onWalkEnded()},T._90O=Qh(v)}W[0]+=R[0]*P,W[1]+=R[1]*P,W[2]+=R[2]*P,O[0]+=R[0]*P,O[1]+=R[1]*P,O[2]+=R[2]*P,T.fp(gd,B,W),T.fp(Qo,B,O)}},handleScroll:function(b,y){b.preventDefault();var V=this,o=V._moveStep,j=V.getDataInfoAt(b);if(j){var _=j.data;if(_&&V.isInteractive(_)){var k=V.intersectObject(b,_);if(k){var S=k.part,u=Ve(_.s(S+".image")||_.s("shape3d."+S+".image")||_.s("all.image")||_.s("shape3d.image"));if(u&&lg(u.scrollable,_,V))return}}}V.isFirstPersonMode()?V.isPannable()&&V.pan(0,y>0?o:-o):V.isZoomable()&&V.setZoom(0>y?1/Lo:Lo)},handlePinch:function(q,E){this.isZoomable()&&this.setZoom(E>q?1/mr:mr)},reset:function(){this.setCenter(w.graph3dViewCenter),this.setEye(w.graph3dViewEye),this.setUp(w.graph3dViewUp)},moveSelection:function(c,s,h){var $=this;$.dm().beginTransaction(),xo(this.sm().toSelection(this.isMovable,this),c,s,h),$.dm().endTransaction()},getMoveMode:function(T,W){var X=W.s("3d.move.mode");if(X)return X;var r="88",i="89",q="90";return us(T)||Hr[r]&&Hr[i]&&Hr[q]?"xyz":Hr[r]&&Hr[i]?"xy":Hr[r]&&Hr[q]?"xz":Hr[i]&&Hr[q]?"yz":Hr[r]?"x":Hr[i]?"y":Hr[q]?"z":"xz"},handleTick:function(){var W=this,J=!1,L=W._moveStep,a=L,$=!1,F=!0,E=W._rotateStep*(F?-1:1);if(W.isWalkable()||(a=0),W.isPannable()||(L=0),W.isRotatable()||(E=0),W._32Q){var n=(np()-W._32Q)/50;a*=n,L*=n,E*=n}W._31Q&&(bp(W._31Q),delete W._31Q,delete W._32Q),eg()&&(J=!0,W.pan(-L,0,$,F)),kb()&&(J=!0,W.pan(L,0,$,F)),An()&&(J=!0,us()?W.pan(0,L,$,F):W.walk(a,$,F)),Cf()&&(J=!0,us()?W.pan(0,-L,$,F):W.walk(-a,$,F)),Bk()&&(J=!0,W.rotate(-E,0,$,F)),Vc()&&(J=!0,W.rotate(E,0,$,F)),ls()&&(J=!0,W.rotate(0,-E/2,$,F)),gm()&&(J=!0,W.rotate(0,E/2,$,F)),J&&(W._32Q=np(),W._31Q=Wo(W.handleTick,W))},handleKeyDown:function(m){var $=this;!Di(m)&&Al[m.keyCode]?$.handleTick():Ui(m)?$.selectAll():_e(m)?$.handleDelete(m):Rg(m)&&this.isResettable()&&$.reset()},checkDoubleClickOnNote:function(C,t,z){var d=this;if(z===Ml){if(t.s("note.toggleable"))return t.s(nb,!t.s(nb)),d.fi({kind:"toggleNote",event:C,data:t,part:z}),!0}else if(z===an&&t.s("note2.toggleable"))return t.s(To,!t.s(To)),d.fi({kind:"toggleNote2",event:C,data:t,part:z}),!0;return!1},checkDoubleClickOnRotation:function(Y,b,i){return i===Xb?(b.setRotationX(0),!0):i===dj?(b.setRotationY(0),!0):i===lm?(b.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(Z){var i=this;if(i.isOrtho())return i.getWidth()/i.getOrthoWidth();var V=i.getCenter(),h=i.getHeight(),O=i.getEye(),I=[V[0]-O[0],V[1]-O[1],V[2]-O[2]],g=[Z[0]-O[0],Z[1]-O[1],Z[2]-O[2]],q=Math.sqrt(I[0]*I[0]+I[1]*I[1]+I[2]*I[2]),A=1/Math.tan(i.getFovy()/2);return h*q*A/(g[0]*I[0]+g[1]*I[1]+g[2]*I[2])},inViewSpace:function(I){var i,E=this,N=E._transformPointToViewSpace(I),S=E.getAspect(),M=E.getNear(),Y=E.getFar();return-N[2]<M||-N[2]>Y?!1:E.isOrtho()?(i=E.getOrthoWidth()/2,Math.abs(N[0])<=i&&Math.abs(N[1]*S)<=i):(i=Math.sqrt(N[0]*N[0]+N[1]*N[1]+N[2]*N[2])*Math.tan(E.getFovy()/2),Math.abs(N[1]<=i)&&Math.abs(N[0])<=i*S)},getPVMatrix:function(){var C,R=this;return(C=R._18Q)||(C=tl(R),R._18Q=Yb(C,C,Yg(R)),R._18Q._wh=R.getWidth()/2/R.getHeight()),C},getFrustum:function(){var t=new Oo,B=new Mr,R=new Array(16);return function(){for(var I=this.getPVMatrix(),P=!1,s=0;16>s;s++)I[s]!==R[s]&&(P=!0,R[s]=I[s]);return P&&B.setFromMatrix(t.fromArray(I)),B}}(),toViewPosition:function(A){var n=this,z=n.getWidth()/2,N=n.getHeight()/2,J=n.getPVMatrix();return A=He([A[0],A[1],A[2],1],J),{x:z+z*A[0]/A[3],y:N-N*A[1]/A[3],z:A[2]/A[3]}},getHitPosition:function(K,y,z){var m=this,i=m.getWidth(),Y=m.getHeight(),Q=K.target?m.lp(K):K,x=Q.x-i/2,s=Q.y-Y/2,f=m.getCenterInfo(),S=Yg(m);y=y?y:[0,0,0],z=z?z:[0,1,0],x=x/i*f.width,s=-1*s/Y*f.height;var a=[S[0]*x,S[4]*x,S[8]*x],V=[S[1]*s,S[5]*s,S[9]*s],d=[a[0]+V[0],a[1]+V[1],a[2]+V[2]],q=m.getCenter(),k=Nh(m,y,z,[d[0]+q[0],d[1]+q[1],d[2]+q[2]]);return k?k:[0,0,0]},intersectObject:function(W,E){return this._raycaster.intersectObject(W,E)},intersectObjects:function(n,q,P){return this._raycaster.intersectObjects(n,q,P)},getLineLength:function(B){this.validate();var S=this.getData3dUI(B);if(S&&S.getCache){var Q=S.getCache();if(Q)return Q[Q.length-1].length}return 0},getLineOffset:function(o,I){var X=this.getData3dUI(o);if(X&&X.getCache){var v=X.getCache();if(v){var S=zq(v,I),Z=o.r3();if(0===Z[0]&&0===Z[1]&&0===Z[2])return S;var H=new pe(o.p3()),a=new pe(S.point).sub(H),Q=new pe(S.tangent).add(a),L=(new So).setFromEuler(new vs(Z,o.getRotationMode(),!0));return a.applyQuaternion(L),Q.applyQuaternion(L),{point:a.add(H),tangent:Q.sub(a).normalize()}}}return B},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(y,W,t){var i=this,u=i.getEye();u=[u[0],u[1],u[2]];var D=i.getCenter();if(D=[D[0],D[1],D[2]],y||(y=u),W||(W=D),i._flyAnim&&i._flyAnim.stop(!0),t=Aq(t),!t)return i.setEye(y[0],y[1],y[2]),i.setCenter(W[0],W[1],W[2]),delete i._flyAnim,!0;var A=[y[0]-u[0],y[1]-u[1],y[2]-u[2]],l=[W[0]-D[0],W[1]-D[1],W[2]-D[2]];return t.action=function(I){i.setCenter(D[0]+l[0]*I,D[1]+l[1]*I,D[2]+l[2]*I),i.setEye(u[0]+A[0]*I,u[1]+A[1]*I,u[2]+A[2]*I)},t._37o=function(){delete i._flyAnim},i._flyAnim=Qh(t)},flyTo:function(){function W(M,g,J){if(J instanceof u.Node){$.fromArray(Lm(J,g.getMat(J)));var j=J.getAnchor3d();M.push((new pe).set(0-j.x,0-j.y,0-j.z).applyMatrix4($)),M.push((new pe).set(0-j.x,0-j.y,1-j.z).applyMatrix4($)),M.push((new pe).set(0-j.x,1-j.y,0-j.z).applyMatrix4($)),M.push((new pe).set(0-j.x,1-j.y,1-j.z).applyMatrix4($)),M.push((new pe).set(1-j.x,0-j.y,0-j.z).applyMatrix4($)),M.push((new pe).set(1-j.x,0-j.y,1-j.z).applyMatrix4($)),M.push((new pe).set(1-j.x,1-j.y,0-j.z).applyMatrix4($)),M.push((new pe).set(1-j.x,1-j.y,1-j.z).applyMatrix4($))}}var d=new pe,k=new pe,O=new pe,t=new pe,$=new Oo,B=new u.Math.Quaternion,L=new vs;return function(h,m,i){var V=this;if(i!==I)m={animation:m,ratio:i};else{var P=typeof m;("boolean"===P||"object"===P&&m.duration)&&(m={animation:m})}m=m||{},d.fromArray(V.getEye()),k.fromArray(V.getCenter());var _,C,N=[],R=m.center,x=m.distance===I;if(R&&O.fromArray(R),h instanceof u.Node)R||O.fromArray(h.p3()),x&&(W(N,V,h),_=N.length);else{if(h||(h=V.dm().getDatas()),!h.length)return;if((x||!R)&&(N=[],h.forEach(function(q){W(N,V,q)}),_=N.length),!_)return;if(!R){for(O.set(0,0,0),C=0;_>C;C++)O.add(N[C]);O.multiplyScalar(1/_)}}if(V.setCenter(O.x,O.y,O.z),t.subVectors(d,k),m.direction||m.worldDirection){!m.worldDirection&&h instanceof u.Node?B.setFromEuler(L.set(h.r3(),h.getRotationMode(),!0)):B.set(0,0,0,1);var F=t.length();t.fromArray(m.worldDirection||m.direction).applyQuaternion(B).setLength(F)}if(x){for(var n,g,A,S,e,s=V.getNear(),b=10,i=m.ratio||.8;b--;){for(V._eye[0]=t.x+O.x,V._eye[1]=t.y+O.y,V._eye[2]=t.z+O.z,n=tl(V),Yb(n,n,Yg(V)),S=!0,e=-1/0,C=0;_>C;C++){if(A=N[C],g=He([A.x,A.y,A.z,1],n),g[3]<s&&b){t.multiplyScalar(2),S=!1;break}e=Math.max(e,Math.max(Math.abs(g[0]),Math.abs(g[1]))/i-g[3])}if(S)break}t.setLength(e+t.length()).add(O)}else t.setLength(m.distance).add(O);V._flyAnim&&V._flyAnim.stop(!0);var f=Aq(m.animation);if(f){V.setEye(d.x,d.y,d.z),V.setCenter(k.x,k.y,k.z);var E=(new pe).subVectors(t,d),y=(new pe).subVectors(O,k),T=new pe,l=new pe;return f.action=function(s){T.copy(d).addScaledVector(E,s),l.copy(k).addScaledVector(y,s),V.setCenter(l.x,l.y,l.z),V.setEye(T.x,T.y,T.z)},f._37o=function(){delete V._flyAnim},{lastEye:d,lastCenter:k,eye:t,center:O,animation:V._flyAnim=Qh(f)}}return V.setEye(t.x,t.y,t.z),delete V._flyAnim,{lastEye:d,lastCenter:k,eye:t,center:O}}}(),getBoundingBox:function(){function D(A,D,x){Z.fromArray(Lm(x,D.getMat(x)));var K=x.getAnchor3d();A.push((new pe).set(0-K.x,0-K.y,0-K.z).applyMatrix4(Z)),A.push((new pe).set(0-K.x,0-K.y,1-K.z).applyMatrix4(Z)),A.push((new pe).set(0-K.x,1-K.y,0-K.z).applyMatrix4(Z)),A.push((new pe).set(0-K.x,1-K.y,1-K.z).applyMatrix4(Z)),A.push((new pe).set(1-K.x,0-K.y,0-K.z).applyMatrix4(Z)),A.push((new pe).set(1-K.x,0-K.y,1-K.z).applyMatrix4(Z)),A.push((new pe).set(1-K.x,1-K.y,0-K.z).applyMatrix4(Z)),A.push((new pe).set(1-K.x,1-K.y,1-K.z).applyMatrix4(Z))}var Z=new Oo;return function(s){if(s=s||this.sm().getSelection(),s instanceof u.Node&&(s=[s]),0===s.length)return B;var U=[];s.forEach(function(k){D(U,this,k)},this);var I=[1/0,1/0,1/0],$=[-1/0,-1/0,-1/0];return U.forEach(function(z){I[0]=Math.min(z.x,I[0]),I[1]=Math.min(z.y,I[1]),I[2]=Math.min(z.z,I[2]),$[0]=Math.max(z.x,$[0]),$[1]=Math.max(z.y,$[1]),$[2]=Math.max(z.z,$[2])}),{min:I,max:$}}}()}),Uh.RenderEnv=function(n){this.gv=n,this.enable=!1},J.defineProperties(Uh.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(s){this._debugOn=s,this.capture&&this.capture()}}}),J.assign(Uh.RenderEnv.prototype,{renderEnvToCube:function(S,o,Z,D){var _=this,j=_.gv;if(!S||!o||!Z)return _.enable=!1,_._42=null,void 0;_.enable=!0;var R=Math.floor(D/S*o),h=j.getGL(),I=_._renderTargets;I?I.length<Z&&(I=_._renderTargets=I.concat(new Array(Z-I.length))):I=_._renderTargets=new Array(Z);for(var v=0;Z>v;v++)I[v]?I[v].setSize(h,D,R):I[v]=new Uh.RenderTarget(j,h,D,R);var O=!1;_.capture=function(){O=!0,j._42(),O=!1};var F=new pe,L=new pe,y=new pe,e=new pe,C=(new pe).setY(0),G=2*Math.PI/Z,P=S/2/Math.tan(Math.PI/Z),K=2*Math.atan2(o/2,P),M=S/o;_._42=function(o,Y,i,V){var f=_._debugOn;if(!O&&!f)return!1;F.copy(j.getEye()),e.copy(j.getCenter()).sub(F);var E=Math.atan2(e.z,e.x),u=j.getNear(),p=j.getFovy(),c=j.getAspect();L.copy(j.getCenter());for(var B,J=0;Z>J;J++)if(B=I[J],C.setZ(Math.cos(E)).setX(Math.sin(E)).multiplyScalar(P),E-=G,y.addVectors(F,C),j.setNear(P),j.setCenter([y.x,y.y,y.z]),j.setFovy(K),j.setAspect(M),f){var U=Math.round(Y/Z);cn.for(o).glState.viewport=[U*J,0,U,i],V()}else $b(o,B.frame),cn.for(o).glState.viewport=[0,0,B.width,B.height],o.clear(o.COLOR_BUFFER_BIT),V(),_j(o),B.assureTexture();return j.setNear(u),j.setCenter([L.x,L.y,L.z]),j.setFovy(p),j.setAspect(c),!0},_.capture()},getTextureInfo:function(k){var K=this._renderTargets;if(!K)return null;var S=this._renderTargets[k];return S?{index:k,texture:S.texture,textureName:S.uuid}:null
}}),J.assign(Uh.Graph3dView.prototype,{renderEnvToCube:function(S,i,n,v){var A=this;A.envRenderer||(A.envRenderer=new Uh.RenderEnv(A)),A.envRenderer.renderEnvToCube(S,i,n,v)}});var xr=["left","front","right","back","top","bottom"],Rq=Uh._RenderList=function(){function A(){N.length=0,c.length=0,s={}}function C(c){var H=c.gv,z=c.data;if(!H.isVisible(z)||f&&!m)return c._renderParams=null,void 0;var n,j,q,L,O=c.shapeModel;if(O){var N,Z,E,a=z.s("shape3d.transparent");for(Zh(O)||(N=lg(O.transparent,z,H),O=[O]),q=0,L=O.length;L>q;q++)E=O[q],Z=lg(E.transparent,z,H),Z===I&&(Z=N),Z===I&&(Z=a),Z?j=!0:n=!0}for(q=0,L=xr.length;L>q;q++){var s=c[xr[q]];s&&(s.transparent?j=!0:n=!0)}H.isLabelVisible(z)&&(c.labelInfo&&(z.s(Bd+".transparent")?j=!0:n=!0),c.label2Info&&(z.s(Ig+".transparent")?j=!0:n=!0)),H.isNoteVisible(z)&&(c.noteInfo&&(z.s(Ml+".transparent")?j=!0:n=!0),c.note2Info&&(z.s(an+".transparent")?j=!0:n=!0)),c._38o&&(j=n=!0),c._renderParams={opaque:n,transparent:j}}function _(A,V){V&&C(A);var w=A.data,g=w._id;if(!s[g]){s[g]=!0;var X=A._renderParams;X&&X.visible!==!1&&(A={ui:A,data:w,z:w._z,id:g},X.opaque&&N.push(A),X.transparent&&c.push(A))}}function r(){N.length>1&&N.sort(g),c.length>1&&c.sort(P)}function a(q){q?(cd(z,h,q),cd(u,y,q),cd(Z,K,q)):(z=this.batchModelMap={},h=this.batchIndexMap={},u=this.polylineModelMap={},y=this.polylineIndexMap={},Z=this.wireframeModelMap={},K=this.wireframeIndexMap={})}function n(f){f?cd(z,h,f):(z=this.batchModelMap={},h=this.batchIndexMap={})}function Y(N){N?cd(u,y,N):(u=this.polylineModelMap={},y=this.polylineIndexMap={})}function E(L){L?cd(Z,K,L):(Z=this.wireframeModelMap={},K=this.wireframeIndexMap={})}var N=[],c=[],z={},h={},u={},y={},Z={},K={},s={};return{opaque:N,transparent:c,init:A,push:_,batchModelMap:z,batchIndexMap:h,polylineModelMap:u,polylineIndexMap:y,wireframeModelMap:Z,wireframeIndexMap:K,ivBatch:a,ivModelBatch:n,ivPolylineBatch:Y,ivWireframeBatch:E,sort:r}},Xq=Uh._RenderLists=function(){function I(){for(var X in T)T[X].init()}function N(W,F){W=W||"main";var Y=T[W];return!Y&&F&&(Y=T[W]=new Rq),Y}function s(x,V){var I=x.data.getRenderLayer(),s=N(I,!0);s.push(x,V)}function F(K){for(var U in T)K(T[U])}var T={};return{init:I,get:N,push:s,each:F,lists:T}},Ji=Uh.RenderTarget=function(o,C,i,I,h){var Q=this;h=h||{},h.samples=Math.min(o._glCapabilities.maxSamples,h.samples&&h.samples>1&&2===o._webGLVersion?h.samples:0),Q.options=h,Q.uuid=u.Math.generateUUID(),Q.gv=o,Q.init(o,C,h),Q.setSize(C,i,I)};J.assign(Uh.RenderTarget.prototype,{bind:function(R){$b(R,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(g){_j(g),this.options.samples&&(g.bindFramebuffer(g.READ_FRAMEBUFFER,this._MSAAFbo),g.bindFramebuffer(g.DRAW_FRAMEBUFFER,this.frame),g.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,g.COLOR_BUFFER_BIT,g.NEAREST),g.bindFramebuffer(g.READ_FRAMEBUFFER,null),g.bindFramebuffer(g.DRAW_FRAMEBUFFER,null))},init:function(r,D,c){var l=this,j=l.texture=D.createTexture();D.activeTexture(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,j),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE);var s=c.samples,Q=s?D.NEAREST:D.LINEAR;D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,c.minFilter||Q),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,c.magFilter||Q),D.bindTexture(D.TEXTURE_2D,null),l.render=D.createRenderbuffer(),l.frame=D.createFramebuffer(),s&&(l._MSAAFbo=D.createFramebuffer(),l._MSAARbO=D.createRenderbuffer()),r._2O[l.uuid]=j},assureTexture:function(){var V=this,S=V.uuid,H=V.gv._2O;H[S]||(H[S]=V.texture)},setSize:function(E,i,w){var k=this;if(i&&w&&(k.width!==i||k.height!==w)){var D=E.RGBA,_=E.TEXTURE_2D,d=E.RENDERBUFFER,U=E.FRAMEBUFFER,T=k.options.samples;E.activeTexture(E.TEXTURE0),eb(E,k.texture),E.texImage2D(_,0,D,i,w,0,D,E.UNSIGNED_BYTE,B),E.bindRenderbuffer(d,k.render),T?E.renderbufferStorageMultisample(d,T,E.DEPTH_COMPONENT16,i,w):E.renderbufferStorage(d,E.DEPTH_COMPONENT16,i,w),$b(E,k.frame),E.framebufferTexture2D(U,E.COLOR_ATTACHMENT0,_,k.texture,0),T||E.framebufferRenderbuffer(U,E.DEPTH_ATTACHMENT,d,k.render),_j(E),T&&(E.bindRenderbuffer(E.RENDERBUFFER,k._MSAARbO),E.renderbufferStorageMultisample(E.RENDERBUFFER,T,E.RGBA8,i,w),$b(E,k._MSAAFbo),E.framebufferRenderbuffer(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.RENDERBUFFER,k._MSAARbO),E.framebufferRenderbuffer(U,E.DEPTH_ATTACHMENT,d,k.render),_j(E)),eb(E,B),E.bindRenderbuffer(d,B),k.width=i,k.height=w}},toCanvas:function(){var f=this,T=f.gv.getGL();$b(T,f.frame);var G=f.width,c=f.height,g=new Uint8Array(4*G*c);T.readPixels(0,0,G,c,T.RGBA,T.UNSIGNED_BYTE,g),_j(T);var n=b.createElement("canvas");n.width=G,n.height=c;var m=n.getContext("2d"),R=m.createImageData(G,c);return R.data.set(g),m.putImageData(R,0,0),n}});var tq=Uh.Interactor=function(Y){this.gv=Y};ys("Interactor",J,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Lc=Uh.DefaultInteractor=function(w){lr(Lc,this,[w])};ys("DefaultInteractor",tq,{handle_contextmenu:function(G){xh(G)},handle_mousewheel:function(K){this.gv.handleScroll(K,K.wheelDelta/40)},handle_DOMMouseScroll:function(e){2===e.axis&&this.gv.handleScroll(e,-e.detail)},handle_keydown:function(Q){this.gv.handleKeyDown(Q)},handle_mousedown:function(v){this.handle_touchstart(v)},handle_touchstart:function(L){xh(L);var E=this,o=E.gv,U=yi(L),b=o.getDataInfoAt(L),q=b?b.data:B,v=b?b.part:B,S=o.sm(),k=sj(L),N=Kl(L);o.setFocus(L)&&(E._62O=B,E._57I=B,q?Di(L)?S.co(q)?S.rs(q):S.as(q):S.co(q)||S.ss(q):U&&(Di(L)?o.isRectSelectable()&&(E._62O=oc):E._57I=pr(L)),E._31Q&&(bp(E._31Q),delete E._31Q,delete E._32Q),E._62O||(o.isFirstPersonMode()&&(us(L)||kf(L)||N>2?E._62O="pan":o.isMouseRoamable()||xc?(E._62O="roaming",E.foward=k&&yi(L),E._32Q=np(),E._31Q=Wo(E.tick,E)):U||(E._62O="roaming")),E._62O||(U&&k&&$r[v]?(E._62O=v,E.p3=q.p3()):U&&k&&$o(q)&&o.isSelected(q)?o.isMovable(q)?(E._62O="move",E.p3=q.p3(),E.movedata=q):o.isInteractive(q)&&(E._62O="none"):xc&&(N>2?E._62O="pan":2===N&&(E.dist=yf(L),E._62O="pinch")))),E.point=o.lp(L),bh(E,L),Sb(L)?o.handleDoubleClick(L,q,v):o.handleClick(L,q,v))},tick:function(){var v=this,m=v.gv,b=m._moveStep;v.point&&m.isWalkable()&&(v._32Q&&(b*=(np()-v._32Q)/50),m.walk(v.foward?b:-b),v._32Q=np(),v._31Q=Wo(v.tick,v))},handle_mouseup:function(P){this.handle_touchend(P)},handle_touchend:function(U){var h=this._57I;h&&(Ke(h,pr(U))<=1&&this.gv.sm().cs(),this._57I=B)},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function($){var M,S,T=this,P=T.gv,A=T._62O,e=T.point,q=P.dm(),N=P.lp($),r=N.x-e.x,o=N.y-e.y,g=P.getWidth(),f=P.getHeight();if(g&&f){var V=-z*r/g,U=-z*o/f;if("roaming"===A)T.rotate($,V/2,U/2);else if(A===Xb||A===dj||A===lm)P._86O||q.beginTransaction(),P.fi({kind:P._86O?"betweenEditRotation":"beginEditRotation",event:$}),P._86O=1,P.sm().each(function(i){if($o(i)&&P.isRotationEditable(i)){var S=j(V)>j(U)?V:U;A===Xb?i.setRotationX(i.getRotationX()+S):A===dj?i.setRotationY(i.getRotationY()+S):A===lm&&i.setRotationZ(i.getRotationZ()+S)}});else if("move"===A||$r[A]){A===nc||A===bm||A===Ln?(P._87O||q.beginTransaction(),P.fi({kind:P._87O?"betweenEditScale":"beginEditScale",event:$}),P._87O=1):(P._moving||q.beginTransaction(),P.fi({kind:P._moving?"betweenMove":"beginMove",event:$}),P._moving=1);var y,F=T.p3,Z=P.getPositionInfo(F),I=Yg(P);y=A===Bp?"x":A===ss?"y":A===En?"z":A===nc?"sx":A===bm?"sy":A===Ln?"sz":P.getMoveMode($,T.movedata),r=r/g*Z.width,o=-1*o/f*Z.height;var L,m,h=[I[0]*r,I[4]*r,I[8]*r],K=[I[1]*o,I[5]*o,I[9]*o],c=h[0]+K[0],E=h[1]+K[1],l=h[2]+K[2],w=[F[0]+c,F[1]+E,F[2]+l],D=Gc(P.getEye(),w,!0);if("xyz"===y?(L=w,P.moveSelection(c,E,l)):"xz"===y?(L=Nh(P,F,[0,1,0],w),L&&P.moveSelection(L[0]-F[0],0,L[2]-F[2])):"xy"===y?(L=Nh(P,F,[0,0,1],w),L&&P.moveSelection(L[0]-F[0],L[1]-F[1],0)):"yz"===y?(L=Nh(P,F,[1,0,0],w),L&&P.moveSelection(0,L[1]-F[1],L[2]-F[2])):"x"===y||"sx"===y?(D[0]=0,L=Nh(P,F,D,w),L&&(m=L[0]-F[0],"x"===y?P.moveSelection(m,0,0):P.sm().each(function(e){$o(e)&&P.isSizeEditable(e)&&(M=e.getScaleX()+m/100,S=M/e.getScaleX(),e.setScaleX(M),us($)&&(e.setScaleY(e.getScaleY()*S),e.setScaleTall(e.getScaleTall()*S)))}))):"y"===y||"sy"===y?(D[1]=0,L=Nh(P,F,D,w),L&&(m=L[1]-F[1],"y"===y?P.moveSelection(0,m,0):P.sm().each(function(E){$o(E)&&P.isSizeEditable(E)&&(M=E.getScaleTall()+m/100,S=M/E.getScaleTall(),E.setScaleTall(M),us($)&&(E.setScaleY(E.getScaleY()*S),E.setScaleX(E.getScaleX()*S)))}))):("z"===y||"sz"===y)&&(D[2]=0,L=Nh(P,F,D,w),L&&(m=L[2]-F[2],"z"===y?P.moveSelection(0,0,m):P.sm().each(function(U){$o(U)&&P.isSizeEditable(U)&&(M=U.getScaleY()+m/100,S=M/U.getScaleY(),U.setScaleY(M),us($)&&(U.setScaleX(U.getScaleX()*S),U.setScaleTall(U.getScaleTall()*S)))}))),!L)return;T.p3=L}else if(A===oc){var n=T.div;n||(n=T.div=ms(),Oi(T.getView(),n),n.op=e,n.style.background=P.getRectSelectBackground()),P.fi({kind:P._rectSelecting?"betweenRectSelect":"beginRectSelect",event:$}),P._rectSelecting=1,n.rect=qh(n.op,N),Bb(n,n.rect)}else if("pinch"===A&&2===Kl($)){P.fi({kind:P._pinching?"betweenPinch":"beginPinch",event:$}),P._pinching=1;var m=yf($);P.handlePinch(m,T.dist),T.dist=m}else"pan"===A||us($)||kf($)?T.pan($,r,o):"none"===A||P.isFirstPersonMode()||(yi($)?T.rotate($,V,U):(T.pan($,r,0),P.isWalkable()&&(P.fi({kind:P._walking?"betweenWalk":"beginWalk",event:$}),P._walking=1,P.walk(o/P.getHeight()*P.getCenterInfo().height))));T.point=N}},pan:function(q,n,O){var d=this.gv;if(d.isPannable()){var t=d.getWidth(),F=d.getHeight();if(!t||!F)return;var u=d.getCenterInfo(),Y=n/t*u.width,Q=-1*O/F*u.height;d.fi({kind:d._panning?"betweenPan":"beginPan",event:q}),d._panning=1,d.pan(-Y,-Q)}},rotate:function(p,t,v){var e=this.gv;e.isRotatable()&&(e.fi({kind:e._rotating?"betweenRotate":"beginRotate",event:p}),e._rotating=1,e.rotate(t,v))},handleWindowMouseUp:function(k){this.handleWindowTouchEnd(k)},handleWindowTouchEnd:function(X){var d=this,K=d.gv,n=K.dm(),l=d.div;if(l){var Q=K.getDatasInRect(l.rect);if(!Q.isEmpty()){var u=K.sm(),E=u.toSelection();Q.each(function($){u.co($)?E.remove($):E.add($)}),u.ss(E)}ih(l)}K._moving&&(delete K._moving,K.fi({kind:"endMove",event:X}),K.onMoveEnded(),n.endTransaction()),K._panning&&(delete K._panning,K.fi({kind:"endPan",event:X}),K.onPanEnded()),K._rotating&&(delete K._rotating,K.fi({kind:"endRotate",event:X}),K.onRotateEnded()),K._86O&&(delete K._86O,K.fi({kind:"endEditRotation",event:X}),n.endTransaction()),K._87O&&(delete K._87O,K.fi({kind:"endEditScale",event:X}),n.endTransaction()),K._pinching&&(delete K._pinching,K.fi({kind:"endPinch",event:X}),K.onPinchEnded()),K._rectSelecting&&(delete K._rectSelecting,K.fi({kind:"endRectSelect",event:X}),K.onRectSelectEnded()),K._walking&&(delete K._walking,K.fi({kind:"endWalk",event:X}),K.onWalkEnded()),d.dist=d.point=d._62O=d.p3=d.movedata=d.div=d._57I=d._32Q=d._31Q=d.foward=B}});var qn=Uh.MapInteractor=function(P){lr(qn,this,[P]),this._minPhi=0,this._maxPhi=5*R/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};ys("MapInteractor",tq,{handle_contextmenu:function(v){xh(v)},handle_mousewheel:function(R){this.gv.handleScroll(R,R.wheelDelta/40)},handle_DOMMouseScroll:function(M){2===M.axis&&this.gv.handleScroll(M,-M.detail)},handle_keydown:function(Z){this.gv.handleKeyDown(Z)},handle_mousedown:function(U){this.handle_touchstart(U)},handle_touchstart:function(A){xh(A);var j=this,t=j.gv;if(t.setFocus(A)){t.lp(A);var r=t.getDataInfoAt(A),v=r?r.data:B,q=r?r.part:B;if(!v||!t.isInteractive(v)){var z=j.editing={point:t.lp(A)};xc?z.touch=!0:(z.touch=!1,z.clickLeft=yi(A),z.pan=kf(A)?!0:"left"===this.panButton===z.clickLeft),bh(j,A)}Sb(A)?t.handleDoubleClick(A,v,q):t.handleClick(A,v,q)}},handle_mouseup:function(Y){this.handle_touchend(Y)},handle_touchend:function(){},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(o){var d=this,I=d.gv,F=d.editing;if(F){var i=I.lp(o),v=F.point,K=i.x-v.x,m=i.y-v.y;if(!F.moved){if(Math.abs(K)<d.threshold&&Math.abs(m)<d.threshold&&!(o.touches&&o.touches.length>1))return;F.moved=!0}if(F.point=i,F.touch){var S=o.touches.length;if(2!==S)d.pan(o,K,m);else{if(1>=S)return;var e=o.touches,t={x:e[0].clientX,y:e[0].clientY},c={x:e[1].clientX,y:e[1].clientY},T={x:c.x-t.x,y:c.y-t.y},O=F.lastCenter,y=Math.atan2(T.y,T.x),U=F.theta,D=0;U==B?U=F.theta=y:(D=y-U,F.thetaStarted||Math.abs(D)>d.touchRotateThreshold?(F.thetaStarted=!0,F.theta=y):D=0);var f=R*(t.y+c.y)/2/I.getHeight(),$=F.phi,k=0;$==B?$=F.phi=f:(k=f-$,F.phiStarted||Math.abs(k)>d.touchRotateThreshold?(F.phiStarted=!0,F.phi=f):k=0);var J,Q=Math.sqrt(T.x*T.x+T.y*T.y),q=F.vlen;if(q){var V=t.x-O.x,b=t.y-O.y,E=c.x-O.x,H=c.y-O.y,s=Math.sqrt(V*V+b*b),g=Math.sqrt(E*E+H*H),L=q/2,j=d._sign2(s-L),x=d._sign2(g-L);0>j*x||0===j&&0===x?(J=1,F.vlen=Q):(J||(J=Q/q),F.scaleStarted||Math.abs(J-1)>d.touchScaleThreshold?(F.vlen=Q,F.scaleStarted=!0):J=1)}else q=F.vlen=Q,J=1;1!==J&&I.setZoom(J),(k||D)&&d.rotate(o,D,-k),F.lastCenter={x:(c.x+t.x)/2,y:(c.y+t.y)/2}}}else if(F.pan)d.pan(o,K,m);else{var G=I.getWidth(),u=I.getHeight();if(!G||!u)return;var C=-z*K/G,p=-z*m/u;d.rotate(o,C,p)}}},_sign2:function(v){return Math.abs(v)<this._touchScaleCheckAccuracy?0:v>0?1:-1},handleWindowMouseUp:function(B){this.handleWindowTouchEnd(B)},handleWindowTouchEnd:function(Q){var d=this,j=d.editing;if(d.editing=null,j){var M=d.gv;if(!j.moved&&j.clickLeft){var I=M.getDataAt(Q);I?M.sm().setSelection([I]):M.sm().clearSelection()}else M._panning=null,M._rotating=null,M.fi({kind:j.pan?"endPan":"endRotate",event:Q})}},pan:function(Y,l,W){var b=this,T=b.gv;if(T.isPannable()){var s=T.getWidth(),z=T.getHeight();if(s&&z){var k=T.getCenterInfo(),m=-l/s*k.width,S=1*W/z*k.height;T.fi({kind:T._panning?"betweenPan":"beginPan",event:Y}),T._panning=1;var c=b.keepHorizon,J=b.editing.touch;if((J&&Y.touches&&Y.touches.length>1||!J&&us(Y))&&(c=!c),!c)return T.pan(m,S);if(m||S){var j=Yg(T),D=[j[0]*m,j[4]*m,j[8]*m],q=[j[1],0,j[9]],v=Math.sqrt(q[0]*q[0]+q[2]*q[2]);v&&(q=[q[0]/v*S,0,q[2]/v*S]);var I=D[0]+q[0],E=D[1]+q[1],t=D[2]+q[2],n=T._center,M=T._eye;n[0]+=I,n[1]+=E,n[2]+=t,M[0]+=I,M[1]+=E,M[2]+=t,T.fp(gd,B,M),T.fp(Qo,B,n)}}}},rotate:function(j,g,L){var O=this,r=O.gv;if(r.isRotatable()){var e=r._center,u=r._eye,Q=Gc(u,e),x=v(h(Q[0]*Q[0]+Q[2]*Q[2]),Q[1]),y=x+L;y=Math.max(O.minPhi,Math.min(O.maxPhi,y)),L=y-x,r.fi({kind:r._rotating?"betweenRotate":"beginRotate",event:j}),r._rotating=1,r.rotate(g,L)}}}),J.defineProperties(qn.prototype,{panButton:{get:function(){return this._panButton},set:function(D){this._panButton=D}},minPhi:{get:function(){return this._minPhi},set:function(l){this._minPhi=l}},maxPhi:{get:function(){return this._maxPhi},set:function(s){this._maxPhi=s}},keepHorizon:{get:function(){return this._keepHorizon},set:function(M){this._keepHorizon=M}},threshold:{get:function(){return this._threshold},set:function(f){this._threshold=f}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(C){this._touchScaleThreshold=C}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(p){this._touchRotateThreshold=p}}});var sl,Ud="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",gl=32,hl=Uh.GlobeInteractor=function(F,E){lr(hl,this,[F]);var Y,q=E.radius||6378137,M=this,V=null;sl||(sl=ms(),sl.style.border="",sl.style.backgroundImage="url("+Ud+")");var s=new So,X=new pe,P=new pe,H=new pe,x=new Ck,A="number"==typeof q?{x:q,y:q,z:q}:q,k={center:new pe(0,0,0),radius:A},C=function(C){F._81O=null;var Y=F.getHitPosition(C,F.getCenter(),X.copy(F.getEye()).sub(P.copy(F.getCenter())).toArray());return x.origin.copy(F.getEye()),x.direction.copy(Y).sub(x.origin).normalize(),x.intersectEllipsoid(k)},$=function(o,K){F._81O=null,x.origin.copy(F.getEye());for(var T,q,g=F.getCenter(),D=X.copy(F.getEye()).sub(P.copy(F.getCenter())).toArray(),E=1,w=16,l=0,y=1,C={x:0,y:0};w--;){if(C.x=K.x+(o.x-K.x)*E,C.y=K.y+(o.y-K.y)*E,T=F.getHitPosition(C,g,D),x.direction.copy(T).sub(x.origin).normalize(),q=x.intersectEllipsoid(k),q&&1===E)return{hit:q};q?l=E:y=E,E=(l+y)/2}return{hit:q,out:1>E}},d=function(t,g){if(V){var N=Date.now();V.deltaTime=V.lastTime?N-V.lastTime:1e3,V.lastTime=N,V.lastAxis=t,V.lastAngle=g}g&&(s.setFromAxisAngle(t,g),F.setEye(X.copy(F.getEye()).applyQuaternion(s).toArray()),F.setCenter(X.copy(F.getCenter()).applyQuaternion(s).toArray()),F.setUp(X.copy(F.getUp()).applyQuaternion(s).toArray()))};M._showCrossIcon=function(z){Oi(M.getView(),sl),Bb(sl,{x:z.clientX-gl/2,y:z.clientY-gl/2,width:gl,height:gl})},M._hideCrossIcon=function(){ih(sl)},M._scrollImpl=function(j,t){V={point:F.lp(j),screen:pr(j),hit:C(j),type:"right"},V.hitNormalize=V.hit?V.hit.clone().normalize():new pe;var r={clientX:V.screen.x,clientY:V.screen.y+10*t};M._handleMoveImpl(r),M._endMoveImpl(r)},M._startMoveImpl=function(e){Y&&(Y.stop(!0),Y=null),V={point:F.lp(e),screen:pr(e),hit:C(e)},V.hitNormalize=V.hit?V.hit.clone().normalize():new pe,xc?1===e.touches.length?V.hit&&(V.type="left"):2===e.touches.length&&(V.type="touch2"):(yi(e)?V.hit&&(V.type="left"):Ho(e)?V.type="right":kf(e)&&V.hit&&(V.type="middle"),!V.hit||"right"!==V.type&&"middle"!==V.type||M._showCrossIcon(e)),V.type&&bh(M,e)},M._handleMoveImpl=function(u){if(V)switch(V.type){case"left":return M._handleLeft(u);case"right":return M._handleRight(u);case"middle":return M._handleMiddle(u);case"touch2":return M._handleTouch2(u)}},M._endMoveImpl=function(){if(V){if(this._hideCrossIcon(),"left"===V.type||"middle"===V.type){var _=1e3*(V.lastAngle/(V.deltaTime||30)),N=V.lastAxis,s=V.lastTime,r=function(){var F=Date.now(),b=(F-s)/1e3;return s=F,_*=Math.pow(Math.abs(M.decelerationRate),3*b),Math.abs(_)<.01?(_=0,Y&&Y.stop(),void 0):(d(N,_*b),void 0)};Y=Qh({action:function(){r(arguments)},duration:5e3})}V=null}},M._handleLeft=function(s){if(!V.finished){var c=pr(s),X=$(c,V.lastScreen||V.screen);if(V.lastScreen=c,!X.hit)return V.finished=!0,M._endMoveImpl(s),void 0;var N=X.hit;N.normalize();var i=V.hitNormalize,p=Math.acos(N.dot(i)),W=N.cross(i).normalize();d(W,p),X.out&&(V.finished=!0,M._endMoveImpl(s))}},M._handleRight=function(m){var s=V.lastScreen||V.screen,c=s.y;s=V.lastScreen=pr(m);var Z=s.y,q=Z-c;if(q){var l=Math.min(.5,q*M.scaleSpeed);X.copy(F.getEye());var r=V.hit;r||(r=X.clone().divide(A).normalize().multiply(A)),P.copy(X).lerp(r,l),F.setEye(P.toArray()),X.copy(F.getUp()),P.normalize();var n=X.clone().cross(P).normalize();if(H.copy(F.getCenter()),H.sub(n.multiplyScalar(H.dot(n))),F.setCenter(H.toArray()),V.hit){var Y=C(V.screen),$=V.hitNormalize;if(Y){Y.normalize();var E=Math.acos(Y.dot($)),u=Y.cross($).normalize();E&&d(u,E)}}}};var z=function(h){return Math.abs(h)<.01?0:h>0?1:-1};M._handleTouch2=function(A){var H=A.touches.length;if(2===H){var c=A.touches,D={x:c[0].clientX,y:c[0].clientY},T={x:c[1].clientX,y:c[1].clientY},C={x:T.x-D.x,y:T.y-D.y},g=V.lastCenter,K=Math.atan2(C.y,C.x),j=V.theta,s=0;j==B?j=V.theta=K:(s=K-j,V.thetaStarted||Math.abs(s)>.03?(V.thetaStarted=!0,V.theta=K):s=0);var e,G=Math.sqrt(C.x*C.x+C.y*C.y),X=V.vlen;if(X){var Y=D.x-g.x,O=D.y-g.y,p=T.x-g.x,w=T.y-g.y,S=Math.sqrt(Y*Y+O*O),h=Math.sqrt(p*p+w*w),R=X/2,v=z(S-R),W=z(h-R);0>v*W||0===v&&0===W?(e=1,V.vlen=G):(e||(e=G/X),V.scaleStarted||Math.abs(e-1)>.05?(V.vlen=G,V.scaleStarted=!0):e=1)}else X=V.vlen=G,e=1;var C=P.copy(F.getEye()).clone();1!==e&&F.setEye(C.setLength((C.length()-q)/e+q).toArray()),s&&d(C.normalize(),s),V.lastCenter={x:(T.x+D.x)/2,y:(T.y+D.y)/2}}},M._handleMiddle=function(Z){var B=pr(Z),g=V.screen;V.screen=B;var O=(B.y-g.y)/180*Math.PI*M.rollSpeed;P.copy(F.getCenter()).sub(X.copy(F.getEye())).normalize(),X.copy(F.getUp()).cross(P).normalize(),P.copy(F.getEye()).sub(V.hit).applyAxisAngle(X,O).add(V.hit);var c=P.clone();P.copy(F.getCenter()).sub(V.hit).applyAxisAngle(X,O).add(V.hit);var I=P.clone(),j=P.copy(F.getUp()).applyAxisAngle(X,O).clone(),y=!1;O>0&&(H.copy(j),P.copy(I).sub(c).normalize(),X.copy(c).multiplyScalar(-1).normalize(),X.dot(H)-P.dot(H)>0&&(y=!0)),y||H.copy(V.hit).sub(c).dot(V.hitNormalize)>=0&&(y=!0),y||(F.setEye(c.toArray()),F.setCenter(I.toArray()),F.setUp(j.toArray()));var E=-(B.x-g.x)/180*Math.PI*M.rotateSpeed;d(V.hitNormalize,E)}};ys("GlobeInteractor",tq,{handle_contextmenu:function(U){xh(U)},handle_mousewheel:function(e){this._scrollImpl(e,e.wheelDelta/40)},handle_DOMMouseScroll:function(h){2===h.axis&&this._scrollImpl(h,-h.detail)},handle_keydown:function(m){this.gv.handleKeyDown(m)},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(f){xh(f);var a=this.gv;if(a.setFocus(f)){var l=a.getDataInfoAt(f),J=l?l.data:B;J&&a.isInteractive(J)||this._startMoveImpl(f);var b=l?l.part:B;Sb(f)?a.handleDoubleClick(f,J,b):a.handleClick(f,J,b)}},handle_mouseup:function(o){this.handle_touchend(o)},handle_touchend:function(){},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowTouchMove:function(r){this._handleMoveImpl(r)},handleWindowMouseUp:function(A){this.handleWindowTouchEnd(A)},handleWindowTouchEnd:function(k){this._endMoveImpl(k)}}),J.defineProperties(hl.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(u){this._rotateSpeed=u}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(l){this._rollSpeed=l}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(c){this._scaleSpeed=c}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(a){this._decelerationRate=a}}});var Fo=function(f){var v=2147483648|f;return[(255&v>>16)/255,(255&v>>8)/255,(255&v)/255,(255&v>>24)/255]},Do=function(d){this.gv=d,this.gv.pickColorMap={_pickIdUsed:1e3}};eh(Do,J,{_iv:!0,iv:function(){this._iv=!0},get:function(d,t){this.validate();var F=this,m=F.gv.getGL();if(!m)return B;var z,v,x=d.x,o=d.width,g=d.height,N=F.height-d.y-g,G=S(o/2),y=new Uint8Array(4*o*g),c=0,C=y.length,L=t?B:new Vn,r=t?B:{};if($b(m,F.frame),m.readPixels(x,N,o,g,m.RGBA,m.UNSIGNED_BYTE,y),_j(m),t){for(;G>=c;c++)for(var J=G-c,Z=G+c,w=J;Z>=w;w++)for(var A=J;Z>=A;A++)if((w===J||w===Z||A===J||A===Z)&&(z=F.info(y,4*(w*o+A))))return z}else for(;C>c;c+=4)z=F.info(y,c),z&&(v=z.data,r[v._id]||(L.add(v),r[v._id]=v));return L},info:function(w,v){return this.gv.pickColorMap[(w[v]<<16)+(w[v+1]<<8)+w[v+2]+((127&w[v+3])<<24)]},validate:function(){var u=this,l=u.gv,S=l.getGL();if(S){var T=l.getWidth(),O=l.getHeight(),Z=S.RGBA,z=S.TEXTURE_2D,p=S.RENDERBUFFER,F=S.FRAMEBUFFER;u.texture||(u.texture=vc(S),u.render=S.createRenderbuffer(),u.frame=S.createFramebuffer()),(u.width!==T||u.height!==O)&&(S.activeTexture(S.TEXTURE0),eb(S,u.texture),S.texImage2D(z,0,Z,T,O,0,Z,S.UNSIGNED_BYTE,B),ph(S,S.TEXTURE_MIN_FILTER,S.LINEAR),S.bindRenderbuffer(p,u.render),S.renderbufferStorage(p,S.DEPTH_COMPONENT16,T,O),$b(S,u.frame),S.framebufferTexture2D(F,S.COLOR_ATTACHMENT0,z,u.texture,0),S.framebufferRenderbuffer(F,S.DEPTH_ATTACHMENT,p,u.render),eb(S,B),S.bindRenderbuffer(p,B),_j(S),u.width=T,u.height=O),u._iv&&(u._iv=!1,$b(S,u.frame),S.clear(S.COLOR_BUFFER_BIT),l.overlappingBox.clear(),l.setViewport(S,0,0,T,O),l._picking=S._picking=!0,l.renderScene(),l._picking=S._picking=!1,_j(S))}}});var rq=function(u){this.gv=u};eh(rq,J,{gap:0,size:0,_42:function(o,d){var b=this,y=b.gv,L=y._gridGap,Z=y._gridSize;if(y._gridVisible){if(b.gap!==L||b.size!==Z){for(var J=[],h=y._gridSize/2,j=L*h,A=0;2*h+1>A;A++){var c=6*A,E=6*(2*h+1)+c;J[c]=-j,J[c+1]=0,J[c+2]=-j+A*L,J[c+3]=j,J[c+4]=0,J[c+5]=-j+A*L,J[E]=-j+A*L,J[E+1]=0,J[E+2]=-j,J[E+3]=-j+A*L,J[E+4]=0,J[E+5]=j}b.vs=new Hf(J),b.gap=L,b.size=Z}rm(y),de(o,d),Fn(o),Wc(o,d,1,y._gridColor,y._buffer.vs,b.vs),gn(o,0,b.vs.length/3,o.LINES),Hd(o),kp(o,d)}else b.vs=b.gap=b.size=B}});var jm=function(f){this.gv=f};eh(jm,J,{_42:function(T,W){var f=this.gv,$=f._buffer.vs,p=f._axisXColor,A=f._axisYColor,I=f._axisZColor,P=f._originAxisVisible,F=f._centerAxisVisible;if(P||F){var x=Tg?T.TRIANGLES:T.TRIANGLE_FAN,o=T.LINES;if(rm(f),de(T,W),Fn(T),P){var V=f.getCenterInfo(),S=s(V.width,V.height)/5,i=.8*S,e=.05*S;Wc(T,W,1.5,p,$,new Hf([0,0,0,S,0,0,i,e,0,i,0,e,i,-e,0,i,0,-e,i,e,0,0,0,0,0,S,0,e,i,0,0,i,e,-e,i,0,0,i,-e,e,i,0,0,0,0,0,0,S,e,0,i,0,e,i,-e,0,i,0,-e,i,e,0,i])),gn(T,0,2,o),gn(T,1,6,x),Wc(T,W,B,A),gn(T,7,2,o),gn(T,8,6,x),Wc(T,W,B,I),gn(T,14,2,o),gn(T,15,6,x)}if(F){var n=f._center,u=n[0],c=n[1],l=n[2],V=f.getPositionInfo(n);S=s(V.width,V.height)/20,Wc(T,W,1.5,p,$,new Hf([u,c,l,u+S,c,l,u,c,l,u,c+S,l,u,c,l,u,c,l+S])),gn(T,0,2,o),Wc(T,W,B,A),gn(T,2,2,o),Wc(T,W,B,I),gn(T,4,2,o)}Hd(T),kp(T,W)}}});var Mj=function(U){this.gv=U,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Mj.Mode.Disable};Mj.Mode={Disable:0,Selection:1,MouseOver:2},eh(Mj,J,{onMouseOver:function(B){w.preventDefault(B);var h=this.gv.getDataAt(B);h!==this.mouseOverData&&(this.mouseOverData=h,this.gv.iv())},setFetchTargetFunc:function(F){this.fetchTargetFunc=F},_42:function($,k){var P,g=this,c=g._mode;if(c!==Mj.Mode.Disable&&(c===Mj.Mode.Selection?P=g.gv.sm().getSelection().toArray(function(n){return n.s("highlight.visible")}):c===Mj.Mode.MouseOver&&g.mouseOverData&&g.mouseOverData.s("highlight.visible")&&(P=[g.mouseOverData]),g.fetchTargetFunc&&(P=g.fetchTargetFunc(P)),P&&P.length)){var K=g.gv,E=K.vr.isPresenting(),e=K.getWidth();if(E){var u=K.getWidth;e/=2,K.getWidth=function(){return e};var M=K.getViewport()}var A,I=K.getDevicePixelRatio(),l=e*I,S=K.getHeight()*I;(A=g._renderTarget)?A.setSize($,l,S):g._renderTarget=A=new Uh.RenderTarget(K,$,l,S),$b($,A.frame),$.clear($.COLOR_BUFFER_BIT),K.setViewport($,0,0,l,S);var x=[];P.forEach(function(Z){var $=Z.getRenderLayer();x.indexOf($)<0&&x.push($)}),K.drawFilter=function(u){return P.indexOf(u)<0},K.renderLayers(x,!0),K.drawFilter=null,_j($),E&&(K.getWidth=u,K.setViewport($,M[0],M[1],M[2],M[3])),g.shader||(g.shader=new sk.Shader($,gk.vs,gk.fs));var _=g.shader;g.shader.bind();var N=cn.for($),j=N.directState();if(j.blend.enabled=!0,$.activeTexture($.TEXTURE0+0),$.bindTexture($.TEXTURE_2D,A.texture),_.uniforms.image=0,_.uniforms.textureSize=[l,S],_.uniforms.edgeWidth=F["highlight.width"],g.highlightColor!==F["highlight.color"]){var h=Lk(g.highlightColor=F["highlight.color"]);g.highlightColorData=[h[0]/255,h[1]/255,h[2]/255,h[3]/255]}_.uniforms.edgeColor=g.highlightColorData,g.ibuffer?(g.ibuffer.upload(),g.vbuffer.upload()):(g.ibuffer=sk.Buffer.createIndexBuffer($,new Uint16Array([0,2,1,1,2,3])),g.vbuffer=sk.Buffer.createVertexBuffer($,new Float32Array([0,0,1,0,0,1,1,1]))),_.attributes.pos.pointer(g.vbuffer),$.drawElements($.TRIANGLES,6,$.UNSIGNED_SHORT,0),j.blend.enabled=!1,$.bindTexture($.TEXTURE_2D,null),$.useProgram(k)}}}),J.defineProperties(Mj.prototype,{mode:{get:function(){return this._mode},set:function(H){var K=this._mode;H!==K&&(this._mode=H,H===Mj.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):K===Mj.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var gk={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},ir=function(F){this.gv=F},Bp="edit_tx",ss="edit_ty",En="edit_tz",Xb="edit_rx",dj="edit_ry",lm="edit_rz",nc="edit_sx",bm="edit_sy",Ln="edit_sz",$r={};$r[Bp]=101,$r[ss]=102,$r[En]=103,$r[Xb]=104,$r[dj]=105,$r[lm]=106,$r[nc]=107,$r[bm]=108,$r[Ln]=109,eh(ir,J,{_42:function(V,o,M){var G=this,N=G.gv,s=N.sm().ld();if(s&&N.isEditable(s)&&!N.isEditHelperDisabled()&&$o(s)&&(!N.isFirstPersonMode()||!N.isMouseRoamable()&&!xc)){rm(N);var g,y,t=N.isMovable(s),z=N.isRotationEditable(s),F=N.isSizeEditable(s),S=N._axisXColor,K=N._axisYColor,x=N._axisZColor,q=N._editSizeColor,E=s.p3(),j=Ke(N.getEye(),E)/10,c=j/(M?5:10),l=.7*j,p=.4*l,a=E[0],C=E[1],f=E[2];g=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],t&&G._17O(V,o,s,M,Bp,S,g,[a,C-c,f,a+l,C-c,f,a+l,C,f,a+l,C,f,a,C,f,a,C-c,f,a,C-c,f+c,a+l,C-c,f+c,a+l,C-c,f,a+l,C-c,f,a,C-c,f,a,C-c,f+c]),y=a+l,F&&G._17O(V,o,s,M,nc,q,g,[y,C-c,f,y+p,C-c,f,y+p,C,f,y+p,C,f,y,C,f,y,C-c,f,y,C-c,f+c,y+p,C-c,f+c,y+p,C-c,f,y+p,C-c,f,y,C-c,f,y,C-c,f+c]),y+=p,z&&G._17O(V,o,s,M,Xb,S,g,[y,C-c,f,y+p,C-c,f,y+p,C,f,y+p,C,f,y,C,f,y,C-c,f,y,C-c,f+c,y+p,C-c,f+c,y+p,C-c,f,y+p,C-c,f,y,C-c,f,y,C-c,f+c]),g=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],t&&G._17O(V,o,s,M,ss,K,g,[a,C,f,a,C+l,f,a-c,C+l,f,a-c,C+l,f,a-c,C,f,a,C,f,a,C,f,a,C,f-c,a,C+l,f-c,a,C+l,f-c,a,C+l,f,a,C,f]),y=C+l,F&&G._17O(V,o,s,M,bm,q,g,[a,y,f,a,y+p,f,a-c,y+p,f,a-c,y+p,f,a-c,y,f,a,y,f,a,y,f,a,y,f-c,a,y+p,f-c,a,y+p,f-c,a,y+p,f,a,y,f]),y+=p,z&&G._17O(V,o,s,M,dj,K,g,[a,y,f,a,y+p,f,a-c,y+p,f,a-c,y+p,f,a-c,y,f,a,y,f,a,y,f,a,y,f-c,a,y+p,f-c,a,y+p,f-c,a,y+p,f,a,y,f]),g=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],t&&G._17O(V,o,s,M,En,x,g,[a,C,f,a,C,f+l,a,C-c,f+l,a,C-c,f+l,a,C-c,f,a,C,f,a,C-c,f,a-c,C-c,f,a-c,C-c,f+l,a-c,C-c,f+l,a,C-c,f+l,a,C-c,f]),y=f+l,F&&G._17O(V,o,s,M,Ln,q,g,[a,C,y,a,C,y+p,a,C-c,y+p,a,C-c,y+p,a,C-c,y,a,C,y,a,C-c,y,a-c,C-c,y,a-c,C-c,y+p,a-c,C-c,y+p,a,C-c,y+p,a,C-c,y]),y+=p,z&&G._17O(V,o,s,M,lm,x,g,[a,C,y,a,C,y+p,a,C-c,y+p,a,C-c,y+p,a,C-c,y,a,C,y,a,C-c,y,a-c,C-c,y,a-c,C-c,y+p,a-c,C-c,y+p,a,C-c,y+p,a,C-c,y])}},_17O:function(M,P,n,R,H,s,L,Q){var m=this.gv,t=m._buffer,W=cn.for(M),C=W.directUniforms(),q=W.directAttribs();
if(m._picking){R=m.pickColorMap;var I=$r[H];R[I]={data:n,part:H},C.uFixPickReverseColor=Fo(I)}pc(M,P,B,!0,B,!0,B,!1),C.uDiffuse=s,q.aPosition=Jj(M,t.vs,new Hf(Q),B),q.aNormal=Jj(M,t.ns,new Hf(L),B),Fn(M),gn(M,0,12),Hd(M),Vf(M,P)}});var zk=u.Raycaster=function(G){this.gv=G,this.maxTriangleTest=1/0};dk("Raycaster",J,{intersect:function(Q){var s=this,B=s.gv,p=B.getDataAt(Q);return p?s.intersectObject(Q,p):null},intersectObjects:function(S,G,W){var u,x,N,r,p=this,d=1/0,Q=S.origin||(new pe).fromArray(p.gv.getEye()),j=p.maxTriangleTest,h=[];return G.forEach(function(u){W&&W(u)===!1||u.s("intersect")!==!1&&h.push(u)}),h.sort(function(y,U){return Q.distanceToSquared2(y.p3())-Q.distanceToSquared2(U.p3())}),p.countTriangles=0,h.forEach(function(V){p.countTriangles>j||(u=p.intersectObject(S,V),u&&(x=Q.distanceToSquared(u.world),d>x&&(N=V,r=u,d=x)))}),p.countTriangles=0,{data:N,intersect:r}},intersectObject:function(U,F){if(U instanceof Ck)return this._intersectObjectImpl(U,F);var i=this,r=i.gv,d=r.unproject(U),s=new pe,B=r.getEye(),q=new pe;if(r.isOrtho()){var x=new pe(B);q.copy(r.getCenter()).sub(x).normalize();var c=s.copy(d).sub(x).dot(q);s.copy(q).setLength(-c).add(x.copy(d))}else s.copy(B),q.copy(d).sub(s).normalize();var Y=new u.Math.Ray(s,q);return i._intersectObjectImpl(Y,F)},_intersectObjectImpl:function(){function k(){var q=new pe;return q.subVectors(g,h),J.subVectors(X,h),q.cross(J).normalize(),q}function s(a,p,V,z,t,B,E){return _o.barycoordFromPoint(a,p,V,z,e),t.multiplyScalar(e.x),B.multiplyScalar(e.y),E.multiplyScalar(e.z),t.add(B).add(E),t.clone()}var P=new Oo,x=new Oo,$=new Ck,V=new pe,o=new pe,F=new pe,G=new pe,f=new pe,X=new pe,h=new pe,g=new pe,m=new ps,K=new ps,Z=new ps,J=new pe,L={vs:ic,is:Ar,uv:xp},e=new pe;return function(d,R){var v=this.gv.getData3dUI(R),D=R.mat||v.mat;if(D){P.fromArray(D),x.getInverse(P),$.copy(d).applyMatrix4(x);var e,t,N="body",W=v.shapeModel;if(W||(W=ds(v)),W||(R instanceof u.Node&&!(R instanceof u.Shape)?(e=!0,W=L):(t=!0,W=[v.left,v.front,v.right,v.back,v.top,v.bottom])),!W)return console.log("Can not find shape model."),null;Zh(W)||(W=[W]);var J,_,I,B,E,l,H,r,A,p,C,n,M,i,Y,w,q=1/0,Q=["","top_","bottom_"],y=!1;for(J=0,_=W.length;_>J;J++)if(M=W[J])for(I=0,B=Q.length;B>I;I++)if(i=Q[I],H=M[i+"vs"],r=M[i+"is"],A=M[i+"uv"]||M[i+"tuv"],H){if(Y=M[i+"boundingBox"]){var C=$.intersectBox(Y);if(!C)continue;if($.origin.distanceTo(C)>q)continue;w=!1}else M[i+"boundingBox"]=Y=new u.Math.Box3,w=!0;for(E=0,l=r?r.length:H.length/3;l>E;E+=3)this.countTriangles++,r?(o.fromArray(H,3*r[E]),F.fromArray(H,3*r[E+1]),G.fromArray(H,3*r[E+2])):(o.fromArray(H,3*E),F.fromArray(H,3*(E+1)),G.fromArray(H,3*(E+2))),w&&(Y.expandByPoint(o),Y.expandByPoint(F),Y.expandByPoint(G)),p=$.intersectTriangle(o,F,G,!0,V),p&&(n=$.origin.distanceTo(p),q>n&&(q=n,f.copy(p),X.copy(o),h.copy(F),g.copy(G),""!==i?N=i.slice(0,-1):e?N=zl[Math.floor(E/6)]:t&&(N=zl[J]),A&&(y=!0,r?(m.fromArray(A,2*r[E]),K.fromArray(A,2*r[E+1]),Z.fromArray(A,2*r[E+2])):(m.fromArray(A,2*E),K.fromArray(A,2*(E+1)),Z.fromArray(A,2*(E+2))))))}if(!isFinite(q))return null;var c,z=f.clone().applyMatrix4(P);y&&(c=s(f,X,h,g,m,K,Z));var S=k(X,h,g),a=k(X.applyMatrix4(P),h.applyMatrix4(P),g.applyMatrix4(P)),j=$.direction.dot(S);return j>0&&(S.multiplyScalar(-1),a.multiplyScalar(-1)),{world:z,local:f.clone(),worldNormal:a,normal:S,uv:c,part:N}}}}()});var Jm=function(I,v){this.gv=I,this.s=function($,f,D){return f==B&&(f=D),f==B?v.getStyle($):lg(f,v,I)},this.data=v};eh(Jm,J,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:I,iv:function(){this._iv=!0},update:function(D,Y,r){var p=this,F=p.data;if(!(F instanceof Vp)){if(D||(D=p.gv,Y=D.getGL(),r=Y._renderLists),!p.needValidate(Y))return r.push(this,!1),void 0;var x,b,f,d,O,h=F._id,G=p.s("shape3d.alwaysOnTop")?null:p.s("batch"),L=F.getRenderLayer(),t=r.get(L,!0),K=t.batchIndexMap,m=t.batchModelMap,z=D.getBrightness(F),o=z!=B&&1!==z;if(x=fi(K,m,F,G),p.validate(x,G?Qn[G]||Vr:B),x&&(b=K[h],f=b.size=x.vs.length/3-b.begin,O=x.rs))for(z=o?z:1,d=0;f>d;d++)O.push(z);if($o(F)){var J=D.getWireframeGeometry(F);if(J)Ae(D,F,J);else{var e=D.getWireframe(F);e&&Ae(D,F,e)}}p.labelInfo=p.label2Info=p.noteInfo=p.note2Info=p._38o=B,p._24O(Bd,"getLabel"),p._24O(Ig,"getLabel2"),p._26O(Ml,"getNote"),p._26O(an,"getNote2"),p._15O(),p.interactiveInfo=D.isInteractive(F)?{}:B,t.push(this,!0),p._iv=!1}},_42:function(Y,o,d){function H(F,N,Z){var u=N.getBrightness(Z),c=Z.s("alphaTest"),e=Z.s("envmap"),O=cn.for(F),z=O.directUniforms();u!=B&&1!==u&&(z.uBrightness=u),z.uAlphaTest=c,z.uUseEnvMap=e?!0:!1,z.uReflectivity=e||.01,z.shadowReceive=Z.s("shadow.receive")}var x,c=this,G=c.data,M=c.gv,N=M._picking;if(N)x=M.pickColorMap;else{if(M.isTransparentMask(G))return;x=I}var i,l,a=G._id,j=M._renderLists.get(G._renderLayer,!0),P=j.batchIndexMap,S=j.batchModelMap,J=M.isSelectable(G),u=!1,W=P[a];N&&(l=uc(Y,x,J,G,Fq,W),l&&(al(l,W,S),al(l,j.polylineIndexMap[a],j.polylineModelMap),al(l,j.wireframeIndexMap[a],j.wireframeModelMap))),W||(u||(u=!0,H(Y,M,G)),c._80o(Y,o,d)),M.isLabelVisible(G)&&((i=c.labelInfo)&&(N&&uc(Y,x,J,G,Bd),u||(u=!0,H(Y,M,G)),c._28O(i,Bd,d)),(i=c.label2Info)&&(N&&uc(Y,x,J,G,Ig),u||(u=!0,H(Y,M,G)),c._28O(i,Ig,d))),M.isNoteVisible(G)&&((i=c.noteInfo)&&(N&&uc(Y,x,J,G,Ml),u||(u=!0,H(Y,M,G)),c._29O(i,Ml,d)),(i=c.note2Info)&&(N&&uc(Y,x,J,G,an),u||(u=!0,H(Y,M,G)),c._29O(i,an,d))),(i=c._38o)&&(u||(u=!0,H(Y,M,G)),c._99O(Y,o,i,x,J,d)),u&&(cn.for(Y).directUniforms().uBrightness=1)},prepare:function(){var R=this,d=R.data;if(!(d instanceof Vp)){var A,S,y,Z,z,J=R.gv,$=J.getGL(),M=d._id,H=R.s("shape3d.alwaysOnTop")?null:R.s("batch"),p=J._batchIndexMap,t=J._batchModelMap,w=J.getBrightness(d),L=w!=B&&1!==w;if(R.needValidate($)){if(A=fi(p,t,d,H),R.validate(A,H?Qn[H]||Vr:B),A&&(S=p[M],y=S.size=A.vs.length/3-S.begin,z=A.rs))for(w=L?w:1,Z=0;y>Z;Z++)z.push(w);if($o(d)){var m=J.getWireframeGeometry(d);if(m)Ae(J,d,m);else{var u=J.getWireframe(d);u&&Ae(J,d,u)}}R.labelInfo=R.label2Info=R.noteInfo=R.note2Info=R._38o=B,R._24O(Bd,"getLabel"),R._24O(Ig,"getLabel2"),R._26O(Ml,"getNote"),R._26O(an,"getNote2"),R._15O(),R.interactiveInfo=J.isInteractive(d)?{}:B,R._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=I},getBoundingBox:function(){var v,S,E,N,j,q;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;v||(v={vs:ic,is:Ar,uv:xp},S=new pe,E=new pe,N=new pe,j=new pe,q=new pe);var m=this,i=m.data,p=m.shapeModel;if(p||i instanceof u.Shape||(p=ds(m)),!p&&i instanceof u.Shape&&(m.prepare(),p=m.shapeModel),p||(i instanceof u.Node&&!(i instanceof u.Shape)?p=v:(m.left||m.front||m.right||m.back||m.top||m.bottom)&&(p=[m.left,m.front,m.right,m.back,m.top,m.bottom])),!p)return I;Zh(p)||(p=[p]);var l,Y,V,Z,M,g,U,K,T,z,_,t,y=["","top_","bottom_"],b=new u.Math.Box3,h=!1;if(m._needRecoverPosition){j.set.apply(j,i.p3());var D=i.s3();q.set(1/(D[0]||1),1/(D[1]||1),1/(D[2]||1))}else j.set(0,0,0),q.set(1,1,1);for(l=0,Y=p.length;Y>l;l++)if(T=p[l])for(V=0,Z=y.length;Z>V;V++)if(z=y[V],U=T[z+"vs"],K=T[z+"is"],U){if(t=z+"boundingBox",_=T[t],!_)for(T[t]=_=new u.Math.Box3,M=0,g=K?K.length:U.length/3;g>M;M+=3)K?(S.fromArray(U,3*K[M]).sub(j).multiply(q),E.fromArray(U,3*K[M+1]).sub(j).multiply(q),N.fromArray(U,3*K[M+2]).sub(j).multiply(q)):(S.fromArray(U,3*M).sub(j).multiply(q),E.fromArray(U,3*(M+1)).sub(j).multiply(q),N.fromArray(U,3*(M+2)).sub(j).multiply(q)),!S.isNaN()&&_.expandByPoint(S),!E.isNaN()&&_.expandByPoint(E),!N.isNaN()&&_.expandByPoint(N);b.expandByBox(_),h=!0}return h?(this._cacheBoundingBox=b,J.freeze(b),J.freeze(b.min),J.freeze(b.max),ab(m.gv,i),b):I}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return ne},_80o:function(){},dispose:function(){},_calcAnchorMat:function(G){if(G.hasOwnProperty("_anchor")||G.hasOwnProperty("_anchorElevation")){var V=G.getAnchor3d(),N={x:V.x-.5,y:V.y-.5,z:V.z-.5},p=Gf();return tg(p,[-N.x,-N.y,-N.z]),p}},getBodyColor:function(W){var r=this.data,Y=this.gv.getBodyColor(r);return Y?Y:W?r.getStyle(W):B},_24O:function(M,o){var F=this,b=F.data,q=F.gv,X=F.s,e=q[o](b);if(e!=B){var l=X(M+".scale"),O=X(M+".max"),E=F[M+"Info"]={label:e,textureScale:X(M+".texture.scale"),color:q[o+"Color"](b),font:X(M+".font"),align:X(M+".align"),background:q[o+"Background"](b)},i=E.rect=Jb(E,e);O>0&&O<i.width&&(E.labelWidth=i.width,i.width=O),i.x=i.y=0,i.width*=l,i.height*=l,E.mat=F._16O(X(M+".autorotate"),X(M+".position"),i,X(M+".face"),X(M+".t3"),X(M+".r3"),X(M+".rotationMode"));var A=i.width/2,$=i.height/2;E.vs=new Hf([-A,$,0,-A,-$,0,A,-$,0,A,$,0]),i.width/=l,i.height/=l}},_26O:function(u,s){var R=this,O=R.data,g=R.gv,e=R.s,A=g[s](O);if(A!=B){var Q=e(u+".scale"),i=this[u+"Info"]={note:A,textureScale:e(u+".texture.scale"),expanded:e(u+".expanded"),font:e(u+".font"),color:e(u+".color"),align:e(u+".align"),borderWidth:e(u+".border.width"),borderColor:e(u+".border.color"),background:g[s+"Background"](O)};if(i.expanded){var c=e(u+".max"),S=Jb(i,A);S.width+=6,S.height+=2,c>0&&c<S.width&&(i.labelWidth=S.width,S.width=c);var K={x:-S.width/2,y:-8-S.height,width:S.width,height:S.height+8}}else K={x:-6,y:-18,width:12,height:18};i.mat=R._16O(e(u+".autorotate"),e(u+".position"),B,e(u+".face"),e(u+".t3"),e(u+".r3"),e(u+".rotationMode")),i.rect=K,1!==Q&&(K=Sf(K),K.x*=Q,K.height*=Q,K.y=-K.height,K.width*=Q);var l=K.x,U=K.y,P=K.width,d=K.height;i.vs=new Hf([l,-U,0,l,-U-d,0,l+P,-U-d,0,l+P,-U,0])}},_28O:function(G,b,j){if(j(this.s(b+".transparent"))){var B=G.rect,O=G.textureScale,Y=B.width*O,t=B.height*O;if(Y>=1&&t>=1){var J=hn(Y,t);1!==O&&(J.translate(J,B.x,B.y),J.scale(O,O),J.translate(J,-B.x,-B.y)),rb(J,G),J.restore(),xi(this,b,G.mat,G.vs,!0)}}},_29O:function(_,y,k){if(k(this.s(y+".transparent"))){var g=_.rect,q=_.textureScale,v=g.x,w=g.y,o=g.width*q,x=g.height*q;if(o>=1&&x>=1){g.x=g.y=0;var r=hn(o,x);1!==q&&r.scale(q,q),Qd(r,_),r.restore(),g.x=v,g.y=w,xi(this,y,_.mat,_.vs,!1)}}},_99O:function(P,w,n,d,i,K){if(n){var G=this,e=G.gv,I=G.data,t=e._buffer,p=e._1O,Z=n.icons,g=cn.for(P),z=g.directAttribs();for(var X in Z){var s=Z[X],f=n.rects[X];if(f&&K(lg(s.transparent,I,e))){uc(P,w,d,i,I,X);var O=lg(s.shape3d,I,e),D=O?[O]:lg(s.names,I,e),r=D?D.length:0,c=lg(s.textureScale,I,e)||1,h=lg(s.light,I,e);h==B&&(h=O?!0:!1),pc(P,w,lg(s.blend,I,e),h,lg(s.opacity,I,e),lg(s.reverseFlip,I,e),lg(s.reverseColor,I,e),lg(s.reverseCull,I,e));for(var Q=0;r>Q;Q++){var H=D[Q],F=f[Q];if(as(G,F.mat),O)ek(e,I,ds(G,O),G);else{var A=Ve(H);if(A){var N=F.width*c,u=F.height*c;if(N>=1&&u>=1){var _=hn(N,u);fl(_,A,lg(s.stretch,I,e),0,0,N,u,I,e),_.restore(),vc(P,Up,p),Fn(P,w,p,lg(s.discardSelectable,I,e),t.uv,fm),z.aPosition=Jj(P,t.vs,F.vs,B),z.aNormal=Wf(P,t.ns,nr,B),vh(P,t.is,Mq),uj(P,0,Mq.length),Hd(P,w,p)}}}Gd(e)}Vf(P,w)}}}}});var Pr=function(R,p){lr(Pr,this,[R,p])};eh(Pr,Jm,{_16O:function(L,i,d,r,A,c,I,O,x){var S=this.data,e=S.getFinalScale3d(),C=fs(i,e,d,r,O,x);if(S.hasOwnProperty("_anchor")||S.hasOwnProperty("_anchorElevation")){var G=S.getAnchor3d();C[0]-=(G.x-.5)*e[0],C[1]-=(G.y-.5)*e[1],C[2]-=(G.z-.5)*e[2]}return jd(Gf(),C,S.p3(),r,A,c,I,L,S.getFinalRotation3d(),S.getRotationMode())},clear:function(){var C=this;C.faceMat=C.mat=C.shapeModel=C.left=C.right=C.front=C.back=C.top=C.bottom=C.csg=B},needValidate:function(_){if(this._iv)return this._validateFrameId=_._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var t=_._renderInfo.frame;if(this._validateFrameId!==t)return this._validateFrameId=t,!0}return!1},validate:function(p,i){var B=this,v=B.gv,e=B.data,V=B.shapeName=B.s(bq),P=ds(B,V);if(B._updateAutoRotation(),B._updateFixSize2d(),B._updateOverlapping(),B.dispatchBoundingBoxChanged(),this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")){var I=e.getRenderLayer(),f=v._renderLists.get(I);f&&f.ivWireframeBatch(e)}var t=Lm(e,v.getMat(e),P?B.s("shape3d.scaleable"):!0),M=B._calcAnchorMat(e);if(M&&Yb(t,t,M),B.clear(),B.mat=e.mat=t,P||!V)if(B.shapeModel=P,p){var c=[];P?ml(v,e,P,B,B.getBodyColor(),[t],p,c):(mg(v,e,p,i,t,ue,c,fo),mg(v,e,p,i,t,cg,c,iq),mg(v,e,p,i,t,Xn,c,wj),mg(v,e,p,i,t,id,c,hb),mg(v,e,p,i,t,yn,c,ej),mg(v,e,p,i,t,wl,c,Fc)),c.length&&(Md(p.vs,c),Md(p.ns,gj(c)))}else P||(B._cubeUvs=null,B.vf(ue,0),B.vf(cg,16),B.vf(yn,8),B.vf(wl,24),B.vf(Xn,32),B.vf(id,40))},_updateAutoRotation:function(){var $=new vs,g=new Oo,I=new pe,b=new pe,f=new pe;return function(){var r=this,D=r.data,M=r.s("shape3d.autorotate");if(!M)return D._dynamicRotation&&delete D._dynamicRotation,void 0;var u=r.gv;f.copy(r.s("shape3d.autorotate.up")||u._up);var R;R="string"==typeof M?[M.indexOf("x")<0?u._eye[0]:u._center[0],M.indexOf("y")<0?u._eye[1]:u._center[1],M.indexOf("z")<0?u._eye[2]:u._center[2]]:u._eye;var F=u._center,K=D.p3();I.copy(K),b.set(R[0]-F[0],R[1]-F[1],R[2]-F[2]).add(I),g.lookAt(b,I,f),$.set(0,0,0,D.getRotationMode(),!0).setFromRotationMatrix(g);var p=D._dynamicRotation;p&&Math.abs(p[0]-$.x)<1e-5&&Math.abs(p[1]-$.y)<1e-5&&Math.abs(p[2]-$.z)<1e-5||(D._dynamicRotation=[$.x,$.y,$.z])}}(),_updateFixSize2d:function(){var g=this,e=g.data,A=g.s("shape3d.fixSizeOnScreen");if(!A)return e._dynamicScale3d&&delete e._dynamicScale3d,void 0;var p=g.gv;e.getFinalScale3d();var c=Lm(e,p.getMat(e)),Y=wd([0,0,0],c),C=p.toViewPosition(Y);if(!isNaN(C.x)&&!isNaN(C.y)){var Z=wd([1,0,0],c),b=p.toViewPosition(Z),M=wd([0,1,0],c),v=p.toViewPosition(M),x=b.x-C.x,D=v.y-C.y;if(x&&D){var _=e._dynamicScale3d||[1,1,1],K=Ve(e.s("shape3d.image")),h=A[0]>0?A[0]:K?Sg(K,e):20,$=A[1]>0?A[1]:K?Xd(K,e):20,q=Math.abs(x/h),N=Math.abs(D/$);Math.abs(q-1)<.001&&Math.abs(N-1)<.001||(e._dynamicScale3d=[_[0]/q,_[1]/N,_[2]])}}},_updateOverlapping:function(){var t=this,w=t.s("hide.overlapping.group");if(!w)return t._rectOverlapping&&(t._rectOverlapping=I),void 0;var T,Y,_,E=t.gv,q=t.data,U=Lm(q,E.getMat(q)),b=1/0,G=1/0,L=-1/0,$=-1/0,O=q.getAnchor3d(),a=O.x,X=O.y,P=O.z;for(T=0;8>T;T++){if(Y=wd([(T>>2)-a,(1&T>>1)-X,(1&T)-P],U),_=E.toViewPosition(Y),isNaN(_.x)||isNaN(_.y))return;b=Math.min(b,_.x),L=Math.max(L,_.x),G=Math.min(G,_.y),$=Math.max($,_.y)}var r={x:b,y:G,w:L-b,h:$-G};t._rectOverlapping=E.overlappingBox.isOverlapping(w,r)},getVectorDynamicSize:function(){var F,p=this,i=p.s("shape3d"),V=p.data;if("billboard"===i||"plane"===i||(F=V._currentCubeElementId)!=B){var H,q,Q=p.gv,r=Lm(V,Q.getMat(V)),C=V.getAnchor3d(),j=.5-C.x,L=.5-C.y,o=.5-C.z,P=p.s("shape3d.vector.dynamic.maxsize"),W=function(z,q){z[0]+=j,z[1]+=L,z[2]+=o,q[0]+=j,q[1]+=L,q[2]+=o;var $=Q.toViewPosition(wd(z,r)),e=Q.toViewPosition(wd(q,r)),k=$.x-e.x,c=$.y-e.y;return Math.min(P,Math.sqrt(k*k+c*c))};if("billboard"===i)H=W([-.5,0,0],[.5,0,0]),q=W([0,-.5,0],[0,.5,0]);else if("plane"===i)H=W([-.5,0,0],[.5,0,0]),q=W([0,0,-.5],[0,0,.5]);else if(V._currentCubeElementId!=B){var J=3*Ar[F+1],O=3*Ar[F],v=3*Ar[F+2];H=W([ic[J],ic[J+1],ic[J+2]],[ic[v],ic[v+1],ic[v+2]]),q=W([ic[J],ic[J+1],ic[J+2]],[ic[O],ic[O+1],ic[O+2]])}return[H,q]}},getCachedTexture:function(){var K=this,h=K.data,T=h._currentCubeElementId;return T!=B?K._cubeCachedImage?K._cubeCachedImage[T]:null:K._shape3dCachedImage},setCachedTexture:function(z){var h=this,y=h.data,J=y._currentCubeElementId;J!=B?(h._cubeCachedImage||(h._cubeCachedImage={}),h._cubeCachedImage[J]=z):h._shape3dCachedImage=z},invalidateCachedTexture:function(D){var S,l,P,c=this;if((P=c._shape3dCachedImage)&&(D.deleteTexture(P),c._shape3dCachedImage=null),l=c._cubeCachedImage){for(S in l)D.deleteTexture(l[S]);c._cubeCachedImage=null}},vf:function(O,N){var R=this;if(R.gv.getFaceVisible(R.data,O)){var P=vj(R,O);P.mat&&(R.faceMat=!0);var n=P.uv;if(n){var y=R._cubeUvs;y||(y=R._cubeUvs=new Hf([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var Q=0;8>Q;Q++)y[N+Q]=n[Q]}return P}},_billboardInView:function(){var h=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],s=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],L=new fp,K=new pe,E=new Oo;return function(k){var r=this;if(!r.mat)return!0;var S=r.gv.getFrustum(),n="billboard"===k?h:s;L.makeEmpty(),E.fromArray(r.mat);for(var A=0,l=n.length;l>A;A+=3)L.expandByPoint(K.fromArray(n,A).applyMatrix4(E));return S.intersectsBox(L)}}(),_80o:function(d,z,W){var w=this;if(w._rectOverlapping)return!0;var V=w.shapeModel;if(V||!w.shapeName){var R=w.s("shape3d");if(("billboard"===R||"plane"===R)&&!w._billboardInView(R))return!0;var K=w.gv,N=w.data,t=K._cube,f=cn.for(d),s=f.directAttribs();rm(K,w.mat),w.s("shape3d.reflector")&&!d._picking||(V?ek(K,N,V,w,w.getBodyColor(),W):(s.aPosition=Jj(d,t.vs,B,B),s.aNormal=Jj(d,t.ns,B,B),Re(d,t.is),w._18O(d,z,w.left,0,W),w._18O(d,z,w.front,6,W),w._18O(d,z,w.right,12,W),w._18O(d,z,w.back,18,W),w._18O(d,z,w.top,24,W),w._18O(d,z,w.bottom,30,W))),Gd(K),w.faceMat&&(w._18O(d,z,w.left,0,W,!0),w._18O(d,z,w.front,6,W,!0),w._18O(d,z,w.right,12,W,!0),w._18O(d,z,w.back,18,W,!0),w._18O(d,z,w.top,24,W,!0),w._18O(d,z,w.bottom,30,W,!0))}},_18O:function(h,I,U,e,Y,u){if(U){if(!Y(U.transparent))return;if(u&&!U.mat||!u&&U.mat)return;var w=this.data.s("polygonOffset");w&&$m(h,w),u&&rm(this.gv,U.mat);var P=this,H=P.data,j=cn.for(h),s=j.directUniforms();H._currentCubeElementId=e;var t=P.gv,T=t.getTexture(U.texture,H),R=U.uv,E=U.uvScale,r=U.uvOffset,$=U.discardSelectable;T?R?Fn(h,I,T,$,t._buffer.uv,P._cubeUvs,r,E):Fn(h,I,T,$,t._cube.uv,B,r,E):Fn(h),pc(h,I,U.blend,U.light,U.opacity,U.reverseFlip,U.reverseColor,U.reverseCull),s.uDiffuse=U.color||F["color.empty"],uj(h,e,6),Vf(h,I),Hd(h,I,T),u&&Gd(t),w&&Ro(h),H._currentCubeElementId=null}},drawReflector:function(){var f=new pe,c=new pe,v=new vs,p=new Oo,X=new pe,e=new pe,$=new pe,L=new pe,m=new Oo,z=new Oo,Y=new Um,r=new Ni,N=new Ni,Z=function(n,$,c){n[c]=$[0],n[c+1]=$[1],n[c+2]=$[2]},G=function(I,P){Z(I,P.getEye(),0),Z(I,P.getCenter(),3),Z(I,P.getUp(),6)},t=function(p,o){o._eye=[p[0],p[1],p[2]],o._center=[p[3],p[4],p[5]],o._up=[p[6],p[7],p[8]],o._18Q=B;var S=o._skyBox;S&&(S.p3([p[0],p[1],p[2]]),o.getData3dUI(S).iv())};return function(w){var T=this;T._reflectorInfo=null;var E=T.data;if(E._reflecting)return!1;var h=T.gv;if(h._picking)return!1;var Z=T._reflectorRenderTarget,_=h.getDevicePixelRatio(),S=h.getWidth()*_,x=h.getHeight()*_;Z?Z.setSize(w,S,x):Z=T._reflectorRenderTarget=new Uh.RenderTarget(h,w,S,x),f.copy(E.p3()),c.copy(h.getEye()),p.makeRotationFromEuler(v.set(E.r3(),E.getRotationMode(),!0));var Q;if(!T._reflectNormal){var Q=ds(T,T.s("shape3d"));if(!Q)return!1;if(!Q.ns&&Q.length&&(Q=Q[0]),!Q.ns||!Q.vs)return!1;T._reflectNormal=[Q.ns[0],Q.ns[1],Q.ns[2]],T._reflectorVbuffer=sk.Buffer.createVertexBuffer(w,new Float32Array(Q.vs))}if(X.copy(T._reflectNormal),X.applyMatrix4(p),e.subVectors(f,c),e.dot(X)>0)return!1;e.reflect(X).negate(),e.add(f),$.copy(h.getCenter()).negate().add(f),$.reflect(X).negate(),$.add(f),L.copy(h.getUp()),L.reflect(X);var l=[0,0,0,0,0,0,0,0,0];G(l,h),h._eye=e.toArray(),h._center=$.toArray(),h._up=L.toArray(),h._18Q=B;var n=h._skyBox;n&&(n.p3(h._eye),h.getData3dUI(n).iv()),$b(w,Z.frame),w.viewport(0,0,Z.width,Z.height),w.clearColor(0,0,0,1),w.clear(w.COLOR_BUFFER_BIT);var C=tl(h),F=Yg(h);Y.setFromNormalAndCoplanarPoint(X,f),Y.applyMatrix4(z.fromArray(F)),r.set(Y.normal.x,Y.normal.y,Y.normal.z,Y.constant),N.x=(Math.sign(r.x)+C[8])/C[0],N.y=(Math.sign(r.y)+C[9])/C[5],N.z=-1,N.w=(1+C[10])/C[14],r.multiplyScalar(2/r.dot(N));var O=E.s("shape3d.reflector.clip"),K=O===I?.003:O;C[2]=r.x,C[6]=r.y,C[10]=r.z+1-K,C[14]=r.w;var A=h._computedProjectMatrix;h._computedProjectMatrix=C,E._reflecting=!0,h.renderScene(),h._computedProjectMatrix=A,m.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),m.multiply(z.fromArray(h._projectMatrix)),m.multiply(z.fromArray(h._viewMatrix)),_j(w),t(l,h);var H=mo.Reflector.shader;return H||(H=mo.Reflector.shader=new sk.Shader(w,mo.Reflector.vs,mo.Reflector.fs)),H.bind(),w.activeTexture(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,Z.texture),H.uniforms.tDiffuse=0,H.uniforms.color=Dk(E.s("shape3d.reflector.color")||"rgb(128,128,128)"),H.uniforms.textureMatrix=m.toArray(),H.uniforms.modelMatrix=Lm(E),H.uniforms.viewMatrix=Yg(h),H.uniforms.projectionMatrix=tl(h),T._reflectorVbuffer.upload(),H.attributes.pos.pointer(T._reflectorVbuffer),w.drawArrays(w.TRIANGLES,0,6),E._reflecting=!1,w.useProgram(h._prg),!0}}()}),mo.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var lc=function(e,S){lr(lc,this,[e,S])};eh(lc,Jm,{_25Q:1,validate:function(J){var q=this,S=q.gv,N=q.data,O=q.s,E=O("edge.width"),y=N._40I,v=N._41I;if(q.shapeModel=q.info=B,y&&v){var F,o,f,H,k,V,u,d,z,t,h=N.isLooped(),W=O(kr),$=w.getEdgeType(W);if($){var m=$(N,Xr(q,S,N,h,W),S,q._19Q);if(!m.points||m.points.isEmpty())return;V=q.info={},u=m.segments,k=m.points,d=k.size();for(var Q=y.getElevation(),T=v.getElevation(),j=0;d>j;j++){var U=k.get(j);U.e==B&&(U.e=Q+(T-Q)*j/(d-1))}z=Ob(k.get(0)),t=Ob(k.get(d-1));var I=d%2;0===I?(V.c1=Ob(k.get(d/2-1)),V.c2=Ob(k.get(d/2))):V.p3=Ob(k.get((d-I)/2)),V.s1=z,V.s2=Ob(k.get(1)),V.t1=Ob(k.get(d-2)),V.t2=t}else{k=new Vn,V=q.info={};var b=O("edge.offset"),x=O("edge.center"),Y=O("edge.source.t3"),c=O("edge.target.t3"),L=y.p3(),n=v.p3();if(Y&&(L[0]+=Y[0],L[1]+=Y[1],L[2]+=Y[2]),c&&(n[0]+=c[0],n[1]+=c[1],n[2]+=c[2]),W===tf){u=O("edge.segments");var e=V.points=O(Dn)||Cc;if(d=e.size()){z=Ob(e.get(0)),t=Ob(e.get(d-1)),!x&&b&&(f=Gc(z,L,!0),b=s(b,Ke(L,z)),L=[L[0]+f[0]*b,L[1]+f[1]*b,L[2]+f[2]*b],f=Gc(n,t,!0),b=s(b,Ke(t,n)),n=[n[0]-f[0]*b,n[1]-f[1]*b,n[2]-f[2]*b]);var I=d%2;0===I?(F=Ob(e.get(d/2-1)),o=Ob(e.get(d/2))):V.p3=Ob(e.get((d-I)/2)),V.s1=L,V.s2=z,V.t1=t,V.t2=n}else!x&&b&&(f=Gc(n,L,!0),H=Ke(L,n),b=Dp(b,H),L=[L[0]+f[0]*b,L[1]+f[1]*b,L[2]+f[2]*b],n=[n[0]-f[0]*b,n[1]-f[1]*b,n[2]-f[2]*b]),F=L,o=n;k.add({x:L[0],y:L[2],e:L[1]}),k.addAll(e),k.add({x:n[0],y:n[2],e:n[1]})}else{var K=Xr(q,S,N,h,W);if(q._19Q||(K=-K),h){var R=L[0],g=L[1],i=L[2],a=y.getTall()/2+K;F=[R-K,g+a,i],o=[R+K,g+a,i],k.add({x:R-K,y:i,e:g}),k.add({x:R-K,y:i,e:g+a}),k.add({x:R+K,y:i,e:g+a}),k.add({x:R+K,y:i,e:g})}else{f=Gc(n,L,!0),H=Ke(L,n);var A={x:L[0],y:L[2]},D={x:n[0],y:n[2]},Z=_g(B,A,D,K),r=Z.x-A.x,X=Z.y-A.y;b=Dp(b,H),f[0]*=b,f[1]*=b,f[2]*=b,F=[L[0]+f[0]+r,L[1]+f[1],L[2]+f[2]+X],o=[n[0]-f[0]+r,n[1]-f[1],n[2]-f[2]+X],x?(k.add({x:L[0],y:L[2],e:L[1]}),k.add({x:F[0],y:F[2],e:F[1]}),k.add({x:o[0],y:o[2],e:o[1]}),k.add({x:n[0],y:n[2],e:n[1]})):(k.add({x:F[0],y:F[2],e:F[1]}),k.add({x:o[0],y:o[2],e:o[1]}))}}V.c1=F,V.c2=o}V.list=O(bq)===Gh?q.createTubeModel(k,u,E/2,J):q.createLineModel(k,u,E,"edge","edge.dash")}}});var Kc=function(m,p){lr(Kc,this,[m,p]),this._needRecoverPosition=!0};eh(Kc,Pr,{_80o:function(D,I,R){var s=this,r=s.gv,B=s.shapeModel;rm(r,s.mat),B?ek(r,s.data,B,s,s.getBodyColor(),R):(Rl(s,D,I,s.left,R),Rl(s,D,I,s.front,R),Rl(s,D,I,s.right,R),Rl(s,D,I,s.back,R),Rl(s,D,I,s.top,R),Rl(s,D,I,s.bottom,R)),Gd(r)},validate:function(a,W){var D,j,p=this,P=p.s,H=p.data,L=H.p3(),w=H._thickness/2,E=H.isClosePath(),G=H.getPoints(),n=H.getSegments(),l=P(Zg),R=a&&a.uv;if(p.clear(),p.dispatchBoundingBoxChanged(),0>w)j=p.shapeModel=Dj(G,n,P(sg),P(Of),l,P(Yo),H.getTall(),H.getShapeElevation(),E),P(Yj)?P("shape3d.image")||delete j.uv:(delete j.vs,delete j.ns,delete j.uv),P("shape3d.top.image")||delete j.top_uv,P("shape3d.bottom.image")||delete j.bottom_uv;else if(P(bq)===Gh)D=ol(G,n,l,E),j=p.shapeModel={vs:[]},P("shape3d.image")&&(j.uv=[],j.sum=P(Yo)||Sd(D)||1,j.len=0),P(sg)&&!E&&(j.top_vs=[],P("shape3d.top.image")&&(j.top_uv=[])),P(Of)&&!E&&(j.bottom_vs=[],P("shape3d.bottom.image")&&(j.bottom_uv=[])),p._12O(D,w);else{var e,Z,I,z,i,J,V,C,_,y;if(D=ol(G,n,l,E),i=p.vf(yn,R,!1,W),w&&(J=p.vf(wl,R,!1,W),V=E?B:p.vf(ue,R,!1,W),C=E?B:p.vf(cg,R,!1,W),_=p.vf(Xn,R,!1,W),y=p.vf(id,R,!1,W)),w){for(var T=0,O=D.length;O>T;T++)D[T]=p._tryRemoveBezierPoints(D[T],w);p._12O(D,w)}else i&&D.forEach(function(C){if(z=C.length,z>0)for(e=C[0],I=1;z>I;I++)Z=C[I],p.addV(i.vs,e,Z),e=Z});p._20Q(D),a||(i&&(i.ns=gj(i.vs),Jn(i,"vs"),Jn(i,Ff)),w&&(J&&(J.ns=gj(J.vs),Jn(J,"vs"),Jn(J,Ff)),V&&(V.ns=gj(V.vs),Jn(V,"vs"),Jn(V,Ff)),C&&(C.ns=gj(C.vs),Jn(C,"vs"),Jn(C,Ff)),_&&(_.ns=gj(_.vs),Jn(_,"vs"),Jn(_,Ff)),y&&(y.ns=gj(y.vs),Jn(y,"vs"),Jn(y,Ff))))}var q=p.mat=Gf();tg(q,L),Xh(q,H.getFinalRotation3d(),H.getRotationMode());var K=H.getScale3d(),h=H._dynamicScale3d;h&&(K[0]*=h[0],K[1]*=h[1],K[2]*=h[2]),Kg(q,K),tg(q,gf(L)),a&&(ob(p,q,a,j),p.clear())},_20Q:function(V){var c,z,s,X,Z,i,k,E=this,O=E.front,L=E.back,S=E.top,J=E.bottom,x=O?O.tuv:B,w=L?L.tuv:B,t=S?S.tuv:B,o=J?J.tuv:B,e=0;(x||w||t||o)&&(c=E.s(Yo)||Sd(V)||1,V.forEach(function(j){if(z=j.length,z>0)for(i=j[0],s=1;z>s;s++)k=j[s],X=e/c,e+=Ke(i,k),Z=e/c,E._14O(O,X,Z),E._14O(L,1-Z,1-X),E._14O(S,X,Z),E._14O(J,X,Z),i=k}))},_14O:function(l,A,a){if(l){var S=l.uv,H=l.tuv;if(H){if(S)var Q=S[0]+(S[6]-S[0])*A,f=S[1]+(S[7]-S[1])*A,q=S[2]+(S[4]-S[2])*A,W=S[3]+(S[5]-S[3])*A,O=S[2]+(S[4]-S[2])*a,Y=S[3]+(S[5]-S[3])*a,u=S[0]+(S[6]-S[0])*a,y=S[1]+(S[7]-S[1])*a;else Q=A,f=0,q=A,W=1,O=a,Y=1,u=a,y=0;H.push(q,W,O,Y,u,y,u,y,Q,f,q,W)}}},_13O:function(K){var V=K.uv,L=K.tuv;L&&(V?L.push(V[2],V[3],V[4],V[5],V[6],V[7],V[6],V[7],V[0],V[1],V[2],V[3]):L.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(U,X){var T=U.length;if(4>T)return U;var w,y,V,L,f,e,S=!1,C=function(Q){return U[Q]},R=function($){return U[T-1-$]};for(f=0;1>=f;f++)for(e=f?R:C,y=e(0),V=e(1),w=2;T-1>w;w++)if(L=e(w),!L.remove)if(L.b){var k=_g(y,V,L,X);k.adjust?(L.remove=!0,S=!0):(y=V,V=L)}else y=V,V=L;if(!S)return U;var c=[];for(w=0;T>w;w++)U[w].remove||c.push(U[w]);return c},_12O:function(o,F){var J,$,M,t,W,X=this.s("shape3d.point.epsilon"),G=this;o.forEach(function(A){if(W=A.length,W>0)for(J={p:A[0],n:!0},t=1;W>t;t++)$=A[t],M=W-1>t?A[t+1]:B,M&&Math.abs($.x-M.x)<X&&Math.abs($.y-M.y)<X||G.addPoint(J,$,M,F,A)})},addPoint:function(d,$,j,K,r){var s,_,C,y,z,V,Z,p,N,J=this,b=d.p,m=d.f,G=d.b,Q=J.s("shape3d.side")||pj,g=J.s("shape3d.start.angle"),q=J.s("shape3d.sweep.angle"),x=J.shapeModel,w=J.data.isClosePath();if(d.n&&(d.n=!1,m=w&&r.length>2?_g(r[r.length-2],b,$,K):_g(B,b,$,K),G=af(b,m),x?x.top_vs&&J._10O(G,m,Q,g,q,x.top_vs,x.top_uv):(s=J.left)&&(J.addV(s.vs,G,m),J._13O(s))),_=j?_g(b,$,j,K):w&&r.length>2?_g(b,$,r[1],K):_g(b,$,B,K),C=af($,_),x){var M,i,o=x.vs,E=x.uv,f=x.sum;for(E&&(M=x.len/f,x.len+=Ke(b,$),i=x.len/f),V=J._9O(G,m,Q,g,q),Z=J._9O(C,_,Q,g,q),p=0;Q>p;p++)N=p+1,Md(o,V[N]),Md(o,Z[p]),Md(o,V[p]),Md(o,Z[p]),Md(o,V[N]),Md(o,Z[N]),E&&(y=p/Q,z=N/Q,E.push(M,z,i,y,M,y,i,y,M,z,i,z));!j&&x.bottom_vs&&J._10O(C,_,Q,g,q,x.bottom_vs,x.bottom_uv,!0)}else!j&&(s=J.right)&&(J.addV(s.vs,_,C),J._13O(s)),(s=J.front)&&J.addV(s.vs,m,_),(s=J.back)&&J.addV(s.vs,C,G),(s=J.top)&&J.addH(s.vs,m,_,C,G,!0),(s=J.bottom)&&J.addH(s.vs,G,C,_,m);d.p=$,d.f=_,d.b=C},_10O:function(V,k,l,b,y,c,s,r){var $,x,J=this,m=J.data,W=J._9O(V,k,l,b,y),N=(V.x+k.x)/2,C=(V.y+k.y)/2,S=m.getShapeElevation(),R=0;for(R=0;l>R;R++)r?(Md(c,W[R]),Md(c,W[R+1])):(Md(c,W[R+1]),Md(c,W[R])),Md(c,[N,S,C]),s&&(r?($=z*(R+1)/l+b,x=z*R/l+b):($=z*R/l+b,x=z*(R+1)/l+b),s.push(.5-.5*n(x),.5-.5*q(x),.5-.5*n($),.5-.5*q($),.5,.5))},_9O:function(Z,m,O,o,P){var W,X,E=this,g=E.data,w=[],K=(Z.x+m.x)/2,G=(Z.y+m.y)/2,i=g.getTall()/2,I=g.getShapeElevation(),u=0;for(P=P||z;O>=u;u++)W=P*u/O+o,X=n(W),w.push([K+(Z.x-K)*X,I+i*q(W),G+(Z.y-G)*X]);return w},addV:function(s,j,Z){var r=j.x,m=j.y,X=Z.x,d=Z.y,O=this.data,x=O.getShapeElevation(),B=O.getTall()/2;s.push(r,x-B,m,X,x-B,d,X,x+B,d,X,x+B,d,r,x+B,m,r,x-B,m)},addH:function(s,u,$,t,D,F){var i=this.data,G=i.getTall()/2,r=i.getShapeElevation()+(F?G:-G);s.push(u.x,r,u.y,$.x,r,$.y,t.x,r,t.y,t.x,r,t.y,D.x,r,D.y,u.x,r,u.y)},vf:function(u,$,G,S){var j,V=this,Q=V.gv.getFaceVisible(V.data,u);return(G||Q)&&(j=vj(V,u,S),j.vs=[],j.tuv=Q&&(j.texture||$)?[]:B,j.visible=Q),j}});var zh=function(z){function c(b){if("string"!=typeof b)return 0|b;switch(b){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var s=this;s.enable=!1;var Y,j,V=F["shadow.type"],f=F["shadow.intensity"],n=F["shadow.bias"],h=F["shadow.quality"],O=F["shadow.radius"],D=F["shadow.degree.x"],L=F["shadow.degree.z"],X=c(h),J=new u.Math.Matrix4;new u.Math.Euler,new u.Math.Vector3;var U=new u.Math.Matrix4,y=s.pvMatrix=new u.Math.Matrix4;s.render=function(){if(!z._picking&&s.enable){var x=z.getGL();if(x){z._glCapabilities&&(X=Math.min(X,z._glCapabilities.maxTextureSize)),s.map?Y.setSize(X,X):Y=s.map=new Ji(z,z.getGL(),0,0,{samples:1,minFilter:fb.NEAREST,magFilter:fb.NEAREST,width:X,height:X}),x._shadowShader||(x._shadowShader=new sk.Shader(x,zh.shaderSrc.vs,zh.shaderSrc.fs));var o=z._frameState,f=o.renderState.glState;f.blend.enabled=!1,f.depth.enabled=!0,f.depth.mask=!0;var F=f.color.clear.slice(0);go(x,[1,1,1,1]),o.renderState.useProgram(x._shadowShader.program),K(),go(x,F)}}},s.setShadow=function(M,x){M=!!M;var T=s.enable!==M;s.enable=M,"object"==typeof x&&(x.intensity!==I&&(f=x.intensity),x.bias!==I&&(n=x.bias),x.radius!==I&&(O=x.radius),x.degreeX!==I&&(D=x.degreeX),x.degreeZ!==I&&(L=x.degreeZ),x.quality!==I&&(h=x.quality),x.type!==I&&V!==x.type&&(V=x.type,T=!0),X=c(h)),M&&s.setupShadowCamera(),T&&Rj(z)},s.createShadow=function(G){G||(G=z._frameState.renderState.directUniforms()),G.shadowMatrix=y.toArray(),G.shadowMap=Y.texture,G.shadowSize=[Y.width,Y.height],G.shadowIntensity=f,G.shadowBias=n,G.shadowRadius=O},s.genShaderDefine=function(){var S="#define USE_SHADOWMAP\n";return"hard"===V?S+="#define SHADOWMAP_TYPE_PCF\n":"soft"===V&&(S+="#define SHADOWMAP_TYPE_PCF_SOFT\n"),S};var x;s.setupShadowCamera=function(){j||(j=s.boundingSphere=new u.Math.Sphere);var i=z.getBoundingBox(z.dm().toDatas(function(u){return u.s("shadow.cast")&&z.isVisible(u)})),_=new pe(i.min),g=new pe(i.max);j.set(_.clone().add(g).multiplyScalar(.5),.5*_.distanceTo(g));var W=j.radius;x=fn(Gf(),-W,W,-W,W,2*W/1e3,2*W),y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(J.fromArray(x));var t=Math.tan(-D*Math.PI/180),e=Math.tan(-L*Math.PI/180),Z=W/Math.sqrt(t*t+e*e+1),d=new pe(Z*t,Z,Z*e);J.lookAt(d,new pe(0,0,0),new pe(0,1,0)).setPosition(d.add(j.center)),J.getInverse(J),y.multiply(J)};var K=function(){var D=z.getGL(),W=X,L=X;Y.setSize(D,W,L),Y.bind(D),D.clear(fb.COLOR_BUFFER_BIT|fb.DEPTH_BUFFER_BIT);var n=z._frameState,d=n.renderState,u=d.directUniforms(),o=d.directAttribs();u.projectionMatrix=x;var O=z._viewport;z.setViewport(D,0,0,W,L);var Q,v,G,f;for(Q=0,v=nl.length;v>Q;Q++)G=nl[Q],Rb[G].ignore||(f=z._renderLists.get(G),f&&(s.renderItems(D,u,o,f.opaque),s.renderItems(D,u,o,f.transparent)));Y.unbind(D),z.setViewport(D,O[0],O[1],O[2],O[3])};s._renderDirect=function(s,M,Q,m){Q&&Q.length&&(M.position=Wf(s,z._buffer.vs,Q,B),m?(vh(s,z._buffer.is,m),uj(s,0,m.length)):gn(s,0,Q.length/3))},s.renderItems=function(C,I,W,q){var i,k,H,A,Q,x,p,e,B=q.length;for(i=0;B>i;i++)if(k=q[i],A=k.ui,H=k.data,!lh(H)&&H.s("shadow.cast"))for(Q=A.shapeModel||ds(A),Q||(Q=H instanceof u.Node&&!(H instanceof u.Shape)?{vs:ic,is:Ar}:[A.left,A.front,A.right,A.back,A.top,A.bottom]),Zh(Q)||(Q=[Q]),I.modelViewMatrix=U.fromArray(A.mat).premultiply(J).toArray(),p=0,e=Q.length;e>p;p++)x=Q[p],x&&(jo(x),s._renderDirect(C,W,x.vs,x.is),s._renderDirect(C,W,x.top_vs,x.top_is),s._renderDirect(C,W,x.bottom_vs,x.bottom_is),s._renderDirect(C,W,x.from_vs,x.from_is),s._renderDirect(C,W,x.to_vs,x.to_is))}};zh.shaderSrc={vs:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","void main() {","vec3 transformed = vec3( position );","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")};
var _n=function(l,O){lr(_n,this,[l,O]),this._needRecoverPosition=!0};eh(_n,Jm,{_25Q:1,validate:function(I){var i=this,L=i.data,k=i.s,r=L.getPoints(),m=r.size();if(i.dispatchBoundingBoxChanged(),i.shapeModel=i.info=B,m>1){var X=i.info={},x=L.getSegments(),g=L.getThickness(),U=Ob(r.get(0)),s=Ob(r.get(m-1)),F=m%2;0===F?(X.c1=Ob(r.get(m/2-1)),X.c2=Ob(r.get(m/2))):X.p3=Ob(r.get((m-F)/2)),X.s1=U,X.s2=Ob(r.get(1)),X.t1=Ob(r.get(m-2)),X.t2=s,X.list=k(bq)===Gh?i.createTubeModel(r,x,g/2,I):i.createLineModel(r,x,g,"shape.border","shape.dash")}var K=L.p3(),n=i.mat=Gf();tg(n,K),Xh(n,L.getFinalRotation3d(),L.getRotationMode());var Q=L.getScale3d(),Z=L._dynamicScale3d;Z&&(Q[0]*=Z[0],Q[1]*=Z[1],Q[2]*=Z[2]),Kg(n,Q),tg(n,gf(K))},_80o:function(H,T,U){var K=this,J=K.shapeModel;if(J){var z=K.gv;rm(z,K.mat),ek(z,K.data,J,K,K.getBodyColor(),U),Gd(z)}}});var ld=u.graph3d.VR=function(Y){var J=this;J.gv=Y,J._controllers=[],J.switch=new Kb(J),J._enable=!1,J._defaultCallLater=u.Default.callLater,J._defaultCancelLater=bp,"undefined"!=typeof Z&&"VRFrameData"in Z&&(J._frameData=new Z.VRFrameData),J.measureOflength=1,J.eyesOffset=[0,0,0],J._orientation=new u.Math.Quaternion,J._lastHeadPose=[0,0,0],J._offsetToBeAdd=[0,0,0],J._fpsInfo={time:0,fps:0,frames:0}};eh(ld,J,{ms_fire:!0,_42:function(d,g,E,Z){var O=this,s=O.gv;if(O._deviceInAction){var H=O._device;if(H){var W=O._measureOflength;H.depthNear=s.getNear()*W,H.depthFar=s.getFar()*W;var n=O._offsetToBeAdd;if(O.eyesOffset[0]+=n[0],O.eyesOffset[1]+=n[1],O.eyesOffset[2]+=n[2],n[0]=0,n[1]=0,n[2]=0,H.isPresenting===!1)return O._controllers.forEach(function(f){f&&f.update()}),s.iv(),!1;var D=O._frameData;H.getFrameData(D);var I=D.pose.position;if(I){var l=O.toViewPosition(I);s.setEye(l),O._orientation.fromArray(D.pose.orientation);var M=new u.Math.Vector3(0,0,-10*O._scaleFactor);M.applyQuaternion(O._orientation),s.setCenter([l[0]+M.x,l[1]+M.y,l[2]+M.z])}O._controllers.forEach(function(N){N&&N.update()}),s.setViewport(d,0,0,g/2,E),O._viewMatrix=O._copyViewMatrix(D.leftViewMatrix),O._projectMatrix=O._copyProjectMatrix(D.leftProjectionMatrix),Z(),s.setViewport(d,g/2,0,g/2,E),O._viewMatrix=O._copyViewMatrix(D.rightViewMatrix),O._projectMatrix=O._copyProjectMatrix(D.rightProjectionMatrix),Z(),O._lastViewMatrix=O._viewMatrix,O._lastProjectMatrix=O._projectMatrix,O._viewMatrix=null,O._projectMatrix=null,O.submitFrame();var Y=Date.now(),S=O._fpsInfo;return Y-S.time>1e3?(S.fps=Math.round(1e3*(S.frames+1)/(Y-S.time)),S.time=Y,S.frames=0):S.frames++,!0}}},onVRDisplayPresentChange:function(){var k=this.isPresenting();this._injectGraphView(k),this.fp("present",!k,k)},getOrientation:function(){return this._orientation},addController:function(u){u=u||0;var D=this,B=D.getController(u);return B?B:(B=new Mc(D,u),D._controllers.push(B),B)},getController:function($){$=$||0;for(var M=this._controllers,d=0,s=M.length;s>d;d++)if(M[d]&&M[d].id===$)return M[d];return null},removeController:function(p){p=p||0;for(var J=this._controllers,c=0,t=J.length;t>c;c++)if(J[c]&&J[c].id===p)return J.splice(c,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(R,H){var C=this,h=C._scaleFactor,w=C._eyesOffset,e=C._lastHeadPose;return e[0]=R[0]*h,e[1]=R[1]*h,e[2]=R[2]*h,H?(H[0]=e[0]+w[0],H[1]=e[1]+w[1],H[2]=e[2]+w[2],H):[e[0]+w[0],e[1]+w[1],e[2]+w[2]]},addEyesOffset:function(d,_,Q){var M=this._offsetToBeAdd;M[0]+=d,M[1]+=_,M[2]+=Q},_copyViewMatrix:function(v){var a=this.dup(v),T=this._scaleFactor;a[12]*=T,a[13]*=T,a[14]*=T;var K=this._eyesOffset;if(K&&(K[0]||K[1]||K[2])){var Q=K[0],h=K[1],Z=K[2];a[12]-=a[0]*Q+a[4]*h+a[8]*Z,a[13]-=a[1]*Q+a[5]*h+a[9]*Z,a[14]-=a[2]*Q+a[6]*h+a[10]*Z}return a},shutdown:function(){var _=this._device;_&&_.isPresenting&&_.exitPresent()},isPresenting:function(){var D=this._device;return D&&D.isPresenting},_copyProjectMatrix:function(j){var J=this.dup(j),A=this._scaleFactor;return J[14]*=A,J},dup:function(j,h){for(var v=j.length,O=h||new Array(v);v--;)O[v]=j[v];return O},getViewMatrix:function(E){var o=this._viewMatrix;return o?this.dup(o,E):void 0},getProjectMatrix:function(){var l=this._projectMatrix;return l?this.dup(l):void 0},submitFrame:function(){var _=this;if(_._enable&&_._deviceInAction){var s=_._device;s&&s.isPresenting&&(s.submitFrame(),_.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(Z){var x=this.gv;return x.intersectObjects(Z,x.dm().getDatas())},setDevice:function(e){var j=this;j._device=e},_injectGraphView:function(){var n,v,H;return function($){var g=this.gv;if(!$)return n&&(g.getWidth=n,g.getHeight=v,g.getDevicePixelRatio=H),void 0;var L=this._device,E=L.getEyeParameters("left"),V=E.renderWidth,R=E.renderHeight;n=g.getWidth,v=g.getHeight,H=g.getDevicePixelRatio,g.getWidth=function(){return 2*V},g.getHeight=function(){return R},g.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(S){var n=this;if(!S)return Wo=u.Default.callLater=n._defaultCallLater,bp=u.Default.cancelLater=n._defaultCancelLater,void 0;var n=this;Wo=u.Default.callLater=function(N,Q,l,c){var V=n._device;return V&&V.isPresenting?c?nd(function(){Wo(N,Q,l)},c):V.requestAnimationFrame(function(){n._deviceInAction=!0,N.apply(Q,l),n._deviceInAction=!1}):n._defaultCallLater(N,Q,l,c)},bp=u.Default.cancelLater=function(K,U){var $=n._device;return $&&$.isPresenting?U?Cd(K):$.cancelAnimationFrame(K):n._defaultCancelLater(K,U)}}}),J.defineProperties(ld.prototype,{enable:{get:function(){return this._enable},set:function(P){var e=this;e._enable!==P&&(e._enable=P,P?(e.switch.showButton(),e._injectCallLaterFunc(!0)):(e.shutdown(),e.switch.hideButton(),e._injectCallLaterFunc(!1)),e.fp("enable",!P,P))}},measureOflength:{get:function(){return this._measureOflength},set:function(g){this._measureOflength=g;var B=this._scaleFactor=1/g;this._controllers.forEach(function(b){b&&b._setScaleFactor(B)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(M){this._eyesOffset=M}},controllerModel:{get:function(){return this._controllerModel},set:function(T){var u;"object"==typeof T?(u=T.mtl,T=T.obj):(u=T+".mtl",T+=".obj");var i=this,G=i._controllerModel;G&&G.obj===T&&G.mtl===u||(G=i._controllerModel={obj:T,mtl:u},w.loadObj(T,u,{finishFunc:function(b,x){i._controllerModel===G&&w.setShape3dModel("vrControllerModel",x)}}))}},interactive:{get:function(){return!!this._interactive},set:function(N){!!N!=!!this._interactive&&(this._interactive=N,N&&this.addController(0),this.gv.getCoreInteractor().enableVR(N))}}});var Mc=function(M,e){function E(d){var s=navigator.getGamepads&&navigator.getGamepads();if(s)for(var u=0,n=0,D=s.length;D>u;u++){var z=s[u];if(z){var T=z.id;if("OpenVR Gamepad"===T||"OpenVR Controller"===T||0===T.indexOf("Oculus Touch")||0===T.indexOf("Spatial Controller")){if(n===d)return z;n++}}}}function B(u,j,E){return Math.abs(u[0]-j[0])<E&&Math.abs(u[1]-j[1])<E&&Math.abs(u[2]-j[2])<E?!0:!1}var g=this;g.vr=M,g.id=e;var o,N,P=[0,0],S=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],m=new Fb;m.s("shape3d","vrControllerModel"),m.isController=!0,m.s("intersect",!1),g.getGamepad=function(){return N},g.isButtonPressed=function(X){for(var F,T=0,p=S.length;p>T;T++)if(F=S[T],F.id===X)return F.pressed;return!1},g.getNode=function(){return m};var C=.003;g.setRotationEpsilon=function(Y){C=Y};var _=5e-4,D=_;g.setPositionEpsilon=function(A){_=A,D=A*g.vr._scaleFactor},g._setScaleFactor=function(i){m.s3(i,i,i),D=_*i},g._setScaleFactor(g.vr._scaleFactor);var Z,K=new So,A=new Oo,T=[0,0,0],t=[0,0,0],c=new vs,O=new pe,v=new Ck;g.getRay=function(){return Z?(v.origin.fromArray(T),v.direction.copy(O),Z=!1,v):v},g.update=function(){if(o=N,N=E(e),o!=N&&console.log("gamepad changed",N),!N||N.pose===I)return N=null,m.s("3d.visible",!1),void 0;if(w.getShape3dModel("vrControllerModel")){m.dm()||M.gv.dm().add(m),m.s("3d.visible",!0);var X=N.pose;if(null!==X){X.position&&(g.vr.toViewPosition(X.position,T),B(m.p3(),T,D)||(Z=!0,m.p3(T))),X.orientation&&(K.fromArray(X.orientation),O.set(0,0,-1).applyQuaternion(K).normalize(),A.makeRotationFromQuaternion(K),c.set(0,0,0,m.getRotationMode(),!0).setFromRotationMatrix(A),t[0]=c.x,t[1]=c.y,t[2]=c.z,B(m.r3(),t,C)||(Z=!0,m.r3(t))),Z&&M.fp("gamepad.pose",null,{position:T,rotation:t,id:e});var $=N.axes;(P[0]!==$[0]||P[1]!==$[1])&&(P=[$[0],$[1]],M.fp("gamepad.axes",null,{id:e,axes:P}));var Q,F,f,d,s=N.buttons;for(Q=0,F=s.length;F>Q;Q++)if(f=s[Q],d=f.pressed,d!==S[Q].pressed){S[Q].pressed=d;var x={id:e},n="state";x[n]=x._62O=d?"down":"up",M.fp("gamepad.button."+S[Q].id,null,x)}}}}},Kb=function(F){this.vr=F,this._button=null};eh(Kb,J,{showButton:function(){var y=this.assureButton();if(!y.parentNode){var k=this.vr.gv,z=k.getView();k._79O?z.insertBefore(y,k._79O):z.appendChild(y)}},hideButton:function(){var x=this._button;x&&x.parentNode&&x.parentNode.removeChild(x)},assureButton:function(){var h=this._button;return h?h:this._button=this.createButton(this.vr.gv)},createButton:function(L){function s(R,X){R.textContent=X&&X.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function y(X){f.style.display="",f.style.cursor="pointer",f.style.left="calc(50% - 50px)",f.style.width="100px",s(f,X),f.onmouseenter=function(){f.style.opacity="1.0"},f.onmouseleave=function(){f.style.opacity="0.5"},f.onclick=function(){X.isPresenting?X.exitPresent():X.requestPresent([{source:L.getCanvas()}])},L.vr.setDevice(X)}function C(){f.style.display="",f.style.cursor="auto",f.style.left="calc(50% - 75px)",f.style.width="150px",s(f,null),f.onmouseenter=null,f.onmouseleave=null,f.onclick=null,L.vr.setDevice(null)}function r(M){M.style.position="absolute",M.style.bottom="20px",M.style.padding="12px 6px",M.style.border="1px solid #fff",M.style.borderRadius="4px",M.style.color="#000",M.style.font="normal 13px sans-serif",M.style.textAlign="center",M.style.opacity="0.5",M.style.outline="none",M.style.zIndex="999"}if("getVRDisplays"in navigator){var f=this._button=b.createElement("button");return f.style.display="none",r(f),Z.addEventListener("vrdisplayconnect",function(i){y(i.display)},o),Z.addEventListener("vrdisplaydisconnect",function(){C()},o),Z.addEventListener("vrdisplaypresentchange",function(C){s(f,C.display),L.vr.onVRDisplayPresentChange()},o),navigator.getVRDisplays().then(function(S){S.length>0?y(S[0]):C()}),f}var i=b.createElement("a");return i.href="https://webvr.info",i.innerHTML="当前不支持 webvr",i.style.left="calc(50% - 90px)",i.style.width="180px",i.style.textDecoration="none",r(i),i}}),J.defineProperties(Kb.prototype,{});var Fe=u.graph3d.PostProcessing=function(W){function L(){if(!o){var q=W.getGL();o=new Uh.RenderTarget(W,q,null,null,{samples:F.renderTextureSamples||1}),E=new sk.Shader(q,R.vs,R.fs),C=sk.Buffer.createIndexBuffer(q,new Uint16Array([0,2,1,1,2,3])),M=sk.Buffer.createVertexBuffer(q,new Float32Array([0,0,1,0,0,1,1,1]))}}var o,E,C,M,x=this,S={},U=!1;!function(){J.keys(Fe).forEach(function(g){S[g]=new Fe[g](W)})}(),x.getModule=function(W){return W?S[W]:x},x.getModuleList=function(){return J.keys(S)},x.handleDataModleChange=function(P,T){P&&(P.setPostProcessingData(x.serialize()),P.removeSerializeListener(x.onDataModelSerialize,x)),T&&(T.addSerializeListener(x.onDataModelSerialize,x),x.deserialize(T.getPostProcessingData()))},x.onDataModelSerialize=function(I){"serialize"===I.type?W.dm()._postProcessingData=x.serialize():"deserialize"===I.type&&x.deserialize(W.dm().getPostProcessingData())},x.serialize=function(){var s,N,l,x,f={};for(s in S)l=S[s],N=s.toLowerCase(),f[N]={enable:l.enable},x=l.serializeProperties,x&&x.forEach(function(u){f[N][u]=l[u]});return f},x.deserialize=function(L){if(L){var e,T,o,X,c;for(T in L)if(T&&(e=T[0].toUpperCase()+T.slice(1),o=S[e])){X=L[T],x.enableModule(e,X.enable);for(c in X)"enable"!==c&&(o[c]=X[c])}}else{var e,o;for(e in S)o=S[e],o.enable=!1,o.resetProperties&&o.resetProperties()}},x.decodeShader=function(K){var Z,x,N,R="",w="";for(N=0;N<K.length;N++)Z=K[N],"%"===Z?Z="'":"a"===Z?Z='"':"]"===Z&&(Z="\\"),x=String.fromCharCode(Z.charCodeAt(0)-1),N%2?w+=x:R=x+R;return w+R},x.createShader=function(w,Y,k){var I=Y.indexOf("^#"),c=x.decodeShader(Y.substr(0,I)),g=x.decodeShader(Y.substr(I+2));if(k){var W=k(c,g);W&&W.vs&&(c=W.vs),W&&W.fs&&(g=W.fs)}return new sk.Shader(w,c,g)},x.enableModule=function(m,C){var r,Q,o,k=m.split(",");for(r=0,Q=k.length;Q>r;r++)o=k[r].trim(),S[o]&&(S[o].enable=C);U=!1;for(o in S)if(S[o].enable){U=!0;break}U&&L()};var R={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};x._42=function(Q,r,s){if(U){o.setSize(Q,r,s),o.bind(Q),Q.clear(Q.COLOR_BUFFER_BIT|Q.DEPTH_BUFFER_BIT),W.setViewport(Q,0,0,r,s),W.renderScene(),o.unbind(Q);for(var d=0,X=W._glCapabilities.maxAttributes;X>d;d++)Q.disableVertexAttribArray(d);var g,q=o;for(g in S)q=S[g]._42(Q,q)||q;return W.setViewport(Q,0,0,r,s),Q.clear(Q.COLOR_BUFFER_BIT|Q.DEPTH_BUFFER_BIT),E.bind(),Q.activeTexture(Q.TEXTURE0+0),Q.bindTexture(Q.TEXTURE_2D,q.texture),E.uniforms.image=0,C.upload(),M.upload(),E.attributes.pos.pointer(M),Q.drawElements(Q.TRIANGLES,6,Q.UNSIGNED_SHORT,0),Q.bindTexture(Q.TEXTURE_2D,null),Q.useProgram(W._prg),!0}}},Qr=u.graph3d.PostProcessing.Bloom=function(t){function W(){var N=t.getWidth(),e=t.getHeight();if(N&&e){p=[N,e],r=!0;var i,D=t.getGL(),F=Math.round(p[0]/2),d=Math.round(p[1]/2);for(K=new Uh.RenderTarget(t,D,F,d),i=0;b>i;i++)V.push(new Uh.RenderTarget(t,D,F,d)),M.push(new Uh.RenderTarget(t,D,F,d)),F=Math.round(F/2),d=Math.round(d/2);var x=t._postProcessing;U=x.createShader(D,Qr._34Q);for(var i=0;b>i;i++)g[i]=x.createShader(D,Qr._35Q,function(D,E){return{fs:E.replace(/DEFINE_VALUE/g,f[i])}});o=x.createShader(D,Qr._36Q,function(k,u){return{fs:u.replace(/NUM_MIPS/g,b)}}),s=x.createShader(D,Qr.finalShader),L=sk.Buffer.createIndexBuffer(D,new Uint16Array([0,2,1,1,2,3])),q=sk.Buffer.createVertexBuffer(D,new Float32Array([0,0,1,0,0,1,1,1]))}}var n,k,m,L,q,H=this,D=!1,r=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){n=1.5,k=.55,m=.4},J.defineProperties(H,{enable:{get:function(){return D},set:function(M){!!D!=!!M&&(D=M,M&&!r&&W())}},strength:{get:function(){return n},set:function(W){n=W}},threshold:{get:function(){return k},set:function(j){k=j}},radius:{get:function(){return m},set:function(z){m=z}}}),this.resetProperties();var K,U,o,s,p=[256,256],V=[],M=[],b=5,f=[3,5,7,9,11],g=[];H._42=function(T,H){function N(J,H,f,b){$b(T,H.frame),t.setViewport(T,0,0,H.width,H.height),b?b(T):T.clear(T.COLOR_BUFFER_BIT|T.DEPTH_BUFFER_BIT),c!==J&&J.bind();var V=0;for(var X in f){var E=f[X];E instanceof WebGLTexture&&(T.activeTexture(T.TEXTURE0+V),T.bindTexture(T.TEXTURE_2D,E),E=V,V++),J.uniforms[X]=E}for(c!==J&&(L.upload(),q.upload(),J.attributes.pos.pointer(q),c=J),T.drawElements(T.TRIANGLES,6,T.UNSIGNED_SHORT,0);V--;)T.activeTexture(T.TEXTURE0+V),T.bindTexture(T.TEXTURE_2D,null);_j(T)}if(D&&(r||(W(),r))){var c;N(U,K,{smoothWidth:.01,luminosityThreshold:k,tDiffuse:H.texture});var _,e=K,h=Math.round(p[0]/2),P=Math.round(p[1]/2);for(_=0;b>_;_++)N(g[_],V[_],{colorTexture:e.texture,direction:[1,0],texSize:[h,P]}),N(g[_],M[_],{colorTexture:V[_].texture,direction:[0,1],texSize:[h,P]}),h=Math.round(h/2),P=Math.round(P/2),e=M[_];return N(o,V[0],{blurTexture1:M[0].texture,blurTexture2:M[1].texture,blurTexture3:M[2].texture,blurTexture4:M[3].texture,blurTexture5:M[4].texture,bloomStrength:n,bloomRadius:m,bloomTintColor:[1,1,1]}),N(s,H,{image:V[0].texture},function(g){cn.for(g).glState.blend.apply({enabled:!0,equation:g.FUNC_ADD,func:[g.SRC_ALPHA,g.ONE]})}),cn.for(T).glState.blend.apply({equation:T.FUNC_ADD,func:[T.SRC_ALPHA,T.ONE_MINUS_SRC_ALPHA,T.ONE,T.ONE_MINUS_SRC_ALPHA]}),H}}};Qr._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Qr._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d1j/t2j!p-on!viTjuhiihqj!fgxm0pnbvuT<ftwvbgsgzjjeo)h5!dwffwd!3>!!wsVpwm<pDvhobjsgGp`smnh!t~bn<qxm!f+s!31E/!3d!p>m,p!snUvfTyuuivhsjff<xv<oxj!g+p!s*n3!fwmfqdn3b!tu!f,y!T2jf{mfq<nbvto)j!g>p,s!nn!vwTffdt3v!gegjjsefd<ucjhpso/<*u$fetfgggjPowfv!!L.F!SwOVFwM!`-SfBsEvJuVyTf!UEsFpGmJpOdF!`)WEB3MfVsFvu$yeffug!j>o!f3!fTmJqHnNbBt!!E4FdGfJwOF<`cWhBsM/V*FufgtmgpgbPuw!vh!b,v!twtVjwb!o-Qfesgv)ujyof!Ugsmppmbpud!!y)-E!3jfos!vgumypfbuu!!>t!j2hfnmbq*n!b|t!s4fdufvwso<!y1!/+4!:f9{:j5T!w+o!jf!y+q!)o!p.j1u/d6f!s+j!ey!!>+!!uyf0t)g!gtPjwhvn!b3!d+f!wtj<h*nbbn*h*j0Ttgj!h-nyb)<ge~Qowbpjjtet!vnbbhj!o>)!*x!!|ubwpfmdg3!<j*ojw)Tujb{pfm!g>!!>2!/y1!!u0b!pumfgyT|j!{*f!<,,g!mjp!b<uT!VgJTEjBhSn`bM!F>O!SgFmLp!b=u!)jT!J<H2N!B>*!<j!gumopjb!u)!sxpfgjh<inuvTTvuni!h>j!fhxb!v+t!tcjhbso/Q*ewgV)w1!/-1f-s!vguTyjfhUnsbp*m<pdw!f)dE43!fesjvgugyvftuf!T>v!n",Qr._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Qr.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Yq=u.graph3d.PostProcessing.Dof=function(m){function u(){y=!0;var b=m.getGL();$=new Uh.RenderTarget(m,b),s=m._postProcessing.createShader(b,Yq._38Q),H=sk.Buffer.createIndexBuffer(b,new Uint16Array([0,2,1,1,2,3])),l=sk.Buffer.createVertexBuffer(b,new Float32Array([0,0,1,0,0,1,1,1]))}var $,s,H,l,O,F,D,j,n=this,M=!1,y=!1;this.serializeProperties="aperture,maxblur,image".split(","),this.resetProperties=function(){this.aperture=.025,this.maxblur=1,this.image=null},J.defineProperties(n,{enable:{get:function(){return M},set:function(s){!!M!=!!s&&(M=s,s&&!y&&u())}},image:{get:function(){return F},set:function(x){F!==x&&(F=x,O&&(m.getGL().deleteTexture(O),O=null),m.iv())}},maxblur:{get:function(){return D},set:function(x){D!==x&&(D=x,m.iv())}},aperture:{get:function(){return j},set:function(p){j!==p&&(j=p,m.iv())}}}),this.resetProperties(),n._42=function(i,t){function x(e,b,E,Q){$b(i,b.frame),m.setViewport(i,0,0,b.width,b.height),Q?Q(i):i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),A!==e&&e.bind();var O=0;for(var z in E){var D=E[z];D instanceof WebGLTexture&&(i.activeTexture(i.TEXTURE0+O),i.bindTexture(i.TEXTURE_2D,D),D=O,O++),e.uniforms[z]=D}for(A!==e&&(H.upload(),l.upload(),e.attributes.pos.pointer(l),A=e),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0);O--;)i.activeTexture(i.TEXTURE0+O),i.bindTexture(i.TEXTURE_2D,null);_j(i)}if(M){y||u();var A;if(!O){var Y=Ve(this.image);if(!Y||!Y.tagName)return t;O=vc(i,Y)}var k=t.width,W=t.height;if(k&&W)return $.setSize(i,k,W),x(s,$,{tColor:t.texture,tDepth:O,aspect:k/W,aperture:this.aperture,maxblur:this.maxblur}),$}}};Yq._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",_p(w,{accordionViewExpandIcon:lq(Km),accordionViewCollapseIcon:lq(Km,!0),accordionViewLabelColor:Jh,accordionViewLabelFont:Dd,accordionViewTitleBackground:bl,accordionViewSelectBackground:Lb,accordionViewSelectWidth:3,accordionViewSeparatorColor:I,splitViewDividerSize:1,splitViewDividerBackground:bl,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:nj,rect:[2,2,12,12],background:Km}]},propertyViewLabelColor:mm,propertyViewLabelSelectColor:Jh,propertyViewLabelFont:Dd,propertyViewExpandIcon:lq(El),propertyViewCollapseIcon:lq(El,!0),propertyViewBackground:Dl,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Pb,propertyViewColumnLineColor:Pb,propertyViewSelectBackground:Lb,listViewLabelColor:mm,listViewLabelSelectColor:Jh,listViewLabelFont:Dd,listViewRowLineVisible:!1,listViewRowLineColor:Pb,listViewSelectBackground:Lb,treeViewLabelColor:mm,treeViewLabelSelectColor:Jh,treeViewLabelFont:Dd,treeViewExpandIcon:lq(qd),treeViewCollapseIcon:lq(qd,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Pb,treeViewSelectBackground:Lb,treeViewDoubleClickToToggle:!0,tableViewLabelColor:mm,tableViewLabelSelectColor:Jh,tableViewLabelFont:Dd,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Pb,tableViewColumnLineColor:Pb,tableViewSelectBackground:Lb,treeTableViewLabelColor:mm,treeTableViewLabelSelectColor:Jh,treeTableViewLabelFont:Dd,treeTableViewExpandIcon:lq(qd),treeTableViewCollapseIcon:lq(qd,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Pb,treeTableViewColumnLineColor:Pb,treeTableViewSelectBackground:Lb,tableHeaderLabelColor:mm,tableHeaderLabelFont:Dd,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:ig,tableHeaderBackground:Dl,tableHeaderMoveBackground:Jf,tableHeaderInsertColor:Lb,tableHeaderSortDescIcon:Uf(El,!0),tableHeaderSortAscIcon:Uf(El),tabViewTabGap:1,tabViewLabelColor:Jh,tabViewLabelFont:Dd,tabViewTabBackground:bl,tabViewSelectWidth:3,tabViewSelectBackground:Lb,tabViewMoveBackground:Jf,tabViewInsertColor:Lb,toolbarLabelColor:mm,toolbarLabelSelectColor:Jh,toolbarLabelFont:Dd,toolbarBackground:Dl,toolbarSelectBackground:Lb,toolbarItemGap:8,toolbarSeparatorColor:bj},!0);var Fh={translateX:1,sortColumn:1},df={sortable:1,sortOrder:1,sortFunc:1},Hq={focusData:1},wp={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},vk={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Rc=function(R,c){c.add(R),R.hasChildren()&&R.eachChild(function(t){Rc(t,c)})},Ii=function(R,I,m,A,H,D,b,$,W,k,P){var l,v=m.getValueType(k),p=m.getAlign(k);if(m.getEnumValues(k)){var n=m.toEnumLabel(I,k),z=sp||0,q=0,x=D,s=w.getTextSize(A,n).width;return l=Ve(m.toEnumIcon(I,k)),l&&(q=D+sp/2,"center"===p?q+=($-(z+s))/2:"right"===p&&(q=q+$-(z+s)),Cn(R,l,q,b+W/2,k,P),x=q+sp/2),n!=B&&(l?ep(R,n,A,H,x,b,$-(x-D),W):ep(R,n,A,H,D,b,$,W,p)),void 0}return I=m.formatValue(I),I!=B?v===Ge?(Xc(R,D,b,$,W,I),void 0):v===Wm||!v&&Bi(I)?(l=Ve(I?fg:Dh),Cn(R,l,D+$/2,b+W/2,k,P),void 0):(ep(R,I,A,H,D,b,$,W,p),void 0):void 0},ns=function(j,b){var K=b.view,Y=Be(j),G=b.column||b.property;K.getDataModel().beginTransaction(),b.editor=j,j.info=b,K.setCurrentEditor(j),K.getView().insertBefore(Y,K._79O),Bb(j,b.editorRect),j.setFocus?j.setFocus():Sp(j),j.commitValue=function(L,s){j._17Q&&(j=j._17Q),s||K.setValue(b.data,G,j.getValue?j.getValue():j.value),j.close&&j.close(),ih(Y)},G.onEditorCreated&&G.onEditorCreated(b)},qe=function(l,e,J,s,L){var t=Zc(l,J),i=e.value,z=e.view,V=L.getValueType(e.data);return t.onblur=t.onchange=function(){z.endEditing()},"input"===l?(i=L.formatValue(i),i!=B&&(t.value=i),t.onkeydown=function(Y){Il(Y)?z.endEditing():Pg(Y)&&z.endEditing(!0)},(V===Mb||V===md)&&t.addEventListener(Fj,w.numberListener,o)):l===oc&&s.forEach(function(W){var D=b.createElement("option");D.innerHTML=L.toEnumLabel(W),D.value=W,L.isEnumEqual(i,W)&&(D.selected=!0),Oi(t,D)}),ns(t,e),t},Ek=u.widget={},qs=function(o,h,E){eh(A+".widget."+o,h,E)};_p(ve,{ms_value:function(p){p.getValue=function(f){var S=this.getItemById(f),z=S.element;return Ug(z)?z:z?z.getValue?z.getValue():z.value:S.selected},p.setValue=function(x,L){var q=this.getItemById(x);if(q){var F=q.element;F&&!Ug(F)?F.setValue?F.setValue(L):F.value=L:Bi(L)?(q.selected=L,this.iv()):(q.element=L,this.iv())}},p.v=function(f,u){var $=this;if(2===arguments.length)$.setValue(f,u);else{if(!ei(f))return $.getValue(f);for(var h in f)$.setValue(h,f[h])}return $}},_46o:function(f){f._icon=B,f._accessType=B,f._valueType=B,f._editable=!1,f._batchEditable=!0,f._align=ue,f._nullable=!0,f._emptiable=!1,f.setParent=Ip,f.formatValue=function(i){var s=this,H=s._valueType;return s.getEnumValues()?s.toEnumLabel(i):H===Wm?!!i:i!=B&&H===Mb?Q(i):i},f.setEnum=function(N,Y,r,U,O,_,F){var n=this;N&&!Zh(N)&&N.values&&(U=N.editable,r=N.icons,Y=N.labels,O=N.strict,_=N.maxHeight,F=N.dropDownWidth,N=N.values),qf(N)&&(N=N._as),qf(Y)&&(Y=Y._as),qf(r)&&(r=r._as),n._enumValues=N,n._enumLabels=Y,n._enumIcons=r,n._enumEditable=U,n._enumStrict=O==B?!0:O,n._enumMaxHeight=_,n._enumDropDownWidth=F,N&&N.length&&Yp(N[0])&&(n._valueType=md),n.fp("enum",!1,!0)},f.getEnumDropDownWidth=function(){return this._enumDropDownWidth},f.getEnumMaxHeight=function(){return this._enumMaxHeight},f.isEnumEditable=function(){return this._enumEditable},f.getEnumValues=function(){return this._enumValues},f.getEnumLabels=function(){return this._enumLabels},f.getEnumIcons=function(){return this._enumIcons},f.isEnumStrict=function(){return this._enumStrict},f.isEnumEqual=function(I,x){return this._enumStrict?I===x:I==x},f.toEnumLabel=function(j,G){var S=this,m=S.getEnumValues(G),v=S.getEnumLabels(G);if(m&&v)for(var C=0;C<m.length;C++)if(S.isEnumEqual(j,m[C]))return v[C];return j},f.toEnumIcon=function(P,Y){var _=this,V=_.getEnumValues(Y),s=_.getEnumIcons(Y);if(V&&s)for(var A=0;A<V.length;A++)if(_.isEnumEqual(P,V[A]))return s[A];return I}},_45o:function(V){V._87o=function(g,e,G,p,o,M){if(g){var I=this,S=I._90I,z=ms(1);I._columnLineVisible&&(o-=1),I._rowLineVisible&&(M-=1),0>=o||0>=M||(I._90I||(S=I._90I={}),S[e]||(S[e]=new Vn),Bb(z,I.tx()+G,I.ty()+p,o,M),Oi(z,g),I._view.insertBefore(z,I._79O),g.onParentAdded&&g.onParentAdded(z),S[e].add(z))}},V._76o=function(){var M=this,t=M._90I;if(t){for(var e in t)t[e].each(function(q){ih(q)});delete M._90I
}},V._77o=function(Q){var e=this;if(e._90I){var B=e._90I[Q];B&&(B.each(function(R){ih(R)}),delete e._90I[Q])}}},_47o:function(N){N.getValue=function(x,j){return j.getValue?j.getValue(x,j,this):ef(x,j.getAccessType(),j.getName())},N.setValue=function(E,h,$){if(h.isEmptiable(E)||""!==$||($=I),h.isNullable(E)||$!=B){var u=this,J=h.getName(E),g=h.getAccessType(E),G=h.getValueType(E);G===Mb&&Ug($)?$=D($):G===md&&Ug($)?$=parseFloat($):G===Wm&&Ug($)&&($="true"===$),u._batchEditable&&h._batchEditable&&u.isSelected(E)?u.sm().each(function(V){h.setValue?h.setValue(V,h,$,u):im(V,g,J,$)}):h.setValue?h.setValue(E,h,$,u):im(E,g,J,$)}},N.setCurrentEditor=function(n){this.endEditing(),this._currentEditor=n,this.redraw()},N.isEditing=function(Q,u){var X=this,_=X._currentEditor;if(!_)return!1;if(u){var W=_.info;return W?(W.column||W.property)===u&&W.data===Q:!1}return!0},N.endEditing=function(m){var E=this,J=E._currentEditor;J&&(delete E._currentEditor,J.commitValue&&J.commitValue(J.info,m),E.redraw(),E.getDataModel().endTransaction())},N.beginEditing=function(X){this.endEditing();var C=this,z=X.column||X.property;if(z.beginEditing)z.beginEditing(X);else{var S=X.data,y=X.value,i=C.getSelectBackground(S),_=z.getEnumValues(S),t=z.getSlider(S),b=z.getColorPicker(S);if(t){var P=Lq(Ek.Slider,t);return P.setValue(y),P.getView().onblur=function(){C.endEditing()},P.isInstant()&&(P.onValueChanged=function(){C.setValue(S,z,P.getValue())}),ns(P,X),void 0}if(b||z.getValueType(S)===Ge){var o=Lq(Ek.ColorPicker,b);return o.setValue(y),o.onClosed=function(){C.endEditing()},o.isInstant()&&(o.onValueChanged=function(Q,N){C.setValue(S,z,N)}),ns(o,X),o.open(),void 0}if(_){if(Ek.ComboBox){var K=new Ek.ComboBox;K.setValue(y),K.setValues(_),K.setLabels(z.getEnumLabels(S)),K.setIcons(z.getEnumIcons(S)),K.setEditable(z.isEnumEditable(S)),K.setStrict(z.isEnumStrict(S)),K.setMaxHeight(z.getEnumMaxHeight(S)),K.setDropDownWidth(z.getEnumDropDownWidth(S)),K.onClosed=function(){C.endEditing()},ns(K,X),K.open()}else qe(oc,X,i,_,z);return}var u=z.getValueType(S);if(u===Wm||Bi(y))return C.setValue(S,z,!y),void 0;if(z.getItemEditor(S)){var $=_q(z.getItemEditor(S)),p=new $(S,z,C,X),f=p.getView();return f._17Q=p,p.setValue(y),Fi(f),ns(f,X),p.editBeginning&&p.editBeginning(),void 0}qe("input",X,i,B,z)}}},_44o:function(U){U.init=function(j){var R=this,y=R.th=new Fd(j),t=R._view=wk(1,R);R.tv=R._tableView=j,Oi(t,y.getView()),Oi(t,j.getView()),y.mp(function(T){T.property===pm&&R.iv()}),R.iv()},U.getTableView=function(){return this.tv},U.getTableHeader=function(){return this.th},U.getDataModel=function(){return this.tv.dm()},U.getColumnModel=function(){return this.tv.getColumnModel()},U.setColumns=function(c){this.tv.setColumns(c)},U.addColumns=function(w){this.tv.addColumns(w)},U.endEditing=function(){this.tv.endEditing()},U.validateImpl=function(){var Y=this,g=Y.th,j=$i(g),I={x:0,y:0,width:Y.getWidth(),height:j};Bb(g,I),I.y=j,I.height=_(0,Y.getHeight()-j),Bb(Y.tv,I)}},ms_vs:function(C){C._41o=function(){return this._29I.height<this._59I},C._43o=function(){var k=this;k._41o()&&(k._58I||(nd(function(){k._94O()},Fl),k.iv()),k._58I=new Date)},C._94O=function(){var B=this;if(B._58I){var n=new Date;n.getTime()-B._58I.getTime()>=Fl?(delete B._58I,B.iv()):nd(function(){B._94O()},Fl)}},C._93I=function(){var f=this,P=f._27I;if(f._58I||!f._autoHideScrollBar){P||Oi(f._79O,P=f._27I=ms());var v=f._29I,h=v.height,g=f._59I,F=f.getScrollBarSize(),z=v.width-F-2,a=h*(-f.ty()/g),l=h*(h/g),B=P.style;g>h?(bg>l&&(a=a+l/2-bg/2,0>a&&(a=0),a+bg>h&&(a=h-bg),l=bg),B.visibility=sh,B.background=f.getScrollBarColor(),B.borderRadius=F/2+bi,Bb(P,z,a,F,l)):B.visibility=Ub}else P&&(P.style.visibility=Ub)}},ms_hs:function(u){u._40o=function(){return this._29I.width<this._91I},u._42o=function(){var y=this;y._40o()&&(y._95O||(nd(function(){y._94I()},Fl),y.iv()),y._95O=new Date)},u._94I=function(){var K=this;if(K._95O){var r=new Date;r.getTime()-K._95O.getTime()>=Fl?(delete K._95O,K.iv()):nd(function(){K._94I()},Fl)}},u._92I=function(){var v=this,y=v._28I;if(v._95O||!v._autoHideScrollBar){y||Oi(v._79O,y=v._28I=ms());var e=v._29I,U=e.width,w=v._91I,P=v.getScrollBarSize(),g=e.height-P-2,$=U*(-v.tx()/w),i=U*(U/w),s=y.style;w>U?(bg>i&&($=$+i/2-bg/2,0>$&&($=0),$+bg>U&&($=U-bg),i=bg),s.visibility=sh,s.background=v.getScrollBarColor(),s.borderRadius=P/2+bi,Bb(y,$,g,i,P)):s.visibility=Ub}else y&&(y.style.visibility=Ub)}}}),mk(fg,Tq(16,16,[{type:kc,rect:[1,1,14,14],background:Lb},{type:nm,rect:[1,1,14,14],width:1,color:Vd},{type:Oh,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),mk(Dh,Tq(16,16,{type:nm,rect:[1,1,14,14],width:1,color:Vd})),mk(Xf,Tq(16,16,[{type:to,rect:[2,2,12,12],borderWidth:1,borderColor:Vd,background:"#FFF"},{type:to,rect:[4,4,8,8],background:Lb}])),mk(of,Tq(16,16,{type:to,rect:[2,2,12,12],borderWidth:1,borderColor:Vd})),ve._15Q=function(F){F._29I=cp,F._59I=0,F._91I=0,F._5o=function(Z){var D=this;D._30I=new Vn,D._rows=new Vn,D._rowMap={},D._31I=0,D._14I=0,D._view=wk(1,D),D._canvas=vn(D._view),Oi(D._view,D._79O=ms()),D.dm(Z?Z:new Hc)},F.getCheckIcon=function(H){var B=this.sm(),D=B.co(H);return B.sg()?Ve(D?Xf:of):Ve(D?fg:Dh)},F.checkData=function(u){var n=this.sm(),c=n.co(u);n.sg()&&c||(this._32o=1,c?n.rs(u):n.as(u),delete this._32o)},F.getDataAt=function(G){G.target&&(G=this.lp(G));var t=S(G.y/this._rowHeight),F=this._rows;return 0>t||t>=F.size()?B:F.get(t)},F.onDataDoubleClicked=function(){},F.onDataClicked=function(){},F.adjustTranslateX=function(){return 0},F.adjustTranslateY=function(T){var k=this.getHeight()-this._59I;return k>T&&(T=k),T>0?0:Q(T)},F.onPropertyChanged=function(o){var G=this,X=o.property;wp[X]?G.ivm():Hq[X]||G.redraw(),X===kh?G._42o():X===ap&&G._43o()},F.getLabel=function(c){return c.toLabel()},F.getLabelFont=function(){return this._labelFont},F.getLabelColor=function(M){var i=this;if(i.isCheckMode()){if(i._focusData===M)return i._labelSelectColor}else if(i.isSelected(M))return i._labelSelectColor;return i._labelColor},F.getStartRowIndex=function(){return this._31I},F.getEndRowIndex=function(){return this._14I},F.getRowDatas=function(){return this._rows},F.getRowIndex=function(l){return this._rowMap[l._id]},F.getRowSize=function(){return this._rows.size()},F.getViewRect=function(){return Sf(this._29I)},F.isVisible=function(i){return this._visibleFunc?this._visibleFunc(i):!0},F.getCurrentSortFunc=function(){return this._sortFunc},F.setDataModel=function(F){var E=this,u=E._dataModel,f=E._selectionModel;u!==F&&(u&&(u.umm(E.handleDataModelChange,E),u.umd(E.handleDataPropertyChange,E),u.umh(E.handleHierarchyChange,E),f||u.sm().ums(E.handleSelectionChange,E)),E._dataModel=F,F.mm(E.handleDataModelChange,E),F.md(E.handleDataPropertyChange,E),F.mh(E.handleHierarchyChange,E),f?f._21I(F):F.sm().ms(E.handleSelectionChange,E),E.fp("dataModel",u,F))},F.validateModel=function(){var n=this;n._rows.clear(),n._rowMap={},n.buildChildren(n._dataModel._roots);var s=n._rows=n._rows.toList(n.isVisible,n),t=0,i=n.getCurrentSortFunc(),H=s.size();for(i&&s.sort(i);H>t;t++)n._rowMap[s.get(t)._id]=t},F.buildChildren=function(l){var D=this;l.each(function($){D._rows.add($),D.buildChildren($._children)})},F.handleDataModelChange=function(){this.ivm()},F.handleDataPropertyChange=function(f){"parent"===f.property?this.ivm():this.invalidateData(f.data)},F.handleHierarchyChange=function(){this.ivm()},F.handleSelectionChange=function(A){A.datas.each(this.invalidateData,this),this.onSelectionChanged(A)},F.onSelectionChanged=function(u){var M=this,$=M.sm();!M.isAutoMakeVisible()||1!==$.size()||"set"!==u.kind&&"append"!==u.kind||M._32o||M.makeVisible($.ld())},F.handleBackgroundClick=function(B){yi(B)&&!this.isCheckMode()&&this.sm().cs()},F.makeVisible=function(C){C&&(this._23I=C,this.iv())},F.scrollToIndex=function(q){var r=this,H=r._29I,K=H.height,e=r._rowHeight,o=e*q;q>=0&&q<r._rows.size()&&K>0&&(o+e>H.y+K?r.ty(-o+K-e):o<H.y&&r.ty(-o))},F.autoScroll=function(F,l){var N=this,G=N._rowHeight,T=G,g=G/4,X=N._29I,n=N.lp(F),x={x:N.tx(),y:N.ty()};return G>0&&X&&(n.x-X.x<T?N.translate(g,0):X.x+X.width-n.x<T&&N.translate(-g,0),n.y-X.y<T?N.translate(0,g):X.y+X.height-n.y<T&&N.translate(0,-g)),x.x=N.tx()-x.x,x.y=N.ty()-x.y,l&&(l.x+=x.x,l.y+=x.y),x},F.getTopRowOrderSelection=function(){var j=this.sm().getTopSelection(),y={},E=new Vn;return j.each(function(o){y[o._id]=o}),this._rows.each(function(S){y[S._id]&&E.add(S)}),E},F.getRowOrderSelection=function(){var b=new Vn;return this._rows.each(function(v){this.isSelected(v)&&b.add(v)},this),b},F.ivm=function(){this.invalidateModel()},F.invalidateModel=function(){var b=this;b._96I||(b._96I=1,b._32I=1,delete b._24I),b.iv()},F.redraw=function(){var f=this;f._32I||(f._32I=1,delete f._24I,f.iv())},F.invalidateData=function(K){var q=this;Mo?q.redraw():q._32I||(q._24I||(q._24I={}),q._24I[K._id]=K,q.iv())},F.getFocusData=function(){return this._focusData},F.setFocusDataById=function(w){this.setFocusData(this.dm().getDataById(w))},F.setFocusData=function(O){var Y=this,r=Y._focusData;r!==O&&(Y._focusData=O,Y.fp("focusData",r,O),r&&Y.invalidateData(r),O&&(Y.invalidateData(O),Y.isAutoMakeVisible()&&Y.makeVisible(O)))},F.drawRowBackground=function(Y,c,t,D,$,y,E){var z=this,b=z.isCheckMode();(c===z._focusData&&b||t&&!b)&&Xc(Y,D,$,y,E,z.getSelectBackground(c))},F.drawData=function(H,E,t){var z=this,g=z._rowHeight,J=g*t,R=z._29I,u=R.x,D=R.width;H.save(),H.beginPath(),H.rect(u,J,D,g),H.clip(),z._87o(z.drawRow(H,E,z.isSelected(E),u,J,D,g),t,u,J,D,g),H.restore(),z._rowLineVisible&&Xc(H,u,J+g-1,D,1,z._rowLineColor)},F._12I=function(O){var n=this,p=n._31I,j=n._29I,d=j.x,h=j.y,a=j.width,W=j.height;for(O.beginPath(),O.rect(d,h,a,W),O.clip(),O.clearRect(d,h,a,W),n._76o(),n._93db(O);p<n._14I;p++)n.drawData(O,n._rows.get(p),p);n._92db(O)},F._13I=function(l){for(var T,j=this,e=j._rowHeight,U=j._29I,Q=U.x,d=U.width,E=j._31I,v=j._30I;E<j._14I;E++)T=j._rows.get(E),j._24I[T._id]&&v.add({data:T,index:E});v.isEmpty()||(l.beginPath(),v.each(function(a){l.rect(Q,a.index*e,d,e)}),l.clip(),v.each(function(r){l.clearRect(Q,r.index*e,d,e)}),v.each(function(m){j._77o(m.index)}),j._93db(l),v.each(function(e){j.drawData(l,e.data,e.index)}),j._92db(l),v.clear())},F.preValidateModel=function(){this.endEditing&&this.endEditing()},F.validateImpl=function(){var O=this,k=O._canvas,A=O.getWidth(),T=O.getHeight(),K=O._rowHeight,Y=O._32I;(A!==k.clientWidth||T!==k.clientHeight)&&(Lg(k,A,T),Y=1);var C=f&&!m;O._96I&&!C&&(O.preValidateModel(),O.validateModel());var U=O._29I,c={x:-O.tx(),y:-O.ty(),width:A,height:T},J=O._rows.size(),w=oj(k),N=O._23I;Y||un(c,U)||(Y=1),O._29I=c,O._59I=J*K+O.getScrollBarSize(),O._31I=S(c.y/K),O._14I=M((c.y+c.height)/K),O._31I<0&&(O._31I=0),O._14I>J&&(O._14I=J),O._99I&&Y&&O._99I(),Id(w,O.tx(),O.ty(),1),Y?O._12I(w):O._24I&&O._13I(w),O._93I(),O._92I(),w.restore(),O._32I=O._24I=O._96I=B,N&&(O.scrollToIndex(O.getRowIndex(N)),delete O._23I),O.tx(O.tx()),O.ty(O.ty())}},ve._48o=function(u){u._rootVisible=!0,u._rootData=B,u._35o=function(){this._expandMap={},this._levelMap={}},u.validateModel=function(){var D=this,b=D._rootData;D._rows.clear(),D._levelMap={},D._rowMap={},D._currentLevel=0,b?D._rootVisible?D.isVisible(b)&&D.buildData(b):D.buildChildren(b):D.buildChildren(),delete D._currentLevel},u.buildData=function(n){var S=this,D=n._id,d=S._rows;S._rowMap[D]=d.size(),d.add(n),S._levelMap[D]=S._currentLevel,S.isExpanded(n)&&(S._currentLevel++,S.buildChildren(n),S._currentLevel--)},u.buildChildren=function(r){var G=this,i=r?r._children:G._dataModel._roots,l=G.getCurrentSortFunc();l&&G.isChildrenSortable(r)?i.toList(G.isVisible,G).sort(l).each(G.buildData,G):i.each(function(w){G.isVisible(w)&&G.buildData(w)})},u.getLevel=function(p){return this._levelMap[p._id]},u.getToggleIcon=function(O){var Q=this,i=Q._loader,b=Q._collapseIcon;return i&&!i.isLoaded(O)?b:O.hasChildren()?Q.isExpanded(O)?Q._expandIcon:b:B},u.isCheckMode=function(){return this._checkMode!=B},u.isChildrenSortable=function(){return!0},u.handleDataModelChange=function(J){var I=this;J.kind===Te?delete I._expandMap[J.data._id]:J.kind===Zj&&(I._expandMap={}),I.ivm()},u.toggle=function(J){var y=this;y.isExpanded(J)?y.collapse(J):y.expand(J)},u.isExpanded=function(q){return 1===this._expandMap[q._id]},u.expand=function(p){var j=this,V=j._loader;j.isExpanded(p)||(V&&!V.isLoaded(p)&&V.load(p),j._expandMap[p._id]=1,j.ivm(),j.onExpanded(p))},u.onExpanded=function(){},u.collapse=function(I){var E=this;E.isExpanded(I)&&(delete E._expandMap[I._id],E.ivm(),E.onCollapsed(I))},u.onCollapsed=function(){},u.expandAll=function(K){if(K)this.expand(K),K.eachChild(function(V){this.expandAll(V)},this);else{var w=this;w._dataModel.each(function(h){h.hasChildren()&&(w._expandMap[h._id]=1)}),w.ivm()}},u.collapseAll=function(){this._expandMap={},this.ivm()},u.makeVisible=function(f){if(f){var $=this;if(!$._rootData||f.isDescendantOf($._rootData)){for(var u=f._parent;u;)$.expand(u),u=u._parent;$._23I=f,$.iv()}}},u.checkData=function(m){var G,V=this,F=V._checkMode,n=V.sm(),i=n.co(m);if(!n.sg()||!i){if(V._32o=1,F===Cb)i?n.rs(m):n.as(m);else if(F===hm)G=new Vn(m),G.addAll(m._children);else if("descendant"===F)G=new Vn,Rc(m,G);else if("all"===F&&(G=new Vn,Rc(m,G),!i))for(var y=m._parent;y;)G.add(y),y=y._parent;G&&(i?n.rs(G):n.as(G)),delete V._32o}},u._97I=function(d,a,g,i,w,h,l){var u=this,C=u._indent,R=u._levelMap[a._id],P=u.getIconWidth(a),$=Ve(u.getToggleIcon(a));$?(i+=C*R,Cn(d,$,i+C/2,w+l/2,a,u),i+=C):i+=C*(R+1),u._checkMode&&(Cn(d,u.getCheckIcon(a),i+C/2,w+l/2,a,u),i+=C),u.drawIcon(d,a,i,w,P,l),u.drawLabel(d,a,i+P,w,l)}},ve._14Q=function(G){G.getIcon=function(S){return S.getIcon()},G.getIconWidth=function(P){return this.getIcon(P)?this._indent:0},G.drawIcon=function(a,u,G,Q,R,T){if(R){var f=this,U=f.getBodyColor(u),m=Ve(f.getIcon(u),U);m&&(T-=f.isRowLineVisible()?1:0,fl(a,m,Qi,G,Q,R,T,u,f,U),Dr(a,f.getBorderColor(u),G,Q,R,T))}},G.drawLabel=function(D,b,C,f,M){var i=this;ep(D,i.getLabel(b),i.getLabelFont(b),i.getLabelColor(b),C,f,0,M)}},ve._50o=function(e){e._98I=function(){var b=this,G=b._39o=new Hc;b._60I=new Vn,G.mm(b._17o,b),G.md(b._18o,b),G.mh(b._19o,b)},e.setColumns=function(E){this._39o.clear(),this.addColumns(E)},e.addColumns=function(f){var $=this._39o;f.forEach(function(H){if(!(H instanceof Od)){var g=_q(H.className);H=Lq(g?g:Od,H)}$.add(H)})},e.onColumnClicked=function(){},e.onCheckColumnClicked=function(){},e._3Q=function(P){for(var a,M=0,x=this._60I,V=x.size();V>M;M++)if(a=x.get(M),a.column===P)return a;return B},e.getColumnAt=function(h){var A=this._4Q(h);return A?A.column:B},e._4Q=function(g){for(var F=this,c=g.target?F.lp(g).x:g.x,m=F._60I,p=0;p<m.size();p++){var h=m.get(p),P=h.startX;if(c>=P&&c<P+h.column.getWidth())return h}return B},e.getToolTip=function(V){var v=this,O=v.getDataAt(V),I=v.getColumnAt(V);return O&&I?I.getToolTip(O,v):B},e.adjustTranslateX=function(J){var y=this.getWidth()-this._91I;return y>J&&(J=y),J>0?0:Q(J)},e._99I=function(){var c=this,F=c._29I,B=c._60I;B.clear(),c._91I=0,c._39o._roots.each(function(o){if(o.isVisible()){var l=c._91I+o.getWidth();c._91I<=F.x+F.width&&l>=F.x&&B.add({column:o,startX:c._91I}),c._91I=l}}),c._91I+=c.getScrollBarSize()},e.drawData=function(Z,z,Y){var S=this,W=S._rowHeight,T=W*Y,$=S.isSelected(z),g=S._29I,n=g.x,G=g.width;S.drawRowBackground(Z,z,$,n,T,G,W),S._60I.each(function(O){var d=O.column,K=O.startX,v=d.getWidth();v>0&&!S.isEditing(z,d)&&(Z.save(),Z.beginPath(),Z.rect(K,T,v,W),Z.clip(),S._87o(S.drawCell(Z,z,$,d,K,T,v,W),Y,K,T,v,W),S._columnLineVisible&&Xc(Z,K+v-1,T,1,W,S._columnLineColor),Z.restore())}),S._rowLineVisible&&Xc(Z,n,T+W-1,G,1,S._rowLineColor)},e.drawCell=function(E,U,j,W,p,u,O,I){var Q=this;if(W.drawCell)return W.drawCell(E,U,j,W,p,u,O,I,Q);var B=Q.getValue(U,W);Ii(E,B,W,Q.getLabelFont(U,W,B),Q.getLabelColor(U,W,B),p,u,O,I,U,Q)},e.getColumnModel=function(){return this._39o},e._17o=function(){this.redraw()},e._18o=function(M){var h=this;M.data===h._sortColumn&&df[M.property]?h.ivm():(h._42o(),h.redraw())},e._19o=function(){this.redraw()},e.getCurrentSortFunc=function(){var l=this,p=l._sortColumn;if(p&&p.isSortable()){var Z=p.getSortFunc(),H=vo===p.getSortOrder()?1:-1;return Z||(Z=Tn),function(I,E){return Z.call(l,l.getValue(I,p),l.getValue(E,p),I,E)*H}}return l._sortFunc},e.isCellEditable=function(b,o,X){return o.isEditable()&&this.isEditable()?o.isCellEditable?o.isCellEditable(b,o,X,this):!0:!1},e._37O=function(c,Q){if(yi(Q))for(var N=this,m=N.lp(Q),V=N._60I,w=N._rowHeight,U=N._29I,u=U.x,H=U.y,J=U.width,r=U.height,z=0;z<V.size();z++){var d=V.get(z),h=d.startX,v=d.column,e=v.getWidth();if(v!==N._31o&&v!==N._4o&&m.x>=h&&m.x<h+e&&N.isCellEditable(c,v,Q)){var k={x:h,y:N.getRowIndex(c)*w,width:e,height:w},L={x:k.x+N.tx(),y:k.y+N.ty(),width:k.width,height:k.height},S=0,R=0;return k.x<u?S=k.x-u:k.x+k.width>u+J&&(S=k.x+k.width-u-J),S&&(N.tx(N.tx()-S),L.x-=S),k.y<H?R=k.y-H:k.y+w>H+r&&(R=k.y+w-H-r),R&&(N.ty(N.ty()-R),L.y-=R),N.beginEditing({data:c,column:v,value:N.getValue(c,v),event:Q,rect:k,editorRect:L,view:N}),void 0}}}},Ek.BaseItemEditor=function(w,D,c,W){this._data=w,this._column=D,this._master=c,this._editInfo=W},qs("BaseItemEditor",J,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Yl=u.Tab=function(){lr(Yl,this)};dk("Tab",db,{ms_ac:["view","closable","disabled","visible"],_icon:B,_closable:!1,_disabled:!1,_visible:!0,setParent:Ip});var Od=u.Column=function(){lr(Od,this)};dk("Column",db,{_46o:1,ms_ac:["accessType","valueType",sh,wn,Ce,nq,"align",Ge,"sortOrder",ki,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:vo,_sortFunc:B,_sortable:!0,_clickable:!0,setWidth:function(j){16>j&&(j=16);var M=this._width;this._width=j,this.fp(nq,M,j)},getToolTip:function(q,z){return this.formatValue(z.getValue(q,this))}});var Li=u.Property=function(){lr(Li,this)};dk("Property",db,{_46o:1,ms_ac:["accessType","valueType",wn,Ce,"categoryName",Ge,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:B,getToolTip:function(D,L,p){var U=this;return L?U.formatValue(p.getValue(D,U)):p.getPropertyName(U)}}),Ek.AccordionView=function(){var J=this;J._20o={},J._21o=new Vn,J._10o=B,J._9o=B,J._11o=B,J._view=wk(0,J),J.iv()},qs("AccordionView",J,{ms_v:1,ms_fire:1,ms_ac:[Ph,Jp,"titleHeight",zd,Xg,"titleBackground","selectWidth",up,"orientation","separatorColor"],_expandIcon:w.accordionViewExpandIcon,_collapseIcon:w.accordionViewCollapseIcon,_titleHeight:Bj,_labelColor:w.accordionViewLabelColor,_labelFont:w.accordionViewLabelFont,_titleBackground:w.accordionViewTitleBackground,_selectBackground:w.accordionViewSelectBackground,_selectWidth:w.accordionViewSelectWidth,_orientation:"v",_separatorColor:w.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(b,T,m,h){var F=this,U=ms();if(F._20o[b])throw b+" already exists";U.onmousedown=xh,U.style.cursor=Vk,U.addEventListener(xc?Nr:$g,function(m){xh(m)},o),U.addEventListener(xc?Mn:Pl,function(E){xh(E),yi(E)&&(F._10o===b?F.collapse():F.expand(b))},o),Oi(F._view,U),F._20o[b]={content:T,div:U,canvas:vn(U),icon:h},F._21o.add(b),m&&F.expand(b),F.iv()},remove:function(E){var D=this,K=D._20o[E];K&&(ih(K.div),delete D._20o[E],D._21o.remove(E),D.iv())},clear:function(){var y=this;y._21o.toArray().forEach(y.remove,y),y._20o={},y._21o.clear(),y.iv()},isExpanded:function(E){return this._10o===E},expand:function(p){var N=this;N._20o[p]&&N._10o!==p&&(N._10o=p,N.onExpanded(p),N.iv())},onExpanded:function(){},collapse:function(){var v=this;v._10o&&(v.onCollapsed(v._10o),delete v._10o,v.iv())},onCollapsed:function(){},initCanvas:function(s,t,S){Lg(s,t,S);var X=oj(s);return Id(X,0,0,1),X.clearRect(0,0,t,S),X},drawTitle:function(c,r,g,X,F){var s=this,U=Ve(F.icon),C=s.isExpanded(r),w=s._titleHeight,M=s._titleBackground,z=s._selectWidth,o=s._separatorColor,I=Ve(C?s._expandIcon:s._collapseIcon),V=z+4;Xc(c,0,0,g,X,M),C&&z&&Xc(c,0,0,z,X,s._selectBackground),(C||s._21o.get(s._21o.size()-1)!==r)&&Xc(c,0,X-1,g,1,o?o:Cl(M)),U&&(Cn(c,U,V+Sg(U)/2,w/2),V+=Sg(U)+2),ep(c,r,s.getLabelFont(r),s.getLabelColor(r),V,0,0,w),I&&Cn(c,I,g-Sg(I)/2-4,w/2)},validateImpl:function(){var K=this,d=K._view,h=0,q=0,M=K.getWidth(),g=K.getHeight(),G=K._titleHeight,i=K._21o.size()*G,w=K._11o,t=K._9o;delete K._11o,delete K._9o,K._21o.each(function(o){var T,D,S=K._20o[o],V=S.content,u=K._10o===o;Uq(K)?(Bb(S.div,h,0,G,g),T=K.initCanvas(S.canvas,G,g),Bn(T,0,g),sb(T,-L),K.drawTitle(T,o,g,G,S),T.restore(),u?(D=_(0,M-i),V&&(K._11o=V,K._9o=Be(V),Bb(V,h+G,0,D,g)),h+=G+D):h+=G):(Bb(S.div,0,q,M,G),T=K.initCanvas(S.canvas,M,G),K.drawTitle(T,o,M,G,S),T.restore(),u?(D=_(0,g-i),V&&(K._11o=V,K._9o=Be(V),Bb(V,0,q+G,M,D)),q+=G+D):q+=G)});var Z=K._9o;w&&w!==K._11o&&w.endEditing&&w.endEditing(),Z&&Z!==t&&Oi(d,Z),t&&t!==Z&&ih(t)}}),Ek.SplitView=function(N,x,K,T){var X=this,_=X._dividerDiv=ms(),M=X._60O=vn(),V=X._61O=vn(),P=M.style,G=V.style;X._view=wk(1,X),Oi(X._view,_),P.msTouchAction=Bg,P.pointerEvents=Bg,P.cursor=Vk,G.msTouchAction=Bg,G.pointerEvents=Bg,G.cursor=Vk,N&&X.setLeftView(N),x&&X.setRightView(x),K&&X.setOrientation(K),T!=B&&X.setPosition(T),X.setStatus(Yi),new Zp(X)},qs("SplitView",J,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:w.splitViewDividerSize,_dividerBackground:w.splitViewDividerBackground,_dragOpacity:w.splitViewDragOpacity,_toggleIcon:w.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(N,t){var Q=this,E=Q._position;isNaN(N)||(t||(Q._82O=0>N?-1:N>1?1:0),Q._position=N,Q.fp(Ci,E,N))},getLeftView:function(){return this._leftView},setLeftView:function(X){var S=this,D=S._leftView,f=S._view;if(S._leftView!==X){if(D&&D!==S._rightView){var n=Be(D);n.parentNode===f&&ih(n)}if(S._leftView=X,X){var p=Be(X);p.parentNode!==f&&f.insertBefore(p,S._dividerDiv)}S.fp("leftView",D,X)}},getRightView:function(){return this._rightView},setRightView:function(p){var v=this,E=v._rightView,F=v._view;if(v._rightView!==p){if(E&&E!==v._leftView){var G=Be(E);G.parentNode===F&&ih(G)}if(v._rightView=p,p){var d=Be(p);d.parentNode!==F&&F.insertBefore(d,v._dividerDiv)}v.fp("rightView",E,p)}},validateImpl:function(){var c=this,n=c._draggable,S=c._position,H=c.getWidth(),D=c.getHeight(),g=c._dividerSize,f=c._dividerBackground,x=xc?18:8,t=c._dividerDiv,O=c._82O,v=c._60O,P=c._61O,T=c._toggleIcon,F=c._status,C=t.style,z=null,p=xc?20:4,r=T.comps[0];g>=x||0===g?c._coverDiv&&(ih(c._coverDiv),delete c._coverDiv):c._coverDiv||(c._coverDiv=ms(),Tg&&(c._coverDiv.style.background=Wn),Oi(t,c._coverDiv)),c._togglable?v.parentNode||(Oi(t,v),Oi(t,P)):(ih(v),ih(P));var J=c._coverDiv,W=c._leftView,y=c._rightView;if(Uq(c)){if(g>H&&(g=H),F===Yi)if(1===O)var u=s(S,H),i=_(0,H-g-u);else-1===O?(i=s(-S,H),u=_(0,H-g-i)):(u=Q((H-g)*S),i=_(0,H-g-u));else"cl"===F?(u=0,i=_(0,H-g)):"cr"===F&&(i=0,u=_(0,H-g));W&&Bb(W,0,0,u,D),y&&Bb(y,u+g,0,i,D),Bb(t,u,0,g,D),c._22o=u,J&&(Bb(J,g/2-x/2,0,x,D),J.style.cursor=n?jk:""),t.style.cursor=n?jk:"";var e=t.clientHeight/2,h=t.clientWidth;Lg(v,h,h),Bb(v,0,e-h-p,h,h),z=oj(v),Id(z,0,0,1),r.rotation=-L,rj(z,T,0,0,h,h),z.restore(),Lg(P,h,h),Bb(P,0,e+p,h,h),z=oj(P),Id(z,0,0,1),r.rotation=L,rj(z,T,0,0,h,h),z.restore()}else{if(g>D&&(g=D),F===Yi)if(1===O)var w=s(S,D),b=_(0,D-g-w);else-1===O?(b=s(-S,D),w=_(0,D-g-b)):(w=Q((D-g)*S),b=_(0,D-g-w));else"cl"===F?(w=0,b=_(0,D-g)):"cr"===F&&(b=0,w=_(0,D-g));W&&Bb(W,0,0,H,w),y&&Bb(y,0,w+g,H,b),Bb(t,0,w,H,g),c._22o=w,J&&(Bb(J,0,g/2-x/2,H,x),J.style.cursor=n?Gm:""),C.cursor=n?Gm:"";var I=t.clientWidth/2,h=t.clientHeight;Lg(v,h,h),Bb(v,I-h-p,0,h,h),z=oj(v),Id(z,0,0,1),r.rotation=0,rj(z,T,0,0,h,h),z.restore(),Lg(P,h,h),Bb(P,I+p,0,h,h),z=oj(P),Id(z,0,0,1),r.rotation=R,rj(z,T,0,0,h,h),z.restore()}C.background=f}});var Zp=function(i){this.sv=i,this.addListeners()};eh(Zp,J,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(L){var V=this,Q=V.sv,l=Q._dividerDiv,q=Q._60O,p=Q._61O,$=Q._status,M=L.target;if(M===q)$===Yi?Q.setStatus("cl"):"cr"===$&&Q.setStatus(Yi);else if(M===p)$===Yi?Q.setStatus("cr"):"cl"===$&&Q.setStatus(Yi);else if(sj(L)&&(M===l||M===Q._coverDiv)&&(xh(L),Q.isDraggable())){Q.getLeftView(),Q.getRightView();var T=V.maskDiv=ms();if(T.style.left=0,T.style.top=0,T.style.width=Q.getWidth()+"px",T.style.height=Q.getHeight()+"px",Q.getView().appendChild(T),!Q.isContinuousLayout()){var F=V.resizeDiv=ms();F.style.left=l.style.left,F.style.top=l.style.top,F.style.width=l.style.width,F.style.height=l.style.height,F.style.opacity=Q.getDragOpacity(),F.style.background=Q.getDividerBackground(),Oi(V.getView(),F)}V._lastAbsPosition=Q._22o,V._86o=Uq(Q)?pr(L).x:pr(L).y,bh(V,L)}},handleWindowTouchMove:function(z){sj(z)&&this.update(z,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(n){var w=this;w.update(n,!0),w.sv.setStatus(Yi),w.maskDiv&&ih(w.maskDiv),w.resizeDiv&&ih(w.resizeDiv),w.maskDiv=w.resizeDiv=B},handle_mousedown:function(S){yi(S)&&this.handle_touchstart(S)},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},update:function(O,G){var e=this,S=e.sv,s=Uq(S)?S.getWidth():S.getHeight(),J=S._dividerSize,Z=e._lastAbsPosition-e._86o;Uq(S)?(Z+=pr(O).x,Z>s-J&&(Z=s-J),0>Z&&(Z=0),e.resizeDiv&&(e.resizeDiv.style.left=Z+bi)):(Z+=pr(O).y,Z>s-J&&(Z=s-J),0>Z&&(Z=0),e.resizeDiv&&(e.resizeDiv.style.top=Z+bi)),G&&s!==J&&(1===S._82O?S.setPosition(Z,1):-1===S._82O?S.setPosition(Z-s+J,1):S.setPosition(Z/(s-J),1))}}),Ek.TabView=function(){var I=this,S=I._view=wk(1,I),z=I._91O=ms(1),M=I._tabModel=new Hc,O=M.sm(),K=I.invalidate;I._7o=new Vn,I._canvas=vn(z),Oi(S,z),Oi(S,I._92O=ms(1)),O.setSelectionMode(Zn),O.ms(I.handleSelectionChange,I),M.mm(K,I),M.mh(K,I),M.md(K,I),I._interactor=new Ql(I),I.iv()},qs("TabView",J,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",zd,Xg,"tabHPadding","tabBackground","selectWidth",up,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Xn,_tabHeight:Bj,_tabGap:w.tabViewTabGap,_labelColor:w.tabViewLabelColor,_labelFont:w.tabViewLabelFont,_tabBackground:w.tabViewTabBackground,_selectWidth:w.tabViewSelectWidth,_selectBackground:w.tabViewSelectBackground,_moveBackground:w.tabViewMoveBackground,_insertColor:w.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(q,b,o){var B,X=this._tabModel;return q instanceof Yl?(B=q,b&&B.setView(b)):(B=new Yl,B.setName(q),B.setView(b)),X.add(B),o&&X.sm().ss(B),B},getLabel:function(w){return w.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(u){this._23o=u,this.iv()},get:function(V){var i=this,G=i._tabModel;if(Yp(V))return G._roots.get(V);if(Ug(V)){var v;return G.each(function(X){V===i.getLabel(X)&&(v=X)}),v}return V instanceof Yl?V:B},select:function(z){this._tabModel.sm().ss(this.get(z))},remove:function(R){var E=this;if(R=E.get(R)){var y=E._tabModel,O=y._roots.indexOf(R);E._tabModel.remove(R),E.selectByIndex(--O)}},getCurrentTab:function(){return this._8o},hideTabView:function(K,I){I.parentNode===this._92O&&(ae(I)?(I.style.display=Iq,I._tab_=K):ih(I),rh())},showTabView:function(Y,T){ae(T)&&(T.style.display="block",T._tab_=Y),T.parentNode!==this._92O&&(Oi(this._92O,T),rh())},_24o:function(){var J,x=this,l=x._8o,D=x._9o,Q=x._tabModel.sm().ld();Q&&(J=Be(Q.getView())),J!==D&&(D&&(l.getView()&&l.getView().endEditing&&l.getView().endEditing(),x.hideTabView(l,D)),J&&x.showTabView(Q,J)),x._8o=Q,x._9o=J,l!==Q&&x.onTabChanged(l,Q)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(Y,o){this.selectByIndex(--o)},selectByIndex:function(n){var P=this,v=P._tabModel,k=v.size();if(k&&!v.sm().ld()){n==B&&(n=0),n>=k&&(n=k-1),0>n&&(n=0);for(var g=n;g>=0;g--){var l=P.get(g);if(!l.isDisabled())return P.select(l),l}for(g=n+1;k>g;g++)if(l=P.get(g),!l.isDisabled())return P.select(l),l}},getTabWidth:function(X){var S=this.getTabHPadding(),$=4+2*S,c=Ve(X.getIcon());c&&($+=Sg(c,X)+4);var x=this.getLabel(X);return x&&($+=ad(this.getLabelFont(X),x).width+4),X.isClosable()&&($+=10),$},drawTab:function(K,S,E,Q,g,u,p){var w,q=this,h=q._tabPosition,G=this.getTabHPadding(),z=E+4+G,k=q._selectWidth,m=Ve(S.getIcon()),j=S.isDisabled(),f=q.getLabelColor(S),x=q.getLabelFont(S),c=q.getLabel(S),e=q._selectBackground,J=h===ue+"-vertical",T=h===cg+"-vertical";(J||T)&&(z=Q+4+G),j&&(K.globalAlpha=Pi),Xc(K,E,Q,g,u,p),S===q._8o&&k&&(h===Xn?Xc(K,E,Q+u-k,g,k,e):h===ue?Xc(K,E+g-k,Q,k,u,e):h===cg?Xc(K,E,Q,k,u,e):J?Xc(K,E+g-k,Q,k,u,e):T?Xc(K,E,Q,k,u,e):Xc(K,E,Q,g,k,e));var W=g/2;if(J&&(Bn(K,W,Q+u/2),sb(K,R),Bn(K,-W,-Q-u/2)),m){var n=Xd(m,S),s=Sg(m,S);if(J||T){var r=E+g/2,b=z+n/2;Bn(K,r,b),sb(K,L),Bn(K,-r,-b),Cn(K,m,E+g/2,z+n/2,S,q),Bn(K,r,b),sb(K,-L),Bn(K,-r,-b),z+=n+4}else Cn(K,m,z+s/2,Q+u/2,S,q),z+=s+4}return J||T?(Bn(K,g/2,z+g/2),sb(K,L),Bn(K,-g/2,-z-g/2),ep(K,c,x,f,E,z,u,g),Bn(K,g/2,z+g/2),sb(K,-L),Bn(K,-g/2,-z-g/2)):ep(K,c,x,f,z,Q,g,u),J&&(Bn(K,W,Q+u/2),sb(K,-R),Bn(K,-W,-Q-u/2)),S.isClosable()&&(w=T?{x:E+g-12,y:Q+u-12,width:12,height:12}:{x:E+g-12,y:Q+2,width:12,height:12},this.drawCloseIcon(S,K,f,w)),j&&(K.globalAlpha=1),w},drawCloseIcon:function(z,A,t,W){var f=W.x,B=W.y;A.strokeStyle=t,A.lineWidth=1,A.beginPath(),A.moveTo(f+2,B+8),A.lineTo(f+8,B+2),A.moveTo(f+8,B+8),A.lineTo(f+2,B+2),A.stroke()},getTabAt:function(e){var Y=this._interactor._8Q(e);return Y?Y.tab:null},validateImpl:function(){var d=this;d._24o();var N,c=d._canvas,e=d._tabPosition,X=d._91O,I=d._92O,H=d._tabModel,z=d.getWidth(),E=d.getHeight(),F=d._tabHeight,u=d._7o,k=d._tabGap,p=e===Xn,M=e===ue,v=e===cg,L=e===ue+"-vertical",T=e===cg+"-vertical",q=d._23o,Y=0;if((M||v)&&H._roots.each(function(X){Y=_(d.getTabWidth(X),Y)}),p?(Bb(X,0,0,z,F),N={x:0,y:F,width:z,height:_(0,E-F)}):M?(Bb(X,0,0,Y,E),N={x:Y,y:0,width:_(0,z-Y),height:E}):v?(Bb(X,z-Y,0,Y,E),N={x:0,y:0,width:_(0,z-Y),height:E}):L?(Bb(X,0,0,F,E),N={x:F,y:0,width:_(0,z-F),height:E}):T?(Bb(X,z-F,0,F,E),N={x:0,y:0,width:_(0,z-F),height:E}):(Bb(X,0,E-F,z,F),N={x:0,y:0,width:z,height:_(0,E-F)}),Bb(I,N),L||T){d._9o&&(N.x=0,Bb(d._8o.getView(),N)),Lg(c,F,E);var C=oj(c),h=0;if(Id(C,0,d.ty(),1),C.clearRect(0,0,F,E),u.clear(),H._roots.each(function($){if($.isVisible()){var G,N=d.getTabWidth($);q&&q.tab===$||(G=d.drawTab(C,$,0,h,F,N,d._tabBackground)),u.add({_75o:G,tab:$,startY:h,endY:h+N,height:N}),h+=N+k}}),d._23Q=_(0,h-k),q){var g=q.position;d.drawTab(C,q.tab,0,q.startY,F,q.height,d._moveBackground),Xc(C,0,g,F,1,d._insertColor)}if(C.restore(),d._selectionChanged){d._selectionChanged=!1;for(var x=d.ty(),$=0;$<u.size();$++){var O=u.get($);if(O.tab===d._8o){if(O.endY+x<0){d.ty(-O.startY);break}if(O.startY+x>E){d.ty(E-O.endY);break}}}}d.ty(d.ty())}else if(M||v){d._9o&&(N.x=0,Bb(d._8o.getView(),N)),Lg(c,Y,E);var C=oj(c),h=0;if(Id(C,0,d.ty(),1),C.clearRect(0,0,Y,E),u.clear(),H._roots.each(function(Z){if(Z.isVisible()){var x;q&&q.tab===Z||(x=d.drawTab(C,Z,0,h,Y,F,d._tabBackground)),u.add({_75o:x,tab:Z,startY:h,endY:h+F,height:F}),h+=F+k}}),d._23Q=_(0,h-k),q){var g=q.position;d.drawTab(C,q.tab,0,q.startY,Y,q.height,d._moveBackground),Xc(C,0,g,Y,1,d._insertColor)}if(C.restore(),d._selectionChanged){d._selectionChanged=!1;for(var x=d.ty(),$=0;$<u.size();$++){var O=u.get($);if(O.tab===d._8o){if(O.endY+x<0){d.ty(-O.startY);break}if(O.startY+x>E){d.ty(E-O.endY);break}}}}d.ty(d.ty())}else{d._9o&&(N.y=0,Bb(d._8o.getView(),N)),Lg(c,z,F);var C=oj(c),t=0;if(Id(C,d.tx(),0,1),C.clearRect(0,0,z,F),u.clear(),H._roots.each(function(K){if(K.isVisible()){var E,r=d.getTabWidth(K);
q&&q.tab===K||(E=d.drawTab(C,K,t,0,r,F,d._tabBackground)),u.add({_75o:E,tab:K,startX:t,endX:t+r,width:r}),t+=r+k}}),d._64I=_(0,t-k),q){var g=q.position;d.drawTab(C,q.tab,q.startX,0,q.width,F,d._moveBackground),Ak(C,d._insertColor,g,0,F)}if(C.restore(),d._selectionChanged){d._selectionChanged=!1;for(var f=d.tx(),$=0;$<u.size();$++){var O=u.get($);if(O.tab===d._8o){if(O.endX+f<0){d.tx(-O.startX);break}if(O.startX+f>z){d.tx(z-O.endX);break}}}}d.tx(d.tx())}for(var W=[],P=I.children,$=0;$<P.length;$++){var r=P[$],K=r._tab_;K&&!H.contains(K)&&W.push(r)}W.forEach(function(M){I.removeChild(M)})}});var Ql=function(f){this.tv=f,this.addListeners()};eh(Ql,J,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(p){this.handleScroll(p,10*(p.wheelDelta/40))},handle_DOMMouseScroll:function(l){this.handleScroll(l,10*-l.detail)},handleScroll:function(C,S){xh(C);var W=this.tv,k=W._tabPosition;!W._40o()||k!==Xn&&k!==id||W.tx(this.tv.tx()+S),!W._41o()||k!==ue&&k!==cg&&k!==ue+"-vertical"&&k!==cg+"-vertical"||W.ty(this.tv.ty()+S)},_8Q:function(N){var j,M,v=this.tv,U=v._tabPosition,m=v._7o;if(U===Xn||U===id){var p=v.lp(N).x;for(j=0;j<m.size();j++)if(M=m.get(j),M.startX<=p&&p<=M.endX)return M}else if(U===ue||U===cg||U===ue+"-vertical"||U===cg+"-vertical"){var y=v.lp(N).y;for(j=0;j<m.size();j++)if(M=m.get(j),M.startY<=y&&y<=M.endY)return M}return B},isClickable:function(b){var A=this.tv,E=A._tabPosition,J=this._73o=this._8Q(b);return!A._40o()||E!==Xn&&E!==id?!A._41o()||E!==ue&&E!==cg&&E!==ue+"-vertical"&&E!==cg+"-vertical"?J&&(!J.tab.isDisabled()||A.isMovable()):!0:!0},handle_mousemove:function(A){var Y=this;Kn?Y._74o=Y._8Q(A):Y.getView().style.cursor=Y.isClickable(A)?Vk:""},handle_mousedown:function(R){this.handle_mousemove(R),this.handle_touchstart(R)},handle_touchstart:function(h){var C=this,m=C.tv,p=m._tabPosition;xh(h),yi(h)&&C.isClickable(h)&&(p===Xn||p===id?(C.x=pr(h).x,C.lp=m.lp(h),C.tx=m.tx()):(C.y=pr(h).y,C.lp=m.lp(h),C.ty=m.ty()),bh(C,h))},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowTouchMove:function(v){var e,i=this,P=i.tv,C=P._tabPosition,A=i._73o;if(C===Xn||C===id){if(e=pr(v).x-i.x,!i._25o&&!i.moving&&j(e)>2&&(P._40o()&&!Di(v)?i._25o=1:A&&P.isMovable()&&(i.moving=1)),i._25o)P.tx(i.tx+e);else if(i.moving){var u=i.lp.x+e,z=P._tabGap/2;P._7o.each(function(h){var O=h.endX,k=u-h.startX<O-u;u>=h.startX&&O>=u&&P._7Q({tab:A.tab,startX:A.startX+e,width:A.width,front:k,insertTab:h.tab,position:k?_(0,h.startX-z):s(P._64I,O+z)})})}}else if(e=pr(v).y-i.y,!i._25o&&!i.moving&&j(e)>2&&(P._41o()&&!Di(v)?i._25o=1:A&&P.isMovable()&&(i.moving=1)),i._25o)P.ty(i.ty+e);else if(i.moving){var x=i.lp.y+e,z=P._tabGap/2;P._7o.each(function(I){var R=I.endY,F=x-I.startY<R-x;x>=I.startY&&R>=x&&P._7Q({tab:A.tab,startY:A.startY+e,height:A.height,front:F,insertTab:I.tab,position:F?_(0,I.startY-z):s(P._23Q,R+z)})})}},handleWindowMouseUp:function(L){this.handleWindowTouchEnd(L)},handleWindowTouchEnd:function(){var F=this,w=F.tv,c=w._tabPosition,D=w.getTabModel(),e=D._roots,L=F._73o;if(F.moving){var C=w._23o;if(C&&C.insertTab!==C.tab){var k=C.tab,z=e.remove(k),J=e.indexOf(C.insertTab);J>=0&&(C.front||J++,J<=e.size()&&(e.add(k,J),D._38I(k,z,J)))}w._7Q(B),delete F.moving}else if(!F._25o&&L){k=L.tab;var j=F._74o;if(!j||j.tab===k)if(!k.isDisabled()&&fr(L._75o,F.lp)){var V=function(){var f=e.indexOf(k);D.remove(k),w.onTabClosed(k,f)};w.onTabClosing(k,V)&&V()}else k.isDisabled()||w._8o===k||D.sm().ss(k)}F._25o=F._73o=F._74o=c===Xn||c===id?F.x=F.lp=F.tx=B:F.y=F.lp=F.ty=B}}),Ek.PropertyView=function(d){var Z=this;Z._view=wk(1,Z),Z._canvas=vn(Z._view),Oi(Z._view,Z._79O=ms()),Z._rows=new Vn,Z._28o=new Vn,Z._26o={},Z._26Q={};var t=Z._propertyModel=new Hc,W=Z.ivm;t.mm(W,Z),t.md(W,Z),t.mh(W,Z),Z.dm(d?d:new Hc),new Ol(Z)},qs("PropertyView",J,{ms_ac:[zd,zj,Xg,wn,Ce,"categorizable",Ic,ki,lj,Ph,Jp,bb,yk,_b,"selectRowIndex",up,"background",Cp,nn,jr,mj,kq],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:cp,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:sp,_background:w.propertyViewBackground,_expandIcon:w.propertyViewExpandIcon,_collapseIcon:w.propertyViewCollapseIcon,_scrollBarColor:jg,_scrollBarSize:el,_autoHideScrollBar:km,_selectBackground:w.propertyViewSelectBackground,_rowHeight:kg,_rowLineVisible:w.propertyViewRowLineVisible,_rowLineColor:w.propertyViewRowLineColor,_10I:.5,_columnLineVisible:w.propertyViewColumnLineVisible,_columnLineColor:w.propertyViewColumnLineColor,_labelColor:w.propertyViewLabelColor,_labelSelectColor:w.propertyViewLabelSelectColor,_labelFont:w.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(U){0>U&&(U=0),U>1&&(U=1);var W=this,R=W._10I;W._10I=U,W.fp("columnPosition",R,U)},getPropertyName:function(x){return x.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(O,Y,x){return x===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(c,D){return D===this._selectRowIndex?this._labelSelectColor:c.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(N){var M=this.getHeight()-this._59I;return M>N&&(N=M),N>0?0:Q(N)},isExpanded:function(x){if(!x)return!0;var c=this._26o[x];return c?c.isExpanded:!(this._26Q[x]===!1)},toggle:function(D){var Q=this;Q.isExpanded(D)?Q.collapse(D):Q.expand(D)},expandAll:function(){this.validate();for(var h in this._26o)this.expand(h)},expand:function(V){if(V&&V!==Iq){var N=this,C=N._26o[V];C&&!C.isExpanded&&(C.isExpanded=!0,N.onExpanded(V),N.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var h in this._26o)this.collapse(h)},collapse:function(A){if(A&&A!==Iq){var X=this,C=X._26o[A];C&&C.isExpanded&&(C.isExpanded=!1,X.onCollapsed(A),X.ivm())}},onCollapsed:function(){},getCategoryName:function(y){if(!this.isCategorizable())return Iq;var c=y.getCategoryName();return c?c:Iq},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function($){var U=this,J=U._dataModel;J!==$&&(J&&(J.umd(U.handlePropertyChange,U),U._selectionModel||J.sm().ums(U.handleSelectionChange,U)),U._dataModel=$,$.md(U.handlePropertyChange,U),U._selectionModel?U._selectionModel._21I($):$.sm().ms(U.handleSelectionChange,U),U.fp(nh,J,$))},isVisible:function(E){return this._visibleFunc?this._visibleFunc(E):!0},onPropertyChanged:function(w){var i=this,K=w.property;vk[K]?i.ivm():i.iv(),K===ap&&i._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Cc},handlePropertyChange:function(K){this._27o===K.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var K=this;K._96I||(K.setSelectRowIndex(-1),K._96I=1,K.iv())},redraw:function(){this.iv()},validateModel:function(){var f=this,q=f._rows,M=f._28o,v={},C=new Vn,j=f._27o;f.updateCurrentData(),j!==f._27o&&f.endEditing(),q.clear(),M.clear(),f.getRawProperties().each(function(B){if(f.isVisible(B)){C.add(B);var x=f.getCategoryName(B);v[x]||(M.add(x,x===Iq?0:I),v[x]={isExpanded:f.isExpanded(x),properties:new Vn})}}),f._sortFunc&&C.sort(f._sortFunc);for(var N in f._26o)f._26Q[N]=f.isExpanded(N);f._26o=v,M.each(function(E){E!==Iq&&q.add(E);var c=v[E];c.isExpanded&&C.each(function(y){f.getCategoryName(y)===E&&(c.properties.add(y),q.add({property:y,data:f._27o}))},f)})},validateImpl:function(){var V=this;V._76o(),V._96I&&(V.validateModel(),delete V._96I);var A=V._canvas,K=V.getWidth(),_=V.getHeight(),x=-V.ty(),v=V._rowHeight,y=V._indent,C=K-y,R=V._rows,G=R.size(),i=V._9I=y+C*V._10I,H=V._59I=G*v;Lg(A,K,_),V._29I={x:0,y:x,width:K,height:_},V._31I=S(x/v),V._14I=M((x+_)/v),V._31I<0&&(V._31I=0),V._14I>G&&(V._14I=G);var U,F=oj(A),P=V._background;Id(F,0,-x,1),F.beginPath(),F.rect(0,x,K,_),F.clip(),F.clearRect(0,x,K,_),V._93db(F),P&&Xc(F,0,0,y,H,P);for(var Y=V._31I;Y<V._14I;Y++){var b=R.get(Y),x=v*Y;if(Ug(b))P&&Xc(F,y,x,C,v,P),U=Ve(V.isExpanded(b)?V._expandIcon:V._collapseIcon),U&&fl(F,U,Qi,0,x,y,v),F.save(),F.beginPath(),F.rect(y,x,C,v),F.clip(),V.drawCategoryName(F,b,Y,y,x,C,v),F.restore();else{var w=b.property,X=b.data,U=Ve(w.getIcon()),q=V._selectRowIndex===Y?V.getSelectBackground():B;if(U&&fl(F,U,Qi,0,x,y,v),q&&Xc(F,y,x,C,v,q),F.save(),F.beginPath(),F.rect(y,x,i-y,v),F.clip(),V.drawPropertyName(F,w,Y,y,x,i-y,v),F.restore(),!V.isEditing(X,w)){var o=i+1,s=K-i-1;F.save(),F.beginPath(),F.rect(o,x,s,v),F.clip(),V._87o(V.drawPropertyValue(F,w,V.getValue(X,w),Y,o,x,s,v,X),Y,o,x,s,v),F.restore()}}V._rowLineVisible&&Xc(F,y,x+v-1,C,1,V._rowLineColor)}V._columnLineVisible&&(Xc(F,i,0,1,H,V._columnLineColor),Xc(F,K-1,0,1,H)),V._92db(F),V._93I(),F.restore(),V.ty(V.ty())},drawCategoryName:function(_,l,A,G,n,a,B){ep(_,l,this.getCategoryFont(l),this.getCategoryColor(l),G,n,a,B)},drawPropertyName:function(W,o,X,F,q,Q,D){return o.drawPropertyName?(o.drawPropertyName(W,o,X,F,q,Q,D,this),void 0):(ep(W,this.getPropertyName(o),this.getPropertyFont(o,X),this.getPropertyColor(o,X),F,q,Q,D),void 0)},drawPropertyValue:function(M,e,s,U,y,n,I,z,$){return e.drawPropertyValue?e.drawPropertyValue(M,e,s,U,y,n,I,z,$,this):(Ii(M,s,e,this.getLabelFont(e,s,U),this.getLabelColor(e,s,U),y,n,I,z,$,this),void 0)},isPropertyEditable:function(J){return J.isEditable()&&this.isEditable()},setProperties:function(P){this._propertyModel.clear(),this.addProperties(P)},addProperties:function(P){if(P){var U=this._propertyModel;P.forEach(function(i){if(!(i instanceof Li)){var s=_q(i.className);i=Lq(s?s:Li,i)}U.add(i)})}},getRowIndexAt:function(u){var j=this,G=S(j.lp(u).y/j._rowHeight);return G>=0&&G<j._rows.size()?G:-1},getPropertyAt:function(W){var Q=this,J=Q.getRowIndexAt(W);return J>=0?Q._rows.get(J).property:B},getToolTip:function(H){var j=this,z=j.getPropertyAt(H),F=j._27o;return z&&F?z.getToolTip(F,j._9I<j.lp(H).x,j):B}});var Ol=function(f){this.pv=f,this.addListeners()};eh(Ol,J,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(b){this.getView().style.cursor=b},clear:function(){var z=this;z._62O=z.cp=z.ty=z.p=B,z.setCursor(Cb)},handle_mousedown:function(V){this.handle_touchstart(V)},handle_touchstart:function(B){var R=this,w=R.pv;xh(B),w.setFocus(B)&&(yi(B)?(R.cp=pr(B),R.ty=w.ty(),R.p=w.getColumnPosition(),R.handle_touchmove(B)):w.setSelectRowIndex(w.getRowIndexAt(B)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(A){var p=this;if(p.cp&&!p._62O){var g=p.pv,S=g.lp(A),x=S.x,L=S.y,e=g._indent,f=g.getRowIndexAt(A),i=g._9I;if(f>=0){var E=g._rowHeight,s=E*f,d=g._rows.get(f),r=d.property;if(Ug(d))Ve(g.isExpanded(d)?g._expandIcon:g._collapseIcon)&&x>=0&&e>=x&&L>=s&&s+E>=L?g.toggle(d):Sb(A)&&g.toggle(d);else if(x>i&&g.isPropertyEditable(r,A)){var I={x:i+1,y:s,width:g.getWidth()-i-1,height:E},X={x:I.x+g.tx(),y:I.y+g.ty(),width:I.width,height:I.height},Z=0,z=g._29I;I.y<z.y?Z=I.y-z.y:I.y+E>z.y+z.height&&(Z=I.y+E-z.y-z.height),Z&&(g.ty(g.ty()-Z),X.y-=Z),g.beginEditing({data:d.data,property:r,value:g.getValue(d.data,r),event:A,rect:I,editorRect:X,view:g})}}g.setSelectRowIndex(f)}p.clear()},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(D){var Y=this,r=Y.pv,W=Y.ty,u=Y.cp,X=pr(D),b=Y._62O;if("p"===b)r.setTranslateY(W+X.y-u.y);else if("c"===b){var H=r.getWidth()-r._indent;if(H>16){var M=Y.p-(u.x-X.x)/H,K=16/H;K>M&&(M=K),M>1-K&&(M=1-K),r.setColumnPosition(M)}}else"s"===b&&r.setTranslateY(W+(u.y-X.y)*r._59I/r._29I.height)},handle_mousemove:function(o){this.handle_touchmove(o)},handle_touchmove:function(F){if(!Kn&&yi(F)){var x=this,s=x.pv,A=j(s.lp(F).x-s._9I)<=(xc?8:3);x.cp?x._62O||(A?(x._62O="c",bh(x)):j(pr(F).y-x.cp.y)>=2&&(x._62O=x.isV(F)?"s":"p",bh(x))):(A?x.setCursor(jk):x.setCursor(Cb),x.isV(F)&&s._43o())}},isV:function(c){var G=this.pv,H=G._29I;return G._41o()&&H.x+H.width-G.lp(c).x<td},handle_mousewheel:function(i){this.handleScroll(i,i.wheelDelta/40)},handle_DOMMouseScroll:function(B){2===B.axis&&this.handleScroll(B,-B.detail)},handleScroll:function(Y,q){var M=this.pv;xh(Y),M.endEditing(),M.translate(0,q*M.getRowHeight())},handle_keydown:function(V){var y=this.pv,m=y._rows.size(),B=y._selectRowIndex+(ls(V)?-1:1);(ls(V)||gm(V))&&(0>B&&(B=0),B>=m&&(B=m-1),y.setSelectRowIndex(B))}}),Ek.ListView=function($){this._5o($),new Br(this)},qs("ListView",J,{ms_ac:[zd,zj,Xg,Cp,Ic,nn,jr,ki,lj,bb,yk,_b,Se,up],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:sp,_rowHeight:kg,_rowLineVisible:w.listViewRowLineVisible,_rowLineColor:w.listViewRowLineColor,_scrollBarColor:jg,_scrollBarSize:el,_autoMakeVisible:dp,_autoHideScrollBar:km,_selectBackground:w.listViewSelectBackground,_labelColor:w.listViewLabelColor,_labelSelectColor:w.listViewLabelSelectColor,_labelFont:w.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(U){var m=this,O=m._checkMode;m._checkMode=U,m.fp(Zm,O,U)},drawRow:function(l,y,G,s,J,K,Z){var M=this,m=0,g=M._indent,f=M.getIconWidth(y);M.drawRowBackground(l,y,G,s,J,K,Z),M._checkMode&&(Cn(l,Ve(M.getCheckIcon(y)),m+g/2,J+Z/2,y,M),m+=g),M.drawIcon(l,y,m,J,f,Z),M.drawLabel(l,y,m+f,J,Z)}});var Br=function(W){this.list=W,this._lastSelectDataTime=np(),this.addListeners()};eh(Br,J,{ms_listener:1,getView:function(){return this.list._view},clear:function(Z){var q=this,Q=q.list;Z&&"d"===q._62O&&!q.dragCancel&&Q.handleDragAndDrop(Z,"end"),Q.draggingData&&(Q.draggingData=null,Q.redraw()),q.dragCancel=q._62O=q._isV=q._isH=q.cp=q.tx=q.ty=B},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(d){var L=this,t=L.list;if(xh(d),t.setFocus(d)){var s=t.getDataAt(d);L.cp=pr(d),L.tx=t.tx(),L.ty=t.ty(),yi(d)?s&&t.handleDragAndDrop&&!L.isV(d)&&!L.isH(d)&&(t.draggingData=s,t.redraw(),t.handleDragAndDrop(d,"prepare")):(s&&L._33o(d,s),L.clear(d))}},handleWindowMouseUp:function(C){this.clear(C)},handleWindowTouchEnd:function(F){this.clear(F)},handle_mouseup:function(V){this.handle_touchend(V)},handle_touchend:function(V){var F=this,d=F.list;if(!F._isV&&!F._isH&&F.cp&&!F._62O){var N=d.getDataAt(V);N?(d.isCheckMode()?F._34o(V,N):F._33o(V,N),Sb(V)?d.onDataDoubleClicked(N,V):d.onDataClicked(N,V)):d.handleBackgroundClick(V)}F.clear(V)},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowTouchMove:function(_){var i=this,K=i.list,r=i._62O,T=i.tx,s=i.ty,Z=i.cp,f=pr(_),g=K._29I;"p"===r?K.setTranslate(T+f.x-Z.x,s+f.y-Z.y):"v"===r?K.ty(s+(Z.y-f.y)*K._59I/g.height):"h"===r?K.tx(T+(Z.x-f.x)*K._91I/g.width):"d"===r&&(i.dragCancel||K.handleDragAndDrop(_,"between"))},handle_mousemove:function(x){this.handle_touchmove(x)},handle_touchmove:function(Y){if(!Kn&&yi(Y)){var p=this,l=p.list;if(p._isV=p.isV(Y),p._isH=p.isH(Y),p.cp){if(!p._62O){if(Ke(pr(Y),p.cp)<2)return;p._isV?p._62O="v":p._isH?p._62O="h":l.draggingData&&!this.dragCancel?(p._62O="d",l.handleDragAndDrop(Y,"begin")):p._62O="p",p._62O&&"d"!==p._62O&&l.draggingData&&(l.draggingData=null,l.redraw()),bh(p)}}else p._isV&&l._43o(),p._isH&&l._42o()}},isV:function(E){var A=this.list,i=A._29I;return A._41o()&&i.x+i.width-A.lp(E).x<td},isH:function(n){var Y=this.list,Z=Y._29I;return Y._40o()&&Z.y+Z.height-Y.lp(n).y<td},handle_mousewheel:function(q){this.handleScroll(q,q.wheelDelta/40,q.wheelDelta!==q.wheelDeltaX)},handle_DOMMouseScroll:function(H){this.handleScroll(H,-H.detail,1)},handleScroll:function(Q,d,z){var P=this.list;xh(Q),P.endEditing&&P.endEditing(),z&&P._41o()?P.translate(0,d*P.getRowHeight()):P._40o()&&P.translate(10*d,0)},handle_keydown:function(r){if(!w.isInput(r.target)){var l,k=this.list,Y=k.sm(),A=k._rows,K=A.size();if(Ui(r))k.selectAll();else if(_e(r))k.handleDelete&&k.handleDelete(r);else if(Pg(r))"d"!==this._62O||this.dragCancel||(k.handleDragAndDrop(r,"cancel"),this.dragCancel=!0);else if(Rg(r))k.isCheckMode()&&(l=k.getFocusData(),l&&k.checkData(l));else if(ls(r)||gm(r)){var s=k.isCheckMode();if(l=s?k.getFocusData():Y.ld()){var n=k.getRowIndex(l);n>=0&&(ls(r)?0!==n&&(l=A.get(n-1),s?k.setFocusData(l):Y.ss(l)):n!==K-1&&(l=A.get(n+1),s?k.setFocusData(l):Y.ss(l)))}else K>0&&(l=A.get(0),s?k.setFocusData(l):Y.ss(l))}}},_34o:function(P,B){var w=this.list,c=w.lp(P).x;return c>=0&&c<=w._indent?(w.checkData(B),void 0):(w.setFocusData(B),void 0)},_33o:function(k,h){var t=this.list,I=t.sm(),G=I.ld();if(Di(k))t.isSelected(h)?I.rs(h):I.as(h);else if(us(k))if(G)for(var M=t.getRowIndex(G),v=t.getRowIndex(h);M!==v;)M+=v>M?1:-1,I.as(t._rows.get(M));else I.ss(h);else if(yi(k)){var $=np();if(I.contains(h)){var R=$-this._lastSelectDataTime;t.handleDataDoubleSelect&&R>500&&1500>R&&t.handleDataDoubleSelect(k,h)}I.ss(h),this._lastSelectDataTime=$}else I.contains(h)||I.ss(h)}}),Ek.TreeView=function(p){var w=this;w._35o(),w._5o(p),new Xk(w)},qs("TreeView",J,{ms_ac:[zd,zj,Xg,"rootVisible",Zm,"rootData",ki,lj,bb,yk,_b,Ic,Cp,nn,jr,Ph,Jp,Se,up,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:B,_indent:sp,_rowHeight:kg,_rowLineVisible:w.treeViewRowLineVisible,_rowLineColor:w.treeViewRowLineColor,_scrollBarColor:jg,_scrollBarSize:el,_autoHideScrollBar:km,_expandIcon:w.treeViewExpandIcon,_collapseIcon:w.treeViewCollapseIcon,_autoMakeVisible:dp,_selectBackground:w.treeViewSelectBackground,_labelColor:w.treeViewLabelColor,_labelSelectColor:w.treeViewLabelSelectColor,_labelFont:w.treeViewLabelFont,_doubleClickToToggle:w.treeViewDoubleClickToToggle,drawRow:function(V,w,l,b,R,M,g){var G=this;G.drawRowBackground(V,w,l,b,R,M,g),G._97I(V,w,l,0,R,M,g)},isOnToggleIcon:function(Z){var b=this.getDataAt(Z);if(b){var G=this.getIndent(),S=this.lp(Z).x;if(Ve(this.getToggleIcon(b))){var u=G*this.getLevel(b);if(S>=u&&u+G>=S)return!0}}return!1}});var Xk=function(h){lr(Xk,this,[h])};eh(Xk,Br,{toggle:function(o,X,l,b){var x=this.list,G=x.lp(o).x;if(Ve(x.getToggleIcon(X))){var r=l*b;if(G>=r&&r+l>=G)return x.toggle(X),!0}return x.isDoubleClickToToggle()&&Sb(o)?(x.toggle(X),!0):!1},_34o:function(f,g){var j=this.list,u=j.lp(f).x,r=j._levelMap[g._id],n=j._indent,I=n*(r+1);return u>=I&&I+n>=u?(j.checkData(g),void 0):(this.toggle(f,g,n,r)||j.setFocusData(g),void 0)},_33o:function(G,R){var u=this,t=u.list;u.toggle(G,R,t._indent,t.getLevel(R))||Xk.superClass._33o.call(u,G,R)},handle_keydown:function(L){if(Bk(L)||Vc(L)){var r=this.list,n=r._rows,h=r.isCheckMode(),Y=r.sm(),J=h?r.getFocusData():Y.ld();J?J.hasChildren()&&(Bk(L)?r.collapse(J):r.expand(J)):n.size()>0&&(J=n.get(0),h?r.setFocusData(J):Y.ss(J))}else Xk.superClass.handle_keydown.call(this,L)}});var js=Ek.TableView=function(g){this._98I(),this._5o(g),new wr(this)};qs("TableView",J,{ms_ac:[zd,zj,Xg,"sortMode",wn,Ce,Cp,nn,jr,mj,kq,"sortColumn",ki,lj,bb,yk,_b,Se,up],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:gg,_editable:!0,_batchEditable:!1,_rowHeight:kg,_rowLineVisible:w.tableViewRowLineVisible,_rowLineColor:w.tableViewRowLineColor,_columnLineVisible:w.tableViewColumnLineVisible,_columnLineColor:w.tableViewColumnLineColor,_scrollBarColor:jg,_scrollBarSize:el,_autoHideScrollBar:km,_autoMakeVisible:dp,_selectBackground:w.tableViewSelectBackground,_labelColor:w.tableViewLabelColor,_labelSelectColor:w.tableViewLabelSelectColor,_labelFont:w.tableViewLabelFont,getCheckColumn:function(){var P=this;if(!P._31o){var B=P._31o=new Od;B.setEditable(!0),B.setWidth(40),B.getValue=P.getCheckColumValue,B.drawCell=P.drawCheckColumnCell}return P._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(k){var P=this,N=P._39o,p=P.getCheckColumn();k!==P.isCheckMode()&&(k?N.add(p,0):N.remove(p),P.fp(Zm,!k,k))},getCheckColumValue:function(I,c,H){return H.isSelected(I)},drawCheckColumnCell:function(r,b,B,z,q,Z,M,Y,S){Cn(r,S.getCheckIcon(b),q+M/2,Z+Y/2,b,S)}});var wr=function(b){lr(wr,this,[b])};eh(wr,Br,{_34o:function(N,n){var f=this.list,V=f._31o;if(f.isCellEditable(n,V,N)){var G=f._3Q(V),T=f.lp(N).x;if(G&&T>=G.startX&&T<G.startX+V.getWidth())return f.checkData(n),void 0}f._37O(n,N),f.setFocusData(n)},_33o:function(D,M){this.list._37O(M,D),wr.superClass._33o.apply(this,arguments)}});var Tk=Ek.TreeTableView=function(e){var q=this,a=q._4o=new Od;q._35o(),q._98I(),q._5o(e),a.setDisplayName("Name"),a.setEditable(!0),a.setWidth(180),a.drawCell=cs,a.getValue=sf,q._39o.add(a),new mb(q)},cs=function(T,z,N,Z,Y,v,j,y,W){W._97I(T,z,N,Y,v,j,y)},sf=function(K,m,M){return M.getLabel(K)};qs("TreeTableView",J,{ms_ac:[zd,zj,Xg,"sortMode",wn,Ce,Ic,Zm,"rootData","rootVisible",ki,lj,"sortColumn",Ph,Jp,bb,yk,_b,Se,jr,Cp,nn,mj,kq,up,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:gg,_checkMode:B,_editable:!0,_batchEditable:!1,_indent:sp,_rowHeight:kg,_rowLineVisible:w.treeTableViewRowLineVisible,_rowLineColor:w.treeTableViewRowLineColor,_columnLineVisible:w.treeTableViewColumnLineVisible,_columnLineColor:w.treeTableViewColumnLineColor,_expandIcon:w.treeTableViewExpandIcon,_collapseIcon:w.treeTableViewCollapseIcon,_scrollBarColor:jg,_scrollBarSize:el,_autoHideScrollBar:km,_autoMakeVisible:dp,_selectBackground:w.treeTableViewSelectBackground,_labelColor:w.treeTableViewLabelColor,_labelSelectColor:w.treeTableViewLabelSelectColor,_labelFont:w.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var mb=function(d){lr(mb,this,[d])};eh(mb,Br,{_34o:function(Q,q){var W=this.list,F=W._4o,A=W._3Q(F),U=W.lp(Q).x;if(A){var k=W._indent,i=A.startX+k*W.getLevel(q);if(Ve(W.getToggleIcon(q))&&U>=i&&i+k>=U)return W.toggle(q),void 0;if(W.isCellEditable(q,F)&&(i+=k,U>=i&&i+k>=U))return W.checkData(q),void 0}W._37O(q,Q),W.setFocusData(q)},_33o:function(i,B){var s=this.list,N=s.lp(i).x;if(Ve(s.getToggleIcon(B))){var W=s._3Q(s._4o);if(W){var K=s._indent,t=W.startX+K*s.getLevel(B);if(N>=t&&t+K>=N)return s.toggle(B),void 0}}s._37O(B,i),mb.superClass._33o.apply(this,arguments)}});var Fd=Ek.TableHeader=function(u){var A=this,f=A._view=wk(1,A),V=A._39o=u.getColumnModel(),x=A.iv;A.tv=A._tableView=u,A._60I=new Vn,A._canvas=vn(f),f.style.background=w.tableHeaderBackground||"",f.style.height=hc+bi,V.mm(x,A),V.md(x,A),V.mh(x,A),u.mp(function(n){Fh[n.property]&&A.iv()},A),new Gn(A),A.iv()};qs("TableHeader",J,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",zd,Xg,Ic,"moveBackground","insertColor",mj,kq,"resizable","movable"],_checkIcon:Dh,_movable:!0,_resizable:!0,_labelColor:w.tableHeaderLabelColor,_labelFont:w.tableHeaderLabelFont,_columnLineColor:w.tableHeaderColumnLineColor,_columnLineVisible:w.tableHeaderColumnLineVisible,_sortDescIcon:w.tableHeaderSortDescIcon,_sortAscIcon:w.tableHeaderSortAscIcon,_moveBackground:w.tableHeaderMoveBackground,_insertColor:w.tableHeaderInsertColor,_indent:sp,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(I){return I.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(c){return c.getColor()||this._labelColor},getLabelAlign:function(G){return G._align},onPropertyChanged:function(){this.iv()},_5Q:function(g){this._61I=g,this.iv()},getLogicalPoint:function(k){return xn(k,this._canvas,this.tv.tx())},validateImpl:function(){var w=this,f=w._canvas,l=w.getWidth(),X=w.getHeight(),r=w.tv,J=w._60I,T=w._61I,j=-r.tx(),M=0;(l!==f.clientWidth||X!==f.clientHeight)&&Lg(f,l,X),J.clear(),w._39o._roots.each(function(g){if(g.isVisible()){var N=M+g.getWidth();j+l>=M&&N>=j&&J.add({column:g,startX:M}),M=N}});var D=oj(f);if(Id(D,-j,0,1),D.beginPath(),D.rect(j,0,l,X),D.clip(),D.clearRect(j,0,l,X),J.each(function(L){var Q=L.column,_=L.startX,V=Q.getWidth();V>0&&(D.save(),D.beginPath(),D.rect(_,0,V,X),D.clip(),T&&T.column===Q||w.drawColumn(D,Q,_,0,V,X),w._columnLineVisible&&Xc(D,_+V-1,0,1,X,w._columnLineColor),D.restore())}),T){var N=T.column,M=T.startX,v=T.position,W=N.getWidth();D.save(),D.beginPath(),D.rect(M,0,W,X),D.clip(),D.fillStyle=w._moveBackground,D.fill(),w.drawColumn(D,N,M,0,W,X),D.restore(),Ak(D,w._insertColor,v,0,X)}D.restore()},_6Q:function(l){var E=this.tv;return E._31o===l&&E.sm().getSelectionMode()===hp},drawColumn:function(g,L,h,r,d,m){var Q=this,Y=Q.tv,v=Ve(L.getIcon()),P=Q.getLabelAlign(L);if(Q._6Q(L)){var i=Ve(Q._checkIcon);Cn(g,i,h+d/2,r+m/2,L,Q)}else{var u=Q.getLabel(L),T=Q.getLabelFont(L),O=Q.getLabelColor(L),n=ad(T,u).width,k=v?Q._indent:0;P===ue?(v&&fl(g,v,Qi,h,r,k,m),ep(g,u,T,O,h+k,r,d,m,ue)):P===cg?(v&&fl(g,v,Qi,h+d-n-k,r,k,m),ep(g,u,T,O,h,r,d,m,cg)):(v&&fl(g,v,Qi,h+(d-n-k)/2,r,k,m),ep(g,u,T,O,h+(d-n+k)/2,r,0,m,ue))}if(L.isSortable()&&Y.getSortColumn()===L&&(v=Ve(L.getSortOrder()===vo?Q._sortAscIcon:Q._sortDescIcon))){var B=Sg(v,L)/2+2;Cn(g,v,P===cg?h+B:h+d-B,r+m/2,L,Y)}}});var Gn=function(X){var d=this;d.th=X,d.tv=X._tableView,d.addListeners()};eh(Gn,J,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(d){this.getView().style.cursor=d},handle_mousemove:function(J){if(!Kn){var U=this;delete U._29o,U.setCursor(Cb);for(var O=U.th,L=O._60I,C=O.lp(J).x,w=L.size()-1;w>=0;w--){var $=L.get(w),N=$.column,I=$.startX+N.getWidth();if(O.isResizable()&&j(I-C)<=(xc?10:3))return U._29o=$,U.setCursor(jk),void 0;C>$.startX&&I>C&&(U._29o=$),(N.isClickable()||N.isSortable()||O.isMovable()||U.tv.getCheckColumn&&N===U.tv.getCheckColumn())&&C>$.startX&&I>C&&U.setCursor(Vk)}}},handle_mousedown:function(Z){this.handle_touchstart(Z)},handle_touchstart:function(B){var m=this;xh(B),m.tv.endEditing(),m.handle_mousemove(B),m._29o&&(m.x=pr(B).x,m.lx=m.th.lp(B).x,m.w=m._29o.column.getWidth(),bh(m,B))},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(n){var U=this,x=U.th,R=U.getView().style.cursor,M=U._29o,h=pr(n).x-U.x;if(U.resizing||U.moving||(R===jk?U.resizing=1:x.isMovable()&&R===Vk&&j(h)>2&&(U.moving=1)),U.resizing)M.column.setWidth(U.w+h);else if(U.moving){var $=U.lx+h;x._60I.each(function(T){var w=T.startX,V=w+T.column.getWidth();if($>=w&&V>=$){var t={column:M.column,startX:M.startX+h,front:V-$>$-w,insertColumn:T.column};t.position=t.front?w:V,x._5Q(t)}})}},_16Q:function(n,C){var f=this,g=f.tv,x=f.th,k=x._checkIcon;if(x._6Q(n)){var r=Ve(k),S=f.lx,Z=n.getWidth(),o=Sg(r,n);if(S>=C+Z/2-o&&C+Z/2+o>=S){x.setCheckIcon(k===fg?Dh:fg);var b=g.sm(),d=g._rows;return k===fg?b.rs(d):b.ss(d),g.onCheckColumnClicked(n),!0}}return!1},handleWindowMouseUp:function(f){this.handleWindowTouchEnd(f)},handleWindowTouchEnd:function(O){var u=this,Z=u.tv,K=u.th,H=u._29o;if(u.moving){var q=K._61I;if(q&&q.insertColumn!==q.column){var c=q.column,J=Z.getColumnModel()._roots,G=J.remove(c),w=J.indexOf(q.insertColumn);w>=0&&(q.front||w++,w<=J.size()&&(J.add(c,w),Z.getColumnModel()._38I(c,G,w)))}K._5Q(B),delete u.moving}else if(!u.resizing&&H){c=H.column;var Q=K.lp(O).x,p=H.startX,P=!0;if(K.onColumnClicked){var v=K.onColumnClicked(c,O,p);v===!1&&(P=!1)}if(P&&Q>=p&&Q<=p+c.getWidth()&&!u._16Q(c,p)){if(c.isSortable()){var x=Z.getSortMode(),E=c.getSortOrder();x===gg?Z.getSortColumn()===c?(E===hs&&Z.setSortColumn(B),c.setSortOrder(E===vo?hs:vo)):Z.setSortColumn(c):"bistate"===x&&(Z.getSortColumn()===c?c.setSortOrder(E===vo?hs:vo):Z.setSortColumn(c))}Z.onColumnClicked(c,O,p)}}u._29o=u.resizing=u.x=u.lx=u.w=B}}),Ek.TablePane=function(j){this.init(new js(j))},qs("TablePane",J,{ms_v:1,_44o:1}),Ek.TreeTablePane=function(x){this.init(new Tk(x))},qs("TreeTablePane",J,{ms_v:1,_44o:1}),Ek.Toolbar=function(N){var J=this,Q=J._view=wk(1,J),f=Q.style;f.background=w.toolbarBackground||"",f.height=Bj+bi,J._canvas=vn(Q),J._30o=new Vn,J._90I=new Vn,J.setItems(N||[]),Q.handleGroupSelectedChanged=function(i){if(i.isSelected()){var B=i.getGroupId();null!=B&&J._items.forEach(function(h){var D=h.element;D&&D!==i&&D.setSelected&&D.getGroupId&&D.getGroupId()===B&&D.setSelected(!1)})}},new qm(J)},qs("Toolbar",J,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Si,zd,Xg,zj,up,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:w.toolbarLabelColor,_labelSelectColor:w.toolbarLabelSelectColor,_labelFont:w.toolbarLabelFont,_selectBackground:w.toolbarSelectBackground,_itemGap:w.toolbarItemGap,_separatorColor:w.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(Y){var s=this.getItemInfoAt(Y);return s?s.item.toolTip:B},getLabelColor:function(B){return B&&B.selected&&B.type!==fg&&B.type!==Uk?this._labelSelectColor:this._labelColor},onPropertyChanged:function(n){this.iv(),n.property===Si&&this._items.forEach(function(O){zm(O)})},redraw:function(){this.iv()},addItem:function(D,T){var A=this._items;T==B?A.push(D):A.splice(T,0,D),this.fp(Si,B,A)},removeItem:function(E){if(E)for(var w=this._items,A=0;A<w.length;A++)E===w[A]&&(w.splice(A,1),this.fp(Si,B,w))},removeItemById:function(Q){if(Q!=B)for(var X=this._items,t=0;t<X.length;t++)if(Q===X[t].id){var D=X.splice(t,1)[0];return this.fp(Si,B,X),D}},getItemById:function(I){if(I!=B)for(var c=this._items,v=0;v<c.length;v++){var u=c[v];if(I===u.id)return u}},setItemVisible:function(u,o){var F=this.getItemById(u);F&&(F.visible=o)},getItemInfos:function(){return this._30o},getItemInfoAt:function(F){var w=this,h=0,x=w._30o,J=w.lp(F),c=J.x,I=J.y;if(I>=0&&I<=w.getHeight())for(;h<x.size();h++){var R=x.get(h);if(R.startX<=c&&c<=R.endX)return R}return B},drawItem:function(H,Y,m,q,B){if(Y.visible===!1)return 0;if(Im(Y.visible)&&!Y.visible())return 0;var U=this,b=Y.disabled;b&&(H.globalAlpha=Pi);var e=U.drawItemImpl(H,Y,m,q,B),S=U._itemGap;return b&&(H.globalAlpha=1),this._currentItem!==Y||"separator"===Y||Y.separator===!0||Y.unfocusable||Dr(H,U._separatorColor,m-S/2,0,e+S,q),e},drawItemImpl:function(O,g,r,J,p){var N=this,M=N._view,j=N._itemGap,y=J/2,$=g.type,f=g.element,R=g.label;Ug(f)&&(R=f,f=B);var C,G=N.getLabelFont(g),W=N.getLabelColor(g),e=g.selected,U=Ve(g.icon),S=Sg(U,g),o=0,k=S+(R?ad(G,R).width:0);if("separator"===g||g.separator===!0)return Ak(O,N._separatorColor,r,J/4,y),1;if(f){U&&Cn(O,U,r+S/2,y,g,N),ep(O,R,G,W,r+S,0,0,J);var H=Be(f);p||N._90I.add(H),H.parentNode!==M&&Oi(M,H),f.iv&&f.iv(),f.validate&&f.validate();var t=H.getBoundingClientRect(),u=t.width,d=H.style;return Fi(H),d.left=N.tx()+r+k+bi,d.top=(J-t.height)/2+bi,k+u}return $===Uk?C=Ve(e?Xf:of):$===fg&&(C=Ve(e?fg:Dh)),C?(o=Sg(C,g),Cn(O,C,r+o/2,y,g,N),r+=o,k+=o):e&&Xc(O,r-j/2,0,k+j,J,N.getSelectBackground(g)),U&&Cn(O,U,r+S/2,y,g,N),ep(O,R,G,W,r+S,0,0,J),k},validateImpl:function(){var D=this,b=D._canvas,Z=D.getWidth(),k=D.getHeight(),g=D._30o,B=D._items;Lg(b,Z,k);var A=oj(b),W=D._itemGap,F=W/2;Id(A,D.tx(),0,1),A.clearRect(0,0,Z,k);var S=D._90I;D._90I=new Vn,g.clear(),B.forEach(function(M){var j=D.drawItem(A,M,F,k);g.add({item:M,startX:F,endX:F+j,width:j}),j&&(F+=j+W)}),S.each(function(h){D._90I.contains(h)||ih(h)});var h=D._64I;D._64I=_(0,F),A.restore(),D._stickToRight?(D._65O=0,A=oj(b),F=Z-D._64I+W,Id(A,0,0,1),A.clearRect(0,0,Z,k),g.clear(),B.forEach(function(r){var Q=D.drawItem(A,r,F,k,!0);g.add({item:r,startX:F,endX:F+Q,width:Q}),Q&&(F+=Q+W)}),A.restore()):D.tx(D.tx()),h!==D._64I&&D.onSumWidthChanged(h,D._64I)},onSumWidthChanged:function(){},handleClick:function(w,g){var v=this,R=w.type,M=w.action,U=w.groupId,h=w.selected;w.disabled||(U!=B?h||(w.selected=!0,this._items.forEach(function(e){e.groupId===U&&w!==e&&(e.selected=!1)}),M&&w.action(w,v,g)):R===fg||"toggle"===R?(w.selected=!h,M&&w.action(w,v,g)):M&&w.action(w,v,g)),rh(),v.iv()}});var qm=function(S){this.tb=S,this.addListeners()};eh(qm,J,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(V){this.handleScroll(V,10*(V.wheelDelta/40))
},handle_DOMMouseScroll:function(s){this.handleScroll(s,10*-s.detail)},handleScroll:function(r,Z){xh(r);var c=this.tb;c.isScrollable()&&!c._stickToRight&&(c.tx(c.tx()+Z),Uo())},handle_mousemove:function(W){var b=this;Kn||b.setItem(W)},handle_mouseout:function(x){var U=this;x.target===U.getView()?U.tb.setCurrentItem(B):U.handle_mousemove(x)},handle_mousedown:function(d){this.handle_mousemove(d),this.handle_touchstart(d)},handle_touchstart:function(E){var O=this,p=O.tb,W=E.target;yi(E)&&(W===O.getView()||W===p._canvas)&&(xh(E),p.setFocus(E)&&(this.setItem(E,!0),(p.isScrollable()||O.info&&!O.info.item.disabled)&&(O.x=pr(E).x,O.tx=p.tx(),bh(O,E))))},handleWindowMouseMove:function(J){this.handleWindowTouchMove(J)},handleWindowTouchMove:function(u){var A=this,k=A.tb;if(!k._stickToRight){var T=pr(u).x-A.x;!A._25o&&j(T)>2&&k.isScrollable()&&(A._25o=1),A._25o&&k.tx(A.tx+T)}},handleWindowMouseUp:function(o){this.handleWindowTouchEnd(o)},handleWindowTouchEnd:function(X){var _=this,t=_.tb,y=_.info,n=_.tb.getItemInfoAt(X);if(!_._25o&&y){var D=y.item;n&&n.item===D&&t.handleClick(D,X)}_._25o=_.x=_.tx=B,_.setItem()},setItem:function(c,H){var h=this,A=h.tb,f=h.info=c?A.getItemInfoAt(c):B,W=f?f.item:B;A.setCurrentItem(W),H&&W&&Im(W.onDown)&&W.onDown(c)}}),Ek.BorderPane=function(){this._view=wk(1,this),this.iv()},qs("BorderPane",J,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(w,V){this._12o("leftView",w),V!=B&&this.setLeftWidth(V)},getRightView:function(){return this._rightView},setRightView:function(h,i){this._12o("rightView",h),i!=B&&this.setRightWidth(i)},getTopView:function(){return this._topView},setTopView:function(r,G){this._12o("topView",r),G!=B&&this.setTopHeight(G)},getBottomView:function(){return this._bottomView},setBottomView:function(y,j){this._12o("bottomView",y),j!=B&&this.setBottomHeight(j)},getCenterView:function(){return this._centerView},setCenterView:function(M){this._12o("centerView",M)},_12o:function(Y,t){var h=this,U="_"+Y,J=h._view,Z=h[U];Z!==t&&(Z&&(Z.getView?ih(Z.getView()):ih(Z)),h[U]=t,t&&(t.getView?Oi(J,t.getView(),1):Oi(J,t,1)),h.fp(Y,Z,t))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var X=this,I=X._topView,J=X._bottomView,e=X._leftView,b=X._rightView,l=X._centerView,Q=X.getWidth(),i=X.getHeight(),q=0,v=0,m=Q,K=i,z=0,h=0,O=0,T=0;I&&(z=X._topHeight==B?$i(I):X._topHeight,v=z),J&&(h=X._bottomHeight==B?$i(J):X._bottomHeight,K=i-h),e&&(O=X._leftWidth==B?qc(e):X._leftWidth,q=O),b&&(T=X._rightWidth==B?qc(b):X._rightWidth,m=Q-T);var p=_(0,m-q),r=_(0,K-v);I&&Bb(I,0,0,Q,z),J&&Bb(J,0,K,Q,h),e&&Bb(e,0,v,O,r),b&&Bb(b,m,v,T,r),l&&Bb(l,q,v,p,r)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);